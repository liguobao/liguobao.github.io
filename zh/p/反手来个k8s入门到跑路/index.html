<!doctype html><html lang=zh dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="åæ‰‹æ¥ä¸ªK8Så…¥é—¨åˆ°è·‘è·¯ å‰è¨€ æ”¾å‡å‰ä¸€ä¸¤å¤©å‘ç°è…¾è®¯äº‘æ‰˜ç®¡K8Sé›†ç¾¤ä¸Šçº¿å¥½ä¸€é˜µå­äº†, è¿˜æ”¯æŒæŠŠåŸæœ‰ä¸»æœºè¿å…¥k8sé›†ç¾¤, ç´¢æ€§å¼€å§‹æäº‹äº†.\nå…ˆç®€å•ç§‘æ™®ä¸€ä¸‹, ä»€ä¹ˆæ˜¯k8s?\nk8s ç§‘æ™®æ—¶é—´ Kubernetes (K8s) is an open-source system for automating deployment, scaling, and management of containerized applications. It groups containers that make up an application into logical units for easy management and discovery. Kubernetes builds upon 15 years of experience of running production workloads at Google, combined with best-of-breed ideas and practices from the community. æ¥è‡ª:https://kubernetes.io/\n1 2 3 4 5 6 7 8 9 Kubernetesæ˜¯ä¸€ä¸ªå¼€æºçš„ï¼Œç”¨äºç®¡ç†äº‘å¹³å°ä¸­å¤šä¸ªä¸»æœºä¸Šçš„å®¹å™¨åŒ–çš„åº”ç”¨ï¼ŒKubernetesçš„ç›®æ ‡æ˜¯è®©éƒ¨ç½²å®¹å™¨åŒ–çš„åº”ç”¨ç®€å•å¹¶ä¸”é«˜æ•ˆï¼ˆpowerfulï¼‰,Kubernetesæä¾›äº†åº”ç”¨éƒ¨ç½²ï¼Œè§„åˆ’ï¼Œæ›´æ–°ï¼Œç»´æŠ¤çš„ä¸€ç§æœºåˆ¶ã€‚ Kubernetesä¸€ä¸ªæ ¸å¿ƒçš„ç‰¹ç‚¹å°±æ˜¯èƒ½å¤Ÿè‡ªä¸»çš„ç®¡ç†å®¹å™¨æ¥ä¿è¯äº‘å¹³å°ä¸­çš„å®¹å™¨æŒ‰ç…§ç”¨æˆ·çš„æœŸæœ›çŠ¶æ€è¿è¡Œç€ï¼ˆæ¯”å¦‚ç”¨æˆ·æƒ³è®©apacheä¸€ç›´è¿è¡Œï¼Œç”¨æˆ·ä¸éœ€è¦å…³å¿ƒæ€ä¹ˆå»åšï¼ŒKubernetesä¼šè‡ªåŠ¨å»ç›‘æ§ï¼Œç„¶åå»é‡å¯ï¼Œæ–°å»º. æ€»ä¹‹ï¼Œè®©apacheä¸€ç›´æä¾›æœåŠ¡ï¼‰ï¼Œç®¡ç†å‘˜å¯ä»¥åŠ è½½ä¸€ä¸ªå¾®å‹æœåŠ¡ï¼Œè®©è§„åˆ’å™¨æ¥æ‰¾åˆ°åˆé€‚çš„ä½ç½®. åŒæ—¶ï¼ŒKubernetesä¹Ÿç³»ç»Ÿæå‡å·¥å…·ä»¥åŠäººæ€§åŒ–æ–¹é¢ï¼Œè®©ç”¨æˆ·èƒ½å¤Ÿæ–¹ä¾¿çš„éƒ¨ç½²è‡ªå·±çš„åº”ç”¨ï¼ˆå°±åƒcanary deploymentsï¼‰ã€‚ -- [https://www.kubernetes.org.cn/k8s](https://www.kubernetes.org.cn/k8s) ç”¨äººè¯æ¥è¯´, é¦–å…ˆæˆ‘ä»¬ä»¥å‰å·²ç»æŠŠæ‰€æœ‰çš„æœåŠ¡(server/api)éƒ½Dockerå®¹å™¨åŒ–äº†,\n"><title>åæ‰‹æ¥ä¸ªK8Så…¥é—¨åˆ°è·‘è·¯</title><link rel=canonical href=https://liguobao.github.io/zh/p/%E5%8F%8D%E6%89%8B%E6%9D%A5%E4%B8%AAk8s%E5%85%A5%E9%97%A8%E5%88%B0%E8%B7%91%E8%B7%AF/><link rel=stylesheet href=/scss/style.min.6a692fd055deae459f2a9767f57f3855ba80cafd5041317f24f7360f6ca47cdf.css><meta property='og:title' content="åæ‰‹æ¥ä¸ªK8Så…¥é—¨åˆ°è·‘è·¯"><meta property='og:description' content="åæ‰‹æ¥ä¸ªK8Så…¥é—¨åˆ°è·‘è·¯ å‰è¨€ æ”¾å‡å‰ä¸€ä¸¤å¤©å‘ç°è…¾è®¯äº‘æ‰˜ç®¡K8Sé›†ç¾¤ä¸Šçº¿å¥½ä¸€é˜µå­äº†, è¿˜æ”¯æŒæŠŠåŸæœ‰ä¸»æœºè¿å…¥k8sé›†ç¾¤, ç´¢æ€§å¼€å§‹æäº‹äº†.\nå…ˆç®€å•ç§‘æ™®ä¸€ä¸‹, ä»€ä¹ˆæ˜¯k8s?\nk8s ç§‘æ™®æ—¶é—´ Kubernetes (K8s) is an open-source system for automating deployment, scaling, and management of containerized applications. It groups containers that make up an application into logical units for easy management and discovery. Kubernetes builds upon 15 years of experience of running production workloads at Google, combined with best-of-breed ideas and practices from the community. æ¥è‡ª:https://kubernetes.io/\n1 2 3 4 5 6 7 8 9 Kubernetesæ˜¯ä¸€ä¸ªå¼€æºçš„ï¼Œç”¨äºç®¡ç†äº‘å¹³å°ä¸­å¤šä¸ªä¸»æœºä¸Šçš„å®¹å™¨åŒ–çš„åº”ç”¨ï¼ŒKubernetesçš„ç›®æ ‡æ˜¯è®©éƒ¨ç½²å®¹å™¨åŒ–çš„åº”ç”¨ç®€å•å¹¶ä¸”é«˜æ•ˆï¼ˆpowerfulï¼‰,Kubernetesæä¾›äº†åº”ç”¨éƒ¨ç½²ï¼Œè§„åˆ’ï¼Œæ›´æ–°ï¼Œç»´æŠ¤çš„ä¸€ç§æœºåˆ¶ã€‚ Kubernetesä¸€ä¸ªæ ¸å¿ƒçš„ç‰¹ç‚¹å°±æ˜¯èƒ½å¤Ÿè‡ªä¸»çš„ç®¡ç†å®¹å™¨æ¥ä¿è¯äº‘å¹³å°ä¸­çš„å®¹å™¨æŒ‰ç…§ç”¨æˆ·çš„æœŸæœ›çŠ¶æ€è¿è¡Œç€ï¼ˆæ¯”å¦‚ç”¨æˆ·æƒ³è®©apacheä¸€ç›´è¿è¡Œï¼Œç”¨æˆ·ä¸éœ€è¦å…³å¿ƒæ€ä¹ˆå»åšï¼ŒKubernetesä¼šè‡ªåŠ¨å»ç›‘æ§ï¼Œç„¶åå»é‡å¯ï¼Œæ–°å»º. æ€»ä¹‹ï¼Œè®©apacheä¸€ç›´æä¾›æœåŠ¡ï¼‰ï¼Œç®¡ç†å‘˜å¯ä»¥åŠ è½½ä¸€ä¸ªå¾®å‹æœåŠ¡ï¼Œè®©è§„åˆ’å™¨æ¥æ‰¾åˆ°åˆé€‚çš„ä½ç½®. åŒæ—¶ï¼ŒKubernetesä¹Ÿç³»ç»Ÿæå‡å·¥å…·ä»¥åŠäººæ€§åŒ–æ–¹é¢ï¼Œè®©ç”¨æˆ·èƒ½å¤Ÿæ–¹ä¾¿çš„éƒ¨ç½²è‡ªå·±çš„åº”ç”¨ï¼ˆå°±åƒcanary deploymentsï¼‰ã€‚ -- [https://www.kubernetes.org.cn/k8s](https://www.kubernetes.org.cn/k8s) ç”¨äººè¯æ¥è¯´, é¦–å…ˆæˆ‘ä»¬ä»¥å‰å·²ç»æŠŠæ‰€æœ‰çš„æœåŠ¡(server/api)éƒ½Dockerå®¹å™¨åŒ–äº†,\n"><meta property='og:url' content='https://liguobao.github.io/zh/p/%E5%8F%8D%E6%89%8B%E6%9D%A5%E4%B8%AAk8s%E5%85%A5%E9%97%A8%E5%88%B0%E8%B7%91%E8%B7%AF/'><meta property='og:site_name' content='äººç”Ÿåˆ é™¤æŒ‡å—'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='linux'><meta property='article:tag' content='k8s'><meta property='article:published_time' content='2019-06-09T00:00:00+00:00'><meta property='article:modified_time' content='2019-06-09T00:00:00+00:00'><meta name=twitter:title content="åæ‰‹æ¥ä¸ªK8Så…¥é—¨åˆ°è·‘è·¯"><meta name=twitter:description content="åæ‰‹æ¥ä¸ªK8Så…¥é—¨åˆ°è·‘è·¯ å‰è¨€ æ”¾å‡å‰ä¸€ä¸¤å¤©å‘ç°è…¾è®¯äº‘æ‰˜ç®¡K8Sé›†ç¾¤ä¸Šçº¿å¥½ä¸€é˜µå­äº†, è¿˜æ”¯æŒæŠŠåŸæœ‰ä¸»æœºè¿å…¥k8sé›†ç¾¤, ç´¢æ€§å¼€å§‹æäº‹äº†.\nå…ˆç®€å•ç§‘æ™®ä¸€ä¸‹, ä»€ä¹ˆæ˜¯k8s?\nk8s ç§‘æ™®æ—¶é—´ Kubernetes (K8s) is an open-source system for automating deployment, scaling, and management of containerized applications. It groups containers that make up an application into logical units for easy management and discovery. Kubernetes builds upon 15 years of experience of running production workloads at Google, combined with best-of-breed ideas and practices from the community. æ¥è‡ª:https://kubernetes.io/\n1 2 3 4 5 6 7 8 9 Kubernetesæ˜¯ä¸€ä¸ªå¼€æºçš„ï¼Œç”¨äºç®¡ç†äº‘å¹³å°ä¸­å¤šä¸ªä¸»æœºä¸Šçš„å®¹å™¨åŒ–çš„åº”ç”¨ï¼ŒKubernetesçš„ç›®æ ‡æ˜¯è®©éƒ¨ç½²å®¹å™¨åŒ–çš„åº”ç”¨ç®€å•å¹¶ä¸”é«˜æ•ˆï¼ˆpowerfulï¼‰,Kubernetesæä¾›äº†åº”ç”¨éƒ¨ç½²ï¼Œè§„åˆ’ï¼Œæ›´æ–°ï¼Œç»´æŠ¤çš„ä¸€ç§æœºåˆ¶ã€‚ Kubernetesä¸€ä¸ªæ ¸å¿ƒçš„ç‰¹ç‚¹å°±æ˜¯èƒ½å¤Ÿè‡ªä¸»çš„ç®¡ç†å®¹å™¨æ¥ä¿è¯äº‘å¹³å°ä¸­çš„å®¹å™¨æŒ‰ç…§ç”¨æˆ·çš„æœŸæœ›çŠ¶æ€è¿è¡Œç€ï¼ˆæ¯”å¦‚ç”¨æˆ·æƒ³è®©apacheä¸€ç›´è¿è¡Œï¼Œç”¨æˆ·ä¸éœ€è¦å…³å¿ƒæ€ä¹ˆå»åšï¼ŒKubernetesä¼šè‡ªåŠ¨å»ç›‘æ§ï¼Œç„¶åå»é‡å¯ï¼Œæ–°å»º. æ€»ä¹‹ï¼Œè®©apacheä¸€ç›´æä¾›æœåŠ¡ï¼‰ï¼Œç®¡ç†å‘˜å¯ä»¥åŠ è½½ä¸€ä¸ªå¾®å‹æœåŠ¡ï¼Œè®©è§„åˆ’å™¨æ¥æ‰¾åˆ°åˆé€‚çš„ä½ç½®. åŒæ—¶ï¼ŒKubernetesä¹Ÿç³»ç»Ÿæå‡å·¥å…·ä»¥åŠäººæ€§åŒ–æ–¹é¢ï¼Œè®©ç”¨æˆ·èƒ½å¤Ÿæ–¹ä¾¿çš„éƒ¨ç½²è‡ªå·±çš„åº”ç”¨ï¼ˆå°±åƒcanary deploymentsï¼‰ã€‚ -- [https://www.kubernetes.org.cn/k8s](https://www.kubernetes.org.cn/k8s) ç”¨äººè¯æ¥è¯´, é¦–å…ˆæˆ‘ä»¬ä»¥å‰å·²ç»æŠŠæ‰€æœ‰çš„æœåŠ¡(server/api)éƒ½Dockerå®¹å™¨åŒ–äº†,\n"><link rel="shortcut icon" href=/favicon.png></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/zh/><img src=/img/zhihu-lgb_hu_2ad0a9defe137384.png width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>ğŸ¥</span></figure><div class=site-meta><h1 class=site-name><a href=/zh>äººç”Ÿåˆ é™¤æŒ‡å—</a></h1><h2 class=site-description>liguobao</h2></div></header><ol class=menu-social><li><a href=https://github.com/liguobao target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://x.com/Liguobao2049 target=_blank title=Twitter rel=me><svg class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M22 4.01c-1 .49-1.98.689-3 .99-1.121-1.265-2.783-1.335-4.38-.737S11.977 6.323 12 8v1c-3.245.083-6.135-1.395-8-4 0 0-4.182 7.433 4 11-1.872 1.247-3.739 2.088-6 2 3.308 1.803 6.913 2.423 10.034 1.517 3.58-1.04 6.522-3.723 7.651-7.742a13.84 13.84.0 00.497-3.753C20.18 7.773 21.692 5.25 22 4.009z"/></svg></a></li><li><a href=https://www.zhihu.com/people/codelover target=_blank title=çŸ¥ä¹ rel=me><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/zh/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/zh/liguobao-resume/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>About</span></a></li><li><a href=/zh/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li><a href=/zh/links/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>Links</span></a></li><li class=menu-bottom-section><ol class=menu><li id=i18n-switch><svg class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 5h7"/><path d="M9 3v2c0 4.418-2.239 8-5 8"/><path d="M5 9c-.003 2.144 2.952 3.908 6.7 4"/><path d="M12 20l4-9 4 9"/><path d="M19.1 18h-6.2"/></svg>
<select name=language title=language onchange="window.location.href=this.selectedOptions[0].value"><option value=https://liguobao.github.io/zh/ selected>ç®€ä½“ä¸­æ–‡</option><option value=https://liguobao.github.io/>English</option></select></li><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#å‰è¨€>å‰è¨€</a><ol><li><a href=#k8s-ç§‘æ™®æ—¶é—´>k8s ç§‘æ™®æ—¶é—´</a></li></ol></li><li><a href=#ç¥è¯´-è¦æœ‰k8s>ç¥è¯´, è¦æœ‰k8s.</a><ol><li><a href=#ç®€å•ç§‘æ™®ä¸€ä¸‹k8sé‡Œé¢å¯¹äºæœºå™¨çš„å®šä¹‰>ç®€å•ç§‘æ™®ä¸€ä¸‹k8sé‡Œé¢å¯¹äºæœºå™¨çš„å®šä¹‰</a></li></ol></li><li><a href=#ç¥è¯´-è®©æˆ‘ä»¬è¦å¼€å§‹äº†>ç¥è¯´, è®©æˆ‘ä»¬è¦å¼€å§‹äº†</a><ol><li><a href=#åˆåˆ°æ¦‚å¿µæ—¶é—´-podservice>åˆåˆ°æ¦‚å¿µæ—¶é—´ Pod/Service</a></li></ol></li><li><a href=#ç¥è¯´-è¦å¼€å§‹å…¥é—¨äº†>ç¥è¯´, è¦å¼€å§‹å…¥é—¨äº†!</a></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><div class=article-title-wrapper><h2 class=article-title><a href=/zh/p/%E5%8F%8D%E6%89%8B%E6%9D%A5%E4%B8%AAk8s%E5%85%A5%E9%97%A8%E5%88%B0%E8%B7%91%E8%B7%AF/>åæ‰‹æ¥ä¸ªK8Så…¥é—¨åˆ°è·‘è·¯</a></h2></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>6æœˆ 09, 2019</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>3 minute read</time></div></footer><footer class=article-translations><svg class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 5h7"/><path d="M9 3v2c0 4.418-2.239 8-5 8"/><path d="M5 9c-.003 2.144 2.952 3.908 6.7 4"/><path d="M12 20l4-9 4 9"/><path d="M19.1 18h-6.2"/></svg><div><a href=https://liguobao.github.io/p/k8s-from-first-steps-to-cleanup-on-tencent-cloud/ class=link>English</a></div></footer></div></header><section class=article-content><h1 id=åæ‰‹æ¥ä¸ªk8så…¥é—¨åˆ°è·‘è·¯>åæ‰‹æ¥ä¸ªK8Så…¥é—¨åˆ°è·‘è·¯</h1><h2 id=å‰è¨€>å‰è¨€</h2><p>æ”¾å‡å‰ä¸€ä¸¤å¤©å‘ç°è…¾è®¯äº‘æ‰˜ç®¡K8Sé›†ç¾¤ä¸Šçº¿å¥½ä¸€é˜µå­äº†, è¿˜æ”¯æŒæŠŠåŸæœ‰ä¸»æœºè¿å…¥k8sé›†ç¾¤, ç´¢æ€§å¼€å§‹æäº‹äº†.</p><p>å…ˆç®€å•ç§‘æ™®ä¸€ä¸‹, ä»€ä¹ˆæ˜¯k8s?</p><h3 id=k8s-ç§‘æ™®æ—¶é—´>k8s ç§‘æ™®æ—¶é—´</h3><blockquote><p>Kubernetes (K8s) is an open-source system for automating deployment, scaling, and management of containerized applications. It groups containers that make up an application into logical units for easy management and discovery. Kubernetes builds upon 15 years of experience of running production workloads at Google, combined with best-of-breed ideas and practices from the community. æ¥è‡ª:<a class=link href=https://kubernetes.io/ target=_blank rel=noopener>https://kubernetes.io/</a></p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Kubernetesæ˜¯ä¸€ä¸ªå¼€æºçš„ï¼Œç”¨äºç®¡ç†äº‘å¹³å°ä¸­å¤šä¸ªä¸»æœºä¸Šçš„å®¹å™¨åŒ–çš„åº”ç”¨ï¼ŒKubernetesçš„ç›®æ ‡æ˜¯è®©éƒ¨ç½²å®¹å™¨åŒ–çš„åº”ç”¨ç®€å•å¹¶ä¸”é«˜æ•ˆï¼ˆpowerfulï¼‰,Kubernetesæä¾›äº†åº”ç”¨éƒ¨ç½²ï¼Œè§„åˆ’ï¼Œæ›´æ–°ï¼Œç»´æŠ¤çš„ä¸€ç§æœºåˆ¶ã€‚
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Kubernetesä¸€ä¸ªæ ¸å¿ƒçš„ç‰¹ç‚¹å°±æ˜¯èƒ½å¤Ÿè‡ªä¸»çš„ç®¡ç†å®¹å™¨æ¥ä¿è¯äº‘å¹³å°ä¸­çš„å®¹å™¨æŒ‰ç…§ç”¨æˆ·çš„æœŸæœ›çŠ¶æ€è¿è¡Œç€ï¼ˆæ¯”å¦‚ç”¨æˆ·æƒ³è®©apacheä¸€ç›´è¿è¡Œï¼Œç”¨æˆ·ä¸éœ€è¦å…³å¿ƒæ€ä¹ˆå»åšï¼ŒKubernetesä¼šè‡ªåŠ¨å»ç›‘æ§ï¼Œç„¶åå»é‡å¯ï¼Œæ–°å»º.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>æ€»ä¹‹ï¼Œè®©apacheä¸€ç›´æä¾›æœåŠ¡ï¼‰ï¼Œç®¡ç†å‘˜å¯ä»¥åŠ è½½ä¸€ä¸ªå¾®å‹æœåŠ¡ï¼Œè®©è§„åˆ’å™¨æ¥æ‰¾åˆ°åˆé€‚çš„ä½ç½®.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>åŒæ—¶ï¼ŒKubernetesä¹Ÿç³»ç»Ÿæå‡å·¥å…·ä»¥åŠäººæ€§åŒ–æ–¹é¢ï¼Œè®©ç”¨æˆ·èƒ½å¤Ÿæ–¹ä¾¿çš„éƒ¨ç½²è‡ªå·±çš„åº”ç”¨ï¼ˆå°±åƒcanary deploymentsï¼‰ã€‚
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>-- [https://www.kubernetes.org.cn/k8s](https://www.kubernetes.org.cn/k8s)
</span></span></code></pre></td></tr></table></div></div><p>ç”¨äººè¯æ¥è¯´, é¦–å…ˆæˆ‘ä»¬ä»¥å‰å·²ç»æŠŠæ‰€æœ‰çš„æœåŠ¡(server/api)éƒ½Dockerå®¹å™¨åŒ–äº†,</p><p>k8så°±æ˜¯ä¸€å¥—ç”¨æ¥åšå®¹å™¨æœåŠ¡ç®¡ç†/ç¼–æ’çš„ç³»ç»Ÿ.</p><p>é‚£ä¹ˆæˆ‘ä»¬ç°åœ¨å¼€å§‹å§.</p><h2 id=ç¥è¯´-è¦æœ‰k8s>ç¥è¯´, è¦æœ‰k8s.</h2><ul><li>åˆå§‹åŒ–è‡ªå·±çš„è…¾è®¯äº‘/é˜¿é‡Œäº‘k8s å®¹å™¨æœåŠ¡</li></ul><p>ç™»å½•ä¸€ä¸‹è‡ªå·±çš„æŸäº‘å¹³å°, æ‰¾ä¸€ä¸‹"å®¹å™¨æœåŠ¡", æ–°å»ºé›†ç¾¤, é€‰"æ‰˜ç®¡é›†ç¾¤", ç‚¹ç‚¹ç‚¹ä¹‹åå®Œæˆé…ç½®.</p><p>ç„¶åæŠŠè‡ªå·±å·²æœ‰çš„æœºå™¨åŠ å…¥åˆ°ä¸Šé¢çš„é›†ç¾¤é‡Œé¢å», åŸºæœ¬ä¹Ÿæ˜¯åœ¨ç•Œé¢ä¸Šç‚¹ç‚¹ç‚¹å°±å¥½.</p><h3 id=ç®€å•ç§‘æ™®ä¸€ä¸‹k8sé‡Œé¢å¯¹äºæœºå™¨çš„å®šä¹‰>ç®€å•ç§‘æ™®ä¸€ä¸‹k8sé‡Œé¢å¯¹äºæœºå™¨çš„å®šä¹‰</h3><p>ä¸€ä¸ªæœºå™¨åœ¨k8sæ˜¯ä¸€ä¸ªèŠ‚ç‚¹,èŠ‚ç‚¹åˆ†æˆä¸¤ç§ç±»å‹,</p><ul><li><p>ä¸€ç±»æ˜¯masterèŠ‚ç‚¹, è·‘ç€ä¸€å †k8sæ ¸å¿ƒæœåŠ¡(etcdä¹‹ç±»çš„, å…·ä½“çš„è‡ªå·±å»äº†è§£å§);</p></li><li><p>ä¸€ç±»æ˜¯workerèŠ‚ç‚¹,ç”¨äºè·‘æˆ‘ä»¬è‡ªå·±çš„ä¸šåŠ¡æœåŠ¡(å¦‚,æŸä¸ªçˆ¬è™«)</p></li></ul><p>ä¸€èˆ¬æƒ…å†µä¸‹, æˆ‘ä»¬æŠŠæœåŠ¡æ‰”ç»™k8sè¿è¡Œèµ·æ¥çš„æ—¶å€™, å®é™…ä¸Šéƒ½æ˜¯åœ¨workerèŠ‚ç‚¹ä¸Šèµ·ä¸€ä¸ªDockerå®¹å™¨å®ä¾‹ + ç›¸å…³çš„é…ç½®.</p><p>è¿™è¾¹äº‘å¹³å°çš„æ‰˜ç®¡é›†ç¾¤å°±æ˜¯masterèŠ‚ç‚¹æˆ‘ä»¬ä¸ç®¡äº†, äº‘å¹³å°è´Ÿè´£å¥½, éœ€è¦çš„æœºå™¨å’Œé…ç½®éƒ½ç»™ä»–ä»¬æ;</p><p>æˆ‘ä»¬æŠŠè‡ªå·±çš„å·²ç»ä¹°è¿‡çš„æœºå™¨æˆ–è€…æ–°ä¹°çš„æœºå™¨åŠ å…¥åˆ°é›†ç¾¤é‡Œé¢, è‡ªå·±ç”¨å°±å®Œäº‹äº†.</p><p>æ‰€ä»¥&mldr;.</p><p>æˆ‘åˆæ¥æäº‹äº†.</p><h2 id=ç¥è¯´-è®©æˆ‘ä»¬è¦å¼€å§‹äº†>ç¥è¯´, è®©æˆ‘ä»¬è¦å¼€å§‹äº†</h2><p>ç­‰ä¸‹, ä¸Šé¢ç‚¹å®Œäº†, å…ˆæŠŠæœ¬åœ°çš„kubectlææ‚.</p><ul><li><p>å“ˆ? ä»€ä¹ˆæ˜¯kubectl.</p></li><li><p>å“¦, ç®¡ç†k8sçš„å‘½ä»¤è¡Œå·¥å…·.</p></li><li><p>æ²¡æœ‰å›¾å½¢ç•Œé¢å—?</p></li><li><p>æœ‰, ä¸è¿‡æŸäº‘åšçš„å¾ˆéš¾ç”¨, åŸç”Ÿçš„å‡‘åˆèƒ½çœ‹, ä¾¿äºç†è§£æ¦‚å¿µçš„æƒ…å†µä¸‹, è¿˜æ˜¯å…ˆç”¨ctlæèµ·å§.</p></li></ul><p>å®‰è£…æ•™ç¨‹: <a class=link href=https://cloud.tencent.com/document/product/457/8438 target=_blank rel=noopener>é€šè¿‡ Kubectl è¿æ¥é›†ç¾¤</a></p><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><p>å‡è£…åˆ°è¿™é‡Œåº”è¯¥éƒ½å¼„å¥½äº†.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl><span class=c1>## è¾“å…¥kubectl version æŸ¥çœ‹å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ç‰ˆæœ¬ä¿¡æ¯, èƒ½æ­£å¸¸è¾“å‡ºä¿¡æ¯è¯æ˜éƒ½workäº†</span>
</span></span><span class=line><span class=cl>âœ  codelover-blog git:<span class=o>(</span>master<span class=o>)</span> âœ— kubectl version
</span></span><span class=line><span class=cl>Client Version: version.Info<span class=o>{</span>Major:<span class=s2>&#34;1&#34;</span>, Minor:<span class=s2>&#34;11&#34;</span>, GitVersion:<span class=s2>&#34;v1.11.1&#34;</span>, GitCommit:<span class=s2>&#34;b1b29978270dc22fecc592ac55d903350454310a&#34;</span>, GitTreeState:<span class=s2>&#34;clean&#34;</span>, BuildDate:<span class=s2>&#34;2018-07-18T11:37:06Z&#34;</span>, GoVersion:<span class=s2>&#34;go1.10.3&#34;</span>, Compiler:<span class=s2>&#34;gc&#34;</span>, Platform:<span class=s2>&#34;darwin/amd64&#34;</span><span class=o>}</span>
</span></span><span class=line><span class=cl>Server Version: version.Info<span class=o>{</span>Major:<span class=s2>&#34;1&#34;</span>, Minor:<span class=s2>&#34;12+&#34;</span>, GitVersion:<span class=s2>&#34;v1.12.4-tke.1.1&#34;</span>, GitCommit:<span class=s2>&#34;900490ac7b7ae6a13aa6599d43258f1164e9c458&#34;</span>, GitTreeState:<span class=s2>&#34;clean&#34;</span>, BuildDate:<span class=s2>&#34;2019-01-30T10:22:33Z&#34;</span>, GoVersion:<span class=s2>&#34;go1.10.4&#34;</span>, Compiler:<span class=s2>&#34;gc&#34;</span>, Platform:<span class=s2>&#34;linux/amd64&#34;</span><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=åˆåˆ°æ¦‚å¿µæ—¶é—´-podservice>åˆåˆ°æ¦‚å¿µæ—¶é—´ Pod/Service</h3><ul><li><p><a class=link href=http://docs.kubernetes.org.cn/312.html target=_blank rel=noopener>Kubernetes Podæ¦‚è¿°</a></p></li><li><p><a class=link href=https://www.kubernetes.org.cn/kubernetes-services target=_blank rel=noopener>Kubernetes Servicesæ¦‚è¿°</a></p></li></ul><p>ç”¨äººè¯æ¥è¯´,</p><p>Podå°±æ˜¯ä¸€å †app(ä¸€ä¸ª/å¤šä¸ªDockerå®¹å™¨å®ä¾‹)çš„é›†åˆ;</p><p>Serviceå°±æ˜¯åœ¨k8så†…ç½‘åå¢ƒ"å¯¹å¤–"æä¾›æœåŠ¡çš„ä¸€ä¸ªå®ä½“;</p><p>æˆ‘ä»¬ç›´æ¥åœ¨ä¸¾ä¸ªæ —å­æ¥è¯´æ˜ä¸€ä¸‹.</p><ul><li><p>ä¸€ä¸ªæ”¯æŒæ°´å¹³æ‰©å±•çš„Web APIæœåŠ¡, æˆ‘ä»¬ä¸ºäº†é«˜å¯ç”¨éœ€è¦ç»™å®ƒéƒ¨ç½²äº†ä¸‰ä¸ªå®ä¾‹, è¿™é‡Œå°±æ˜¯ä¸€ä¸ªPod, ç”±ä¸‰ä¸ªå®ä¾‹ç»„æˆ</p></li><li><p>&ldquo;å¯¹å¤–&rdquo;(å…¶ä»–æœåŠ¡æˆ–è€…appéœ€è¦è®¿é—®å®ƒ)æ¥è¯´, æˆ‘ä»¬éœ€è¦ç›´æ¥è®¿é—®å®ƒä½†æ˜¯æœ‰æ²¡å¿…è¦çŸ¥é“å®ƒæœ‰å‡ ä¸ªå®ä¾‹, è¿™ä¸ªæ—¶å€™å°±æœ‰ä¸€ä¸ªServiceæ¥æ‰¿è½½å®ƒ, Serviceè´Ÿè´£æŠŠè¯·æ±‚ç›´æ¥è½¬å‘åˆ°Podä¸­, Podé‡Œé¢æœ‰å¤šå°‘å®ä¾‹å¯¹Serviceå’Œå¯¹è°ƒç”¨è€…æ¥è¯´éƒ½æ˜¯é€æ˜çš„.</p></li></ul><p>æ‰€ä»¥æˆ‘ä»¬æ¥éƒ¨ç½²æˆ‘ä»¬çš„ç¬¬ä¸€å¥—æœåŠ¡å§.</p><h2 id=ç¥è¯´-è¦å¼€å§‹å…¥é—¨äº†>ç¥è¯´, è¦å¼€å§‹å…¥é—¨äº†!</h2><p>å°†ä¸‹é¢çš„æ–‡ä»¶ä¿å­˜æˆsample.yaml, ç„¶åæ‰§è¡Œ &ldquo;kubectl apply -f sample.yaml&rdquo;</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nn>---</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>extensions/v1beta1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Deployment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># ç»™podæ‰“ä¸Šæ ‡ç­¾, å®šä¹‰service éœ€è¦ç”¨</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>first-web-size</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>first-web-size</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># å®ä¾‹ä¸ªæ•°</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>replicas</span><span class=p>:</span><span class=w> </span><span class=m>2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>matchLabels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>first-web-size</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>strategy</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>rollingUpdate</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>maxSurge</span><span class=p>:</span><span class=w> </span><span class=m>1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>maxUnavailable</span><span class=p>:</span><span class=w> </span><span class=m>1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>RollingUpdate</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>template</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>creationTimestamp</span><span class=p>:</span><span class=w> </span><span class=kc>null</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>first-web-size</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>containers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># å¾®è½¯ dotnet core æ ·ä¾‹é•œåƒ</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>mcr.microsoft.com/dotnet/core/samples:aspnetapp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>imagePullPolicy</span><span class=p>:</span><span class=w> </span><span class=l>IfNotPresent</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>first-web-size</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>terminationMessagePath</span><span class=p>:</span><span class=w> </span><span class=l>/dev/termination-log</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>livenessProbe</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>httpGet</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=l>/v1/health</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=m>80</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>initialDelaySeconds</span><span class=p>:</span><span class=w> </span><span class=m>120</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>periodSeconds</span><span class=p>:</span><span class=w> </span><span class=m>30</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c># CPU + å†…å­˜é™åˆ¶</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>resources</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=c># æœ€é«˜ä½¿ç”¨500mçš„CPU, è¶…è¿‡å°±é™åˆ¶CPU;æœ€é«˜ç”¨512Må†…å­˜, è¶…è¿‡å°±ç‚¸åº”ç”¨</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>limits</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>cpu</span><span class=p>:</span><span class=w> </span><span class=l>500m</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>memory</span><span class=p>:</span><span class=w> </span><span class=l>512Mi</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=c># è¦æ±‚ç»™50mçš„CPUè°ƒåº¦å’Œ128Må†…å­˜æ‰å¯ä»¥å¯åŠ¨</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>requests</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>cpu</span><span class=p>:</span><span class=w> </span><span class=l>50m</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>memory</span><span class=p>:</span><span class=w> </span><span class=l>128Mi</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c># è¿™é‡Œæ˜¯ç§æœ‰é•œåƒä»“åº“éœ€è¦è‡ªå·±é…ç½®çš„ä¸€ä¸‹ç§˜é’¥ä»€ä¹ˆä¹‹ç±»çš„, é…ç½®è¿‡ç¨‹è§k8så®˜æ–¹æ–‡æ¡£</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c>#   imagePullSecrets:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c>#     - name: regcred</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>dnsPolicy</span><span class=p>:</span><span class=w> </span><span class=l>ClusterFirst</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>restartPolicy</span><span class=p>:</span><span class=w> </span><span class=l>Always</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>terminationGracePeriodSeconds</span><span class=p>:</span><span class=w> </span><span class=m>30</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=nn>---</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Service</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>first-web-size</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>annotations</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c># è¿™é‡Œ:åé¢çš„å€¼å¡«è…¾è®¯äº‘çš„å­ç½‘id, è¿™æ ·serviceå°±åœ¨è…¾è®¯äº‘ç§æœ‰ç½‘ç»œå­ç½‘é‡Œé¢æœ‰è‡ªå·±çš„ ipäº†</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>service.kubernetes.io/qcloud-loadbalancer-internal-subnetid</span><span class=p>:</span><span class=w> </span><span class=l>subnet-xxx</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c># è¿‡æ»¤æ ‡ç­¾, åœ¨ä¸Šé¢å®šä¹‰podçš„æ—¶å€™ä¹Ÿå†™äº†å¯¹åº”çš„label</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>first-web-size</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>protocol</span><span class=p>:</span><span class=w> </span><span class=l>TCP</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c># serviceå¯¹å¤–æä¾›è®¿é—®çš„ç«¯å£</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=m>80</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c># podçš„ç«¯å£</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>targetPort</span><span class=p>:</span><span class=w> </span><span class=m>80</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>LoadBalancer</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>externalTrafficPolicy</span><span class=p>:</span><span class=w> </span><span class=l>Cluster</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>å°†ä¸Šé¢çš„æ–‡ä»¶ä¿å­˜æˆsample.yaml, ç„¶åæ‰§è¡Œ &ldquo;kubectl apply -f sample.yaml&rdquo;, å¯ä»¥çœ‹åˆ°ä¸‹é¢çš„Log</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>âœ  _posts git:<span class=o>(</span>master<span class=o>)</span> âœ— kubectl apply -f sample.yaml
</span></span><span class=line><span class=cl>deployment.extensions/first-web-size created
</span></span><span class=line><span class=cl>service/first-web-size created
</span></span><span class=line><span class=cl>âœ  _posts git:<span class=o>(</span>master<span class=o>)</span> âœ— kubectl get pod
</span></span><span class=line><span class=cl>first-web-size-797fb6f8cc-q79df       1/1       Running     <span class=m>0</span>          68s
</span></span><span class=line><span class=cl>first-web-size-797fb6f8cc-thwm7       1/1       Running     <span class=m>0</span>          68s
</span></span><span class=line><span class=cl>âœ  _posts git:<span class=o>(</span>master<span class=o>)</span> âœ— kubectl get service
</span></span><span class=line><span class=cl>NAME             TYPE           CLUSTER-IP     EXTERNAL-IP   PORT<span class=o>(</span>S<span class=o>)</span>        AGE
</span></span><span class=line><span class=cl>first-web-size   LoadBalancer   10.3.255.248   &lt;pending&gt;     80:31054/TCP   101s
</span></span></code></pre></td></tr></table></div></div><p>æˆ‘ä»¬åœ¨ä¸Šé¢å¯ä»¥çœ‹åˆ°, æœ‰first-web-sizeè¿™ä¸ªPodæœ‰ä¸¤ä¸ªå®ä¾‹, æœ‰ä¸€ä¸ªService</p><p>è¿™ä¸ªæ—¶å€™ç™»å½•å’Œé›†ç¾¤åœ¨åŒä¸€ä¸ªå†…ç½‘çš„æœåŠ¡å™¨ä¸Šé¢</p><p>æ‰§è¡Œ curl http://10.3.255.248 èƒ½çœ‹åˆ°å¯¹åº”çš„è®¿é—®HTML</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>root@VM-0-6-ubuntu:~# curl http://10.3.255.248
</span></span><span class=line><span class=cl>&lt;!DOCTYPE html&gt;
</span></span><span class=line><span class=cl>&lt;html&gt;
</span></span><span class=line><span class=cl>&lt;head&gt;
</span></span><span class=line><span class=cl>    &lt;meta <span class=nv>charset</span><span class=o>=</span><span class=s2>&#34;utf-8&#34;</span> /&gt;
</span></span><span class=line><span class=cl>    &lt;meta <span class=nv>name</span><span class=o>=</span><span class=s2>&#34;viewport&#34;</span> <span class=nv>content</span><span class=o>=</span><span class=s2>&#34;width=device-width, initial-scale=1.0&#34;</span> /&gt;
</span></span><span class=line><span class=cl>    &lt;title&gt;Home Page - aspnetapp&lt;/title&gt;
</span></span></code></pre></td></tr></table></div></div><p>æ€ä¹ˆå¯¹å¤–æä¾›è®¿é—®ç­‰æˆ‘ä¸‹æ¬¡åˆ†äº«äº†.</p><p>ç”¨å®Œäº†è¦åˆ æ‰è¿™äº›ä¸œè¥¿è¯·æ‰§è¡Œ &ldquo;kubectl delete -f sample.yaml&rdquo;</p><p>æ‹œ&mldr;</p><p>æˆ‘å»åšé¥­äº†.</p></section><footer class=article-footer><section class=article-tags><a href=/zh/tags/linux/>Linux</a>
<a href=/zh/tags/k8s/>K8s</a></section><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><script src=https://utteranc.es/client.js repo=liguobao/liguobao.github.io issue-term=title crossorigin=anonymous async></script><style>.utterances{max-width:unset}</style><script>let utterancesLoaded=!1;function setUtterancesTheme(e){let t=document.querySelector(".utterances iframe");t&&t.contentWindow.postMessage({type:"set-theme",theme:`github-${e}`},"https://utteranc.es")}addEventListener("message",e=>{if(e.origin!=="https://utteranc.es")return;utterancesLoaded=!0,setUtterancesTheme(document.documentElement.dataset.scheme)}),window.addEventListener("onColorSchemeChange",e=>{if(!utterancesLoaded)return;setUtterancesTheme(e.detail)})</script><footer class=site-footer><section class=copyright>&copy;
2020 -
2026 äººç”Ÿåˆ é™¤æŒ‡å—</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.30.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>