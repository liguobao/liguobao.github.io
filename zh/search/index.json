[{"content":" PSï¼šé©¬ä¸Šæ”¾å‡äº†ï¼Œå†æŠ˜è…¾ä¸€ä¸‹ï¼ï¼ï¼\næ‰‹åŠ¨ç‹—å¤´~\nã€ç¼–ç¨‹æŠ€æœ¯ä¸“åŒºåŠé€€æç¤ºã€‘\nä¸Šä¸€ç¯‡ k3s æ–‡ç« å·²ç»æ˜¯ 2025 å¹´äº†ï¼Œå½“æ—¶ç”¨çš„æ˜¯ WireGuard åšè·¨äº‘ç»„ç½‘ã€‚\nä¸€å¹´è¿‡å»äº†ï¼ŒWireGuard é…ç½®ææ¥æå»è¿˜æ˜¯å¤ªç´¯äº†\nâ€”â€”æ¯åŠ ä¸€å°æœºå™¨éƒ½å¾—æ‰‹åŠ¨æ”¹é…ç½®ã€äº’åŠ  Peerã€è°ƒè·¯ç”±â€¦â€¦\näºæ˜¯ä»Šå¹´å†³å®šæŠŠåº•å±‚ç½‘ç»œå…¨æ¢æˆ Tailscaleã€‚\næ›´å…·ä½“ä¸€ç‚¹â€”â€”è‡ªå»º Headscale æ§åˆ¶é¢ï¼Œä¸ä¾èµ–å®˜æ–¹ SaaSã€‚\nè¿™æ ·ä¸€æ¥ï¼Œæ•´ä¸ªå†…ç½‘æƒ³åŠ å¤šå°‘èŠ‚ç‚¹å°±åŠ å¤šå°‘èŠ‚ç‚¹ï¼Œ\nä¸€è¡Œå‘½ä»¤å…¥ç½‘ï¼Œä¸ç”¨å†æ‰‹åŠ¨ç®¡ WireGuard Peer é…ç½®äº†ã€‚\nåŒæ—¶ï¼Œk3s é›†ç¾¤ä» 2 èŠ‚ç‚¹å¯’é…¸ç‰ˆï¼Œ\nå‡çº§åˆ°äº† 4 Master + 4 Edge çš„ 8 èŠ‚ç‚¹ HA é›†ç¾¤ã€‚\néº»é›€è™½å°ï¼Œäº”è„ä¿±å…¨ã€‚\nç›´æ¥å¹²ã€‚\næ•´ä½“æ¶æ„ å…ˆæ”¾ä¸€å¼ æ¶æ„å›¾ï¼Œå…¨å±€æ¦‚è§ˆï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 äº’è”ç½‘ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ [è…¾è®¯äº‘] [Rainyun] [æœ¬åœ°] (å›½å†…å¤šå°) (æµ·å¤–æ–°åŠ å¡) (å®¶åº­/åŠå…¬) â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ Tailscale VPN (100.64.0.0/10) Headscale è‡ªå»ºæ§åˆ¶é¢ (ts.example.com) Authentik OIDC ç™»å½• (auth.example.com) â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ [control1] [control2] [control3] [control4] vm-0-8 vm-16-12 vm-28-17 vm-0-15 100.64.0.6 100.64.0.5 100.64.0.7 100.64.0.10 (Primary) (Member) (Member) (TSæ§åˆ¶é¢) â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ K3S HA é›†ç¾¤ (Flannel VXLAN over Tailscale) Pod: 10.42.0.0/16 | Service: 10.43.0.0/16 â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ [haru] [lgb-amd] [rainyun] [hc1] å›½å†… æœ¬åœ° æµ·å¤– å›½å†… Ready âœ… Ready âœ… Ready âœ… Ready âœ… å½“å‰é›†ç¾¤å®é™…çŠ¶æ€ï¼š\nèŠ‚ç‚¹åç§° è§’è‰² Tailscale IP çŠ¶æ€ è¯´æ˜ vm-0-8-ubuntu-new Master 100.64.0.6 Ready âœ… åˆå§‹ Master, \u0026ndash;cluster-init vm-16-12-ubuntu Master 100.64.0.5 Ready âœ… HA Master vm-28-17-ubuntu Master 100.64.0.7 Ready âœ… HA Master vm-0-15-ubuntu Master 100.64.0.10 Ready âœ… Headscale æ§åˆ¶é¢èŠ‚ç‚¹, NoSchedule haru Edge 100.64.0.3 Ready âœ… å›½å†…èŠ‚ç‚¹ lgb-amd-3700 Edge 100.64.0.4 Ready âœ… æœ¬åœ° AMD ä¸»æœº, 16GB rainyun-ssh7pavp Edge 100.64.0.12 Ready âœ… æµ·å¤–æ–°åŠ å¡èŠ‚ç‚¹ hc1 Edge 100.64.0.9 Ready âœ… å›½å†…èŠ‚ç‚¹ 8 ä¸ªèŠ‚ç‚¹çš„é›†ç¾¤ï¼Œè·‘ç€åå‡ ä¸ªæœåŠ¡ï¼Œç¨³å¾—ä¸€æ¯”ã€‚\nä¸€ã€å…ˆæ Tailscaleï¼šäº‘ç«¯å†…ç½‘é›†ç¾¤ ä¸ºä»€ä¹ˆä¸ç”¨ WireGuard æ‰‹åŠ¨ç»„ç½‘äº†ï¼Ÿ 2025 å¹´å†™çš„é‚£ç¯‡æ–‡ç« é‡Œï¼Œæˆ‘ç”¨çš„æ˜¯ WireGuard åŸç”Ÿæ–¹æ¡ˆ + k3s Flannel wireguard-native æ¨¡å¼ã€‚\nè¯´å®è¯ï¼ŒWireGuard æœ¬èº«å¾ˆç¨³ï¼Œæ€§èƒ½ä¹Ÿå¥½ã€‚ä½†æ‰‹åŠ¨ç®¡ç† Peer è¿™ä»¶äº‹ï¼Œåœ¨èŠ‚ç‚¹å¤šäº†ä¹‹åç®€ç›´æ˜¯å™©æ¢¦ï¼š\næ¯åŠ ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå…¶ä»–èŠ‚ç‚¹çš„ WireGuard é…ç½®éƒ½è¦æ”¹ å…¬é’¥äº¤æ¢ã€IP åˆ†é…å…¨é æ‰‹åŠ¨ æŸå°æœºå™¨æ¢äº†å…¬ç½‘ IPï¼Œæ‰€æœ‰ Peer éƒ½å¾—æ›´æ–° æ²¡æœ‰ç»Ÿä¸€çš„ç®¡ç†ç•Œé¢ æ‰€ä»¥ï¼Œè¿™æ¬¡ç›´æ¥ä¸Š Tailscaleã€‚\nä¸ºä»€ä¹ˆè‡ªå»º Headscaleï¼Ÿ Tailscale å®˜æ–¹çš„ SaaS æœåŠ¡å½“ç„¶å¥½ç”¨ï¼Œä¸ªäººç‰ˆç°åœ¨æ”¯æŒæœ€å¤š 100 å°è®¾å¤‡ï¼Œæ•°é‡ä¸Šå®Œå…¨å¤Ÿç”¨ã€‚ä½†æœ‰å‡ ä¸ªé—®é¢˜ï¼š\nç™»å½•éœ€è¦å¤–ç½‘â€”â€”Tailscale çš„ç™»å½•è®¤è¯èµ°çš„æ˜¯ Google/Microsoft/GitHub OAuthï¼Œå›½å†…è£¸è¿åŸºæœ¬æ²¡æˆï¼Œæ¯æ¬¡ tailscale up éƒ½å¾—å…ˆç¿»å¢™æˆæƒï¼ŒæœåŠ¡å™¨ç«¯æ›´æ˜¯éº»çƒ¦ æ•°æ®æ§åˆ¶â€”â€”æ‰€æœ‰èŠ‚ç‚¹ä¿¡æ¯éƒ½åœ¨åˆ«äººé‚£ï¼Œå¿ƒé‡Œä¸è¸å® å›½å†…è®¿é—®â€”â€”Tailscale å®˜æ–¹çš„åè°ƒæœåŠ¡å™¨ï¼ˆcoordination serverï¼‰åœ¨æµ·å¤–ï¼Œå›½å†…èŠ‚ç‚¹è¿æ¥ä¸å¤ªç¨³å®šï¼Œå¶å°”ä¼šå‡ºç°èŠ‚ç‚¹é—´å»ºè¿æ…¢çš„é—®é¢˜ æ‰€ä»¥æˆ‘é€‰æ‹©äº† Headscaleâ€”â€”å¼€æºçš„ Tailscale æ§åˆ¶é¢å®ç°ã€‚\né…åˆ Authentik åš OIDC ç™»å½•ï¼Œä½“éªŒå’Œå®˜æ–¹ Tailscale å‡ ä¹ä¸€è‡´ï¼Œç”šè‡³æ›´çµæ´»ã€‚\nHeadscale éƒ¨ç½² æœåŠ¡å™¨è¦æ±‚ï¼šä¸€å° 2C2G çš„å°æœºå™¨å°±å¤Ÿäº†ï¼Œæˆ‘ç”¨çš„æ˜¯è…¾è®¯äº‘è½»é‡ Ubuntu 24.04ã€‚\næ ¸å¿ƒå°±æ˜¯ä¸€ä¸ª docker-compose.ymlï¼ŒåŒ…å«ï¼š\nç»„ä»¶ è¯´æ˜ Headscale v0.28.0 Tailscale æ§åˆ¶é¢ Authentik 2025.2.4 OIDC è´¦å·å¯†ç ç™»å½• PostgreSQL 16 Authentik æ•°æ®åº“ Redis Authentik ç¼“å­˜ Nginx HTTPS åå‘ä»£ç† éƒ¨ç½²å®Œä¹‹åï¼Œä¸¤ä¸ªåŸŸåå°±ä½ï¼š\nhttps://ts.example.com â†’ Headscale æ§åˆ¶é¢ https://auth.example.com â†’ Authentik ç™»å½•ç®¡ç† è¯¦ç»†çš„éƒ¨ç½²æµç¨‹è¿™é‡Œä¸å±•å¼€äº†ï¼ˆé‚£æ˜¯å¦ä¸€ç¯‡æ–‡ç« çš„äº‹ï¼‰ï¼Œæ ¸å¿ƒè¦ç‚¹ï¼š\nHTTPS ç”¨ acme.sh + Nginxï¼Œåˆ«æ Traefik é‚£äº›èŠ±é‡Œèƒ¡å“¨çš„ Headscale é…ç½® OIDCï¼ŒIssuer æŒ‡å‘ Authentik IP æ®µç”¨ 100.64.0.0/10ï¼Œè¿™æ˜¯ CGNAT åœ°å€æ®µï¼Œä¸ä¼šå’Œå†…ç½‘å†²çª èŠ‚ç‚¹å…¥ç½‘ è£…å¥½ Headscale ä¹‹åï¼Œä»»ä½•ä¸€å°æœºå™¨å…¥ç½‘å°±æ˜¯ä¸€è¡Œå‘½ä»¤çš„äº‹ï¼š\n1 2 3 4 5 # å®‰è£… Tailscale å®¢æˆ·ç«¯ curl -fsSL https://tailscale.com/install.sh | sh # è¿æ¥åˆ°è‡ªå»ºæ§åˆ¶é¢ tailscale up --login-server=https://ts.example.com --hostname=ä½ çš„ä¸»æœºå --accept-dns=false ç»ˆç«¯ä¼šåå‡ºä¸€ä¸ªé“¾æ¥ï¼Œæµè§ˆå™¨æ‰“å¼€ï¼Œè·³åˆ° Authentik ç™»å½•é¡µï¼Œè¾“å…¥è´¦å·å¯†ç ï¼Œæˆæƒå®Œæˆâ€”â€”èŠ‚ç‚¹å…¥ç½‘ã€‚\nå°±è¿™ä¹ˆç®€å•ã€‚\nå…³é”®å»ºè®®ï¼š\nä¸è¦ä¾èµ–å…¬æœ‰äº‘å†…ç½‘ï¼\nå³ä½¿ä½ çš„ Master èŠ‚ç‚¹åœ¨åŒä¸€ä¸ªäº‘ï¼Œä¹Ÿå»ºè®®ç»Ÿä¸€èµ° Tailscale é€šä¿¡ã€‚\nåŸå› å¾ˆç®€å•ï¼šå…¬æœ‰äº‘å†…ç½‘æ˜¯ä¸ªé»‘ç›’ï¼Œå“ªå¤©æ¢ä¸ªæœºå™¨ã€æ¢ä¸ªå¯ç”¨åŒºï¼Œå†…ç½‘ IP å°±å˜äº†ã€‚ è€Œ Tailscale IP æ˜¯ä½ è‡ªå·±åˆ†é…çš„ï¼Œä¸ä¼šå˜ã€‚\næ‰€æœ‰èŠ‚ç‚¹ï¼Œä¸ç®¡æ˜¯äº‘ç«¯ã€æœ¬åœ°ã€è¿˜æ˜¯å…¶ä»–äº‘å¹³å°ï¼Œç»Ÿä¸€ç”¨ Tailscale æ¥å…¥ï¼Œç½‘ç»œæ¶æ„å¹²å‡€åˆ©è½ã€‚\nå½“å‰æˆ‘çš„ Tailscale ç½‘ç»œé•¿è¿™æ ·ï¼š\n1 2 3 4 5 6 7 8 9 10 11 100.64.0.2 lgb-macbookair-m4 macOS â† æˆ‘çš„å¼€å‘æœº 100.64.0.3 haru linux â† Edge èŠ‚ç‚¹ 100.64.0.4 lgb-amd-3700 linux â† æœ¬åœ° Edge èŠ‚ç‚¹ 100.64.0.5 vm-16-12-ubuntu linux â† K3s Master 100.64.0.6 vm-0-8-ubuntu-new linux â† K3s Master (Primary) 100.64.0.7 vm-28-17-ubuntu linux â† K3s Master 100.64.0.8 rainyun-vja2g92e linux â† æµ·å¤–èŠ‚ç‚¹ 100.64.0.9 hc1 linux â† Edge èŠ‚ç‚¹ 100.64.0.10 ts-headscale linux â† Headscale æ§åˆ¶é¢ + K3s Master 100.64.0.12 ipv6radar linux â† æµ·å¤–èŠ‚ç‚¹ 100.64.0.13 localhost android â† æ‰‹æœºä¹Ÿèƒ½å…¥ç½‘ï¼ˆæ‘¸é±¼ç”¨ï¼‰ ä¸ç®¡åœ¨å“ªï¼Œping 100.64.0.6 å°±èƒ½é€šã€‚è¿™æ‰æ˜¯æ­£ç¡®çš„å†…ç½‘ä½“éªŒã€‚\näºŒã€K3s é›†ç¾¤æ­å»ºï¼šåŸºäº Tailscale ç½‘ç»œ æ ¸å¿ƒåŸåˆ™ Master èŠ‚ç‚¹å…¨éƒ¨æ”¾åœ¨äº‘ç«¯åŒä¸€å®¶äº‘â€”â€”æˆ‘çš„ 4 å° Master éƒ½åœ¨è…¾è®¯äº‘ï¼Œetcd åŒæ­¥å»¶è¿Ÿä½ Master ä¹‹é—´ä¹Ÿç”¨ Tailscale IP é€šä¿¡â€”â€”ä¸ä¾èµ–äº‘å†…ç½‘ Edge èŠ‚ç‚¹éšæ„â€”â€”å®¶é‡Œçš„å°å¼æœºã€æµ·å¤–çš„ VPSã€å…¬å¸çš„å·¥ä½œç«™ï¼Œåªè¦ Tailscale èƒ½é€šå°±è¡Œ ç½‘å…³èŠ‚ç‚¹ç”¨å¤§æµé‡æœºå™¨â€”â€”Ingress è·‘åœ¨è½»é‡äº‘ä¸Šï¼Œæµé‡å¤Ÿç”¨ å®‰è£… Master å®‰è£…å…¶å®æ²¡ä»€ä¹ˆèŠ±æ´»ï¼Œçœ‹å®˜æ–¹æ–‡æ¡£å°±å¥½ï¼šhttps://docs.k3s.io/zh/quick-start\nä½†æœ‰å‡ ä¸ªå…³é”®å‚æ•°å¿…é¡»æ³¨æ„ã€‚\nç¬¬ä¸€ä¸ª Masterï¼ˆåˆå§‹åŒ–é›†ç¾¤ï¼‰ï¼š\n1 2 3 4 5 6 7 curl -sfL https://rancher-mirror.rancher.cn/k3s/k3s-install.sh | \\ INSTALL_K3S_MIRROR=cn \\ sh -s - server \\ --cluster-init \\ --flannel-iface=tailscale0 \\ --node-ip=100.64.0.6 \\ --tls-san=100.64.0.6 åç»­ Master åŠ å…¥é›†ç¾¤ï¼š\n1 2 3 4 5 6 7 8 curl -sfL https://rancher-mirror.rancher.cn/k3s/k3s-install.sh | \\ INSTALL_K3S_MIRROR=cn \\ K3S_TOKEN=\u0026#34;ä½ çš„Token\u0026#34; \\ sh -s - server \\ --server https://100.64.0.6:6443 \\ --flannel-iface=tailscale0 \\ --node-ip=$(tailscale ip -4) \\ --tls-san=$(tailscale ip -4) æ ¸å¿ƒå‚æ•°è¯´æ˜ï¼š\nå‚æ•° ä¸ºä»€ä¹ˆå¿…é¡» --cluster-init ç¬¬ä¸€ä¸ª Master ç”¨ï¼Œå¯ç”¨åµŒå…¥å¼ etcd HA --flannel-iface=tailscale0 æœ€å…³é”®ï¼ è®© Flannel VXLAN èµ° Tailscale ç½‘å¡ï¼Œä¸æ˜¯ç‰©ç†ç½‘å¡ --node-ip=$(tailscale ip -4) èŠ‚ç‚¹ IP ç”¨ Tailscale IPï¼Œä¿è¯è·¨äº‘é€šä¿¡ --tls-san=\u0026lt;ip\u0026gt; API Server è¯ä¹¦åŒ…å« Tailscale IP INSTALL_K3S_MIRROR=cn å›½å†…é•œåƒåŠ é€Ÿï¼Œæµ·å¤–èŠ‚ç‚¹ä¸éœ€è¦ --flannel-iface=tailscale0 è¿™ä¸ªå‚æ•°æ˜¯è¸©äº†æ— æ•°å‘ä¹‹åçš„è¡€æ³ªæ•™è®­ã€‚\nå¦‚æœä¸åŠ è¿™ä¸ªå‚æ•°ï¼ŒFlannel ä¼šé»˜è®¤ç”¨ç‰©ç†ç½‘å¡çš„ IPï¼ˆæ¯”å¦‚å…¬ç½‘ IP æˆ–è€…äº‘å†…ç½‘ IPï¼‰æ¥å»º VXLAN éš§é“ã€‚ç»“æœå°±æ˜¯â€”â€”åŒäº‘çš„èŠ‚ç‚¹èƒ½é€šï¼Œè·¨äº‘çš„èŠ‚ç‚¹ Pod å…¨éƒ¨ä¸é€šã€‚\nåŠ äº†è¿™ä¸ªå‚æ•°ä¹‹åï¼ŒFlannel çš„ VXLAN éš§é“å…¨éƒ¨èµ° Tailscale è™šæ‹Ÿç½‘å¡ï¼Œè·¨äº‘ Pod é€šä¿¡å®Œç¾ã€‚\nå®‰è£… Edge èŠ‚ç‚¹ Edge èŠ‚ç‚¹å°±æ˜¯ Agentï¼Œæ›´ç®€å•ã€‚\nå›½å†…èŠ‚ç‚¹ï¼š\n1 2 3 4 5 6 7 8 curl -sfL https://rancher-mirror.rancher.cn/k3s/k3s-install.sh | \\ K3S_URL=\u0026#34;https://100.64.0.6:6443\u0026#34; \\ K3S_TOKEN=\u0026#34;ä½ çš„Token\u0026#34; \\ INSTALL_K3S_MIRROR=cn \\ sh -s - agent \\ --node-ip=$(tailscale ip -4) \\ --flannel-iface=tailscale0 \\ --node-label=\u0026#34;node.kubernetes.io/role=edge\u0026#34; æµ·å¤–èŠ‚ç‚¹ï¼š\n1 2 3 4 5 6 7 curl -sfL https://get.k3s.io | \\ K3S_URL=\u0026#34;https://100.64.0.6:6443\u0026#34; \\ K3S_TOKEN=\u0026#34;ä½ çš„Token\u0026#34; \\ sh -s - agent \\ --node-ip=$(tailscale ip -4) \\ --flannel-iface=tailscale0 \\ --node-label=\u0026#34;node.kubernetes.io/role=edge\u0026#34; å·®åˆ«å°±æ˜¯å›½å†…ç”¨ rancher-mirror.rancher.cnï¼Œæµ·å¤–ç”¨å®˜æ–¹ get.k3s.ioã€‚\nå›½å†… Docker é•œåƒæ‹‰å–é—®é¢˜ è¿™é‡Œè¦ç‰¹åˆ«æä¸€ä¸‹ï¼šå›½å†…ç¯å¢ƒä¸‹ Docker / containerd æ‹‰å–é•œåƒæ˜¯ä¸ªå¤§éº»çƒ¦ã€‚\nDocker Hubã€ghcr.ioã€gcr.io è¿™äº›é•œåƒæºåœ¨å›½å†…åŸºæœ¬å¤„äºåŠå¢™çŠ¶æ€ï¼Œk3s å†…ç½®çš„ä¸€äº›ç³»ç»Ÿç»„ä»¶é•œåƒï¼ˆæ¯”å¦‚ pauseã€corednsã€metrics-serverï¼‰å¯èƒ½æ‹‰ä¸ä¸‹æ¥ï¼Œå¯¼è‡´èŠ‚ç‚¹ä¸€ç›´ NotReadyã€‚\nå‡ ä¸ªè§£å†³æ€è·¯ï¼š\né…ç½®é•œåƒåŠ é€Ÿå™¨â€”â€”åœ¨ /etc/rancher/k3s/registries.yaml ä¸­é…ç½®å›½å†…å¯ç”¨çš„ mirrorï¼ˆå¦‚æœä½ è¿˜èƒ½æ‰¾åˆ°æ´»ç€çš„ï¼‰ æœ¬åœ°å¯¼å‡ºå†å¯¼å…¥ï¼ˆæ¨èï¼‰â€”â€”åœ¨æµ·å¤–èŠ‚ç‚¹æˆ–è€…èƒ½æ­£å¸¸æ‹‰å–çš„æœºå™¨ä¸Šå…ˆæŠŠé•œåƒæ‹‰ä¸‹æ¥ï¼Œå¯¼å‡ºåä¼ åˆ°å›½å†…èŠ‚ç‚¹å¯¼å…¥ï¼š 1 2 3 4 5 6 7 8 # åœ¨æµ·å¤–èŠ‚ç‚¹å¯¼å‡º ctr -n k8s.io images export pause.tar registry.k8s.io/pause:3.9 # ä¼ åˆ°å›½å†…èŠ‚ç‚¹ scp pause.tar root@\u0026lt;å›½å†…èŠ‚ç‚¹IP\u0026gt;:/tmp/ # åœ¨å›½å†…èŠ‚ç‚¹å¯¼å…¥ ctr -n k8s.io images import /tmp/pause.tar è‡ªå»º Harbor é•œåƒä»“åº“â€”â€”å¦‚æœèŠ‚ç‚¹å¤šï¼Œå»ºè®®æä¸€ä¸ªç§æœ‰é•œåƒä»“åº“åš proxy cacheï¼Œä¸€åŠ³æ°¸é€¸ æˆ‘çš„åšæ³•æ˜¯åœ¨æµ·å¤–èŠ‚ç‚¹ä¸Šæå‰æ‹‰å¥½éœ€è¦çš„é•œåƒï¼Œç„¶å ctr images export å¯¼å‡ºï¼Œé€šè¿‡ Tailscale å†…ç½‘ä¼ åˆ°å›½å†…èŠ‚ç‚¹å† ctr images import å¯¼å…¥ã€‚è™½ç„¶ç¬¨äº†ç‚¹ï¼Œä½†èƒœåœ¨ç¨³å®šå¯é ã€‚\nToken åœ¨ç¬¬ä¸€ä¸ª Master ä¸Šè·å–ï¼š\n1 cat /var/lib/rancher/k3s/server/node-token æ²¡ä»€ä¹ˆé—®é¢˜çš„è¯ï¼Œå‡ ç§’é’Ÿåå°±èƒ½çœ‹åˆ°æ–°èŠ‚ç‚¹ä¸Šçº¿ï¼š\n1 2 3 4 5 6 7 8 9 10 $ kubectl get nodes -o wide NAME STATUS ROLES AGE VERSION vm-0-8-ubuntu-new Ready control-plane,etcd,master 30d v1.34.3+k3s3 vm-16-12-ubuntu Ready control-plane,etcd,master 30d v1.34.3+k3s3 vm-28-17-ubuntu Ready control-plane,etcd,master 30d v1.34.3+k3s3 vm-0-15-ubuntu Ready control-plane,etcd,master 1d v1.34.3+k3s3 haru Ready \u0026lt;none\u0026gt; 20d v1.34.3+k3s3 lgb-amd-3700 Ready \u0026lt;none\u0026gt; 15d v1.34.3+k3s3 rainyun-ssh7pavp Ready \u0026lt;none\u0026gt; 10d v1.34.3+k3s3 hc1 Ready \u0026lt;none\u0026gt; 5d v1.34.3+k3s3 8 ä¸ªèŠ‚ç‚¹å…¨éƒ¨ Readyã€‚\nç¾ã€‚\nå…³äºç½‘å…³èŠ‚ç‚¹ Ingress æµé‡å…¥å£éœ€è¦å…¬ç½‘ IP + è¶³å¤Ÿçš„å¸¦å®½ã€‚\næˆ‘çš„åšæ³•æ˜¯ï¼š\nç½‘å…³èŠ‚ç‚¹ç”¨è½»é‡äº‘æœåŠ¡å™¨â€”â€”è…¾è®¯äº‘è½»é‡ã€é˜¿é‡Œäº‘è½»é‡ä¹‹ç±»çš„ï¼Œæœˆä»˜å‡ åå—ï¼Œæµé‡åŒ…å¤Ÿç”¨ k3s è‡ªå¸¦çš„ Traefik Ingress é»˜è®¤ä¼šè·‘åœ¨æ‰€æœ‰èŠ‚ç‚¹ä¸Šï¼ˆDaemonSetï¼‰ï¼Œä½†å®é™…å¯¹å¤–æš´éœ²çš„åªéœ€è¦ä¸€ä¸¤ä¸ªèŠ‚ç‚¹ åŸŸå DNS è§£æåˆ°è¿™äº›è½»é‡äº‘çš„å…¬ç½‘ IP å°±è¡Œ æµé‡è·¯å¾„ï¼šç”¨æˆ·è¯·æ±‚ â†’ è½»é‡äº‘å…¬ç½‘IP â†’ Traefik Ingress â†’ Service â†’ Podï¼ˆå¯èƒ½åœ¨ä»»æ„èŠ‚ç‚¹ä¸Šï¼‰\nPod åœ¨æµ·å¤–èŠ‚ç‚¹ä¸Šä¹Ÿæ²¡å…³ç³»ï¼ŒFlannel over Tailscale ä¼šæŠŠæµé‡æ‰“é€šã€‚\nä¸‰ã€è¸©å‘å®å½• å‘ 1ï¼šFlannel ç”¨é”™ç½‘å¡ï¼ˆè¡€æ³ªæ•™è®­ï¼‰ ç—‡çŠ¶ï¼šEdge èŠ‚ç‚¹ Ready äº†ï¼Œä½†è·¨èŠ‚ç‚¹ Pod é€šä¿¡å…¨æŒ‚ã€‚\nåŸå› ï¼šæ²¡åŠ  --flannel-iface=tailscale0ï¼ŒFlannel é»˜è®¤é€‰äº†å…¬ç½‘ç½‘å¡ã€‚\nè¯Šæ–­ï¼š\n1 2 kubectl describe node rainyun-ssh7pavp | grep flannel # çœ‹åˆ° flannel.alpha.coreos.com/public-ip ç”¨çš„æ˜¯å…¬ç½‘ IP è€Œä¸æ˜¯ 100.64.0.x è§£å†³ï¼šå¸è½½ k3s agentï¼Œé‡è£…æ—¶åŠ ä¸Š --flannel-iface=tailscale0ã€‚\nè¿™ä¸ªå‚æ•°çœŸçš„å¤ªé‡è¦äº†ï¼Œè¯´ä¸‰éï¼š\n--flannel-iface=tailscale0 --flannel-iface=tailscale0 --flannel-iface=tailscale0 å‘ 2ï¼šTailscale è¿æ¥ä¸ç¨³å®š æŸå° Vultr çš„ VPSï¼ŒTailscale è¿æ¥ä¸‰å¤©ä¸¤å¤´æ–­ã€‚\nèŠ‚ç‚¹åœ¨ Ready å’Œ NotReady ä¹‹é—´åå¤æ¨ªè·³ï¼Œkubelet ç–¯ç‹‚æŠ¥ unable to update node statusã€‚\næ’æŸ¥ä¸‹æ¥å‘ç°æ˜¯ VPN é“¾è·¯é—®é¢˜ï¼Œè·Ÿ K3s æ²¡å…³ç³»ã€‚\nè§£å†³æ–¹æ¡ˆï¼šå…ˆç”¨ taint éš”ç¦»ï¼Œåé¢ç›´æ¥æ¢æ‰äº†è¿™å°æœºå™¨ã€‚\n1 2 kubectl taint nodes vultr.guest node-problem=true:NoSchedule --overwrite kubectl taint nodes vultr.guest node-problem=true:NoExecute --overwrite æ•™è®­ï¼šä¸ç¨³å®šçš„èŠ‚ç‚¹å®å¯ä¸è¦ï¼Œåˆ«æ­»ç£•ã€‚ æ¢ä¸€å°æ–°æœºå™¨æ¯”æ’æŸ¥ç½‘ç»œé—®é¢˜å¿«å¾—å¤šã€‚\nå‘ 3ï¼šä½é… Master åˆ«è·‘ä¸šåŠ¡ Pod æˆ‘çš„ç¬¬å››å° Masterï¼ˆvm-0-15-ubuntuï¼‰åªæœ‰ 2G å†…å­˜ï¼ŒåŒæ—¶è¿˜è·‘ç€ Headscale æ§åˆ¶é¢ã€‚\nå¦‚æœè®©å®ƒè·‘ä¸šåŠ¡ Podï¼Œåˆ†åˆ†é’Ÿ OOMã€‚\nè§£å†³ï¼šåŠ  NoSchedule taintï¼Œåªè·‘æ§åˆ¶å¹³é¢ç»„ä»¶ + etcdã€‚\n1 kubectl taint nodes vm-0-15-ubuntu node-role.kubernetes.io/control-plane=:NoSchedule 2G å†…å­˜è·‘ k3s control-plane + etcd + Headscale å…¨å®¶æ¡¶ï¼ŒCPU å’Œå†…å­˜å ç”¨å¤§çº¦ 60%ï¼Œç¨³å¾—ä½ã€‚\nå››ã€æ•…éšœæ’æŸ¥é€ŸæŸ¥ èŠ‚ç‚¹åŠ å®Œä¹‹åå‡ºé—®é¢˜ï¼ŸæŒ‰è¿™ä¸ªé¡ºåºæŸ¥ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 # 1. çœ‹èŠ‚ç‚¹çŠ¶æ€ kubectl get nodes -o wide # 2. çœ‹èŠ‚ç‚¹äº‹ä»¶ kubectl describe node \u0026lt;èŠ‚ç‚¹å\u0026gt; # 3. çœ‹ Tailscale è¿é€šæ€§ tailscale ping \u0026lt;ç›®æ ‡èŠ‚ç‚¹Tailscale IP\u0026gt; # 4. çœ‹ Flannel é…ç½®å¯¹ä¸å¯¹ kubectl describe node \u0026lt;èŠ‚ç‚¹å\u0026gt; | grep flannel # 5. çœ‹ kubelet æ—¥å¿— ssh root@\u0026lt;èŠ‚ç‚¹IP\u0026gt; \u0026#34;journalctl -u k3s-agent -n 50\u0026#34; # 6. æµ‹è¯•è·¨èŠ‚ç‚¹ Pod é€šä¿¡ kubectl run test --image=busybox --rm -it -- wget -qO- http://\u0026lt;å…¶ä»–èŠ‚ç‚¹PodIP\u0026gt; 90% çš„é—®é¢˜éƒ½æ˜¯å‰ 4 æ­¥èƒ½æŸ¥å‡ºæ¥çš„ã€‚\näº”ã€æ€»ç»“ å¯¹æ¯” 2025 å¹´çš„æ–¹æ¡ˆï¼Œè¿™æ¬¡å‡çº§çš„æ ¸å¿ƒå˜åŒ–ï¼š\né¡¹ç›® 2025 å¹´ 2026 å¹´ ç»„ç½‘æ–¹æ¡ˆ WireGuard æ‰‹åŠ¨é…ç½® Tailscale (Headscale è‡ªå»º) æ§åˆ¶é¢ å®˜æ–¹ Tailscale / æ‰‹åŠ¨ WG è‡ªå»º Headscale + OIDC Master æ•°é‡ 2 4 (HA) Edge èŠ‚ç‚¹ 0 4 æ€»èŠ‚ç‚¹æ•° 2 8 æ–°èŠ‚ç‚¹æ¥å…¥ æ”¹ä¸€å †é…ç½® ä¸€è¡Œå‘½ä»¤ è·¨äº‘é€šä¿¡ Flannel wireguard-native Flannel VXLAN over Tailscale ç®¡ç†å¤æ‚åº¦ é«˜ ä½ ä¸€å¥è¯æ€»ç»“æ–¹æ¡ˆï¼š\nç”¨ Tailscaleï¼ˆHeadscale è‡ªå»ºï¼‰åšåº•å±‚ç½‘ç»œâ€”â€”æ‰€æœ‰èŠ‚ç‚¹ç»Ÿä¸€æ¥å…¥ï¼Œä¸ä¾èµ–ä»»ä½•å…¬æœ‰äº‘å†…ç½‘ K3s Master æ”¾åœ¨åŒä¸€å®¶äº‘çš„åŒä¸€åœ°åŸŸâ€”â€”etcd å»¶è¿Ÿä½ï¼Œæ§åˆ¶å¹³é¢ç¨³å®š Edge èŠ‚ç‚¹éšä¾¿åŠ â€”â€”å®¶é‡Œçš„æœºå™¨ã€æµ·å¤–çš„ VPSã€åŠå…¬å®¤çš„å·¥ä½œç«™ï¼Œåªè¦ Tailscale èƒ½é€šå°±è¡Œ ç½‘å…³èŠ‚ç‚¹ç”¨è½»é‡äº‘â€”â€”ä¾¿å®œã€å¸¦å®½å¤Ÿã€å…¬ç½‘ IP å›ºå®š æ•´ä¸ªé›†ç¾¤è·‘äº†ä¸€ä¸ªæœˆï¼Œç¨³å¦‚è€ç‹—ã€‚\n8/8 èŠ‚ç‚¹å…¨éƒ¨å¯ç”¨ï¼ˆä¹‹å‰æœ‰ 1 å° Vultr ç½‘ç»œä¸è¡Œï¼Œå·²ç»æ¢æ‰äº†ï¼‰ã€‚\nå®Œäº‹ã€‚\nå…¨æ–‡åœ¨å‡Œæ™¨çš„ä¹¦æˆ¿é‡Œå®Œæˆï¼Œç¥å¤§å®¶æ–°å¹´å¿«ä¹~\næ‰‹åŠ¨ç‹—å¤´~\nç›¸å…³é“¾æ¥ï¼š\nK3s å®˜æ–¹æ–‡æ¡£ï¼šhttps://docs.k3s.io/zh/ Headscaleï¼šhttps://github.com/juanfont/headscale Authentikï¼šhttps://goauthentik.io/ ä¸Šä¸€ç¯‡ï¼šã€k3sã€‘å¹´åº¦æœ€ä½³è¾¹ç¼˜è®¡ç®—é›†ç¾¤æ–¹æ¡ˆ æœ¬æ–‡ä½¿ç”¨ AI è¾…åŠ©å†™ä½œã€‚\n","date":"2026-02-11T08:00:00Z","image":"https://liguobao.github.io/zh/p/k3s-tailscale-cluster-2026/logo_hu_5a496e6dfb978d62.png","permalink":"https://liguobao.github.io/zh/p/k3s-tailscale-cluster-2026/","title":"2206å¹´æœ€ä½³è¾¹ç¼˜è®¡ç®—é›†ç¾¤æ–¹æ¡ˆï¼šTailscale + k3s"},{"content":"å‰è¨€ æ­£ç»äººè°æ²¡ä¸€ä¸ªk8sé›†ç¾¤å‘¢ï¼Ÿå¯¹çš„å§ã€‚\næ­£ç»äººä¸€å¹´æ²¡å´©ä¸¤æ¬¡é›†ç¾¤éƒ½ä¸ç®—äº‹å§ï¼Ÿ\næ­£ç»äººè°ä¸è¿™é‡Œè–…ä¸€å°æœºå™¨å“ªé‡Œæä¸€å°æœåŠ¡å™¨å‘¢ï¼Ÿ\näºæ˜¯ï¼Œå¼€å§‹æŠ˜è…¾è·¨â€œå±€åŸŸç½‘å†…ç½‘â€œçš„æ­å»ºäº†ã€‚\næ—©ä¸€äº›æ—¶é—´ï¼Œå·²ç»åœ¨äº‘ç«¯æ‰‹åŠ¨æ­å»ºWireguardï¼Œ\nå€’æ˜¯å‡ ä¸ªèŠ‚ç‚¹éƒ½è·‘èµ·æ¥äº†ï¼ŒåŸºæœ¬ä¹Ÿæ˜¯å¯ç”¨çš„ã€‚\nä½†æ˜¯è¿™ç©æ„æ‰‹åŠ¨éƒ¨ç½²æ€»æ˜¯è¿‡äºéº»çƒ¦ï¼Œ\nä¸€ä¸ªä¸ªèŠ‚ç‚¹é…ç½®æé”™äº†Debugèµ·æ¥éƒ½æƒ³æ­»ã€‚\nå‰é˜µå­ä¹Ÿçœ‹åˆ°è¿‡Tailscaleï¼Œ\nç”¨ä»–ä»¬çš„å®˜æ–¹æˆæƒæœåŠ¡ä¹Ÿè·‘èµ·æ¥äº†Demoï¼Œ\næ„Ÿè§‰æ˜¯èƒ½ç”¨çš„ï¼Œåªæ˜¯å‘ç°ä¸ä»˜é’±åªç»™äº”å°è®¾å¤‡ï¼Œ\nå¥½åƒä¸å¤ªåˆé€‚ï¼Œæ•°é‡ä¹Ÿä¸å¤ªå¤Ÿ~\nåæ¥çœ‹äº†ä¸‹è¿ç»´å°å“¥æœ€è¿‘åœ¨æŠ˜è…¾Tailscale è‡ªå»ºæˆæƒï¼Œ\nå¹³æ—¶æˆ‘ä»¬çš„æœºå™¨äº’è®¿ä¹Ÿè·‘èµ·æ¥äº†ï¼Œ\nçªç„¶å°±æƒ³æ‡‚åº”è¯¥æ€ä¹ˆåšäº†ã€‚\näºæ˜¯ï¼Œå¼€æ•´~\nTailscaleï¼šæ¦‚å¿µå…ˆè¡Œ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 Tailscale æœ¬è´¨æ˜¯ä¸‰å±‚ä¸œè¥¿ï¼š å®¢æˆ·ç«¯ï¼ˆå¿…éœ€ï¼‰ tailscale CLI / GUIï¼ˆmacOS / Linux / Windows / iOS / Androidï¼‰ è´Ÿè´£ï¼šWireGuard åŠ å¯†ã€æ‰“æ´ã€ç›´è¿/ä¸­ç»§ æ§åˆ¶é¢ï¼ˆControl Planeï¼‰ è®¾å¤‡æ³¨å†Œ èº«ä»½è®¤è¯ ä¸‹å‘èŠ‚ç‚¹åˆ—è¡¨ã€ACLã€DERP ä¿¡æ¯ - å®˜æ–¹çš„æ˜¯ Tailscale SaaS - è‡ªå»ºçš„æ˜¯ Headscale ä¸­ç»§é¢ï¼ˆDERPï¼Œå¯é€‰ï¼‰ æ‰“æ´å¤±è´¥æ—¶è½¬å‘æµé‡ å¯ç”¨å®˜æ–¹ DERPï¼Œä¹Ÿå¯ä»¥è‡ªå»º æ‰€ä»¥, å…ˆæ¥ä¸€å°æœåŠ¡å™¨~\næŸäº‘è½»é‡æœåŠ¡å™¨èµ°èµ·ã€‚\nå†å’ŒGPTèŠèŠæ–¹æ¡ˆ å’ŒGPTèŠä¸€ä¸‹ï¼Œç¡®è®¤äº†å¯è¡Œæ€§ã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 ç”¨ Headscale ä½œä¸º Tailscale Control Serverï¼Œ å…³é—­ Tailscale å®˜æ–¹ SaaSï¼Œ é‰´æƒæ¥å…¥ä½ è‡ªå·±çš„ OAuth / LDAP / Token / SSOã€‚ ## äºŒã€å…³é”®ç»„ä»¶è¯´æ˜ï¼ˆé‡è¦ï¼‰ ### Tailscale å®˜æ–¹å®¢æˆ·ç«¯ + å®˜æ–¹ SaaS ä½ ä¸ç”¨å®˜æ–¹ SaaS åªä½¿ç”¨å®¢æˆ·ç«¯ï¼ˆtailscale up --login-server=...ï¼‰ ### Headscaleï¼ˆæ ¸å¿ƒï¼‰ Tailscale å®˜æ–¹åè®®çš„ å¼€æº Control Server 100% è‡ªæ‰˜ç®¡ MIT License æ”¯æŒï¼š Namespaces / Users ACL PreAuthKey OIDCï¼ˆå¯æ‰©å±•ï¼‰ ğŸ‘‰ Headscale = ä½ è‡ªå·±çš„ Tailscale Server é“ç†æ‡‚äº†ï¼Œå¼€å¹²å§ã€‚\nVibe Coding DevOps å¼€æ•´ æƒ³äº†ä¸‹ï¼Œ\nç›´æ¥è®©GPTç”Ÿæˆä¸€ä¸ªVibe Codingè¦æ±‚ï¼Œ\næ‰”ç»™Copilot ç›´æ¥åŠ¡å™¨ä¸Šé¢è·‘è¯•è¯•çœ‹ã€‚\näºæ˜¯æœ‰äº†ä¸‹é¢è¿™ä¸ª\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 ä½ æ˜¯ä¸€ä¸ªèµ„æ·± SRE / åŸºç¡€è®¾æ–½å·¥ç¨‹å¸ˆï¼Œè¯·å¸®æˆ‘åœ¨ä¸€å° Linux æœåŠ¡å™¨ä¸Šï¼Œ ä» 0 åˆ° 1 å®Œæ•´éƒ¨ç½²ä¸€ä¸ªã€è‡ªå»º Tailscale æ§åˆ¶é¢ç³»ç»Ÿã€‘ã€‚ ================================================ ã€æœåŠ¡å™¨ä¸åŸºç¡€ä¿¡æ¯ã€‘ ================================================ æœåŠ¡å™¨åœ°å€ï¼š ts.example.cn SSH ç™»å½•æ–¹å¼ï¼š ssh root@ts.example.cn æ“ä½œç³»ç»Ÿï¼š å‡è®¾ä¸º Ubuntu 20.04 / 22.04ï¼ˆä¸»æµ Linux å³å¯ï¼‰ æƒé™ï¼š - root æƒé™ - å¯æ‰§è¡Œä»»æ„ç³»ç»Ÿå‘½ä»¤ åŸŸåçŠ¶æ€ï¼ˆå·²å®Œæˆï¼‰ï¼š - ts.example.cn â†’ æœ¬æœºå…¬ç½‘ IP - auth.example.cn â†’ æœ¬æœºå…¬ç½‘ IP DNS å·²è§£æå®Œæˆï¼Œä¸éœ€è¦ä½ å¤„ç† DNS HTTPS è¦æ±‚ï¼š - ä½¿ç”¨ acme.sh ç”³è¯· Letâ€™s Encrypt è¯ä¹¦ - ä½¿ç”¨ Nginx æ¨¡å¼æˆ– standalone å‡å¯ - éœ€è¦é…ç½®è‡ªåŠ¨ç»­æœŸ - è¯ä¹¦è·¯å¾„è¦æ¸…æ™°ã€å¯ç»´æŠ¤ ================================================ ã€æœ€ç»ˆç›®æ ‡ã€‘ ================================================ åœ¨è¿™å°æœåŠ¡å™¨ä¸Šå®Œæˆä»¥ä¸‹ç³»ç»Ÿéƒ¨ç½²ï¼Œå¹¶ç¡®ä¿é•¿æœŸç¨³å®šè¿è¡Œï¼š 1. Headscale - ä½œä¸ºå”¯ä¸€çš„ Tailscale æ§åˆ¶é¢ï¼ˆæ›¿ä»£å®˜æ–¹ SaaSï¼‰ - å¯¹å¤–æœåŠ¡åœ°å€ï¼šhttps://ts.example.cn 2. è´¦å· / å¯†ç ç™»å½•ç³»ç»Ÿ - ä½¿ç”¨ Authentik - é€šè¿‡ OIDC ä¸ Headscale é›†æˆ - ç™»å½•å…¥å£ï¼šhttps://auth.example.cn 3. PostgreSQL - ä»…ä¾› Authentik ä½¿ç”¨ 4. Tailscale Client - æœ¬æœºä½œä¸ºä¸€ä¸ªæ™®é€š Tailscale èŠ‚ç‚¹åŠ å…¥ç½‘ç»œ 5. HTTPS - ç”±å®¿ä¸»æœº Nginx ç»Ÿä¸€è´Ÿè´£ - ä¸ä½¿ç”¨ Traefik / Caddy 6. å®¹å™¨ç®¡ç† - ä½¿ç”¨ Docker + docker-compose - æ‰€æœ‰æœåŠ¡å¯ä¸€é”®å¯åŠ¨ / åœæ­¢ æœ€ç»ˆæ•ˆæœåº”æ”¯æŒï¼š tailscale up --login-server=https://ts.example.cn ================================================ ã€å¼ºåˆ¶æ¶æ„çº¦æŸï¼ˆå¿…é¡»éµå®ˆï¼‰ã€‘ ================================================ - âŒ ä¸ä½¿ç”¨å®˜æ–¹ Tailscale SaaS - âœ… ä½¿ç”¨ Headscale ä½œä¸ºå”¯ä¸€æ§åˆ¶é¢ - âœ… ä½¿ç”¨ Authentik æä¾›è´¦å· / å¯†ç ç™»å½• - âœ… Headscale + Authentik + PostgreSQL ä½¿ç”¨ docker-compose - âœ… Tailscale client ä½¿ç”¨å®˜æ–¹ tailscale å®¹å™¨ - âœ… HTTPS å®Œå…¨ç”±å®¿ä¸»æœº Nginx æä¾› - âŒ ä¸åœ¨è¯¥æœºå™¨ä¸Šè¿è¡Œ k3s master / etcd - âœ… æ‰€æœ‰é…ç½®å¿…é¡»æ˜¯çœŸå®å¯è¿è¡Œé…ç½®ï¼Œä¸å…è®¸ä¼ªä»£ç  ================================================ ã€åŸŸåä¸ç«¯å£è§„åˆ’ï¼ˆå›ºå®šï¼‰ã€‘ ================================================ å¯¹å¤–åŸŸåï¼š - Headscaleï¼š https://ts.example.cn - é‰´æƒå…¥å£ï¼š https://auth.example.cn å†…éƒ¨ç«¯å£ï¼ˆå¯è‡ªè¡Œé€‰æ‹©ï¼Œä½†éœ€åˆç†ï¼‰ï¼š - Headscaleï¼š8080 - Authentikï¼š9000 - PostgreSQLï¼š5432 ================================================ ã€ä½ éœ€è¦è¾“å‡ºçš„å†…å®¹ï¼ˆä¸€æ­¥éƒ½ä¸èƒ½å°‘ï¼‰ã€‘ ================================================ è¯·ä½ ã€ä¸¥æ ¼æŒ‰é¡ºåºã€‘è¾“å‡ºå¹¶è§£é‡Šä»¥ä¸‹å†…å®¹ï¼š 1. ğŸ§± æœåŠ¡å™¨åˆå§‹åŒ– - æ›´æ–°ç³»ç»Ÿ - å®‰è£… Docker - å®‰è£… docker-composeï¼ˆplugin æˆ– standaloneï¼‰ - å®‰è£… Nginx - å®‰è£… acme.sh 2. ğŸ” HTTPS è¯ä¹¦ç”³è¯· - ä½¿ç”¨ acme.sh ä¸ºä»¥ä¸‹åŸŸåç”³è¯·è¯ä¹¦ï¼š - ts.example.cn - auth.example.cn - ç»™å‡ºå®Œæ•´ã€çœŸå®çš„å‘½ä»¤ - é…ç½®è‡ªåŠ¨ç»­æœŸ - æ˜ç¡®è¯ä¹¦å­˜æ”¾è·¯å¾„ 3. ğŸŒ Nginx é…ç½® - ä¸º ts.example.cn ç”Ÿæˆ server blockï¼ˆåä»£ Headscaleï¼‰ - ä¸º auth.example.cn ç”Ÿæˆ server blockï¼ˆåä»£ Authentikï¼‰ - å¯ç”¨ HTTPS - è®¾ç½®æ­£ç¡®çš„ proxy headersï¼ˆHost / X-Forwarded-Proto ç­‰ï¼‰ 4. ğŸ“ ç›®å½•ç»“æ„è§„åˆ’ - ç»™å‡ºä¸€ä¸ªæ¨èçš„éƒ¨ç½²ç›®å½•ï¼ˆä¾‹å¦‚ /opt/headscale-stackï¼‰ - è¾“å‡ºå®Œæ•´ç›®å½•æ ‘ 5. ğŸ³ Docker Compose - PostgreSQLï¼ˆä»… Authentik ä½¿ç”¨ï¼‰ - Authentikï¼ˆè´¦å· / å¯†ç  + OIDCï¼‰ - Headscale - Tailscale client - åŒ…å«ï¼š - volumes - networks - restart policy 6. âš™ï¸ Headscale é…ç½®æ–‡ä»¶ - server_url è®¾ç½®ä¸ºï¼šhttps://ts.example.cn - IP æ®µä½¿ç”¨ï¼š100.64.0.0/10 - å¯ç”¨ OIDC - OIDC issuer è®¾ç½®ä¸ºï¼š https://auth.example.cn/application/o/headscale/ 7. ğŸ‘¤ Authentik åˆå§‹åŒ–ä¸ OIDC é…ç½® - å¦‚ä½•é¦–æ¬¡åˆå§‹åŒ–ç®¡ç†å‘˜è´¦å· - å¦‚ä½•åˆ›å»º OIDC Application - Client ID åº”è®¾ç½®ä¸ºï¼šheadscale - Redirect URI å¿…é¡»æ˜¯ï¼š https://ts.example.cn/oidc/callback - å¦‚ä½•è·å– Client Secret å¹¶å¡«å› Headscale 8. â–¶ï¸ å¯åŠ¨ä¸éªŒè¯ - docker compose up -d - å¦‚ä½•æ£€æŸ¥å®¹å™¨çŠ¶æ€ - å¦‚ä½•éªŒè¯ï¼š - https://ts.example.cn å¯è®¿é—® - https://auth.example.cn ç™»å½•é¡µæ­£å¸¸ 9. ğŸ§ª å®¢æˆ·ç«¯æ¥å…¥éªŒè¯ - ç»™å‡ºçœŸå®å‘½ä»¤ï¼š tailscale up --login-server=https://ts.example.cn - æè¿°å®Œæ•´ç™»å½•æµç¨‹ï¼š CLI â†’ æµè§ˆå™¨ â†’ è´¦å·å¯†ç  â†’ å›è°ƒ â†’ å…¥ç½‘ 10. âš ï¸ å…³é”®æ³¨æ„äº‹é¡¹ - å“ªäº›ç›®å½•å¿…é¡»å¤‡ä»½ - ä¸ºä»€ä¹ˆ 2C2G èµ„æºè¶³å¤Ÿ - å“ªäº›äº‹æƒ…ç»å¯¹ä¸èƒ½åšï¼ˆä¾‹å¦‚è·‘ k3s master / etcdï¼‰ ================================================ ã€è¾“å‡ºé£æ ¼è¦æ±‚ã€‘ ================================================ - å¿…é¡»æ˜¯ã€Œä¸€æ­¥ä¸€æ­¥å¯æ‰§è¡Œçš„å®æ“æ‰‹å†Œã€ - æ‰€æœ‰å‘½ä»¤ã€é…ç½®éƒ½å¯ä»¥ç›´æ¥å¤åˆ¶æ‰§è¡Œ - ä¸å…è®¸è¯´â€œè‡ªè¡Œé…ç½®â€â€œç•¥â€ - å‡è®¾è¯»è€…æ˜¯æ‡‚ Linux / Docker / ç½‘ç»œçš„å·¥ç¨‹å¸ˆ - ä»¥å·¥ç¨‹å®æˆ˜ä¸ºç¬¬ä¸€ä¼˜å…ˆçº§ ================================================ ã€æœ€ç»ˆéªŒæ”¶æ ‡å‡†ã€‘ ================================================ å½“æˆ‘å®Œå…¨ç…§ä½ ç»™å‡ºçš„æ­¥éª¤æ‰§è¡Œåï¼Œåº”å½“æ»¡è¶³ï¼š - https://ts.example.cn æ­£å¸¸å·¥ä½œï¼ˆHeadscaleï¼‰ - https://auth.example.cn æ­£å¸¸ç™»å½•ï¼ˆè´¦å· / å¯†ç ï¼‰ - æ–°æœºå™¨å¯é€šè¿‡è´¦å·å¯†ç åŠ å…¥ Tailscale ç½‘ç»œ - è¯¥ç½‘ç»œå¯ç¨³å®šæ‰¿è½½ k3s over Tailscale è¯·ä¸¥æ ¼æŒ‰ç…§ä»¥ä¸Šè¦æ±‚è¾“å‡ºå®Œæ•´éƒ¨ç½²æ–¹æ¡ˆã€‚ äº‘æœåŠ¡ä¹°å¥½äº†ï¼ŒæŠŠä¸Šé¢ä¸¤ä¸ªåŸŸåè§£æåˆ°æ–°æœºå™¨ï¼Œ\nå¼€æ•´\u0026hellip;\næœ€ç»ˆçš„æˆæœçš„æ ¸å¿ƒDocker-composeæ˜¯å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 version: \u0026#39;3.8\u0026#39; services: postgresql: image: docker.io/library/postgres:16-alpine container_name: headscale-postgresql restart: unless-stopped healthcheck: test: [\u0026#34;CMD-SHELL\u0026#34;, \u0026#34;pg_isready -d $${POSTGRES_DB} -U $${POSTGRES_USER}\u0026#34;] start_period: 20s interval: 30s retries: 5 timeout: 5s volumes: - ./postgres:/var/lib/postgresql/data environment: POSTGRES_PASSWORD: ${PG_PASS:-authentik_password_change_me} POSTGRES_USER: ${PG_USER:-authentik} POSTGRES_DB: ${PG_DB:-authentik} networks: - headscale-net ports: - \u0026#34;127.0.0.1:5432:5432\u0026#34; redis: image: docker.io/library/redis:alpine container_name: headscale-redis command: --save 60 1 --loglevel warning restart: unless-stopped healthcheck: test: [\u0026#34;CMD-SHELL\u0026#34;, \u0026#34;redis-cli ping | grep PONG\u0026#34;] start_period: 20s interval: 30s retries: 5 timeout: 3s volumes: - redis:/data networks: - headscale-net authentik-server: image: ghcr.io/goauthentik/server:latest container_name: authentik-server restart: unless-stopped command: server environment: AUTHENTIK_REDIS__HOST: redis AUTHENTIK_POSTGRESQL__HOST: postgresql AUTHENTIK_POSTGRESQL__USER: ${PG_USER:-authentik} AUTHENTIK_POSTGRESQL__NAME: ${PG_DB:-authentik} AUTHENTIK_POSTGRESQL__PASSWORD: ${PG_PASS:-authentik_password_change_me} AUTHENTIK_SECRET_KEY: ${AUTHENTIK_SECRET_KEY:-change_this_to_random_string_min_50_chars_abcdefghijklmnopqrstuvwxyz} AUTHENTIK_ERROR_REPORTING__ENABLED: \u0026#34;false\u0026#34; AUTHENTIK_DISABLE_UPDATE_CHECK: \u0026#34;true\u0026#34; AUTHENTIK_DISABLE_STARTUP_ANALYTICS: \u0026#34;true\u0026#34; AUTHENTIK_AVATARS: \u0026#34;initials\u0026#34; volumes: - ./authentik/media:/media - ./authentik/custom-templates:/templates ports: - \u0026#34;127.0.0.1:9000:9000\u0026#34; networks: - headscale-net depends_on: - postgresql - redis authentik-worker: image: ghcr.io/goauthentik/server:latest container_name: authentik-worker restart: unless-stopped command: worker environment: AUTHENTIK_REDIS__HOST: redis AUTHENTIK_POSTGRESQL__HOST: postgresql AUTHENTIK_POSTGRESQL__USER: ${PG_USER:-authentik} AUTHENTIK_POSTGRESQL__NAME: ${PG_DB:-authentik} AUTHENTIK_POSTGRESQL__PASSWORD: ${PG_PASS:-authentik_password_change_me} AUTHENTIK_SECRET_KEY: ${AUTHENTIK_SECRET_KEY:-change_this_to_random_string_min_50_chars_abcdefghijklmnopqrstuvwxyz} AUTHENTIK_ERROR_REPORTING__ENABLED: \u0026#34;false\u0026#34; AUTHENTIK_DISABLE_UPDATE_CHECK: \u0026#34;true\u0026#34; AUTHENTIK_DISABLE_STARTUP_ANALYTICS: \u0026#34;true\u0026#34; user: root volumes: - /var/run/docker.sock:/var/run/docker.sock - ./authentik/media:/media - ./authentik/certs:/certs - ./authentik/custom-templates:/templates networks: - headscale-net depends_on: - postgresql - redis headscale: image: headscale/headscale:latest container_name: headscale restart: unless-stopped command: serve volumes: - ./headscale/config.yaml:/etc/headscale/config.yaml:ro - ./headscale/data:/var/lib/headscale - ./headscale/run:/var/run/headscale ports: - \u0026#34;127.0.0.1:8080:8080\u0026#34; - \u0026#34;127.0.0.1:9090:9090\u0026#34; networks: - headscale-net networks: headscale-net: driver: bridge volumes: redis: driver: local Nginx config é…ç½®å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 upstream authentik { server 127.0.0.1:9000; } server { listen 80; server_name auth.example.cn; return 301 https://$server_name$request_uri; } server { listen 443 ssl http2; server_name auth.example.cn; ssl_certificate /etc/nginx/ssl/ts.example.cn.fullchain.cer; ssl_certificate_key /etc/nginx/ssl/ts.example.cn.key; ssl_protocols TLSv1.2 TLSv1.3; ssl_ciphers HIGH:!aNULL:!MD5; ssl_prefer_server_ciphers on; client_max_body_size 25M; location / { proxy_pass http://authentik; proxy_http_version 1.1; proxy_set_header X-Forwarded-Proto $scheme; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; proxy_set_header Host $host; proxy_set_header Upgrade $http_upgrade; proxy_set_header Connection \u0026#34;upgrade\u0026#34;; add_header Strict-Transport-Security \u0026#34;max-age=15552000; includeSubDomains\u0026#34; always; } } upstream headscale { server 127.0.0.1:8080; } map $http_upgrade $connection_upgrade { default keep-alive; \u0026#39;websocket\u0026#39; upgrade; \u0026#39;\u0026#39; close; } server { listen 80; server_name ts.example.cn; return 301 https://$server_name$request_uri; } server { listen 443 ssl http2; server_name ts.example.cn; ssl_certificate /etc/nginx/ssl/ts.example.cn.fullchain.cer; ssl_certificate_key /etc/nginx/ssl/ts.example.cn.key; ssl_protocols TLSv1.2 TLSv1.3; ssl_ciphers HIGH:!aNULL:!MD5; ssl_prefer_server_ciphers on; location / { proxy_pass http://headscale; proxy_http_version 1.1; proxy_set_header Upgrade $http_upgrade; proxy_set_header Connection $connection_upgrade; proxy_set_header Host $server_name; proxy_redirect http:// https://; proxy_buffering off; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; proxy_set_header X-Forwarded-Proto $http_x_forwarded_proto; add_header Strict-Transport-Security \u0026#34;max-age=15552000; includeSubDomains\u0026#34; always; } } æœ€ç»ˆæˆæœ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 *** System restart required *** âœ ~ tailscale status 100.64.0.3 haru https://auth.example.cn/application/o/headscale dcaba24e364c6ea7c3dd676f3d445f85843028f1f12880dcba46acabf82509ad linux - 100.64.0.9 hc1 https://auth.example.cn/application/o/headscale/dcaba24e364c6ea7c3dd676f3d445f85843028f1f12880dcba46acabf82509ad linux - 100.64.0.4 lgb-amd-3700 https://auth.example.cn/application/o/headscale/dcaba24e364c6ea7c3dd676f3d445f85843028f1f12880dcba46acabf82509ad linux idle, tx 1052 rx 860 100.64.0.2 lgb-macbookair-m4 https://auth.example.cn/application/o/headscale/dcaba24e364c6ea7c3dd676f3d445f85843028f1f12880dcba46acabf82509ad macOS offline 100.64.0.8 rainyun https://auth.example.cn/application/o/headscale/dcaba24e364c6ea7c3dd676f3d445f85843028f1f12880dcba46acabf82509ad linux - 100.64.0.10 ts-example-cn https://auth.example.cn/application/o/headscale/dcaba24e364c6ea7c3dd676f3d445f85843028f1f12880dcba46acabf82509ad linux - 100.64.0.11 us-vultr https://auth.example.cn/application/o/headscale/dcaba24e364c6ea7c3dd676f3d445f85843028f1f12880dcba46acabf82509ad linux idle, tx 1012 rx 860 100.64.0.6 vm-0-8-ubuntu-new https://auth.example.cn/application/o/headscale/dcaba24e364c6ea7c3dd676f3d445f85843028f1f12880dcba46acabf82509ad linux - 100.64.0.5 vm-16-12-ubuntu https://auth.example.cn/application/o/headscale/dcaba24e364c6ea7c3dd676f3d445f85843028f1f12880dcba46acabf82509ad linux - 100.64.0.7 vm-28-17-ubuntu https://auth.example.cn/application/o/headscale/dcaba24e364c6ea7c3dd676f3d445f85843028f1f12880dcba46acabf82509ad linux - âœ ~ âœ ~ ping 100.64.0.3 PING 100.64.0.3 (100.64.0.3) 56(84) bytes of data. 64 bytes from 100.64.0.3: icmp_seq=1 ttl=64 time=0.049 ms 64 bytes from 100.64.0.3: icmp_seq=2 ttl=64 time=0.034 ms 64 bytes from 100.64.0.3: icmp_seq=3 ttl=64 time=0.043 ms ^C --- 100.64.0.3 ping statistics --- 3 packets transmitted, 3 received, 0% packet loss, time 2026ms rtt min/avg/max/mdev = 0.034/0.042/0.049/0.006 ms âœ ~ ping 100.64.0.9 PING 100.64.0.9 (100.64.0.9) 56(84) bytes of data. 64 bytes from 100.64.0.9: icmp_seq=1 ttl=64 time=737 ms 64 bytes from 100.64.0.9: icmp_seq=2 ttl=64 time=12.5 ms 64 bytes from 100.64.0.9: icmp_seq=3 ttl=64 time=12.0 ms 64 bytes from 100.64.0.9: icmp_seq=4 ttl=64 time=12.1 ms 64 bytes from 100.64.0.9: icmp_seq=5 ttl=64 time=12.9 ms 64 bytes from 100.64.0.9: icmp_seq=6 ttl=64 time=12.3 ms 64 bytes from 100.64.0.9: icmp_seq=7 ttl=64 time=12.1 ms 64 bytes from 100.64.0.9: icmp_seq=8 ttl=64 time=12.4 ms ^C --- 100.64.0.9 ping statistics --- 8 packets transmitted, 8 received, 0% packet loss, time 7008ms rtt min/avg/max/mdev = 12.015/102.875/736.725/239.572 ms âœ ~ ping 100.64.0.5 PING 100.64.0.5 (100.64.0.5) 56(84) bytes of data. 64 bytes from 100.64.0.5: icmp_seq=1 ttl=64 time=96.3 ms 64 bytes from 100.64.0.5: icmp_seq=2 ttl=64 time=5.57 ms 64 bytes from 100.64.0.5: icmp_seq=3 ttl=64 time=4.93 ms 64 bytes from 100.64.0.5: icmp_seq=4 ttl=64 time=5.12 ms 64 bytes from 100.64.0.5: icmp_seq=5 ttl=64 time=5.40 ms ^C --- 100.64.0.5 ping statistics --- 5 packets transmitted, 5 received, 0% packet loss, time 4006ms rtt min/avg/max/mdev = 4.932/23.468/96.318/36.425 ms âœ ~ å®æ“æ³¨æ„äº‹é¡¹ åˆ‡è®°è®©Vibe Codingåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œæ“ä½œï¼Œä¸ç„¶å¾ˆå¤šæ—¶å€™å¯èƒ½åœ¨å½“å‰çš„æœºå™¨ä¸Šå°±è·‘èµ·æ¥äº† Docker é•œåƒå›½å†…ä¸å¤ªå¥½è®¿é—®ï¼Œå»ºè®®æœ¬åœ°å¯¼å‡ºåå¯¼å…¥åˆ°æœåŠ¡å™¨ authentik åˆ›å»ºç”¨æˆ·å¯èƒ½æ²¡æœ‰è‡ªåŠ¨å®Œæˆï¼Œç»§ç»­è®©Vibe Coding ç”Ÿæˆè„šæœ¬å»è®©ä»–æ“ä½œå³å¯ åŸºæœ¬æ²¡ä»€ä¹ˆåˆ«çš„å‘äº†ï¼Œ\nç¥ç©å¾—å¼€å¿ƒ~\n","date":"2026-02-09T08:00:00Z","image":"https://liguobao.github.io/zh/p/vibe-coding-deploy-tailscale/logo_hu_bffb7fc0fd4bf5c.png","permalink":"https://liguobao.github.io/zh/p/vibe-coding-deploy-tailscale/","title":"è°ä¸æƒ³è¦è‡ªå·±çš„Tailscaleå†…ç½‘å‘¢~"},{"content":"å¼•è¨€ å¦‚æœè¦è°ƒè¯• unitree-g1-edu æœºå™¨äººçš„è¯ï¼Œ\nè‚¯å®šæ˜¯çœ‹è¿‡ä»–ä»¬çš„å®˜æ–¹æ–‡æ¡£çš„ã€‚\nå¿«é€Ÿå¼€å‘æ–‡æ¡£åœ¨è¿™é‡Œï¼š\nG1_developer/å¿«é€Ÿå¼€å‘\nç¯å¢ƒè¦æ±‚å€’æ²¡æ’’ï¼ŒåŸºäºUbuntu 20.04 or 22.04,\nè£…ä¸Šä¾èµ–åº“ï¼Œ\nåŸºæœ¬æ˜¯æœ‰æ‰‹å°±èƒ½è¡Œçš„æ“ä½œã€‚\nåªæ˜¯ï¼Œ\nå¦‚æœä½ æƒ³å»è°ƒè¯•ä¸€ä¸‹G1æœºå™¨äººçš„è¯ï¼Œ\nå®˜æ–¹çš„æ–¹æ¡ˆæ˜¯ï¼Œå¤§æ¦‚æ˜¯è¿™æ ·çš„ã€‚\næ¼”ç¤ºè§†é¢‘ã€‚\næ‹–ä¸€æ ¹ç½‘çº¿ä»G1æœºå™¨äººé¢ˆéƒ¨ç½‘å£æ¥å…¥ï¼Œè¿æ¥åˆ°ä½ çš„Ubuntuä¸»æœº\nç»™Ubuntuä¸»æœºç½‘ç»œè®¾å®šå›ºå®šIP, é€šè¿‡lanå£åšç½‘ç»œé€šè®¯\nå¤§æ¦‚å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 å»ºè®®æ–°ç”¨æˆ·ä½¿ç”¨ç½‘çº¿ä¸è½¬æ¥çº¿å°†ç”¨æˆ·è®¡ç®—æœºæ¥å…¥ G1 äº¤æ¢æœºï¼Œ å¹¶å°†ä¸æœºå™¨äººé€šä¿¡çš„ç½‘å¡è®¾ç½®åœ¨ 192.168.123.X ç½‘æ®µä¸‹ï¼Œ æ¨èä½¿ç”¨ 192.168.123.99ã€‚ å€’æ²¡ä»€ä¹ˆé—®é¢˜ï¼Œåªæ˜¯æ‹–ç€ä¸€ä¸ªç½‘çº¿ï¼Œæ€ä¹ˆçœ‹éƒ½æ˜¯éº»çƒ¦ã€‚\næœ‰ä»€ä¹ˆåˆ«çš„åŠæ³•ä¹ˆï¼Ÿ\næ€ç´¢äº†ä¸€ä¸‹ï¼Œç›´æ¥ç”¨â€œæ ‘è“æ´¾â€åšä¸ªä¸»æ§æœºå™¨è¿æ¥G1ç½‘ç»œï¼Œ\nåŒæ—¶æ ‘è“æ´¾è¿æ¥åˆ°æœ¬åœ°å±€åŸŸç½‘ï¼Œ\né‚£ä¸å°±å¯ä»¥ç›´æ¥è¿œç¨‹æ˜¯æ“æ§æœºå™¨äº†ï¼Ÿ\nåˆç ”ç©¶äº†ä¸€ä¸‹ï¼ŒG1-EDUç½‘å¡æ—è¾¹è¿˜æœ‰ä¸‰ä¸ªä¾›ç”µå£ï¼Œ\nåˆ†åˆ«æ˜¯12V ã€ 24V ã€ 48Vï¼Œ\nä¹Ÿè¶³å¤Ÿç»™æ ‘è“æ´¾ä¾›ç”µäº†ï¼ˆæ ‘è“æ´¾æ˜¯5Vï¼Œä¹°ä¸ªç”µå‹è½¬æ¢å™¨å³å¯ï¼‰ã€‚\nå°±è¿™ä¸ªç”µå‹ï¼Œç»™æ›´å¤šçš„è®¾å¤‡ä¾›ç”µä¹Ÿæ²¡ä»€ä¹ˆé—®é¢˜ã€‚\nä¾‹å¦‚ï¼šçµå·§æ‰‹ï¼Ÿå¾ˆæ˜¯æœ‰è¶£äº†ã€‚\nâ€œæ ‘è“æ´¾â€ ç¡¬ä»¶ç¯å¢ƒå‡†å¤‡ è½¬å‹å™¨(EVEPSç›´æµé™å‹å™¨) + ç”µæºçº¿ï¼Œ\nEVEPSç›´æµé™å‹å™¨\nç”µæºçº¿\nåŠ èµ·æ¥ä¸‰åæ¥å—ææ‚ï¼Œ\næ·˜å®ç›´æ¥ä¹°å°±å¯ä»¥ã€‚\n3Mèƒ¶å¸ƒå›ºå®šâ€œæ ‘è“æ´¾â€åˆ°æœºå™¨èƒŒé¢ï¼Œç”µæºçº¿æ¥ä¸Šå»ï¼Œ\nç½‘çº¿ä»è„–å­åé¢å‡ºæ¥ï¼Œæ¥åˆ°æ ‘è“æ´¾ä¸Šé¢ï¼Œ\næœ€åï¼Œå¥—ä¸€ä¸ªè¡£æœåˆ°G1ä¸Šé¢ï¼Œ\nä¸€åˆ‡éƒ½å¯ä»¥è—èµ·æ¥äº†ã€‚\nPython åŠ¨ä½œè°ƒè¯• æœ¬åœ°å…ˆæŠŠä»–ä»¬å®¶çš„unitree_sdk2pyè£…å¥½ï¼Œ\nç„¶åå°±å¯ä»¥è¯•è¯•è°ƒè¯•ä¸€ä¸‹G1äº†~\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 import time import sys from unitree_sdk2py.core.channel import ChannelSubscriber, ChannelFactoryInitialize from unitree_sdk2py.g1.arm.g1_arm_action_client import G1ArmActionClient from unitree_sdk2py.g1.arm.g1_arm_action_client import action_map from dataclasses import dataclass @dataclass class TestOption: name: str id: int option_list = [ TestOption(name=\u0026#34;release arm\u0026#34;, id=0), TestOption(name=\u0026#34;shake hand\u0026#34;, id=1), TestOption(name=\u0026#34;high five\u0026#34;, id=2), TestOption(name=\u0026#34;hug\u0026#34;, id=3), TestOption(name=\u0026#34;high wave\u0026#34;, id=4), TestOption(name=\u0026#34;clap\u0026#34;, id=5), TestOption(name=\u0026#34;face wave\u0026#34;, id=6), TestOption(name=\u0026#34;left kiss\u0026#34;, id=7), TestOption(name=\u0026#34;heart\u0026#34;, id=8), TestOption(name=\u0026#34;right heart\u0026#34;, id=9), TestOption(name=\u0026#34;hands up\u0026#34;, id=10), TestOption(name=\u0026#34;x-ray\u0026#34;, id=11), TestOption(name=\u0026#34;right hand up\u0026#34;, id=12), TestOption(name=\u0026#34;reject\u0026#34;, id=13), TestOption(name=\u0026#34;right kiss\u0026#34;, id=14), TestOption(name=\u0026#34;two-hand kiss\u0026#34;, id=15), ] class UserInterface: def __init__(self): self.test_option_ = None def convert_to_int(self, input_str): try: return int(input_str) except ValueError: return None def terminal_handle(self): input_str = input(\u0026#34;Enter id or name: \\n\u0026#34;) if input_str == \u0026#34;list\u0026#34;: self.test_option_.name = None self.test_option_.id = None for option in option_list: print(f\u0026#34;{option.name}, id: {option.id}\u0026#34;) return for option in option_list: if input_str == option.name or self.convert_to_int(input_str) == option.id: self.test_option_.name = option.name self.test_option_.id = option.id print(f\u0026#34;Test: {self.test_option_.name}, test_id: {self.test_option_.id}\u0026#34;) return print(\u0026#34;No matching test option found.\u0026#34;) def shake_hand(network_interface): ChannelFactoryInitialize(0, network_interface) armAction_client = G1ArmActionClient() armAction_client.SetTimeout(10.0) armAction_client.Init() time.sleep(0.5) armAction_client.ExecuteAction(action_map.get(\u0026#34;shake hand\u0026#34;)) time.sleep(2) armAction_client.ExecuteAction(action_map.get(\u0026#34;release arm\u0026#34;)) print(\u0026#34;Shaked hand and released arm.\u0026#34;) def release_arm(network_interface): ChannelFactoryInitialize(0, network_interface) armAction_client = G1ArmActionClient() armAction_client.SetTimeout(10.0) armAction_client.Init() time.sleep(0.5) result = armAction_client.ExecuteAction(action_map.get(\u0026#34;release arm\u0026#34;)) print(f\u0026#34;Released arm with result: {result}\u0026#34;) if __name__ == \u0026#34;__main__\u0026#34;: if len(sys.argv) \u0026lt; 2: print(f\u0026#34;Usage: python3 {sys.argv[0]} networkInterface\u0026#34;) sys.exit(-1) print(\u0026#34;WARNING: Please ensure there are no obstacles around the robot while running this example.\u0026#34;) input(\u0026#34;Press Enter to continue...\u0026#34;) ChannelFactoryInitialize(0, sys.argv[1]) test_option = TestOption(name=None, id=None) user_interface = UserInterface() user_interface.test_option_ = test_option armAction_client = G1ArmActionClient() armAction_client.SetTimeout(10.0) armAction_client.Init() # actionList = armAction_client.GetActionList() # print(\u0026#34;actionList\\n\u0026#34;,actionList) print(\u0026#34;Input \\\u0026#34;list\\\u0026#34; to list all test option ...\u0026#34;) while True: user_interface.terminal_handle() print(f\u0026#34;Updated Test Option: Name = {test_option.name}, ID = {test_option.id}\u0026#34;) if test_option.id == 0: armAction_client.ExecuteAction(action_map.get(\u0026#34;release arm\u0026#34;)) elif test_option.id == 1: armAction_client.ExecuteAction(action_map.get(\u0026#34;shake hand\u0026#34;)) time.sleep(2) armAction_client.ExecuteAction(action_map.get(\u0026#34;release arm\u0026#34;)) elif test_option.id == 2: armAction_client.ExecuteAction(action_map.get(\u0026#34;high five\u0026#34;)) time.sleep(2) armAction_client.ExecuteAction(action_map.get(\u0026#34;release arm\u0026#34;)) elif test_option.id == 3: armAction_client.ExecuteAction(action_map.get(\u0026#34;hug\u0026#34;)) time.sleep(2) armAction_client.ExecuteAction(action_map.get(\u0026#34;release arm\u0026#34;)) elif test_option.id == 4: armAction_client.ExecuteAction(action_map.get(\u0026#34;high wave\u0026#34;)) elif test_option.id == 5: armAction_client.ExecuteAction(action_map.get(\u0026#34;clap\u0026#34;)) elif test_option.id == 6: armAction_client.ExecuteAction(action_map.get(\u0026#34;face wave\u0026#34;)) elif test_option.id == 7: armAction_client.ExecuteAction(action_map.get(\u0026#34;left kiss\u0026#34;)) elif test_option.id == 8: armAction_client.ExecuteAction(action_map.get(\u0026#34;heart\u0026#34;)) time.sleep(2) armAction_client.ExecuteAction(action_map.get(\u0026#34;release arm\u0026#34;)) elif test_option.id == 9: armAction_client.ExecuteAction(action_map.get(\u0026#34;right heart\u0026#34;)) time.sleep(2) armAction_client.ExecuteAction(action_map.get(\u0026#34;release arm\u0026#34;)) elif test_option.id == 10: armAction_client.ExecuteAction(action_map.get(\u0026#34;hands up\u0026#34;)) time.sleep(2) armAction_client.ExecuteAction(action_map.get(\u0026#34;release arm\u0026#34;)) elif test_option.id == 11: armAction_client.ExecuteAction(action_map.get(\u0026#34;x-ray\u0026#34;)) time.sleep(2) armAction_client.ExecuteAction(action_map.get(\u0026#34;release arm\u0026#34;)) elif test_option.id == 12: armAction_client.ExecuteAction(action_map.get(\u0026#34;right hand up\u0026#34;)) time.sleep(2) armAction_client.ExecuteAction(action_map.get(\u0026#34;release arm\u0026#34;)) elif test_option.id == 13: armAction_client.ExecuteAction(action_map.get(\u0026#34;reject\u0026#34;)) time.sleep(2) armAction_client.ExecuteAction(action_map.get(\u0026#34;release arm\u0026#34;)) elif test_option.id == 14: armAction_client.ExecuteAction(action_map.get(\u0026#34;right kiss\u0026#34;)) elif test_option.id == 15: armAction_client.ExecuteAction(action_map.get(\u0026#34;two-hand kiss\u0026#34;)) time.sleep(1) ","date":"2026-01-24T08:00:00Z","image":"https://liguobao.github.io/zh/p/unitree-g1-develop-on-raspberry-pi/logo_hu_a3946870fe30519f.png","permalink":"https://liguobao.github.io/zh/p/unitree-g1-develop-on-raspberry-pi/","title":"å®‡æ ‘æœºå™¨äººG1ä¾¿æºå¼€å‘æŒ‡åŒ—ï¼šåŸºäºæ ‘è“æ´¾çš„ç¯å¢ƒæ­å»º"},{"content":"åˆšåˆšè¿‡å»äº†â€œåŒåä¸€â€æ´»åŠ¨æœˆï¼Œä»Šå¹´å€’æ˜¯é›·å£°å°é›¨æ›´å°äº†ã€‚\næˆ‘è‡ªå·±çš„æ¶ˆè´¹æ”¯å‡ºæ˜¯0ã€‚\nè¿™å‡ å¹´pddçš„ç™¾äº¿è¡¥è´´è·‘å‡ºåå¤´ä¹‹åï¼Œ\nå¥½åƒæ¶ˆæ¯ä¹Ÿä¸å¤šäº†ã€‚\nä½œä¸ºç»å†äº†äº’è”ç½‘äº§å“â€œæ’’é’±æ—¶ä»£â€çš„äººï¼Œä¸Šé¢è¿™äº›äº‹ç‰©å€’çœŸè§æƒ¯ä¸æ€ªäº†ã€‚\nå›æƒ³ä¸‹\n","date":"2025-11-15T23:36:00Z","image":"https://liguobao.github.io/zh/p/internet-history-part2/logo_hu_7eebd6ecfe307200.png","permalink":"https://liguobao.github.io/zh/p/internet-history-part2/","title":"ã€Šå½“æˆ‘ä»¬è°ˆè®ºAIæ—¶ã€‹- ä»äº’è”ç½‘â€œæ’’é’±â€æ—¶ä»£èµ°æ¥"},{"content":"æ‰‹æœºå¾€äº‹ è¿œåœ¨2009å¹´ï¼Œé‚£æ—¶å€™è¯ºåŸºäºšå¦‚æ—¥ä¸­å¤©ï¼Œå¡ç­S40ã€S60ç³»ç»Ÿä¸å¯ä¸€ä¸–ã€‚\nç„¶è€Œå®åœ¨æ˜¯å¤ªè´µäº†ï¼ŒåŠ¨åˆ™å‡ åƒçš„æ‰‹æœºï¼Œ\né«˜ä¸­çš„æˆ‘æ˜¯æ²¡æœ‰è¿™æ ·çš„è´­ä¹°åŠ›çš„ã€‚\nåªèƒ½æœ›æ´‹å…´å¹ã€‚\nå·²ç»å­¦ä¼šä¸Šç½‘æ‰¾èµ„æ–™çš„é«˜ä¸­ç”Ÿï¼Œ\nçœ‹äº†ä¸€åœˆä¹‹åï¼Œæœ€åé€‰æ‹©äº†ä¸€ä¸ªâ€œç¥å¥‡å±±å¯¨æœºâ€ï¼š\nåå¼ºåŒ—ä»¿å¤šæ™®è¾¾ Windows Mobile 6.5ã€‚\nå½“æ—¶æ— æ¯”å…ˆè¿›çš„â€œæ™ºèƒ½æ‰‹æœºâ€ã€‚\nèƒ½è¿WiFiï¼Œèƒ½è£…UCæµè§ˆå™¨ èƒ½å†™Wordã€PPTã€æ’­è§†é¢‘ èƒ½å®‰è£…JAVAæ¨¡æ‹Ÿå™¨è·‘S40ç¨‹åº èƒ½æ‹ç…§èƒ½æ‰“è§†é¢‘ç”µè¯ ç”šè‡³è¿˜æœ‰æ‰‹å†™ç¬” -\u0026gt; ç”µæ„Ÿè§¦æ‘¸å± æ‰€æœ‰çš„ä¸€åˆ‡ï¼Œåªéœ€è¦å¤§æ¦‚å…«ç™¾å—ã€‚\næ˜¯ä»æ·˜å®ä¸Šä¹°çš„ï¼Œç”¨ATMè½¬è´¦ä»˜çš„é’±ã€‚\nä»˜äº†é’±ä¹‹åè¿˜å¿å¿‘ä¸å®‰å¾ˆä¹…ï¼Œä½†æ˜¯æ˜¯è¢«éª—äº†æ€ä¹ˆåŠã€‚\nä¸è¿‡æ‹…å¿ƒçš„äº‹æƒ…å¹¶æ²¡æœ‰å‘ç°ï¼Œè¿‡ä¸€ä¼šåº—å®¶è¯´åˆ°è´¦äº†ï¼Œä¸‹åˆå°±å‘å‡ºã€‚\nä¸€å‘¨å·¦å³å°±æ‹¿åˆ°äº†æ‰‹æœºäº†ã€‚\nå¾ˆæ˜¯â€œå®Œç¾â€çš„æ‰‹æœºï¼Œéšæ—¶éšåœ°çš„ä¸Šç½‘å†²æµªã€‚\nå”¯ä¸€çš„é—®é¢˜åªæ˜¯ï¼Œæµé‡å®åœ¨ä¸å¤ªç”¨å¾—èµ·ï¼Œ\nä¸ä¸Šç½‘çš„æ—¶å€™ä»æ¥ä¸æ•¢æ‰“å¼€æµé‡å¼€å…³ï¼Œ\nä¸€ä¸ªæœˆ30Mçš„æµé‡ä»æ¥éƒ½æ˜¯çœç€èŠ±çš„ã€‚\nQQå·²ç»æ˜¯å¾ˆæµè¡Œçš„èŠå¤©ç¤¾äº¤è½¯ä»¶ï¼Œ\nåªæ˜¯èŠå¤©çš„æ—¶å€™ï¼Œè¿˜æ˜¯è¦çœ‹äººå®¶åœ¨ä¸åœ¨çº¿ã€‚\nä¹Ÿå·®ä¸å¤šåœ¨é‚£ä¸ªæ—¶å€™æ³¨å†Œäº†Googleè´¦å·å’Œå¾®è½¯è´¦å·ï¼Œ\nè‹±è¯­æ°´å¹³å®åœ¨ä¸è¡Œï¼Œç”¨æˆ·åç”¨çš„éƒ½æ˜¯æ‹¼éŸ³+QQå·ç ï¼Œ\nä¹Ÿç®—æ˜¯æ—¶ä»£å°è®°äº†ã€‚\nå½“æ—¶Google è¿˜æ²¡é€€å‡ºä¸­å›½ï¼Œæ‰‹æœºä¸Šè¿˜èƒ½è£…è°·æ­Œåœ°å›¾ï¼Œ\nèƒ½çœ‹è°·æ­Œå«æ˜Ÿåœ°å›¾æ‰¾è‡ªå·±å®¶é‡Œçš„å±‹é¡¶ï¼Œ\nç¬¬ä¸€æ¬¡çœ‹åˆ°ç†Ÿæ‚‰çš„ä¹¡é—´å°è·¯åœ¨æ‰‹æœºä¸Šå‡ºæ¥ï¼Œ\nå€’æ˜¯æƒŠå¥‡ä¸‡åˆ†ã€‚\næ²¡è¿‡ä¸€é˜µå­ï¼Œè¿˜èƒ½é‡åˆ°3Qå¤§æˆ˜ä¸»æˆ˜åœºã€‚\nç”µè„‘ä¸Šçš„QQå’Œ360æ‰“èµ·æ¥äº†ï¼ŒäºŒé€‰ä¸€çš„äº‹æƒ…å¤§å®¶éƒ½é€‰äº†QQï¼Œ\nåªæ˜¯å¥½åƒä¹Ÿæ²¡æŒç»­å‡ å¤©ï¼Œå¾ˆå¿«ä¹Ÿå°±å¹³æ¯ä¸‹å»äº†ã€‚\nå†ä¸€æ¬¡å»æŠ˜è…¾æ‰‹æœºçš„æ—¶å€™ï¼Œå·²ç»åˆ°äº†â€œä¸­åé…·æ´¾â€çš„æ—¶ä»£äº†ã€‚\næ¼«å¤©ä¹±é£çš„å®‰å“2.2å’Œåˆ·æœºæ—¶ä»£å¼€å§‹äº†ã€‚\nå½“å¹´æ˜¯æˆ‘å§æ¢æ‰‹æœºï¼Œä¹°äº†è”æƒ³çš„æŸä¸ªæ‰‹æœºä¹‹åï¼Œ\nå¸®å¥¹å€’è…¾é€šè®¯å½•å’Œå¤‡ä»½æ‰‹æœºï¼Œä»æ­¤å¼€å¯äº†è¿™ä¹ˆå¤šå¹´åˆ·æœºä¹‹æ—…ã€‚\nå†ä¸‹ä¸€æ¬¡èƒ½è‡ªå·±ä¹°æ‰‹æœºï¼Œå·²ç»æ˜¯é«˜ä¸­æ¯•ä¸šäº†ã€‚\nåˆ°å¸‚é‡Œé¢çš„äºŒæ‰‹å¸‚åœºæºœè¾¾ï¼Œå€’æ˜¯èƒ½çœ‹åˆ°ä¸€äº›ç¥å¥‡çš„æ´‹åƒåœ¾æ‰‹æœºã€‚\nå¦‚ï¼Œæ”¯æŒ3Gçš„å…¨çƒé¦–æ¬¾1GHzçš„ åŒæ ¸LGæ‰‹æœºï¼Œå¸¦ä¸ªå¤–ç½®å¤©çº¿èƒ½çœ‹ç”µè§†ã€‚\nç„¶åï¼ŒèŠ±äº†å…­ä¸ƒç™¾å—ä¹°äº†è¿™ç©æ„ï¼Œåˆ·ä¸Šäº†MIUIã€‚\né‚£æ—¶å€™å°±å¬è¯´è¿‡1999çš„å°ç±³æ‰‹æœºäº†ï¼Œ\nåªæ˜¯åœ¨åå…«çº¿åŸå¸‚çš„é«˜ä¸­ç”Ÿæ˜¯æŠ¢ä¸åˆ°çš„ã€‚\nç­‰åˆ°äº†å¤§å­¦ä¹‹åï¼Œç¬¬ä¸€æ¬¡åœ¨å®éªŒå®¤åšé¡¹ç›®èµšåˆ°é’±ä¹‹åï¼Œ\nä¹Ÿæ˜¯çœŸçš„æŠ¢åˆ°äº† å°ç±³2Sï¼Œå½“å¹´çš„æ€§èƒ½æ€ªå…½ã€‚\nä½¿ç”¨ä½“éªŒä¹Ÿæ˜¯æè‡´ï¼Œå‡ ä¸ªç”µæ± å¤‡ç€ç”¨ï¼Œ\nä»æ¥ä¸æ‹…å¿ƒç»­èˆªé—®é¢˜~\n","date":"2025-11-09T08:00:00Z","permalink":"https://liguobao.github.io/zh/p/internet-history/","title":"äº’è”ç½‘ç§‘æŠ€å¾€äº‹ â€”â€” ã€Šå½“æˆ‘ä»¬è°ˆè®ºAIæ—¶ã€‹"},{"content":"å…³äºå¯»å‘³é˜¿å©† å¯»å‘³é˜¿å©† BiteUp æ˜¯ä¸€ä¸ªæ•´ç† Up ä¸»ç¾é£Ÿæ¨èçš„å¯¼èˆªç«™ï¼Œ\nå¿«é€Ÿå®šä½è§†é¢‘é‡Œå‡ºç°çš„ç‰¹äº§ã€é›¶é£Ÿã€åº—é“ºå’Œå¥½ç‰©é“¾æ¥ã€‚\næ— è®ºæ˜¯ç§è‰æ¸…å•è¿˜æ˜¯åœ°æ–¹ç‰¹è‰²ï¼Œåªè¦è¢« Up ä¸»ä»‹ç»è¿‡ï¼Œ\næˆ‘ä»¬éƒ½ä¼šå°½é‡æŠŠä¿¡æ¯æ•´ç†é½å…¨ï¼Œæ–¹ä¾¿éšæ—¶å›çœ‹ã€‚\næˆ‘ä»¬åœ¨åšä»€ä¹ˆ æ¯å½“ Up ä¸»åˆ†äº«ä»¤äººå¿ƒåŠ¨çš„ç¾é£Ÿï¼Œæˆ‘ä»¬ä¼šæŠŠè¿™äº›å†…å®¹å½’æ¡£æˆç»“æ„åŒ–ã€æ˜“æ£€ç´¢çš„å¡ç‰‡ã€‚\né€šè¿‡ç®€å•çš„ç­›é€‰å’Œæœç´¢ï¼Œå¯ä»¥è¿…é€Ÿæ‰¾åˆ°è§†é¢‘åŸé“¾æ¥ã€è´­ä¹°æ¸ é“ä»¥åŠå¯¹åº”çš„æ¨èç†ç”±ï¼Œ\nè®©çµæ„Ÿå’Œä¸‹å•éƒ½ä¸å†è´¹åŠ›ã€‚\nå¦‚ä½•ä½¿ç”¨æœ¬ç«™ æµè§ˆç²¾é€‰åˆ—è¡¨ï¼Œå¿«é€Ÿå‘ç°æœ€æ–°æ•´ç†çš„æ¨èå†…å®¹ã€‚ è¿›å…¥è¯¦æƒ…é¡µï¼ŒæŸ¥çœ‹è§†é¢‘ã€è´­ä¹°é“¾æ¥ä»¥åŠç‰¹è‰²äº®ç‚¹ã€‚ æ ¹æ®åŸå¸‚ã€å“ç±»ç­‰ç»´åº¦è¿‡æ»¤ï¼Œæ‰¾åˆ°æœ€é€‚åˆè‡ªå·±çš„ç¾å‘³ã€‚ æ¬¢è¿ä¸€èµ·å»ºè®¾ å¦‚æœä½ ä¹Ÿæƒ³è´¡çŒ®å†…å®¹æˆ–æå‡ºå»ºè®®ï¼Œæ¬¢è¿å‰å¾€æˆ‘ä»¬çš„ GitHub ä»“åº“æäº¤ Issue æˆ– PRï¼Œ\nä¸€èµ·æŠŠå¯»å‘³é˜¿å©†æ‰“é€ æˆæ›´å¥½ç”¨çš„ç¾é£Ÿå¯¼èˆªç«™ã€‚\nç«‹å³æäº¤ Issue\n","date":"2025-10-28T10:00:00+08:00","image":"https://liguobao.github.io/zh/p/bite-up-website/cover_hu_4b74744daa6fd5f7.png","permalink":"https://liguobao.github.io/zh/p/bite-up-website/","title":"å¯»å‘³é˜¿å©†ï¼šè·Ÿç€ Up ä¸»åƒåƒå–å–~"},{"content":"å‰è¨€ æ‰€æœ‰åˆ·æœºçš„å‰æéƒ½æ˜¯ï¼Œè§£é”Bootloaderã€‚\nåœ¨2025å¹´çš„ä»Šå¤©ï¼Œå›½å†…å¤§å¤šæ•°æ‰‹æœºå‚å•†å·²ç»ä¸é‚£ä¹ˆæ”¯æŒè§£é”Bootloaderäº†ã€‚\nä¸è¿‡ä¹Ÿæ²¡æœ‰å®Œå…¨æ‘æ­»ï¼Œæ‰€ä»¥ç®€å•åˆ—ä¸¾ä¸€ä¸‹å·²çŸ¥çš„è§£é”æ–¹æ³•ã€‚\nä¸€åŠ æ‰‹æœº OnePlus ä¸€åŠ æ‰‹æœºçš„Bootloaderè§£é”ç›¸å¯¹ç®€å•ï¼Œå¼€å‘è€…æ¨¡å¼ä¸‹ï¼Œ\nç›´æ¥æ‰“å¼€â€œå…è®¸OEMè§£é”â€é€‰é¡¹ï¼Œç„¶åä½¿ç”¨Fastbootå‘½ä»¤è§£é”å³å¯ã€‚\n1 2 fastboot oem unlock çŸ­æœŸå†…ï¼Œè¿˜æ²¡çœ‹åˆ°å®˜æ–¹æ”¿ç­–å˜åŒ–ï¼Œæ‰€ä»¥ä¸€åŠ æ‰‹æœºä¾ç„¶æ˜¯åˆ·æœºçˆ±å¥½è€…çš„é¦–é€‰ã€‚\nrealme ç³»åˆ— realme çš„Bootloader å«ï¼š æ·±åº¦æµ‹è¯•æ¨¡å¼ã€‚\nåœ¨realme å®˜æ–¹è®ºå›ï¼Œæ³¨å†Œä¸€ä¸‹è´¦å·ï¼Œæœç´¢ä¸€ä¸‹â€œæ·±åº¦æµ‹è¯•â€ï¼Œ\næ‰¾åˆ°é‚£ä¸ªå¸–å­ä¸‹è½½ä¸€ä¸ªApkï¼Œå®‰è£…åˆ°æ‰‹æœºä¸Šï¼Œæ‰“å¼€å®ƒï¼Œç„¶åæŒ‰ç…§æç¤ºæ“ä½œå³å¯ã€‚\nç„¶åå¤§æ¦‚ç­‰å¾…ä¸€å‘¨å·¦å³å®¡æ ¸ï¼Œâ€œæ·±åº¦æµ‹è¯•â€ appçœ‹åˆ°å®¡æ ¸çŠ¶æ€ä¸ºå·²é€šè¿‡ã€‚\nè¿™ä¸ªæ—¶å€™åœ¨Appé‡Œé¢è¿›å…¥æ·±åº¦æµ‹è¯•æ¨¡å¼ï¼Œè‡ªåŠ¨é‡å¯æ‰‹æœºåˆ° fastboot unlock é¡µé¢ï¼Œ\næŒ‰ç€æ“ä½œè§£é”ä¸€ä¸‹bootloader å³å¯ã€‚\nå°ç±³æ‰‹æœº Xiaomi PSï¼šå™©æ¢¦çº§åˆ«è§£é”ã€‚\næœ‰å®˜æ–¹è§£é”å·¥å…·ï¼Œèµ°è´¦æˆ·ç”³è¯·è§£é”ã€‚\nä½†æ˜¯ï¼š\nä»€ä¹ˆç¤¾åŒºç­‰çº§5çº§ï¼Œæ¯åŠå¹´åªèƒ½è§£é”ä¸€æ¬¡ï¼Œè§£é”ç­‰å¾…æ—¶é—´é•¿è¾¾14å¤©ä»¥ä¸Šã€‚\nï¼ˆ å’¸é±¼æœ‰ç»•è¿‡è´¦å·ç™»å½•çš„ï¼Œä½†æ˜¯ç»•è¿‡ä¹‹åè¿˜å¾—ç­‰14å¤©ã€‚ï¼‰\n2025å¹´çš„ä»Šå¤©ï¼Œå»ºè®®æ— éå¿…è¦ï¼Œæ²¡å¿…è¦æŠ˜è…¾å°ç±³æ‰‹æœºè§£é”äº†ã€‚\nå½“ç„¶ï¼Œèƒ½ä¹°åˆ°å·²ç»è§£é”è¿‡çš„äºŒæ‰‹æ‰‹æœºï¼Œå¯ä»¥ç›´æ¥ç©ã€‚\nå…¶ä»–æ‰‹æœº oem å¼€å¯ä¹‹åï¼Œç†è®ºä¸Šæ˜¯å¯ä»¥ä½¿ç”¨ fastboot oem unlock è§£é”çš„ã€‚\næå– boot.img åˆ·é¢å…·ä¹‹ç±»çš„å‰æï¼Œæ˜¯è¦æœ‰ boot.img æ–‡ä»¶ã€‚\nboot.img æ–‡ä»¶ï¼Œä¸€èˆ¬æœ‰ä¸¤ç§æ–¹å¼è·å–ï¼š\nä»åˆ·æœºåŒ…æå–\nä»è¿è¡Œçš„ Android ç³»ç»Ÿæå–\nä»åˆ·æœºåŒ…æå– boot.img å¦‚æœæœ‰åˆ·æœºåŒ…çš„è¯ï¼Œç›´æ¥ä»åˆ·æœºåŒ…playload.binæå– boot.img æ–‡ä»¶å³å¯ã€‚\nä¸€èˆ¬ç”¨FastbootEnhanceå®Œäº‹ï¼Œå›¾å½¢ç•Œé¢ç‚¹ç‚¹ç‚¹å°±ææ‚ã€‚\nåœ¨macOSæˆ–Linuxä¸‹ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ payload_dumper_go å·¥å…·æå–ã€‚\npayload_dumper_go 1 2 # https://github.com/xishang0128/payload-dumper-go/releases ./payload_dumper_go -i \u0026lt;åˆ·æœºåŒ…è·¯å¾„\u0026gt; -o \u0026lt;è¾“å‡ºç›®å½•\u0026gt; å¦‚æœæ˜¯çº¿åˆ·åŒ…ï¼Œç›´æ¥è§£å‹zipåŒ…ï¼Œå¤§æ¦‚ä¹Ÿèƒ½çœ‹åˆ°boot.img æ–‡ä»¶ã€‚\nä»è¿è¡Œçš„ Android ç³»ç»Ÿæå– boot.img å¾ˆå¤šæ—¶å€™æˆ‘ä»¬å¯èƒ½å¹¶æ²¡æœ‰åˆ·æœºåŒ…ï¼Œæˆ–è€…åˆ·æœºåŒ…åŠ¨åˆ™å‡ ä¸ªGBï¼Œä¸‹è½½èµ·æ¥å¾ˆéº»çƒ¦ã€‚\nè¿™ä¸ªæ—¶å€™å¯ä»¥å°è¯•ä½¿ç”¨ dsu-sideloader + system-squeak-arm64-ab-vanilla.img\nè¿›å…¥åˆ°ä¾§è½½ç³»ç»Ÿæ¨¡å¼ï¼Œä½¿ç”¨adb shell æå–boot.img.\nDSU-Sideloader dsu-sideloader æ˜¯ Android ç³»ç»Ÿä¸­ç”¨äº**åŠ¨æ€ç³»ç»Ÿæ›´æ–°ï¼ˆDSU, Dynamic System Updatesï¼‰**æœºåˆ¶çš„ä¸€ä¸ªå·¥å…·æˆ–æœåŠ¡ç»„ä»¶ï¼Œå®ƒå…è®¸ç”¨æˆ·åœ¨ä¸å½±å“å½“å‰ç³»ç»Ÿçš„å‰æä¸‹ï¼Œä¸´æ—¶åŠ è½½å¹¶è¿è¡Œä¸€ä¸ªæ›¿ä»£æ€§çš„ç³»ç»Ÿé•œåƒã€‚è¿™æ˜¯å¼€å‘è€…è°ƒè¯•æˆ–æµ‹è¯• GSIï¼ˆé€šç”¨ç³»ç»Ÿæ˜ åƒï¼‰çš„ä¸€ç§å®˜æ–¹æœºåˆ¶ã€‚\nsystem-squeak-arm32_binder64-ab-vanilla.img.xz Scripts to automatically build/CI/Release TrebleDroid GSI\nå®‰è£…å¥½ä¸Šçš„dsu + system-squeak-arm64-ab-vanilla.img åï¼Œè¿›å…¥åˆ°ä¾§è½½ç³»ç»Ÿæ¨¡å¼ã€‚\nåœ¨shell ä¸­æ‰§è¡Œï¼Œè¿›å…¥systemå®‰è£…ç¯å¢ƒã€‚\n1 # æå–boot.img è„šæœ¬å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 #!/bin/bash set -e # è·å–å½“å‰ slot slot=$(adb shell getprop ro.boot.slot_suffix | tr -d \u0026#39;\\r\u0026#39;) if [[ -z \u0026#34;$slot\u0026#34; ]]; then echo \u0026#34;âŒ æ— æ³•è·å– slot_suffix\u0026#34; exit 1 fi echo \u0026#34;ğŸ” å½“å‰å¯åŠ¨ slot: $slot\u0026#34; # è·å– boot åˆ†åŒºçœŸå®è·¯å¾„ï¼ˆä½¿ç”¨ adb shell su è¿›å…¥ root å† ls -lï¼‰ boot_dev=$(adb shell \u0026lt;\u0026lt;EOF su ls -l /dev/block/by-name/boot$slot | awk \u0026#39;{print \\$NF}\u0026#39; exit EOF ) boot_dev=$(echo \u0026#34;$boot_dev\u0026#34; | tr -d \u0026#39;\\r\u0026#39; | tail -n 1) if [[ -z \u0026#34;$boot_dev\u0026#34; ]]; then echo \u0026#34;âŒ æ— æ³•è§£æ boot$slot åˆ†åŒºè·¯å¾„\u0026#34; exit 1 fi echo \u0026#34;ğŸ“ è§£æåˆ° boot$slot çœŸå®è·¯å¾„: $boot_dev\u0026#34; # æ‰§è¡Œ dd æå– boot.img adb shell \u0026lt;\u0026lt;EOF su dd if=$boot_dev of=/sdcard/boot.img exit EOF # æ‹‰å–åˆ°æœ¬åœ° echo \u0026#34;ğŸ“¥ æ­£åœ¨æ‹‰å– boot.img åˆ°æœ¬åœ°...\u0026#34; adb pull /sdcard/boot.img echo \u0026#34;âœ… æå–å®Œæˆï¼boot.img å·²ä¿å­˜åˆ°å½“å‰ç›®å½•ã€‚\u0026#34; å¦‚æœä¸Šé¢çš„å‘½ä»¤ä¸å¯ç”¨ï¼Œè¿˜æ˜¯ç›´æ¥adb shell åˆ°ä¾§è½½ç³»ç»Ÿé‡Œé¢ï¼Œæ‰‹åŠ¨æ‰§è¡Œä¸Šé¢çš„å‘½ä»¤ä¹Ÿå¯ä»¥ã€‚\næ‰‹åŠ¨æ‰¾åˆ° boot åˆ†åŒºè·¯å¾„ï¼Œç„¶åä½¿ç”¨ dd æå–å³å¯ã€‚\nç»“è¯­ æå–åˆ° boot.img ä¹‹åï¼Œå°±å¯ä»¥ç»§ç»­åç»­çš„é¢å…·å®‰è£…æ­¥éª¤äº†ã€‚\nç¥åˆ·æœºæ„‰å¿«ï¼\n","date":"2025-10-20T08:00:00Z","image":"https://liguobao.github.io/zh/p/android-magisk-install-guide-part-1-unlock-bootloader/logo_hu_4faf4a02431817ba.png","permalink":"https://liguobao.github.io/zh/p/android-magisk-install-guide-part-1-unlock-bootloader/","title":"Magisk é¢å…·å®‰è£…æ‰‹æŠŠæ‰‹æ•™ç¨‹ä¹‹ä¸€ï¼šè§£é”Bootloader + æå–boot.img"},{"content":"åœ¨è¿›è¡Œç½‘ç»œçˆ¬è™«ã€æ•°æ®é‡‡é›†ç­‰ä»»åŠ¡æ—¶ï¼Œä½¿ç”¨IPä»£ç†æ± å¯ä»¥æœ‰æ•ˆåœ°éšè—çœŸå®IPï¼Œé¿å…è¢«ç›®æ ‡ç½‘ç«™å°ç¦ã€‚\næœ¬æ–‡å°†ä»‹ç»å¦‚ä½•æ­å»ºä¸€ä¸ªç®€å•çš„IPä»£ç†æ± ã€‚\n1. å‡†å¤‡å·¥ä½œ åœ¨å¼€å§‹ä¹‹å‰ï¼Œç¡®ä¿ä½ æœ‰ä¸€å°æ‹¨å·VPSï¼ˆè™šæ‹Ÿä¸“ç”¨æœåŠ¡å™¨ï¼‰ã€‚\næ‹¨å·VPSçš„ä»·æ ¼åŸºæœ¬æ˜¯å‡ åå—åˆ°ç™¾æ¥å—ä¸ç­‰ï¼Œå¯é€‰çš„ç³»ç»Ÿæ˜¯Windows Or Linuxã€‚\nVPS æœåŠ¡å•†äº¤ä»˜ä¹‹å‰åŸºæœ¬ä¼šå¸®ä½ é…ç½®å¥½æ‹¨å·ç¯å¢ƒï¼Œç®€å•ä½¿ç”¨pppoe å‘½ä»¤å³å¯é‡æ’­ã€‚\n2. æ­å»ºä»£ç†æœåŠ¡å™¨ ä¸€èˆ¬ä¸ä¼šç›´æ¥åœ¨VPSä¸Šæš´éœ²ä»£ç†æœåŠ¡ï¼Œå› ä¸ºè¿™ç©æ„åŸºæœ¬æ˜¯ä¸ç»™ä½ å…¬ç½‘IPçš„ã€‚\näºæ˜¯ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªä»£ç†æœåŠ¡å™¨æ¥ä¸­è½¬æµé‡ã€‚\nä¸æ­¤åŒæ—¶ï¼Œéœ€è¦ä¸€å¥—â€œä»£ç†æœåŠ¡å™¨è½¯ä»¶â€å¯¹å†…è¿æ¥æ‹¨å·VPSï¼Œå¯¹å¤–æä¾›ä»£ç†æœåŠ¡ã€‚\nè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨çš„ majora3 proxy server ç”¨æ¥æ­å»ºæˆ‘ä»¬çš„ä»£ç†æœåŠ¡å™¨ã€‚\nMajora æ˜¯ä¸€å¥—å®Œæ•´çš„ä»£ç† ip å»ºè®¾é›†ç¾¤æ–¹æ¡ˆï¼Œä¸ºä»£ç† IP æ± ä¾›åº”é“¾ç³»ç»Ÿï¼Œ\nå¦‚æœæ‚¨æ‹¥æœ‰å¤§æ‰¹é‡çš„å¯ä»¥ä¸Šç½‘çš„ç½‘ç»œè®¾å¤‡ï¼ˆVPS æœåŠ¡å™¨ã€è·¯ç”±å™¨è®¾å¤‡ã€æ‰‹æœºç­‰ç§»åŠ¨è®¾å¤‡ï¼‰ï¼Œ\né‚£ä¹ˆä½ å¯ä»¥ä½¿ç”¨è¿™äº›ç½‘ç»œè®¾å¤‡æ–¹ä¾¿çš„æ„å»ºæ‚¨çš„ä»£ç† IP æ± ã€‚\nMajora å¯ä»¥æ»¡è¶³çš„åº”ç”¨åœºæ™¯å¦‚ä¸‹ï¼š\næ‚¨æ˜¯ä»£ç† ip ä¾›åº”å•†ï¼Œæ‹¥æœ‰å¤§é‡ VPS èŠ‚ç‚¹ï¼Œåˆ™ä½ å¯ä»¥é€šè¿‡ Majora å¿«é€Ÿæ­å»ºæ‚¨çš„ä»£ç† IP æ±  æ‚¨å¯ä»¥å°† Majora ç»ˆç«¯ç¨‹åºåˆ·å…¥åˆ°è·¯ç”±å™¨ç­‰ç½‘ç»œè®¾å¤‡ä¸­ï¼Œåˆ™æ‚¨å¯ä»¥é€šè¿‡ Majora æ„å»ºæ‚¨çš„å®¶åº­ ip èµ„æºæ± æˆ–è€… ADSL IP èµ„æºæ±  æ‚¨å¯ä»¥å®‰è£… Majora çš„ apkï¼Œæˆ–è€…ä½¿ç”¨ Majora çš„ sdk é›†æˆåˆ°æ‰‹æœºç¨‹åºä¸­ï¼Œåˆ™æ‚¨å¯ä»¥é€šè¿‡ Majora å¿«é€Ÿæ­å»ºæ‚¨çš„æ‰‹æœºå‡ºå£ IP èµ„æºæ± (å¦‚æœæ‚¨çš„æ‰‹æœºæœ‰ rootï¼Œé‚£ä¹ˆè¿˜å¯ä»¥æ‹¥æœ‰å®šæ—¶é‡æ’­çš„åŠŸèƒ½) Majora åŠŸèƒ½ç‰¹ç‚¹ ä½¿ç”¨ç®€å•ï¼šæ‰€æœ‰ç»ˆç«¯èŠ‚ç‚¹éƒ½æ˜¯ä¸€é”®å®‰è£…å³å¯æ¥å…¥ä»£ç† ip é›†ç¾¤ï¼Œæ— éœ€æœåŠ¡å™¨å¤æ‚çš„å‚æ•°é…ç½® å¤šä¾›åº”å•†å’Œé‡‡è´­å•†æ¦‚å¿µï¼šæ‚¨å¯ä»¥è®©å¤šä¸ªæŒæœ‰ç½‘ç»œè®¾å¤‡çš„ä¾›åº”å•†åŒæ—¶æ¥å…¥ Majora ç³»ç»Ÿï¼ŒåŒæ—¶å¯ä»¥è®©å¤šä¸ª ip ä½¿ç”¨æ–¹æ¥å…¥ Majora çš„ IP èµ„æºã€‚Majora è®°å½•äº†æ¯ä¸ªä¾›åº”è€…å’Œæ¶ˆè´¹è€…çš„è¯¦ç»†è´¦å•æµæ°´ï¼Œæ‚¨å¯ä»¥æ ¹æ®æµæ°´å¯¹ä¾›åº”å•†å’Œé‡‡è´­å•†è¿›è¡Œè´¹ç”¨ç»“ç®— åè®®å®Œæ•´ï¼šæœ¬ç³»ç»Ÿå®Œæ•´æ”¯æŒ http/https/socks5 ä»£ç†åè®®ï¼Œæ‰€æœ‰ä»£ç†ç«¯å£å‡è‡ªåŠ¨è¯†åˆ«ä»£ç†åè®®ã€‚æ— éœ€ç”¨æˆ·æ‰‹åŠ¨é€‰æ‹©ç«¯å£ ip è´¨é‡å¯é æ€§ï¼šMajora æš´éœ²ç«¯å£èŒƒå›´ï¼Œä»¥éš§é“ä»£ç†çš„æ–¹å¼æä¾›æœåŠ¡ã€‚å¹¶æä¾›å†…å­˜çº§åˆ«çš„ IP èµ„æºå¤±è´¥è·¯ç”±åŠŸèƒ½ã€‚é™¤æå°‘æƒ…å†µï¼ˆè¢«ä¸­æ–­è¯·æ±‚ä¸­çš„é“¾æ¥ï¼‰ï¼ŒMajora ä¿è¯ä¾›åº”ç«¯æ¯ä¸ªä»£ç†ç«¯å£å‡å¯æä¾›å¯¹ç­‰çš„ç¨³å®šä»£ç†æœåŠ¡ã€‚æ°¸è¿œä¸ä¼šå‡ºç°ä»£ç†é“¾æ¥ä¸ä¸Šï¼Œæˆ–è€…è¿æ¥ä¸Šæ— æ³•ä½¿ç”¨çš„æƒ…å†µ å¤šç½‘ç»œè®¾å¤‡æ”¯æŒï¼šæ”¯æŒæœåŠ¡å™¨ï¼ˆVPS)ã€æ‰‹æœºã€è·¯ç”±å™¨ã€PC(æ™®é€š windows æˆ–è€… mac ç”µè„‘) é«˜å¹¶å‘å’Œé«˜å¸¦å®½ï¼šNIO æ¡†æ¶å¤©ç„¶æ”¯æŒéå¸¸é«˜çš„ååï¼Œä¸” Majora çš„å‰åºç³»ç»Ÿ(Rogue)å·²ç»ç»è¿‡å•èŠ‚ç‚¹ç™¾M çš„å¸¦å®½å‹åŠ› majora3 server å®‰è£… docker æ–¹å¼å®‰è£… 1 2 3 4 5 6 7 8 9 10 # å®‰è£…docker yum install -y docker # ä¸‹è½½é•œåƒ: docker pull registry.cn-beijing.aliyuncs.com/iinti/majora3:all-in-one # å¯åŠ¨majoraæœåŠ¡å™¨ docker run -d --network host -v ~/majora3-mysql-data:/var/lib/mysql registry.cn-beijing.aliyuncs.com/iinti/majora3:all-in-one ## all-in-oneé•œåƒåŒ…å«äº†majora3 serverå’Œmysqlæ•°æ®åº“ï¼Œæ•°æ®ä¿å­˜åœ¨å®¿ä¸»æœºçš„~/majora3-mysql-dataç›®å½•ä¸‹ æµ‹è¯•æ˜¯å¦éƒ¨ç½²æˆåŠŸ 1 curl http://127.0.0.1:6879/ è®¿é—®ç½‘ç«™ï¼š http://ä½ çš„IP:WebæœåŠ¡ç«¯å£ å¦‚(http://127.0.0.1:6879/)[http://127.0.0.1:6879/],\né¦–æ¬¡æ‰“å¼€ç½‘ç«™è¯·æ³¨å†Œè´¦æˆ·ï¼Œç¬¬ä¸€ä¸ªæ³¨å†Œè´¦æˆ·å°†ä¼šæˆä¸ºç®¡ç†å‘˜,\næ³¨å†Œå®Œæˆåè®°å¾—è®¾ç½®â€ä»£ç†é‰´æƒè´¦å·å¯†ç â€œ, å¦‚ admin/admin\nè‹¥æˆåŠŸæ‰“å¼€ç½‘ç«™ï¼Œå®Œæˆè´¦æˆ·æ³¨å†Œï¼Œåˆ™ä»£è¡¨éƒ¨ç½²å®Œæˆ\nç”Ÿäº§ç¯å¢ƒéƒ¨ç½² ç”Ÿäº§ç¯å¢ƒæ•°æ®ä¸€èˆ¬ä½¿ç”¨äº‘ç«¯RDSç­‰æ•°æ®åº“ï¼Œé¿å…å•ç‚¹æ•…éšœã€‚\nMajora ä½¿ç”¨ java å¼€å‘ï¼Œå¹¶ä¸”ä½¿ç”¨ mysql ä½œä¸ºæ•°æ®åº“,\nå¦‚æœä½ æƒ³æ‰‹åŠ¨éƒ¨ç½² Majoraï¼Œåˆ™éœ€è¦æ‰‹åŠ¨å®Œå…¨ java å’Œ mysql çš„å®‰è£…ï¼Œä¹‹åè¿›è¡Œç›¸å…³é…ç½®\nå®‰è£…å‡†å¤‡ ä¸‹è½½å®‰è£…åŒ… å®‰è£… jdk17 å®‰è£… mysqlï¼Œæˆ–è€…è´­ä¹° mysql æœåŠ¡ é…ç½®å’Œåˆå§‹åŒ– è§£å‹å®‰è£…åŒ… æ•°æ®åº“é…ç½®åˆå§‹åŒ–é…ç½®åœ¨:assets/ddl.sql,è¯·æ ¹æ®æœ¬ sql æ–‡ä»¶è¿›è¡Œæ•°æ®åº“å»ºè¡¨åˆå§‹åŒ–\nconf æ–‡ä»¶å¤¹çš„ç›¸å…³é…ç½®\né¡¹ç›®ä½¿ç”¨ springbootï¼Œå…¶ä¸­é¡¹ç›®å¯é€‰é…ç½®åœ¨ conf/application.propertiesï¼Œè¯·åœ¨è¿™é‡Œé…ç½®æ‚¨çš„æ•°æ®åº“é“¾æ¥ä¿¡æ¯ï¼ˆæ•°æ®åº“ä¸ºæ‚¨ä¸Šä¸€æ­¥å®Œæˆçš„ mysql å®‰è£…å’Œæ•°æ®åº“é…ç½®ï¼‰ conf/static/*ä¸ºå‰ç«¯èµ„æºï¼Œå¦‚æœä½ æƒ³æ›¿æ¢å‰ç«¯ç½‘é¡µçš®è‚¤ï¼Œåˆ™å¯ä»¥æ›¿æ¢è¿™é‡Œçš„å†…å®¹ majora å‰ç«¯æ˜¯å¼€æºçš„ï¼Œæ”¯æŒäºŒå¼€çš„ conf/static/majora-doc/*ä¸ºæ–‡æ¡£èµ„æºï¼Œå¦‚æœä½ æƒ³ä¿®æ”¹æ–‡æ¡£å†…å®¹ï¼Œåˆ™å¯ä»¥ç¼–è¾‘è¿™é‡Œ è¿è¡Œ æ‰§è¡Œbin/startup.sh (å¦‚æœæ˜¯ windowsï¼Œé‚£ä¹ˆæ‰§è¡Œ xxx.bat å³å¯)\nè§‚å¯Ÿæ—¥å¿—æ˜¯å¦æ­£å¸¸\n3. majora å®¢æˆ·ç«¯æ¥å…¥VPS ç™»å½•majora admin åå°åï¼Œåœ¨å³ä¾§èœå•ä¸­é€‰æ‹©â€œç»ˆç«¯ä¸‹è½½â€ï¼Œä¸‹è½½å¯¹åº”ç‰ˆæœ¬ç»ˆç«¯ã€‚\nç›®å‰æ”¯æŒçš„ç‰ˆæœ¬æœ‰ï¼š\nWindows ç‰ˆï¼ˆwindows_amd64_v3ï¼‰ Linux ç‰ˆï¼ˆlinux_amd64_v3ï¼‰ Android ç‰ˆï¼ˆandroid_allï¼‰ è·¯ç”±å™¨ç‰ˆï¼ˆlinux_mipsle_softfloatï¼‰ æ ¹æ®ä¸åŒçš„èŠ¯ç‰‡æ¶æ„ç‰ˆæœ¬é€‰æ‹©ä¸‹è½½å³å¯ã€‚\nä»¥ä¸‹æˆ‘ä»¬ä»¥Linuxç‰ˆæœ¬ä¸ºä¾‹ã€‚\nä¸‹è½½majora3_linux_amd64_v3.tar.gzåˆ°æœ¬åœ°ï¼Œè§£å‹ã€‚\nä¿®æ”¹ majora.toml é…ç½®æ–‡ä»¶ä¸­çš„ tunnel_addr åœ°å€ä¸ºä½ çš„ majora3 server åœ°å€ï¼Œ\nä¿®æ”¹ client_id ä¸ºä½ çš„ç»ˆç«¯å”¯ä¸€IDï¼ˆåœ¨ majora admin åå°çš„â€œç»ˆç«¯ç®¡ç†â€ä¸­å¯ä»¥çœ‹åˆ°ï¼‰\n1 2 3 4 5 6 7 8 9 10 11 12 13 group = \u0026#34;majora3\u0026#34; extra = \u0026#34;zone_de\u0026#34; client_id = \u0026#34;helloworld\u0026#34; tunnel_addr = \u0026#34;majora3.iinti.cn:6879\u0026#34; #tunnel_addr = \u0026#34;majora3.iinti.cn:6879\u0026#34; # trace/debug/info/error/fatal/disabled log_level = \u0026#34;info\u0026#34; [redial] # æ‰§è¡Œè„šæœ¬çš„shell bash/ash/cmd command = \u0026#34;bash\u0026#34; # è„šæœ¬å®Œæ•´è·¯å¾„ exec_path = \u0026#34;/root/majora3/ppp.sh\u0026#34; é‡æ‰“åŒ…æˆmajora3_linux_amd64_v3.tar.gz, ç„¶åä¸Šä¼ åˆ°ä½ çš„VPSä¸Šã€‚\nç›´æ¥ç™»å½•åˆ°VPSæµ‹ï¼Œè§£å‹åæ‰§è¡Œ systemd.sh, è‡ªåŠ¨å®‰è£…æˆ systemd æœåŠ¡\n1 2 3 tar zxvf majora3_linux_amd64_v3.tar.gz cd majora3_linux_amd64_v3 ./systemd.sh æ²¡é—®é¢˜çš„æƒ…å†µä¸‹ï¼Œmajora client ä¼šè¿æ¥åˆ° majora server, å¹¶ä¸”åœ¨â€œç»ˆç«¯ç®¡ç†â€ä¸­å¯ä»¥çœ‹åˆ°ä½ çš„ç»ˆç«¯ã€‚\nåŒæ—¶ï¼Œç¨‹åºä¼šè‡ªåŠ¨æ¥ç®¡è®¾å¤‡pppoeæ‹¨å·ï¼Œå®šæ—¶é‡æ‹¨ã€‚\n4. ä½¿ç”¨ä»£ç†IP å®Œæˆä»¥ä¸Šæ­¥éª¤åï¼Œä½ çš„ä»£ç†IPæ± å°±æ­å»ºå®Œæˆäº†ã€‚\nè¿™ä¸ªæ—¶å€™éœ€è¦åœ¨majora admin ä¸­å»ºç«‹IPæ± ï¼Œå¹¶å°†VPSè®¾å¤‡æ·»åŠ åˆ°æ± ä¸­ã€‚\nIPæ± åˆ—è¡¨\n-\u0026gt; åˆ›å»ºIPæ± \n-\u0026gt; é€‰æ‹©â€œIPæ± ç±»å‹â€ + è®¾å®šç«¯å£\n-\u0026gt; è®¾å¤‡åˆ—è¡¨\n-\u0026gt; æ·»åŠ è®¾å¤‡\n-\u0026gt; ä¿å­˜\nåˆ›å»ºå®Œæˆåï¼Œå¯ä»¥åœ¨â€œIPæ± åˆ—è¡¨â€ä¸­çœ‹åˆ°ä½ åˆ›å»ºçš„IPæ± ã€‚\nç„¶åä½¿ç”¨è®¾å®šçš„ç«¯å£è¿›è¡Œæµ‹è¯•ã€‚\n1 2 3 4 curl -x majora:majora3@majora3.iinti.cn:6879 https://www.baidu.com/ curl -x majora:majora3@majora3.iinti.cn:6879 https://myip.ipip.net ","date":"2025-09-17T08:00:00Z","image":"https://liguobao.github.io/zh/p/how-to-build-your-ip-proxy/logo_hu_dd28101035aa7aaf.png","permalink":"https://liguobao.github.io/zh/p/how-to-build-your-ip-proxy/","title":"å¦‚ä½•æ­å»ºä½ çš„IPä»£ç†æ± 2025ç‰ˆ"},{"content":"å‰é˜µå­åˆ·â€œä»€ä¹ˆå€¼å¾—ä¹°â€çš„æ—¶å€™çœ‹åˆ°ï¼Œ\nã€æµæµªåœ°çƒ2ã€‘è”åæ¬¾äº’è”ç½‘ä¸»æœºç§˜é’¥å……ç”µå®å¤§ç”©å–äº†ï¼Œ\nhttps://post.smzdm.com/p/aev3zw74/\nåŸä»·ä¸¤ä¸‰ç™¾çš„ç©æ„ï¼Œæœ‰æ•…éšœçš„å¤§æ¦‚å››äº”åå—å—ï¼Œèƒ½ç”¨çš„å¤§æ¦‚80-90ã€‚\n200å—ä¹°ä¸ªä¸Šä¸äº†é£æœºçš„å……ç”µå®æ˜¯ä¸ªå¤§èªæ˜ï¼Œ\n90å—ä¹°ä¸ªè”åæ‰‹åŠè¿˜è¦ä»€ä¹ˆè‡ªè¡Œè½¦å•Šã€‚\näºæ˜¯ï¼Œä¸‹å•æäº†ä¸€ä¸ªã€‚åˆ°æ‰‹äº†å¦‚ä¸‹ï¼š\nä¸€ä¸ªæ•°ç ç®¡çš„æ˜¾ç¤ºå±ï¼Œä¸‹é¢ä¸‰ä¸ªæŒ‰é’®å¯ä»¥æ§åˆ¶æ˜¾ç¤ºåŠŸèƒ½ã€‚\nç”šè‡³è¿˜èƒ½çœ‹åˆ°å……ç”µåŠŸç‡å’Œç”µé‡~\nèƒ½ç”¨ï¼Œå¾ˆé‡ï¼Œä¸é€‚åˆå‡ºé—¨ã€‚\nç¡®å®å°±æ˜¯ä¸ªæ‰‹åŠç©å…·ã€‚\nè¿‡äº†ä¸¤å¤©åˆæƒ³äº†ä¸‹ï¼Œè¦ä¸æ‹†äº†è¿™ç©æ„ï¼Œâ€˜\næŠŠæ˜¾ç¤ºå±æ¥åˆ°è‡ªå·±çš„è®¾å¤‡ä¸Šï¼Œ\nåœ¨è®¾å¤‡ä¸Šå†™ä¸ªæ”¯æŒ Authenticator 2FAçš„ç¨‹åºï¼Œ\nè®©å®ƒåšä¸ªçœŸæ­£çš„â€œäº’è”ç½‘ä¸»æœºç§˜é’¥â€è®¾å¤‡ï¼Ÿ\nè¯´å¹²å°±å¹²ã€‚\né¦–å…ˆå°±æ˜¯é€‰ä¸ªç¡¬ä»¶æ¿å­ï¼Œéœ€è¦å°ï¼ŒåŒæ—¶èƒ½é©±åŠ¨æ˜¾ç¤ºå±ã€‚\nçœ‹äº†ä¸€ä¸‹ï¼ŒESP32 å¾ˆåˆé€‚ï¼ŒIOå£å¤Ÿç”¨ï¼Œ\nèƒ½é©±åŠ¨å°æ˜¾ç¤ºå™¨ï¼Œèƒ½è¿æ¥WIFIï¼Œ\nä»·æ ¼ä¹Ÿä¾¿å®œ~\né€‰ä¸ªç¡¬ä»¶æ¿å­ -\u0026gt; ESP32C3 ä¸Šäº†æ·˜å®çœ‹äº†ä¸€åœˆï¼Œæœ€ç»ˆæ‰¾äº†ä¸€ä¸ªESP32C3çš„æ¿å­ã€‚\næ”¯æŒCå£ï¼Œç”µè„‘ç›´è¿å°±å®Œäº‹äº†ã€‚\nä»€ä¹ˆé©±åŠ¨éƒ½ä¸éœ€è¦ï¼Œç”šè‡³macOSä¹Ÿæ˜¯ç›´æ¥èƒ½ç”¨çš„~\nå¼€å‘æ¡†æ¶ -\u0026gt; micropython çœ‹äº†ä¸€åœˆå¼€å‘æ¡†æ¶ä¹‹åï¼Œå‘ç°è¿˜æ˜¯micropythonæ¯”è¾ƒç®€å•ã€‚\nboot.pyæ˜¯æ¡†æ¶è‡ªå¸¦çš„ï¼Œè‡ªå·±çš„é€»è¾‘å†™åœ¨main.pyï¼Œ\nIOå£å’Œç½‘ç»œéƒ½å†…éƒ¨è‡ªå¸¦ï¼Œéœ€è¦çš„é©±åŠ¨åŸºæœ¬éƒ½èƒ½æ‰¾åˆ°ç¬¬ä¸‰æ–¹åº“ã€‚\nä¸è¿‡ï¼Œéœ€è¦è‡ªå·±åˆ·ä¸ªå›ºä»¶ -\u0026gt; åœ¨ ESP32 ä¸Šå¼€å§‹ä½¿ç”¨ MicroPythonã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 # å®‰è£…esptoolå·¥å…· pip install esptool # æ“¦é™¤è®¾å¤‡ ## macOS or linux esptool.py --port /dev/ttyUSB0 erase_flash ## windows ä¸Š python esptool --port COM6 erase_flash # æŒ‰ä½booté”®ï¼Œæ‰§è¡Œåˆ·å…¥åˆ·å…¥å›ºä»¶ # ä¸‹è½½é“¾æ¥ï¼šhttps://micropython.org/download/ESP32_GENERIC_C3/ # å…¶ä»–çš„ç‰ˆæœ¬è‡ªå·±çœ‹ esptool.py --chip esp32 --port /dev/ttyUSB0 --baud 460800 write_flash -z 0x0000 micropython.bin ## Windowsç‰ˆæœ¬ python esptool --port COM6 --baud 460800 write_flash -z 0x0000 micropython.bin ## åˆ·å…¥æˆåŠŸä¹‹åï¼Œæ–­ç”µé‡å¯ åˆ·å…¥æˆåŠŸä¹‹åï¼Œæ–­ç”µé‡å¯ã€‚ éªŒè¯micropythonç¯å¢ƒ\næœ€ç®€å•çš„æ–¹æ¡ˆï¼ŒVS Code Pymark æ’ä»¶ï¼šPymakr - Visual Studio Marketplace\nè£…ä¸Šå»ä¹‹åï¼Œåœ¨å·¦ä¾§æ ç›®ï¼Œç‚¹å‡»ä¸€ä¸‹â€œ\nâ€å›¾æ ‡ï¼Œé€‰æ‹©â€œList Deviceâ€ã€‚\nå¦‚æœListDeviceæ²¡æœ‰å‡ºç°æˆ–è€…æŠ¥é”™äº†ï¼Œ\nå¯èƒ½éœ€è¦å†å®‰è£…ä¸€ä¸‹Nodejsè¿è¡Œç¯å¢ƒã€‚ï¼ˆWindowsä¸Šç¢°åˆ°è¿‡ï¼šchoco install nodejs å®Œäº‹ã€‚ï¼‰\nå†ç‚¹å‡»â€œè®¾å¤‡COMâ€ï¼Œé€‰æ‹©â€œè¿æ¥â€å›¾æ ‡ä¹‹åï¼Œåœ¨é€‰æ‹©â€œç»ˆç«¯â€å›¾æ ‡ã€‚\né€‰æ‹©ç»ˆç«¯å›¾æ ‡ä¹‹åï¼Œèƒ½çœ‹åˆ°è¿™ä¸ªå‘½ä»¤è¡Œç•Œé¢ï¼Œè¯´æ˜micropythonç¯å¢ƒå¥½äº†ã€‚\nå¦‚æœçœ‹åˆ°çš„æ˜¯æŠ¥é”™ï¼Œä¼°è®¡æ˜¯ä¸Šé¢çš„å›ºä»¶æ²¡æœ‰åˆ·å¥½ã€‚\né‡æ–°å°è¯•è¾“å…¥å›ºä»¶å³å¯ã€‚\nPSï¼šå¯èƒ½éœ€è¦åˆ‡æ¢\u0026ndash;baud 460800 è¾“å…¥ï¼Œå…·ä½“çš„çœ‹micropythonæ–‡æ¡£æˆ–è€…é—®ä¸‹AI\nesptool.py \u0026ndash;chip esp32 \u0026ndash;port /dev/ttyUSB0 \u0026ndash;baud 460800 write_flash -z 0x0000 micropython.bin\né€‰ä¸ªå±å¹• -\u0026gt; 2.25å¯¸é•¿æ¡å± é€‰å±å¹•æ˜¯ä¸ªå¤§éš¾é¢˜äº†ã€‚æ‰¾äº†ä¸€åœˆå¾ˆéš¾æ‰¾åˆ°è¿™ä¸ªè§„æ ¼çš„å±å¹•ã€‚\nè¿™ç©æ„æ˜¾ç¤ºåŒºåŸŸï¼š1.8CMé«˜ï¼Œ15CMå®½ï¼Œé•¿æ¡å½¢ã€‚\nåœ¨æ·˜å®ç¿»äº†ä¸€åœˆéƒ½æ²¡æ‰¾åˆ°ç±»ä¼¼çš„è§„æ ¼ã€‚\næœ€åé€€è€Œæ±‚æ¬¡ï¼š2.25å¯¸ TFTæ¶²æ™¶å±å¹•ã€‚\næ”¯æŒäº†ST7789ï¼ˆmicropythonæœ‰st7789.pyé©±åŠ¨)ã€‚\næ˜¾ç¤ºå±çš„8Pæ¥å£åˆ†è¡¨æ˜¯ï¼šGNDã€VCCã€SCLã€SDAã€RSTã€DCã€CSã€BLã€‚\nå¯¹ç€ESP32çš„å¼•è„šï¼Œå°±æ˜¯åœ¨å³ä¾§ä¸€ä¸ªä¸ªæ¥è¿›å»ã€‚\nESP32çš„å¼•è„šåˆ†åˆ«æ˜¯ï¼šGNDã€3.3Vã€GPIO02ã€GPIO03ã€GPIO02ã€GPIO10ã€GPIO06ã€GPIO07\nå¯¹åº”ä»£ç ï¼š\nä½ çš„æ¥çº¿: SCLã€SDAã€RSTã€DCã€CS -\u0026gt; GPI002ã€GPI003ã€GPI010ã€GPI006ã€GPI007 SCK_PIN = 2 # SCL å¼•è„š (æ—¶é’Ÿ) -\u0026gt; GPI002 MOSI_PIN = 3 # SDA å¼•è„š (æ•°æ®) -\u0026gt; GPI003\nRST_PIN = 10 # RST å¼•è„š (å¤ä½) -\u0026gt; GPI010 DC_PIN = 6 # DC å¼•è„š (æ•°æ®/å‘½ä»¤) -\u0026gt; GPI006 CS_PIN = 7 # CS å¼•è„š (ç‰‡é€‰) -\u0026gt; GPI007\n\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;-`\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026ndash; æœ€åå±å¹•çš„BEå£æ¥åˆ°å¦ä¸€ä¸ªGNDã€‚ï¼ˆè¿™é‡Œæˆ‘ä¹Ÿæ²¡å¼„æ‡‚ï¼Œæµ‹è¯•å‡ºæ¥çš„\nç„¶åå±å¹•å°±ç‚¹äº®äº†ã€‚\n\u0026ldquo;å¼€å§‹è¡¨æ¼”\u0026rdquo; ï¼šé¡¹ç›®ä»£ç  -rw-r\u0026ndash;r\u0026ndash; 1 liguobao staff 6.3K 7 30 11:05 http_server.py -rw-r\u0026ndash;r\u0026ndash; 1 liguobao staff 4.3K 7 30 11:05 main.py -rw-r\u0026ndash;r\u0026ndash; 1 liguobao staff 265B 7 20 13:53 pymakr.conf -rw-r\u0026ndash;r\u0026ndash; 1 liguobao staff 1.6K 7 30 11:05 show_text.py -rw-r\u0026ndash;r\u0026ndash;@ 1 liguobao staff 30K 7 22 15:19 st7789.py -rw-r\u0026ndash;r\u0026ndash;@ 1 liguobao staff 3.6K 7 22 15:19 vga1_8x8.py\nst7789å’Œvga1 éƒ½æ¥æºäºï¼š https://github.com/russhughes/st7789py_mpy/\nè¿æ¥WIFI + å®ç°HTTPæœåŠ¡ http_server.py\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 import network import time import socket #from show_text import display_text_on_tft # --- WiFi ç½‘ç»œé…ç½®åˆ—è¡¨ --- WIFI_NETWORKS = [ {\u0026#34;ssid\u0026#34;: \u0026#34;xiaomi_505\u0026#34;, \u0026#34;password\u0026#34;: \u0026#34;å¯†ç \u0026#34;}, {\u0026#34;ssid\u0026#34;: \u0026#34;miaowuwu_505\u0026#34;, \u0026#34;password\u0026#34;: \u0026#34;å¯†ç \u0026#34;} ] def connect_wifi(ssid, password): \u0026#34;\u0026#34;\u0026#34;è¿æ¥åˆ°æŒ‡å®šçš„ WiFi ç½‘ç»œ\u0026#34;\u0026#34;\u0026#34; wlan = network.WLAN(network.STA_IF) wlan.active(True) if not wlan.isconnected(): print(f\u0026#34;æ­£åœ¨è¿æ¥ WiFi: {ssid}\u0026#34;) wlan.connect(ssid, password) for _ in range(15): # æœ€å¤šç­‰å¾…15ç§’ if wlan.isconnected(): ip_address = wlan.ifconfig()[0] print(f\u0026#34;è¿æ¥æˆåŠŸï¼ŒIP åœ°å€: {ip_address}\u0026#34;) return ip_address time.sleep(1) print(f\u0026#34;WiFi è¿æ¥å¤±è´¥: {ssid}\u0026#34;) return None else: ip_address = wlan.ifconfig()[0] print(f\u0026#34;WiFi å·²è¿æ¥ï¼ŒIP åœ°å€: {ip_address}\u0026#34;) return ip_address def connect_to_available_wifi(): \u0026#34;\u0026#34;\u0026#34;å°è¯•è¿æ¥åˆ°å¯ç”¨çš„ WiFi ç½‘ç»œ\u0026#34;\u0026#34;\u0026#34; print(\u0026#34;å¼€å§‹æ‰«æå¹¶è¿æ¥å¯ç”¨çš„ WiFi ç½‘ç»œ...\u0026#34;) wlan = network.WLAN(network.STA_IF) wlan.active(True) # å¦‚æœå·²ç»è¿æ¥ï¼Œç›´æ¥è¿”å›IPåœ°å€ if wlan.isconnected(): ip_address = wlan.ifconfig()[0] print(f\u0026#34;WiFi å·²è¿æ¥ï¼ŒIP åœ°å€: {ip_address}\u0026#34;) return ip_address # æ‰«æå¯ç”¨çš„WiFiç½‘ç»œ print(\u0026#34;æ­£åœ¨æ‰«æWiFiç½‘ç»œ...\u0026#34;) networks = wlan.scan() available_ssids = [net[0].decode(\u0026#39;utf-8\u0026#39;) for net in networks] print(f\u0026#34;æ‰«æåˆ°çš„ç½‘ç»œ: {available_ssids}\u0026#34;) # å°è¯•è¿æ¥é…ç½®ä¸­çš„WiFiç½‘ç»œ for wifi_config in WIFI_NETWORKS: ssid = wifi_config[\u0026#34;ssid\u0026#34;] password = wifi_config[\u0026#34;password\u0026#34;] if ssid in available_ssids: print(f\u0026#34;æ‰¾åˆ°é…ç½®çš„ç½‘ç»œ: {ssid}ï¼Œå°è¯•è¿æ¥...\u0026#34;) ip_address = connect_wifi(ssid, password) if ip_address: return ip_address else: print(f\u0026#34;æœªæ‰¾åˆ°ç½‘ç»œ: {ssid}\u0026#34;) print(\u0026#34;æ— æ³•è¿æ¥åˆ°ä»»ä½•é…ç½®çš„WiFiç½‘ç»œ\u0026#34;) return None def url_decode(text): \u0026#34;\u0026#34;\u0026#34;ç®€å•çš„URLè§£ç \u0026#34;\u0026#34;\u0026#34; text = text.replace(\u0026#39;+\u0026#39;, \u0026#39; \u0026#39;) text = text.replace(\u0026#39;%20\u0026#39;, \u0026#39; \u0026#39;) text = text.replace(\u0026#39;%21\u0026#39;, \u0026#39;!\u0026#39;) text = text.replace(\u0026#39;%22\u0026#39;, \u0026#39;\u0026#34;\u0026#39;) text = text.replace(\u0026#39;%23\u0026#39;, \u0026#39;#\u0026#39;) text = text.replace(\u0026#39;%24\u0026#39;, \u0026#39;$\u0026#39;) text = text.replace(\u0026#39;%25\u0026#39;, \u0026#39;%\u0026#39;) text = text.replace(\u0026#39;%26\u0026#39;, \u0026#39;\u0026amp;\u0026#39;) text = text.replace(\u0026#39;%27\u0026#39;, \u0026#34;\u0026#39;\u0026#34;) text = text.replace(\u0026#39;%28\u0026#39;, \u0026#39;(\u0026#39;) text = text.replace(\u0026#39;%29\u0026#39;, \u0026#39;)\u0026#39;) text = text.replace(\u0026#39;%2A\u0026#39;, \u0026#39;*\u0026#39;) text = text.replace(\u0026#39;%2B\u0026#39;, \u0026#39;+\u0026#39;) text = text.replace(\u0026#39;%2C\u0026#39;, \u0026#39;,\u0026#39;) text = text.replace(\u0026#39;%2D\u0026#39;, \u0026#39;-\u0026#39;) text = text.replace(\u0026#39;%2E\u0026#39;, \u0026#39;.\u0026#39;) text = text.replace(\u0026#39;%2F\u0026#39;, \u0026#39;/\u0026#39;) return text def handle_request(tft, conn): \u0026#34;\u0026#34;\u0026#34;å¤„ç†HTTPè¯·æ±‚\u0026#34;\u0026#34;\u0026#34; try: request = conn.recv(1024).decode(\u0026#39;utf-8\u0026#39;) print(f\u0026#34;æ”¶åˆ°è¯·æ±‚:\\n{request}\u0026#34;) # è§£æè¯·æ±‚è¡Œ lines = request.split(\u0026#39;\\n\u0026#39;) if lines: request_line = lines[0] parts = request_line.split(\u0026#39; \u0026#39;) if len(parts) \u0026gt;= 2: method = parts[0] path = parts[1] print(f\u0026#34;æ–¹æ³•: {method}, è·¯å¾„: {path}\u0026#34;) if method == \u0026#39;GET\u0026#39;: # è§£ææŸ¥è¯¢å‚æ•° if \u0026#39;?\u0026#39; in path: path_part, query_part = path.split(\u0026#39;?\u0026#39;, 1) params = {} for param in query_part.split(\u0026#39;\u0026amp;\u0026#39;): if \u0026#39;=\u0026#39; in param: key, value = param.split(\u0026#39;=\u0026#39;, 1) params[key] = url_decode(value) # è·å–textå‚æ•° received_text = params.get(\u0026#39;text\u0026#39;, None) else: received_text = None if not received_text: response = \u0026#34;\u0026#34;\u0026#34;HTTP/1.1 400 Bad Request\\r Content-Type: text/plain\\r Connection: close\\r \\r Bad Request: \u0026#39;text\u0026#39; parameter is required\u0026#34;\u0026#34;\u0026#34; print(\u0026#34;è¯·æ±‚ä¸­ç¼ºå°‘\u0026#39;text\u0026#39;å‚æ•°\u0026#34;) conn.send(response.encode(\u0026#39;utf-8\u0026#39;)) conn.close() return print(f\u0026#34;ä» GET è¯·æ±‚ä¸­æå–çš„æ–‡æœ¬: \u0026#39;{received_text}\u0026#39;\u0026#34;) show_text = f\u0026#34;Received Text:\\n{received_text}\u0026#34; # æ˜¾ç¤ºå™¨ä»£ç  # display_text_on_tft(tft, show_text) # å‘é€æˆåŠŸå“åº” response = \u0026#34;\u0026#34;\u0026#34;HTTP/1.1 200 OK\\r Content-Type: text/plain\\r Connection: close\\r \\r Text received and displayed!\u0026#34;\u0026#34;\u0026#34; else: # æ–¹æ³•ä¸å…è®¸ response = \u0026#34;\u0026#34;\u0026#34;HTTP/1.1 405 Method Not Allowed\\r Content-Type: text/plain\\r Connection: close\\r \\r Method Not Allowed. Only GET is supported.\u0026#34;\u0026#34;\u0026#34; else: response = \u0026#34;\u0026#34;\u0026#34;HTTP/1.1 400 Bad Request\\r Content-Type: text/plain\\r Connection: close\\r \\r Bad Request\u0026#34;\u0026#34;\u0026#34; else: response = \u0026#34;\u0026#34;\u0026#34;HTTP/1.1 400 Bad Request\\r Content-Type: text/plain\\r Connection: close\\r \\r Bad Request\u0026#34;\u0026#34;\u0026#34; conn.send(response.encode(\u0026#39;utf-8\u0026#39;)) except Exception as e: print(f\u0026#34;å¤„ç†è¯·æ±‚æ—¶å‡ºé”™: {e}\u0026#34;) try: error_response = \u0026#34;\u0026#34;\u0026#34;HTTP/1.1 500 Internal Server Error\\r Content-Type: text/plain\\r Connection: close\\r \\r Internal Server Error\u0026#34;\u0026#34;\u0026#34; conn.send(error_response.encode(\u0026#39;utf-8\u0026#39;)) except: pass finally: conn.close() def start_http_server(tft, ip_address, port=80): \u0026#34;\u0026#34;\u0026#34;å¯åŠ¨HTTPæœåŠ¡å™¨\u0026#34;\u0026#34;\u0026#34; addr = socket.getaddrinfo(ip_address, port)[0][-1] s = socket.socket() s.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1) s.bind(addr) s.listen(1) print(f\u0026#39;HTTPæœåŠ¡å™¨å·²å¯åŠ¨ï¼Œç›‘å¬åœ°å€: http://{ip_address}:{port}\u0026#39;) display_text_on_tft(tft, f\u0026#34;HTTP Server\\nListening on {ip_address}:{port}\u0026#34;) while True: try: conn, addr = s.accept() print(f\u0026#39;å®¢æˆ·ç«¯è¿æ¥æ¥è‡ª: {addr}\u0026#39;) handle_request(tft, conn) except KeyboardInterrupt: print(\u0026#34;æœåŠ¡å™¨åœæ­¢\u0026#34;) break except Exception as e: print(f\u0026#34;æœåŠ¡å™¨é”™è¯¯: {e}\u0026#34;) s.close() ä¸»å‡½æ•° -\u0026gt; å±å¹•åˆå§‹åŒ– + é€‚é…é«˜åº¦ã€å®½åº¦ main.py 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 import network import time import socket from machine import Pin, SPI import vga1_8x8 as font import st7789 from show_text import display_text_on_tft from http_server import connect_to_available_wifi, handle_request, start_http_server # -------------------------- # --- ST7789 æ˜¾ç¤ºå±å¼•è„šå®šä¹‰ --- # ä½ çš„æ¥çº¿: SCLã€SDAã€RSTã€DCã€CS -\u0026gt; GPI002ã€GPI003ã€GPI010ã€GPI006ã€GPI007 SCK_PIN = 2 # SCL å¼•è„š (æ—¶é’Ÿ) -\u0026gt; GPI002 MOSI_PIN = 3 # SDA å¼•è„š (æ•°æ®) -\u0026gt; GPI003 RST_PIN = 10 # RST å¼•è„š (å¤ä½) -\u0026gt; GPI010 DC_PIN = 6 # DC å¼•è„š (æ•°æ®/å‘½ä»¤) -\u0026gt; GPI006 CS_PIN = 7 # CS å¼•è„š (ç‰‡é€‰) -\u0026gt; GPI007 # -------------`-------------- # åˆå§‹åŒ–TFTå¯¹è±¡ spi = SPI(1, baudrate=10000000, polarity=0, phase=0, sck=Pin(SCK_PIN), mosi=Pin(MOSI_PIN)) dc = Pin(DC_PIN, Pin.OUT) rst = Pin(RST_PIN, Pin.OUT) cs = Pin(CS_PIN, Pin.OUT) # ç¡®ä¿CSå¼•è„šåˆå§‹çŠ¶æ€ cs.value(1) time.sleep(0.01) # ç¡¬ä»¶å¤ä½åºåˆ— rst.value(1) time.sleep(0.01) rst.value(0) time.sleep(0.01) rst.value(1) time.sleep(0.12) # ç­‰å¾…å¤ä½å®Œæˆ def test_display_basic(): \u0026#34;\u0026#34;\u0026#34;åŸºç¡€æ˜¾ç¤ºæµ‹è¯•å‡½æ•°\u0026#34;\u0026#34;\u0026#34; print(\u0026#34;å¼€å§‹åŸºç¡€æ˜¾ç¤ºæµ‹è¯•...\u0026#34;) # æ‰‹åŠ¨å‘é€åŸºç¡€å‘½ä»¤æµ‹è¯• def send_command(cmd, data=None): cs.value(0) dc.value(0) # å‘½ä»¤æ¨¡å¼ spi.write(cmd) if data: dc.value(1) # æ•°æ®æ¨¡å¼ spi.write(data) cs.value(1) time.sleep(0.01) print(\u0026#34;å‘é€åŸºç¡€åˆå§‹åŒ–å‘½ä»¤...\u0026#34;) send_command(b\u0026#39;\\x01\u0026#39;) # è½¯ä»¶å¤ä½ time.sleep(0.15) send_command(b\u0026#39;\\x11\u0026#39;) # é€€å‡ºç¡çœ  time.sleep(0.12) send_command(b\u0026#39;\\x29\u0026#39;) # æ˜¾ç¤ºå¼€å¯ time.sleep(0.1) print(\u0026#34;åŸºç¡€æµ‹è¯•å®Œæˆ\u0026#34;) def init_st7789_display(st_width, st_height, rotation=1): \u0026#34;\u0026#34;\u0026#34;åˆå§‹åŒ– ST7789 æ˜¾ç¤ºå±\u0026#34;\u0026#34;\u0026#34; print(f\u0026#34;åˆå§‹åŒ– ST7789 æ˜¾ç¤ºå±: {st_width}x{st_height}, æ—‹è½¬: {rotation}\u0026#34;) tft = st7789.ST7789(spi, st_width, st_height, reset=rst, cs=cs, dc=dc, rotation=rotation) # rotation å¯¹åº” MADCTL çš„ x36 å¯„å­˜å™¨å€¼ rotation_to_x36 = { 0: 0x00, # é»˜è®¤ç«–å± 1: 0x60, # é¡ºæ—¶é’ˆ90åº¦ï¼Œæ¨ªå± 2: 0xC0, # 180åº¦æ—‹è½¬ 3: 0xA0, # é¡ºæ—¶é’ˆ270åº¦ } x36_value = rotation_to_x36.get(rotation, 0x00) print(f\u0026#34;å†…å­˜è®¿é—®æ§åˆ¶å€¼: {x36_value:#04x}\u0026#34;) # æ ¹æ® rotation é€‰æ‹©åˆ—åœ°å€å’Œè¡Œåœ°å€èŒƒå›´ if rotation % 2 == 0: col_start, col_end = 0, 75 # width - 1 row_start, row_end = 0, 283 # height - 1 else: col_start, col_end = 0, 283 row_start, row_end = 0, 75 init_commands = [ (b\u0026#39;\\x01\u0026#39;, None, 150), # è½¯ä»¶å¤ä½ (b\u0026#39;\\x11\u0026#39;, None, 120), # é€€å‡ºç¡çœ æ¨¡å¼ (b\u0026#39;\\x3A\u0026#39;, b\u0026#39;\\x05\u0026#39;, 10), # è®¾ç½®åƒç´ æ ¼å¼ RGB565 (b\u0026#39;\\x36\u0026#39;, bytes([x36_value]), 10), # å†…å­˜è®¿é—®æ§åˆ¶ (b\u0026#39;\\x2A\u0026#39;, col_start.to_bytes(2, \u0026#39;big\u0026#39;) + col_end.to_bytes(2, \u0026#39;big\u0026#39;), 10), # åˆ—åœ°å€è®¾ç½® (b\u0026#39;\\x2B\u0026#39;, row_start.to_bytes(2, \u0026#39;big\u0026#39;) + row_end.to_bytes(2, \u0026#39;big\u0026#39;), 10), # è¡Œåœ°å€è®¾ç½® (b\u0026#39;\\x21\u0026#39;, None, 10), # æ˜¾ç¤ºåè½¬ (b\u0026#39;\\x13\u0026#39;, None, 10), # æ­£å¸¸æ˜¾ç¤º (b\u0026#39;\\x29\u0026#39;, None, 100), # æ˜¾ç¤ºå¼€å¯ ] tft.init(init_commands) print(\u0026#34;init_commands finished\u0026#34;) test_display_basic() # æµ‹è¯•åƒç´ æ˜¾ç¤º try: tft.pixel(0, 0, 0xFFFF) # å·¦ä¸Šè§’ tft.pixel(st_width // 2, st_height // 2, 0xF800) # ä¸­å¿ƒç‚¹çº¢è‰² tft.pixel(st_width - 1, st_height - 1, 0xFFFF) # å³ä¸‹è§’ print(f\u0026#34;{st_width}x{st_height} æ˜¾ç¤ºåŒºåŸŸè®¾ç½®æˆåŠŸ\u0026#34;) return tft except Exception as e: print(f\u0026#34;æ˜¾ç¤ºæµ‹è¯•å¤±è´¥: {e}\u0026#34;) return None # 135 x 240 æ˜¾ç¤ºå±çš„åˆå§‹åŒ– # è¿™é‡Œå‡è®¾ä½ ä½¿ç”¨çš„æ˜¯ ST7789 æ˜¾ç¤ºå±ï¼Œåˆ†è¾¨ç‡ä¸º 135x240 # å¦‚æœä½ ä½¿ç”¨çš„æ˜¯å…¶ä»–å‹å·ï¼Œè¯·æ ¹æ®å®é™…æƒ…å†µè°ƒæ•´å‚æ•° ST_WIDTH = 240 # é©±åŠ¨å†…éƒ¨ç†è§£ä¸º widthï¼Œä½†å®é™…åœ¨æ¨ªå±æ—¶å˜æˆäº† height ST_HEIGHT = 320 # åˆå§‹åŒ–TFTå¯¹è±¡ tft = init_st7789_display(ST_WIDTH, ST_HEIGHT, 3) # æ—‹è½¬ 3 è¡¨ç¤ºé¡ºæ—¶é’ˆ 270 åº¦ def main(): \u0026#34;\u0026#34;\u0026#34;ä¸»ç¨‹åºå…¥å£\u0026#34;\u0026#34;\u0026#34; print(\u0026#34;--- ESP32-C3 ---\u0026#34;) tft.fill(st7789.BLACK) # é»‘è‰²èƒŒæ™¯ display_text_on_tft(tft, \u0026#34;ESP32-C3 TFT Display\\nReady to receive text...\u0026#34;) ip_address = connect_to_available_wifi() start_http_server(tft, ip_address) if __name__ == \u0026#34;__main__\u0026#34;: main() å¤šè¡Œæ–‡æœ¬æ˜¾ç¤º show_text.py 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 from machine import Pin, SPI import vga1_8x8 as font import st7789 def display_text_on_tft(tft, text_content): \u0026#34;\u0026#34;\u0026#34;åœ¨ TFT æ˜¾ç¤ºå±ä¸Šæ˜¾ç¤ºæ–‡æœ¬å†…å®¹ï¼ˆ5è¡Œï¼Œ35å­—ç¬¦é™åˆ¶ï¼Œè¡Œèµ·ç‚¹x=20ï¼‰\u0026#34;\u0026#34;\u0026#34; if not tft: print(\u0026#34;é”™è¯¯: TFT æ˜¾ç¤ºå±æœªåˆå§‹åŒ–ã€‚\u0026#34;) return tft.fill(st7789.BLACK) # é»‘åº• # æ ‡é¢˜æ  tft.text(font, \u0026#34;Received Text:\u0026#34;, 20, 2, 0x07FF) tft.text(font, \u0026#34;-\u0026#34; * 35, 20, 12, 0x07FF) x_offset = 20 # æ¯è¡Œèµ·ç‚¹xåæ ‡ä¿®æ”¹ä¸º20 max_chars_per_line = 35 y_start = 85 # æ¯è¡Œèµ·ç‚¹yåæ ‡ä¿®æ”¹ä¸º85 line_height = font.HEIGHT + 1 max_lines = 5 # åªæ˜¾ç¤º5è¡Œ lines = text_content.split(\u0026#39;\\n\u0026#39;) line_count = 0 for line in lines: while len(line) \u0026gt; max_chars_per_line: if line_count \u0026lt; max_lines: y_offset = y_start + line_count * line_height line_text = line[:max_chars_per_line] print(f\u0026#34;æ˜¾ç¤ºè¡Œ: {line_text} at y={y_offset}\u0026#34;) tft.text(font, line_text, x_offset, y_offset, st7789.WHITE) line = line[max_chars_per_line:] line_count += 1 else: # è¡Œæ•°ç”¨å®Œï¼Œæ˜¾ç¤ºæç¤º tft.text(font, \u0026#34;... (more)\u0026#34;, x_offset, y_start + (max_lines - 1) * line_height, 0xF800) return if line_count \u0026lt; max_lines: tft.text(font, line, x_offset, y_start + line_count * line_height, st7789.WHITE) line_count += 1 else: tft.text(font, \u0026#34;... (more)\u0026#34;, x_offset, y_start + (max_lines - 1) * line_height, 0xF800) return æœ€ç»ˆæ•ˆæœ\nè£…å›å»ä¹‹åå‘ç°æ˜¾ç¤ºåäº†ï¼Œå®‰è£…ä½ç½®æ²¡æ³•æ”¹äº†ï¼Œç›´æ¥æ”¹ä¸‹ä»£ç ç®—äº†ã€‚\nå†…éƒ¨èµ°çº¿\nå¡äº†ä¸ªUSBçº¿è¿›å»ï¼Œä¾›ç”µ+æ•°æ®ä¼ è¾“\næ€»ç»“ å› ä¸ºå±å¹•å°ºå¯¸å’Œé©±åŠ¨æ”¯æŒçš„å°ºå¯¸ä¸é‚£ä¹ˆåŒ¹é…ï¼Œæœ€åé‡‡ç”¨çš„æ–¹æ¡ˆæ˜¯ä»£ç é€»è¾‘ä¸Šå®ç°è£å‰ªã€‚\nåˆå› ä¸ºå±å¹•å°ºå¯¸ç¿»è½¬çš„æ—¶å€™éœ€è¦æ›´æ”¹å†…å­˜åœ°å€ï¼ŒæŠ˜è…¾è¿™ä¸ªæäº†å¾ˆä¹…ã€‚\nå…¶ä»–çš„ä»£ç å€’éƒ½æ˜¯ä¸æ–­è¯•é”™éªŒè¯ï¼Œæ²¡å¤ªå¤§çš„é—®é¢˜ã€‚\nåè®° -\u0026gt; â€œå‹æƒ…å¿ å‘Šâ€ è¯¥è®¾å¤‡ç»„è£…æ˜¯é ç€å›ºä½“èƒ¶æ°´å’Œå¡æ‰£ï¼Œ\nä¸å­˜åœ¨åæœŸæ‹†è£…çš„å¯èƒ½ã€‚\nä¸€åˆ‡çš„æ‹†è£…éƒ½åŸºäºæš´åŠ›å’Œç ´åã€‚\næ‰€ä»¥ï¼š\nè¿™ç©æ„çš„æ‹†å¸æ˜¯â€œæœ‰æŸæ–¹æ¡ˆâ€ï¼Œä¸å­˜åœ¨æ— æŸæ‹†è£…æ”¹é€ ã€‚\nè¿™ç©æ„çš„æ‹†å¸æ˜¯â€œæœ‰æŸæ–¹æ¡ˆâ€ï¼Œä¸å­˜åœ¨æ— æŸæ‹†è£…æ”¹é€ ã€‚\nè¿™ç©æ„çš„æ‹†å¸æ˜¯â€œæœ‰æŸæ–¹æ¡ˆâ€ï¼Œä¸å­˜åœ¨æ— æŸæ‹†è£…æ”¹é€ ã€‚\nå†…éƒ¨å±å¹•æ²¡æ‰¾åˆ°é€‚é…çš„ICé©±åŠ¨æ¿ï¼Œ\nå·¦å³ä¸¤ä¾§ä¸€å…±å››ä¸ªç”µæºçº¿ç„Šæ¥ä¸é‚£ä¹ˆç‰¢å›ºï¼Œ\næ‹†è£…è¿‡ç¨‹å¾ˆå®¹æ˜“æ–­å¼€ï¼Œ\næ­£å¸¸æƒ…å†µä¸‹å¾ˆéš¾å¤ç”¨è¿™ç©æ„\nï¼ˆæœ‰æœ‹å‹æœ‰æ–¹æ¡ˆå¯ä»¥æ»´æ»´æˆ‘ã€‚\nç”µæ± æ‹†è£…æœ‰èµ·ç«é£é™©ï¼Œè¯·è°¨æ…æ“ä½œã€‚\nç”µæ± æ‹†è£…æœ‰èµ·ç«é£é™©ï¼Œè¯·è°¨æ…æ“ä½œã€‚\nç”µæ± æ‹†è£…æœ‰èµ·ç«é£é™©ï¼Œè¯·è°¨æ…æ“ä½œã€‚\næœ€åã€‚\nç¥ç©å¾—å¼€å¿ƒ~\nèµ„æ–™è¿æ¥ï¼š\nhttps://github.com/russhughes/st7789py_mpy/ ","date":"2025-07-30T23:36:00Z","image":"https://liguobao.github.io/zh/p/esp32-diy/logo_hu_7eebd6ecfe307200.png","permalink":"https://liguobao.github.io/zh/p/esp32-diy/","title":"ä»0å¼€å§‹åšä¸€ä¸ªäº’è”ç½‘ä¸»æœºç§˜é’¥ ï¼ˆåŸºäºESP32ï¼‰"},{"content":"ä»åˆ·æœºåŒ…æå– boot.img å¦‚æœæœ‰åˆ·æœºåŒ…çš„è¯ï¼Œç›´æ¥ä»åˆ·æœºåŒ…playload.binæå– boot.img æ–‡ä»¶å³å¯ã€‚\nä¸€èˆ¬ç”¨FastbootEnhanceå®Œäº‹ï¼Œå›¾å½¢ç•Œé¢ç‚¹ç‚¹ç‚¹å°±ææ‚ã€‚\nå¾ˆå¤šæ—¶å€™æˆ‘ä»¬å¯èƒ½å¹¶æ²¡æœ‰åˆ·æœºåŒ…ï¼Œæˆ–è€…åˆ·æœºåŒ…åŠ¨åˆ™å‡ ä¸ªGBï¼Œä¸‹è½½èµ·æ¥å¾ˆéº»çƒ¦ã€‚\nè¿™ä¸ªæ—¶å€™å¯ä»¥å°è¯•ä½¿ç”¨ dsu-sideloader + system-squeak-arm64-ab-vanilla.img\nè¿›å…¥åˆ°ä¾§è½½ç³»ç»Ÿæ¨¡å¼ï¼Œä½¿ç”¨adb shell æå–boot.img.\nDSU-Sideloader dsu-sideloader æ˜¯ Android ç³»ç»Ÿä¸­ç”¨äº**åŠ¨æ€ç³»ç»Ÿæ›´æ–°ï¼ˆDSU, Dynamic System Updatesï¼‰**æœºåˆ¶çš„ä¸€ä¸ªå·¥å…·æˆ–æœåŠ¡ç»„ä»¶ï¼Œå®ƒå…è®¸ç”¨æˆ·åœ¨ä¸å½±å“å½“å‰ç³»ç»Ÿçš„å‰æä¸‹ï¼Œä¸´æ—¶åŠ è½½å¹¶è¿è¡Œä¸€ä¸ªæ›¿ä»£æ€§çš„ç³»ç»Ÿé•œåƒã€‚è¿™æ˜¯å¼€å‘è€…è°ƒè¯•æˆ–æµ‹è¯• GSIï¼ˆé€šç”¨ç³»ç»Ÿæ˜ åƒï¼‰çš„ä¸€ç§å®˜æ–¹æœºåˆ¶ã€‚\nğŸ” ä»€ä¹ˆæ˜¯ DSUï¼ˆDynamic System Updatesï¼‰ï¼Ÿ\nDSU æ˜¯ Google ä» Android 10 å¼€å§‹å¼•å…¥çš„åŠŸèƒ½ï¼Œå…è®¸åœ¨æ”¯æŒçš„è®¾å¤‡ä¸ŠåŠ è½½ä¸€ä¸ªç³»ç»Ÿé•œåƒï¼ˆé€šå¸¸æ˜¯ GSIï¼‰åˆ°åŠ¨æ€åˆ†åŒºä¸­è¿›è¡Œæµ‹è¯•ï¼Œè€Œä¸ä¼šç ´åå½“å‰è®¾å¤‡çš„å®é™…ç³»ç»Ÿï¼ˆuserdata/system åˆ†åŒºï¼‰ã€‚\nä»è¿è¡Œçš„ Android ç³»ç»Ÿæå– boot.img å®‰è£…å¥½ä¸Šçš„dsu + system-squeak-arm64-ab-vanilla.img åï¼Œè¿›å…¥åˆ°ä¾§è½½ç³»ç»Ÿæ¨¡å¼ã€‚\nåœ¨ä¾§è½½ç³»ç»Ÿä¸­ï¼Œä½¿ç”¨ä»¥ä¸‹è„šæœ¬æå– boot.imgï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 #!/bin/bash set -e # è·å–å½“å‰ slot slot=$(adb shell getprop ro.boot.slot_suffix | tr -d \u0026#39;\\r\u0026#39;) if [[ -z \u0026#34;$slot\u0026#34; ]]; then echo \u0026#34;âŒ æ— æ³•è·å– slot_suffix\u0026#34; exit 1 fi echo \u0026#34;ğŸ” å½“å‰å¯åŠ¨ slot: $slot\u0026#34; # è·å– boot åˆ†åŒºçœŸå®è·¯å¾„ï¼ˆä½¿ç”¨ adb shell su è¿›å…¥ root å† ls -lï¼‰ boot_dev=$(adb shell \u0026lt;\u0026lt;EOF su ls -l /dev/block/by-name/boot$slot | awk \u0026#39;{print \\$NF}\u0026#39; exit EOF ) boot_dev=$(echo \u0026#34;$boot_dev\u0026#34; | tr -d \u0026#39;\\r\u0026#39; | tail -n 1) if [[ -z \u0026#34;$boot_dev\u0026#34; ]]; then echo \u0026#34;âŒ æ— æ³•è§£æ boot$slot åˆ†åŒºè·¯å¾„\u0026#34; exit 1 fi echo \u0026#34;ğŸ“ è§£æåˆ° boot$slot çœŸå®è·¯å¾„: $boot_dev\u0026#34; # æ‰§è¡Œ dd æå– boot.img adb shell \u0026lt;\u0026lt;EOF su dd if=$boot_dev of=/sdcard/boot.img exit EOF # æ‹‰å–åˆ°æœ¬åœ° echo \u0026#34;ğŸ“¥ æ­£åœ¨æ‹‰å– boot.img åˆ°æœ¬åœ°...\u0026#34; adb pull /sdcard/boot.img echo \u0026#34;âœ… æå–å®Œæˆï¼boot.img å·²ä¿å­˜åˆ°å½“å‰ç›®å½•ã€‚\u0026#34; ","date":"2025-06-24T23:36:00Z","permalink":"https://liguobao.github.io/zh/p/android-boot-image-extraction/","title":"Android boot é•œåƒæå–å¤‡å¿˜å½•"},{"content":"æ‰‹æœºç«¯è¿ç§»èŠå¤©è®°å½•åŸºæœ¬ç”¨å¾®ä¿¡å†…éƒ¨å·¥å…·å®Œäº‹äº†ï¼Œ macOSè·¨æœºå™¨è¿ç§»å€’æ˜¯éœ€è¦æŠ˜è…¾ä¸€ä¸‹äº†ã€‚ ç ”ç©¶äº†ä¸€ä¸‹ï¼Œå…¶å®åªéœ€è¦å¤‡ä»½ \u0026ldquo;$HOME/Library/Containers/com.tencent.xinWeChat\u0026rdquo;\næ•´ä¸ªæ–‡ä»¶å¤¹åˆ°æ–°æœºå™¨ï¼Œ ä¸¤è¾¹ä¿æŒå¾®ä¿¡ç‰ˆæœ¬ä¸€è‡´ï¼Œ åŸºæœ¬å°±æ²¡å•¥éœ€è¦å¤„ç†çš„ã€‚\näºæ˜¯åœ¨GPTçš„å¸®åŠ©ä¸‹ï¼Œ å†™äº†ä¸‹é¢çš„ä¸€ä¸ªè„šæœ¬ backup_wechat.sh\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 #!/bin/bash set -euo pipefail BACKUP_SRC=\u0026#34;$HOME/Library/Containers/com.tencent.xinWeChat\u0026#34; BACKUP_DIR=\u0026#34;/Volumes/workspace/weixin\u0026#34; TIMESTAMP=$(date +%Y%m%d_%H%M%S) BACKUP_DEST=\u0026#34;$BACKUP_DIR/wechat_backup_${TIMESTAMP}.tar.gz\u0026#34; echo \u0026#34;ğŸš€ å¼€å§‹å¤‡ä»½å¾®ä¿¡èŠå¤©è®°å½•...\u0026#34; # æ£€æŸ¥å¾®ä¿¡è¿›ç¨‹ if pgrep -f WeChat \u0026gt; /dev/null; then echo \u0026#34;âš ï¸ æ£€æµ‹åˆ°å¾®ä¿¡æ­£åœ¨è¿è¡Œï¼Œè¯·å…ˆé€€å‡ºå¾®ä¿¡ï¼ˆCmd + Qï¼‰ï¼Œç„¶åé‡æ–°è¿è¡Œè„šæœ¬ã€‚\u0026#34; exit 1 fi # æ£€æŸ¥æ•°æ®ç›®å½• if [ ! -d \u0026#34;$BACKUP_SRC\u0026#34; ]; then echo \u0026#34;âŒ æ‰¾ä¸åˆ°å¾®ä¿¡æ•°æ®ç›®å½•ï¼š$BACKUP_SRC\u0026#34; exit 1 fi # æ£€æŸ¥å¤‡ä»½ç›®å½• if [ ! -d \u0026#34;$BACKUP_DIR\u0026#34; ]; then echo \u0026#34;âŒ å¤‡ä»½ç›®å½•ä¸å­˜åœ¨ï¼š$BACKUP_DIR\u0026#34; exit 1 fi echo \u0026#34;ğŸ“¦ å¼€å§‹æ‰“åŒ…...ï¼ˆå¼€å§‹æ—¶é—´ï¼š$(date \u0026#39;+%F %T\u0026#39;)ï¼‰\u0026#34; START_TIME=$(date +%s) tar --exclude=\u0026#39;.com.apple.containermanagerd.metadata.plist\u0026#39; --preserve-permissions -czf \u0026#34;$BACKUP_DEST\u0026#34; -C \u0026#34;$HOME/Library/Containers\u0026#34; com.tencent.xinWeChat END_TIME=$(date +%s) DURATION=$((END_TIME - START_TIME)) echo \u0026#34;âœ… å¤‡ä»½å®Œæˆï¼\u0026#34; echo \u0026#34;ğŸ“ æ–‡ä»¶ä½ç½®ï¼š$BACKUP_DEST\u0026#34; echo \u0026#34;â±ï¸ è€—æ—¶ï¼š${DURATION} ç§’ï¼ˆ$(printf \u0026#39;%02d:%02d\u0026#39; $((DURATION/60)) $((DURATION%60)))ï¼‰\u0026#34; å¤‡æ³¨ï¼š/Volumes/workspace/weixin æ˜¯æŒ‚è½½åˆ°æœ¬åœ°çš„NAS ç›˜ï¼Œ æ¯•ç«Ÿæˆ‘ç”µè„‘æ²¡æœ‰170Gçš„å¯ç”¨ç©ºé—´äº†ã€‚ å»ºè®®æœ‰SSDç§»åŠ¨ç¡¬ç›˜é‚£å°±æ›´å¥½çš„ï¼Œ ä¸è¿‡æˆ‘æ‰‹ä¸Šç¡®å®æ²¡è¿™ç©æ„~\nè¿˜åŸè„šæœ¬ restore_wechat.sh\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 #!/bin/bash set -euo pipefail BACKUP_DIR=\u0026#34;/Volumes/workspace/weixin\u0026#34; BACKUP_FILE=$(ls -t \u0026#34;$BACKUP_DIR\u0026#34;/wechat_backup_*.tar.gz 2\u0026gt;/dev/null | head -1 || true) TARGET_DIR=\u0026#34;$HOME/Library/Containers/com.tencent.xinWeChat\u0026#34; if [ -z \u0026#34;$BACKUP_FILE\u0026#34; ]; then echo \u0026#34;âŒ æœªæ‰¾åˆ°å¤‡ä»½æ–‡ä»¶ï¼Œè¯·ç¡®è®¤ $BACKUP_DIR ç›®å½•ä¸‹æœ‰å¾®ä¿¡å¤‡ä»½æ–‡ä»¶ã€‚\u0026#34; exit 1 fi echo \u0026#34;ğŸš€ å¼€å§‹è¿˜åŸå¾®ä¿¡èŠå¤©è®°å½•...\u0026#34; if pgrep -f WeChat \u0026gt; /dev/null; then echo \u0026#34;âš ï¸ æ£€æµ‹åˆ°å¾®ä¿¡æ­£åœ¨è¿è¡Œï¼Œè¯·å…ˆé€€å‡ºå¾®ä¿¡ï¼ˆCmd + Qï¼‰ï¼Œç„¶åé‡æ–°è¿è¡Œè„šæœ¬ã€‚\u0026#34; exit 1 fi echo \u0026#34;ğŸ“¦ è¿˜åŸçš„å¤‡ä»½æ–‡ä»¶ï¼š$BACKUP_FILE\u0026#34; echo \u0026#34;ğŸ“¦ æ–‡ä»¶å¤§å°ï¼š$(du -sh \u0026#34;$BACKUP_FILE\u0026#34; | awk \u0026#39;{print $1}\u0026#39;)\u0026#34; echo \u0026#34;ğŸ“‚ å¼€å§‹è§£å‹å¹¶è¦†ç›–æ—§æ•°æ®...ï¼ˆå¼€å§‹æ—¶é—´ï¼š$(date \u0026#39;+%F %T\u0026#39;)ï¼‰\u0026#34; START_TIME=$(date +%s) # è§£å‹ï¼Œè¦†ç›–æ—§å†…å®¹ï¼ˆä¸åˆ é™¤åŸç›®å½•ï¼‰ sudo tar -xzf \u0026#34;$BACKUP_FILE\u0026#34; -C \u0026#34;$HOME/Library/Containers\u0026#34; END_TIME=$(date +%s) DURATION=$((END_TIME - START_TIME)) echo \u0026#34;âœ… è¿˜åŸå®Œæˆï¼\u0026#34; echo \u0026#34;â±ï¸ è€—æ—¶ï¼š${DURATION} ç§’ï¼ˆ$(printf \u0026#39;%02d:%02d\u0026#39; $((DURATION/60)) $((DURATION%60)))ï¼‰\u0026#34; echo \u0026#34;è¯·æ‰“å¼€å¾®ä¿¡æ£€æŸ¥èŠå¤©è®°å½•æ˜¯å¦å®Œæ•´ã€‚\u0026#34; æ•´ä¸ªè¿‡ç¨‹ç”šè‡³æ¯”æ‰‹æœºèŠå¤©è®°å½•å¤‡ä»½è¿˜åŸè¿˜è¦å¿«å¤šäº†ã€‚ (æ¯•ç«Ÿè·‘æ»¡å¸¦å®½çš„NASä¼ è¾“é€Ÿåº¦è¿˜æ˜¯å¾ˆå¿«çš„)\nå¾®ä¿¡çœŸçš„\u0026hellip;.\né“ç†æ¥è¯´ Windowsç”µè„‘ä¹Ÿå·®ä¸å¤šæ˜¯ç±»ä¼¼çš„ï¼Œ\nä¸è¿‡æˆ‘æ‰‹ä¸ŠåŸºæœ¬æ²¡åœ¨Windowsä¸ŠæŠ˜è…¾äº†ï¼Œ è‡ªå·±çœ‹ç€æ¥äº†~\n","date":"2025-06-24T23:36:00Z","permalink":"https://liguobao.github.io/zh/p/wechat-backup/","title":"macOSæ— æŸè¿ç§»PCå¾®ä¿¡èŠå¤©è®°å½•"},{"content":" 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 #!/bin/bash echo \u0026#39;å¼€å§‹æ‰§è¡Œwireguard-install.sh\u0026#39; set -e WG_DIR=\u0026#34;/etc/wireguard\u0026#34; KEY_DIR=\u0026#34;/tmp/wg-keys\u0026#34; WG_CONF=\u0026#34;$WG_DIR/wg0.conf\u0026#34; WG_NET_BASE=\u0026#34;10.200.200\u0026#34; WG_PORT=51820 NODE_LIST=\u0026#34;$HOME/all-node.txt\u0026#34; # === Step 0: æ£€æŸ¥èŠ‚ç‚¹åˆ—è¡¨æ–‡ä»¶ === if [[ ! -f \u0026#34;$NODE_LIST\u0026#34; ]]; then echo \u0026#34;âŒ èŠ‚ç‚¹åˆ—è¡¨æ–‡ä»¶ä¸å­˜åœ¨ï¼š$NODE_LIST\u0026#34; exit 1 fi mkdir -p \u0026#34;$WG_DIR\u0026#34; mkdir -p \u0026#34;$KEY_DIR\u0026#34; chmod 700 \u0026#34;$WG_DIR\u0026#34; # === Step 1: è¯»å– IP åˆ—è¡¨ === ALL_IPS=() while read -r ip; do [[ -z \u0026#34;$ip\u0026#34; || \u0026#34;$ip\u0026#34; =~ ^# ]] \u0026amp;\u0026amp; continue ALL_IPS+=(\u0026#34;$ip\u0026#34;) done \u0026lt; \u0026#34;$NODE_LIST\u0026#34; NODE_COUNT=${#ALL_IPS[@]} # === Step 2: è·å–å…¬ç½‘IPå‡½æ•°ï¼Œä¼˜å…ˆç”¨ iinti.cnï¼Œå¤±è´¥ç”¨ ipify === get_public_ip() { ip=$(curl -s https://iinti.cn/conn/getPublicIp) if [[ -z \u0026#34;$ip\u0026#34; || \u0026#34;$ip\u0026#34; == \u0026#34;null\u0026#34; ]]; then ip=$(curl -s https://api.ipify.org) fi echo \u0026#34;$ip\u0026#34; } echo \u0026#34;å‡†å¤‡è·å–å…¬ç½‘ IP...\u0026#34; MY_PUBLIC_IP=$(get_public_ip) if [[ -z \u0026#34;$MY_PUBLIC_IP\u0026#34; ]]; then echo \u0026#34;âŒ æ— æ³•è·å–å…¬ç½‘ IPï¼Œé€€å‡º\u0026#34; exit 1 fi echo \u0026#34;è·å–åˆ°å…¬ç½‘ IPï¼š$MY_PUBLIC_IP\u0026#34; MY_ID=0 for i in \u0026#34;${!ALL_IPS[@]}\u0026#34;; do if [[ \u0026#34;${ALL_IPS[$i]}\u0026#34; == \u0026#34;$MY_PUBLIC_IP\u0026#34; ]]; then MY_ID=$((i + 1)) break fi done if [[ $MY_ID -eq 0 ]]; then echo \u0026#34;âŒ æœªåœ¨ all-node.txt ä¸­æ‰¾åˆ°å½“å‰å…¬ç½‘IPï¼š$MY_PUBLIC_IP\u0026#34; exit 1 fi MY_WG_IP=\u0026#34;${WG_NET_BASE}.${MY_ID}/24\u0026#34; MY_KEY_NAME=\u0026#34;node${MY_ID}.pub\u0026#34; echo \u0026#34; å½“å‰èŠ‚ç‚¹ç¼–å·: $MY_ID\u0026#34; echo \u0026#34; å…¬ç½‘ IP: $MY_PUBLIC_IP\u0026#34; echo \u0026#34; WireGuard IP: $MY_WG_IP\u0026#34; # === Step 3: å®‰è£… WireGuardï¼ˆå¦‚æœªå®‰è£…ï¼‰ === if ! command -v wg \u0026amp;\u0026gt;/dev/null; then echo \u0026#34; å®‰è£… wireguard-tools...\u0026#34; apt update \u0026amp;\u0026amp; apt install -y wireguard fi # === Step 4: ç”Ÿæˆå¯†é’¥ === PRIVATE_KEY_FILE=\u0026#34;$WG_DIR/privatekey\u0026#34; PUBLIC_KEY_FILE=\u0026#34;$WG_DIR/publickey\u0026#34; if [ ! -f \u0026#34;$PRIVATE_KEY_FILE\u0026#34; ]; then echo \u0026#34; ç”Ÿæˆå¯†é’¥å¯¹...\u0026#34; wg genkey | tee \u0026#34;$PRIVATE_KEY_FILE\u0026#34; | wg pubkey \u0026gt; \u0026#34;$PUBLIC_KEY_FILE\u0026#34; fi MY_PRIVATE_KEY=$(cat \u0026#34;$PRIVATE_KEY_FILE\u0026#34;) MY_PUBLIC_KEY=$(cat \u0026#34;$PUBLIC_KEY_FILE\u0026#34;) # === Step 5: å†™æœ¬æœºå…¬é’¥åˆ°æœ¬åœ°ç›®å½• === echo \u0026#34;$MY_PUBLIC_KEY\u0026#34; \u0026gt; \u0026#34;$KEY_DIR/$MY_KEY_NAME\u0026#34; # === Step 6: è‡ªåŠ¨å°†æœ¬æœºå…¬é’¥ scp åˆ°å…¶ä»–æ‰€æœ‰èŠ‚ç‚¹çš„ KEY_DIR === echo \u0026#34; è‡ªåŠ¨åŒæ­¥å…¬é’¥åˆ°å…¶ä»–èŠ‚ç‚¹...\u0026#34; for ip in \u0026#34;${ALL_IPS[@]}\u0026#34;; do # è·³è¿‡æœ¬æœº if [[ \u0026#34;$ip\u0026#34; == \u0026#34;$MY_PUBLIC_IP\u0026#34; ]]; then continue fi echo \u0026#34;â³ å¤åˆ¶å…¬é’¥åˆ° $ip:$KEY_DIR\u0026#34; ssh -o ConnectTimeout=5 root@\u0026#34;$ip\u0026#34; \u0026#34;mkdir -p $KEY_DIR \u0026amp;\u0026amp; chmod 700 $KEY_DIR\u0026#34; scp \u0026#34;$KEY_DIR/$MY_KEY_NAME\u0026#34; root@\u0026#34;$ip\u0026#34;:\u0026#34;$KEY_DIR/\u0026#34; done # === Step 7: ç­‰å¾…æ‰€æœ‰èŠ‚ç‚¹çš„å…¬é’¥æ–‡ä»¶éƒ½åˆ°é½ === echo \u0026#34; ç­‰å¾…æ‰€æœ‰èŠ‚ç‚¹å…¬é’¥å†™å…¥ $KEY_DIR ...\u0026#34; while true; do FOUND_KEYS=$(ls \u0026#34;$KEY_DIR\u0026#34;/*.pub 2\u0026gt;/dev/null | wc -l) if [ \u0026#34;$FOUND_KEYS\u0026#34; -ge \u0026#34;$NODE_COUNT\u0026#34; ]; then echo \u0026#34;âœ… æ£€æµ‹åˆ°æ‰€æœ‰ $NODE_COUNT ä¸ªèŠ‚ç‚¹çš„å…¬é’¥\u0026#34; break fi echo -n \u0026#34;.\u0026#34; sleep 2 done # === Step 8: ç”Ÿæˆ WireGuard é…ç½® === echo \u0026#34;âš™ï¸ ç”Ÿæˆ WireGuard é…ç½®: $WG_CONF\u0026#34; echo \u0026#34;[Interface]\u0026#34; \u0026gt; \u0026#34;$WG_CONF\u0026#34; echo \u0026#34;Address = $MY_WG_IP\u0026#34; \u0026gt;\u0026gt; \u0026#34;$WG_CONF\u0026#34; echo \u0026#34;ListenPort = $WG_PORT\u0026#34; \u0026gt;\u0026gt; \u0026#34;$WG_CONF\u0026#34; echo \u0026#34;PrivateKey = $MY_PRIVATE_KEY\u0026#34; \u0026gt;\u0026gt; \u0026#34;$WG_CONF\u0026#34; echo \u0026gt;\u0026gt; \u0026#34;$WG_CONF\u0026#34; for i in \u0026#34;${!ALL_IPS[@]}\u0026#34;; do ID=$((i + 1)) PEER_IP=\u0026#34;${ALL_IPS[$i]}\u0026#34; PEER_WG_IP=\u0026#34;${WG_NET_BASE}.${ID}/32\u0026#34; if [ \u0026#34;$ID\u0026#34; -eq \u0026#34;$MY_ID\u0026#34; ]; then continue fi PEER_KEY_FILE=\u0026#34;$KEY_DIR/node${ID}.pub\u0026#34; if [ ! -f \u0026#34;$PEER_KEY_FILE\u0026#34; ]; then echo \u0026#34;âŒ ç¼ºå°‘ $PEER_KEY_FILEï¼Œé€€å‡º\u0026#34; exit 1 fi PEER_KEY=$(cat \u0026#34;$PEER_KEY_FILE\u0026#34;) echo \u0026#34;[Peer]\u0026#34; \u0026gt;\u0026gt; \u0026#34;$WG_CONF\u0026#34; echo \u0026#34;PublicKey = $PEER_KEY\u0026#34; \u0026gt;\u0026gt; \u0026#34;$WG_CONF\u0026#34; echo \u0026#34;AllowedIPs = $PEER_WG_IP\u0026#34; \u0026gt;\u0026gt; \u0026#34;$WG_CONF\u0026#34; echo \u0026#34;Endpoint = $PEER_IP:$WG_PORT\u0026#34; \u0026gt;\u0026gt; \u0026#34;$WG_CONF\u0026#34; echo \u0026#34;PersistentKeepalive = 25\u0026#34; \u0026gt;\u0026gt; \u0026#34;$WG_CONF\u0026#34; echo \u0026gt;\u0026gt; \u0026#34;$WG_CONF\u0026#34; done # === Step 9: å¯åŠ¨ WireGuard === echo \u0026#34; å¯åŠ¨ WireGuard...\u0026#34; systemctl stop wg-quick@wg0 \u0026amp;\u0026gt;/dev/null || true wg-quick up wg0 systemctl enable wg-quick@wg0 echo \u0026#34;âœ… å¯åŠ¨æˆåŠŸï¼Œå½“å‰èŠ‚ç‚¹ WireGuard IP: ${WG_NET_BASE}.${MY_ID}\u0026#34; echo \u0026#34; æŸ¥çœ‹çŠ¶æ€: wg show\u0026#34; å‰ç½®æ¡ä»¶ èŠ‚ç‚¹äº’ç›¸å¯ä»¥ç›´æ¥å…å¯†ç ç™»å½• éƒ½æœ‰å…¬ç½‘IPå¯è¾¾ æŠ˜è…¾ä¸€ä¸‹åŸºæœ¬å®ç°äº†è·¨äº‘å†…ç½‘äº’é€šï¼Œå»¶è¿Ÿåœ¨å¯æ¥å—è®¿é—®å†…ã€‚\n( æ¯•ç«Ÿè·¨å¤§æ´‹äº†ã€‚\nä¹‹æ‰€ä»¥è¿™æ ·æè¿˜æ˜¯å› ä¸ºæ—©äº›æ—¶é—´ï¼Œ\nç›´æ¥åœ¨k3sä¸ŠæŠ˜è…¾WireGuard æ€»æœ‰å¥‡å¥‡æ€ªæ€ªé—®é¢˜ã€‚\nç®—äº†ï¼Œè‡ªå·±æ­å§ã€‚\nç°åœ¨çœ‹èµ·æ¥å°±ç¨³å®šå¾ˆå¤šäº†ã€‚\nä¹Ÿä¸åœ¨æŠ˜è…¾k3sé‚£è¾¹çš„å¥‡æ€ªé…ç½®äº†ã€‚\nå®Œäº‹ã€‚\n","date":"2025-06-08T08:00:00Z","image":"https://liguobao.github.io/zh/p/wireguard-setup/logo_hu_ade08796556b0394.jpg","permalink":"https://liguobao.github.io/zh/p/wireguard-setup/","title":"è·¨äº‘å†…ç½‘WireGuard é…ç½®å¤‡å¿˜å½•"},{"content":"åœ¨å›½å†…æäº‹æƒ…å˜›ï¼Œæ—¥å¸¸å¾—è§£å†³ç½‘ç»œé—®é¢˜ã€‚\nåœ¨æœ¬åœ°å€’å¥½è¯´ï¼Œåœ¨æœåŠ¡å™¨å°±æœ‰ç‚¹è›‹ç–¼äº†ã€‚\nä»Šå¤©æŠ˜è…¾k3sé›†ç¾¤çš„æ—¶å€™ï¼Œä¸å°å¿ƒæŠŠetcdå¹²æ²¡äº†ã€‚\näºæ˜¯å¼€å§‹é‡è£…æ•´ä¸ªé›†ç¾¤ã€‚\nåˆ«çš„éƒ½å¥½è¯´ï¼Œåæ­£é•œåƒéƒ½åœ¨æŸäº‘ï¼Œç„¶é¹…traefikå°±è›‹ç–¼äº†ã€‚\nè¿™ç©æ„ç”¨çš„æ˜¯docker hubæºã€‚\nå¦‚æœæ˜¯æ—©äº›å¹´ä¹Ÿå¥½è¯´ï¼Œå›½å†…é‚£ä¹ˆå¤šçš„é•œåƒæºï¼Œéšä¾¿é…ä¸€ä¸ªä¹Ÿå°±å®Œäº‹äº†\nä½†æ˜¯å»å¹´ä¹‹åï¼Œé•œåƒæºæ­»å¾—ä¸ƒä¸ƒå…«å…«äº†ã€‚\næ€»ä¸èƒ½ç»™æœåŠ¡å™¨ä¹ŸæŒ‚ä¸ªç§‘å­¦ä¸Šç½‘å§ã€‚\nè€Œä¸”ç§‘å­¦ä¸Šç½‘çš„å‰ææ˜¯ä½ è¿˜å¾—å…ˆç§‘å­¦ä¸Šç½‘å‡ºå»ä¸‹è½½ä¸œè¥¿ã€‚\næ­»å±€ã€‚\næŠ˜è…¾äº†å‡ ä¸ªå°æ—¶ä¹‹åçªå‘å¥‡æƒ³ã€‚\nç›´æ¥åœ¨æœ¬åœ°å¯¼å‡ºé•œåƒå†å¯¼å…¥ä¸å°±å®Œäº‹äº†ã€‚\nk3s è™½ç„¶ç”¨çš„ä¸æ˜¯dockerè¿è¡Œæ—¶ï¼Œä½†ä¹Ÿæœ‰å…¼å®¹çš„å‘½ä»¤å•Šã€‚\né—®äº†ä¸‹GPTï¼Œå¾ˆç®€å•ã€‚\n1 2 3 4 5 6 docker save docker.io/traefik:v3.4.1 -o traefik_v3.4.1.tar scp traefik_v3.4.1.tar root@my-ip:~/ ctr -n k8s.io images import /root/traefik_v3.4.1.tar å®Œäº‹äº†ã€‚\nå¯¹ã€‚å°±è¿™ä¹ˆç®€å•å®Œäº‹äº†ã€‚\nä¸€åˆ‡éƒ½é‚£ä¹ˆå’Œè°ã€‚\n","date":"2025-06-07T08:00:00Z","permalink":"https://liguobao.github.io/zh/p/k3s-image-pull-error/","title":"k3sæ—¥å¸¸ImagePullErrorå¤‡å¿˜å½•"},{"content":"Part1 â€œé›•å¡‘å›­æ›¾è®¡åˆ’è¦æˆä¸ºäºšæ´²æœ€å¤§çš„é›•å¡‘ä¸»é¢˜å…¬å›­ï¼Œå åœ°æ•°ç™¾äº©ï¼Œç»è¿‡è‰°è‹¦çš„å»ºè®¾ï¼Œç»ˆäºçƒ‚å°¾ã€‚è¿™ä¸ªé›•å¡‘å›­çš„æœ€å¤§ç‰¹è‰²å°±æ˜¯ä¸€å°Šé›•å¡‘éƒ½æ²¡æœ‰ã€‚â€\nã€Šæˆ‘æ‰€ç†è§£çš„ç”Ÿæ´»-ç­”äº­æ—é’å¹´é—®ã€‹ å…³äºè¿™ä¸ªåœ°æ–¹çš„æœ€åˆè®°å¿†ï¼Œåªæ˜¯æ¥æºäºéŸ©å¯’çš„æŸä¸ªæ–‡ç« ã€‚\nå†å¾€åå¤§æ¦‚æ˜¯22å¹´ä¸Šæµ·â€œæœ‰åºâ€ï¼Œâ€œè‡ªæˆ‘å°ç¦â€çš„æ—¶å€™ï¼Œä¸ºæ•°ä¸å¤šå¯ä»¥è‡ªç”±æ´»åŠ¨çš„åŒºåŸŸåœ¨è·ç¦»å¸‚åŒº70å…¬é‡Œçš„é‡‘å±±åŒºâ€œä¹¡ä¸‹â€ï¼Œå½“æ—¶è¿˜èƒ½åœ¨æ–°é—»è”æ’­çœ‹åˆ°è®°è€…é‡‡è®¿å¯¹åº”çš„é‡‡è®¿ã€‚\né™¤æ­¤ä¹‹å¤–ï¼Œåœ¨ä¸Šæµ·ç”Ÿæ´»äº†åå¹´ï¼Œå¯¹é‡‘å±±è¿™ä¸ªåœ°æ–¹æ˜¯æ²¡æœ‰ä»»ä½•çš„æ¦‚å¿µçš„ã€‚\nåœ¨æ²¡æœ‰è½¦ä¹‹å‰ï¼Œåœ°é“ä¸€ä¸ªå°æ—¶è¦†ç›–ä¸äº†çš„åœ°æ–¹æ˜¯ä¸é‚£ä¹ˆæƒ³å»çš„ã€‚\nåœ¨èƒ½å¼€è½¦ä¹‹åï¼Œå¼€è½¦ä¸€ä¸ªå°æ—¶å»ä¸åˆ°çš„åœ°æ–¹éœ€è¦æœ‰å¿µæƒ³å’ŒåŠ¨åŠ›çš„ã€‚\nä¸è¿‡ï¼Œåœ¨è¿™ä¸ªæ˜¥å¤©çš„å‘¨æœ«ï¼Œå¤œé‡Œçœ‹å®Œäº†æ¨±èŠ±ä¹‹åï¼Œ\nç¡è¶³äº†ä¸€ä¸ªå¥½è§‰ï¼Œå€’æ˜¯å¥½åƒå¯ä»¥å‡ºè¡Œäº†ã€‚\näºæ˜¯ï¼Œå¼€è½¦ä¸€ä¸ªå°æ—¶å»äº†äº­æ—é•‡ã€‚\né‚£è¾¹çš„æ²¹èœèŠ±å¼€äº†ï¼Œå¯ä»¥å»çœ‹çœ‹äº†ã€‚\nä»é«˜é€Ÿä¸‹å»ä¹‹åå°±åˆ°äº†ä¹¡ä¸‹å°é“ï¼Œ\nå¤§æ¦‚ä¹Ÿå°±æ˜ç™½è¿™æ˜¯ä¸ªä»€ä¹ˆæ ·çš„åœ°æ–¹äº†ã€‚\nä¹¡ä¸‹ã€‚\næ³¥åœŸé‡Œé•¿å‡ºä¸€åˆ‡ã€‚\nä¸‹è¿‡é›¨ååœŸåœ°æœ‰ç‚¹æ½®ã€‚\nå°æ²³æµè¿‡æ‘è¾¹ï¼Œ\nè·¯è¾¹æ’ç¼ç§ç€èš•è±†ï¼Œ\nç°åœ¨å¼€ç€é»‘è‰²çš„èŠ±ã€‚\nå’Œç†Ÿæ‚‰çš„ä¹¡æ‘ä¸€æ ·ã€‚\nå’Œèµ°å‡ºæ¥çš„è€å®¶ä¸€æ ·ã€‚\nPart2 ä»ä¹¡ä¸‹å‡ºæ¥ä¹‹åï¼Œå¼€è½¦å»äº†â€çœŸæ­£çš„â€œäº­æ—é•‡ã€‚\nä¸¾ç›®å››æœ›ï¼Œå¤§æŠµå°±æ˜¯å—æ–¹æ™®é€šå°é•‡çš„æ ·å­ã€‚\nå¤§æ¦‚æ˜¯ä¸ä¼šå’Œâ€é­”éƒ½â€œäº§ç”ŸåŠç‚¹è”æƒ³ã€‚\næ‰“å¼€äº†å¤§ä¼—ç‚¹è¯„ï¼Œå‘ç°åœè½¦å¯¹é¢æœ‰å®¶ç¾Šè‚‰é¦†ã€‚\nè¿›åº—åçœ‹ä¸åˆ°èœå•ï¼Œæœ‰ç‚¹ç–‘æƒ‘ã€‚\nä¸è¿‡è€æ¿å’Œè€æ¿å¨˜æ¥å¾…å¾ˆæ˜¯çƒ­æƒ…ï¼Œæ¯•ç«Ÿçœ‹èµ·æ¥ä¸‹åˆä¹Ÿæ²¡äººåƒé¥­ã€‚\nåä¸‹æ¥å¬ç€è€æ¿åœ¨æ¨èç¾Šè‚‰åƒæ³•ã€‚\nåŠæ‡‚ä¸æ‡‚çš„è§‰å¾—æ— æ‰€è°“äº†ï¼Œå°±åƒä¸ªç¾Šæ‚é”…å®Œäº‹ã€‚\nä¸€ä¼šè€æ¿å¨˜å°±ç«¯ç€ä¸€é”…æ±¤ä¸Šæ¥äº†ï¼Œ\nç¾Šæ‚ç¾Šè¡€ç¾Šè‚‰éƒ½æœ‰ï¼Œæ··æ‚ç€è’œè‹—çš„ç™½æ±¤å€’æ˜¯å‘³é“ä¸é”™ã€‚\nåƒäº†ä¸€åŠè€æ¿å¨˜ç»™æˆ‘ä»¬æ·»äº†ä¸€ç¢—ç±³é¥­ï¼Œåˆšå¥½å¤Ÿåƒã€‚\nç©¿è¿‡äº†åº—é‡Œé¢çš„é•¿å»Šå»ä¸Šå•æ‰€ï¼Œçœ‹åˆ°åº—é‡Œé¢è¿˜æœ‰å¥½å‡ ä¸ªåŒ…é—´å°å±‹ï¼Œ\nè™½ç„¶çœ‹èµ·æ¥ç°åœ¨ä¸æ€ä¹ˆç”¨äº†ï¼Œæƒ³å¿…å°åº—æ›¾ç»ä¹Ÿæ˜¯çƒ­é—¹è¿‡ã€‚\nåªæ˜¯ç°åœ¨æ‹›ç‰Œéƒ½é”ˆè¿¹æ–‘æ–‘äº†ã€‚\nPart3 å¤§æ¦‚ä¹Ÿä¸å¤ªä¼šå†å»ä¸€æ¬¡äº­æ—é•‡äº†ã€‚\näººç”Ÿå¾ˆå¤šåœ°æ–¹ä¹Ÿå°±å»ä¸€æ¬¡å°±ä¸€æ¬¡ï¼Œ\nç›¸èšæœ‰æ—¶ï¼Œå¤§æŠµå¦‚æ­¤ã€‚\næœ‰äº›äººèƒ½è§ä¸€é¢å¤šå‡ é¢ã€‚\n","date":"2025-03-31T12:36:00Z","image":"https://liguobao.github.io/zh/p/tingling-world/logo_hu_c2d03dfdcb456be2.png","permalink":"https://liguobao.github.io/zh/p/tingling-world/","title":"äº­æ—é•‡â€œå¾€äº‹â€"},{"content":" 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 // ==UserScript== // @name ä¸‹è½½å¾®åšç›¸å†Œå›¾ç‰‡ä¸ºZIPæ–‡ä»¶ // @namespace http://tampermonkey.net/ // @version 0.1 // @description ä¸‹è½½å¾®åšç›¸å†Œä¸Šçš„æ‰€æœ‰å›¾ç‰‡å¹¶å°†å®ƒä»¬æ‰“åŒ…ä¸ºZIPæ–‡ä»¶ // @author You // @match https://weibo.com/u/*?tabtype=album // @grant GM_addStyle // ==/UserScript== (function() { \u0026#39;use strict\u0026#39;; // è·å–å¾®åšç”¨æˆ·çš„ ID ä½œä¸ºä¸‹è½½æ–‡ä»¶å const match = window.location.href.match(/https:\\/\\/weibo\\.com\\/u\\/(\\d+)\\?/); if (!match) { console.error(\u0026#34;æ— æ³•è·å–å¾®åšç”¨æˆ· ID\u0026#34;); return; } const userId = match[1]; const downloadFileName = `weibo_album_${userId}.zip`; // æ’å…¥æŒ‰é’®åˆ°é¡µé¢é¡¶éƒ¨å¹¶å±…ä¸­ const button = document.createElement(\u0026#34;button\u0026#34;); button.innerText = \u0026#34;ä¸‹è½½å›¾ç‰‡ä¸ºZIP\u0026#34;; button.style.position = \u0026#34;fixed\u0026#34;; button.style.top = \u0026#34;50%\u0026#34;; // å‚ç›´å±…ä¸­ button.style.left = \u0026#34;50%\u0026#34;; // æ°´å¹³å±…ä¸­ button.style.transform = \u0026#34;translate(-50%, -50%)\u0026#34;; // ä½¿æŒ‰é’®å®Œå…¨å±…ä¸­ button.style.zIndex = \u0026#34;9999\u0026#34;; // ç¡®ä¿æŒ‰é’®ä½äºé¡µé¢é¡¶éƒ¨ button.style.padding = \u0026#34;10px 20px\u0026#34;; button.style.backgroundColor = \u0026#34;#007bff\u0026#34;; button.style.color = \u0026#34;#fff\u0026#34;; button.style.border = \u0026#34;none\u0026#34;; button.style.borderRadius = \u0026#34;5px\u0026#34;; button.style.cursor = \u0026#34;pointer\u0026#34;; button.style.fontSize = \u0026#34;16px\u0026#34;; // å¢åŠ å­—ä½“å¤§å° button.style.boxShadow = \u0026#34;0 2px 10px rgba(0, 0, 0, 0.3)\u0026#34;; // æ·»åŠ é˜´å½± document.body.appendChild(button); // æŒ‰é’®ç‚¹å‡»äº‹ä»¶ button.addEventListener(\u0026#34;click\u0026#34;, () =\u0026gt; { downloadAllImagesAsZip(); }); // åŠ è½½ JSZip åº“ const loadJSZip = () =\u0026gt; { return new Promise((resolve, reject) =\u0026gt; { const script = document.createElement(\u0026#34;script\u0026#34;); script.src = \u0026#34;https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js\u0026#34;; script.onload = resolve; script.onerror = reject; document.head.appendChild(script); }); }; // ä¸‹è½½æ‰€æœ‰å›¾ç‰‡å¹¶æ‰“åŒ…ä¸ºZIP const downloadAllImagesAsZip = async () =\u0026gt; { console.log(\u0026#34;å¼€å§‹åŠ è½½ JSZip...\u0026#34;); await loadJSZip(); // åŠ è½½ JSZip console.log(\u0026#34;JSZip åŠ è½½å®Œæˆã€‚\u0026#34;); const zip = new JSZip(); // ä½¿ç”¨ new JSZip() å®ä¾‹åŒ– const images = document.getElementsByClassName(\u0026#34;woo-picture-img\u0026#34;); console.log(`å…±æ‰¾åˆ° ${images.length} å¼ å›¾ç‰‡ã€‚`); if (images.length === 0) { alert(\u0026#34;æ²¡æœ‰æ‰¾åˆ°ä»»ä½•å›¾ç‰‡ï¼\u0026#34;); // å¦‚æœæ²¡æœ‰å›¾ç‰‡ï¼Œæç¤ºç”¨æˆ· return; // ç»ˆæ­¢å‡½æ•°ï¼Œä¸æ‰§è¡Œä¸‹è½½é€»è¾‘ } // ä¸‹è½½æ‰€æœ‰å›¾ç‰‡å¹¶å­˜å‚¨åˆ°å†…å­˜ä¸­ const imageBlobs = await Promise.all( Array.from(images).map((img, index) =\u0026gt; { if (img.tagName === \u0026#34;IMG\u0026#34; \u0026amp;\u0026amp; img.src) { console.log(`å¼€å§‹ä¸‹è½½å›¾ç‰‡ ${index + 1}: ${img.src}`); return fetch(img.src) .then((response) =\u0026gt; { if (!response.ok) { throw new Error(`HTTP çŠ¶æ€ç : ${response.status}`); } return response.blob(); }) .then((blob) =\u0026gt; { console.log(`å›¾ç‰‡ ${index + 1} ä¸‹è½½å®Œæˆã€‚`); return { blob, index, src: img.src }; }) .catch((error) =\u0026gt; { console.error(`æ— æ³•ä¸‹è½½å›¾ç‰‡ ${index + 1}: ${img.src}`, error); return null; // è¿”å› null è¡¨ç¤ºä¸‹è½½å¤±è´¥ }); } else { console.warn(`å›¾ç‰‡å…ƒç´ æ— æ•ˆ: ${img}`); return null; } }) ); console.log(\u0026#34;æ‰€æœ‰å›¾ç‰‡ä¸‹è½½å®Œæˆï¼Œå¼€å§‹æ·»åŠ åˆ° ZIP åŒ…ã€‚\u0026#34;); // å°†å›¾ç‰‡æ·»åŠ åˆ° ZIP åŒ… imageBlobs.forEach((image) =\u0026gt; { if (image) { const ext = image.src.split(\u0026#34;.\u0026#34;).pop().split(\u0026#34;?\u0026#34;)[0] || \u0026#34;jpg\u0026#34;; // æå–æ‰©å±•å zip.file(`image-${image.index + 1}.${ext}`, image.blob); // æ·»åŠ åˆ° ZIP console.log(`å›¾ç‰‡ ${image.index + 1} å·²æ·»åŠ åˆ° ZIP åŒ…ã€‚`); } }); // ç”Ÿæˆ ZIP å¹¶ä¸‹è½½ console.log(\u0026#34;å¼€å§‹ç”Ÿæˆ ZIP æ–‡ä»¶ã€‚\u0026#34;); zip.generateAsync({ type: \u0026#34;blob\u0026#34; }).then((content) =\u0026gt; { console.log(\u0026#34;ZIP æ–‡ä»¶ç”Ÿæˆå®Œæˆï¼Œå¼€å§‹ä¸‹è½½ã€‚\u0026#34;); const a = document.createElement(\u0026#34;a\u0026#34;); a.href = URL.createObjectURL(content); a.download = downloadFileName; // ä½¿ç”¨ç”¨æˆ· ID ä½œä¸ºä¸‹è½½æ–‡ä»¶å document.body.appendChild(a); a.click(); document.body.removeChild(a); console.log(\u0026#34;ZIP æ–‡ä»¶ä¸‹è½½å®Œæˆã€‚\u0026#34;); }); }; })(); æ•ˆæœå˜›ã€‚\nå¤§æ¦‚ä¼šé‡åˆ°CORSé”™è¯¯ã€‚\nè§£å†³åŠæ³•å˜› -\u0026gt; Modheader ä¿®æ”¹ä¸€ä¸‹ResponseHeaderã€‚\nAccess-Control-Allow-Origin ç›´æ¥å¡«æˆ *\nå®Œäº‹ã€‚\nä¸‹è½½å†…å®¹ã€‚\n","date":"2025-01-23T08:00:00Z","image":"https://liguobao.github.io/zh/p/one-line-download-weibo-img/logo_hu_d61078ab2b688570.png","permalink":"https://liguobao.github.io/zh/p/one-line-download-weibo-img/","title":"ä¸€è¡Œä»£ç ä¸‹è½½å¾®åšç›¸å†Œ"},{"content":"mini-dashboard æ˜¯ meilisearch çš„ä¸€ä¸ªå°å‹æŸ¥è¯¢çœ‹æ¿ï¼Œ\næä¾›äº†æ¯”è¾ƒé›†ç¾¤çš„æŸ¥è¯¢é¡µé¢ï¼Œå¯¹äºæˆ‘çš„éœ€æ±‚æ¥è¯´åˆšå¥½å¤Ÿç”¨ã€‚\nä¸è¿‡å®˜æ–¹çš„é•œåƒæ„å»ºåªæ˜¯ä¸ªnode Debugç‰ˆæœ¬ï¼Œ\næ‰€ä»¥æˆ‘è‡ªå·±æ„å»ºäº†ä¸€ä¸ªé™æ€ç«™ç‚¹é•œåƒã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 FROM node:20-alpine AS build-env WORKDIR /home/node/app RUN chown -R node:node /home/node/app USER node COPY package*.json ./ COPY --chown=node:node . . RUN yarn install ENV NODE_ENV=production # if you want to use your own meilisearch server, you can set the following env # ENV REACT_APP_MEILI_SERVER_ADDRESS=http://meilisearch:7700 # ENV REACT_APP_MEILI_API_KEY=masterKey RUN yarn build FROM nginx COPY --from=build-env /home/node/app/build/ /usr/share/nginx/html/ Docker with Nginx nginx is also available in the Docker image.\nYou can use it to serve the mini-dashboard.\n1 2 docker build --build-arg REACT_APP_MEILI_SERVER_ADDRESS=http://meilisearch:7700 -t meilisearch-mini-dashboard-nginx . -f Dockerfile.nginx docker run -p 8080:80 meilisearch-mini-dashboard-nginx You can then access the mini-dashboard at http://localhost:8080.\nå¤§æ¦‚å¦‚æ­¤ã€‚\nå½“ç„¶ï¼Œæœ€ç®€å•çš„è¿˜æ˜¯ç›´æ¥æŠŠç”¨docker-compose\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 version: \u0026#34;3.8\u0026#34; services: meilisearch-node1: image: getmeili/meilisearch:v1.12 restart: always container_name: meilisearch-node1 ports: - \u0026#34;7700:7700\u0026#34; environment: MEILI_MASTER_KEY: \u0026#34;iinti_2025_gogogo_123\u0026#34; MEILI_ENV: \u0026#34;production\u0026#34; MEILI_DB_PATH: \u0026#34;/meili_data\u0026#34; MEILI_NO_ANALYTICS: \u0026#34;true\u0026#34; volumes: - /mnt/nvme/Meilisearch/meili_data/node1:/meili_data networks: - meili-network meilisearch-dashboard: restart: always image: mini-dashboard-nginx container_name: meilisearch-dashboard ports: - \u0026#34;7707:80\u0026#34; networks: - meili-network networks: meili-network: driver: bridge ","date":"2025-01-16T08:00:00Z","image":"https://liguobao.github.io/zh/p/meili-dashboard/logo_hu_d248d5d94b3cb12b.png","permalink":"https://liguobao.github.io/zh/p/meili-dashboard/","title":"æ„å»º meilisearch mini-dashboard é™æ€ç«™ç‚¹é•œåƒ"},{"content":"Windows æ•´ç›˜å¤‡ä»½è¿ç§»ç®€æ˜“æ•™ç¨‹ æ­»å…šå‰é˜µå­ä¸€ç›´åœ¨æŠ±æ€¨ç”µè„‘ç£ç›˜ç©ºé—´ä¸å¤Ÿç”¨äº†ï¼Œ\næŸ¥äº†ä¸‹ä»–çš„ç¬”è®°æœ¬å‹å·ï¼Œé—®äº†ä¸‹å°ç±³å®¢æœç¡®è®¤ï¼Œè¿™ä¸ªå‹å·åªæœ‰ä¸€ä¸ªM.2æ’æ§½ï¼Œæ²¡æœ‰é¢„ç•™æ‰©å±•ä½ã€‚\nä¸è¿‡SSDå¹¶æ²¡æœ‰ç„Šæ­»åœ¨ä¸»æ¿ä¸Šï¼Œæ‹†è£…èµ·æ¥è¿˜æ˜¯æ¯”è¾ƒæ–¹ä¾¿çš„ã€‚\næŸ¥äº†ä¸€ä¸‹æ‹†æœºæ•™ç¨‹ï¼ŒèƒŒæ¿èºä¸æ‹†ä¸‹æ¥ä¹‹åå°±èƒ½æ¢ç¡¬ç›˜äº†ã€‚\nå‡†å¤‡å·¥å…· 4T M.2 SSD ç»´ä¿®èºä¸åˆ€å¥—è£… SSD ç¡¬ç›˜ç›’ è½¯ä»¶ï¼šåˆ†åŒºåŠ©æ‰‹ æ“ä½œæµç¨‹ æŠŠæ–°ç¡¬ç›˜è£…åˆ°SSD ç¡¬ç›˜ç›’ ä½¿ç”¨â€œåˆ†åŒºåŠ©æ‰‹â€ å…‹éš†æ•´ä¸ªç£ç›˜åˆ†åŒºåˆ°æ–°ç¡¬ç›˜ æ‹†ç¬”è®°æœ¬åç›–ï¼Œæ›¿æ¢åŸç¡¬ç›˜ å¼€æœºç¡®è®¤ç³»ç»Ÿæ­£å¸¸å¯åŠ¨è¿è¡Œ å…‹éš†æ•´ä¸ªç£ç›˜åˆ†åŒº è¿™ä¸ªæ²¡ä»€ä¹ˆå¤ªå¤šéœ€è¦è®²çš„ï¼Œæ‰“å¼€åˆ†åŒºåŠ©æ‰‹ï¼Œ\né€‰æ‹©ç£ç›˜å…‹éš†ï¼Œé€‰æ‹©æºç›˜å’Œç›®æ ‡ç›˜ï¼Œç„¶åå¼€å§‹å…‹éš†ã€‚\nçœ‹ç£ç›˜é€Ÿåº¦ï¼Œéƒ½æ˜¯SSDçš„æƒ…å†µï¼Œæˆ‘è¿™è¾¹ä¸€ä¸ªå¤šå°æ—¶å°±è·‘å®Œäº†ã€‚\næ•™ç¨‹å¯ä»¥å‚è€ƒï¼š\næ— éœ€é‡è£…ï¼Œè½»æ¾å°†ç³»ç»Ÿè¿ç§»åˆ°å›ºæ€ç¡¬ç›˜! å¦‚ä½•å¿«é€Ÿå°†ç³»ç»Ÿè¿ç§»åˆ°æ–°ç¡¬ç›˜ï¼Ÿ3ç§æ•°æ®è¿ç§»æ–¹æ³•ï¼ æ“ä½œæµç¨‹å¤§åŒå°å¼‚ï¼Œä¸å†èµ˜è¿°ã€‚\nè¿ç§»å®Œæˆä¹‹åï¼Œå¯ä»¥æ‰“å¼€æ–‡ä»¶å¤¹ï¼Œç®€å•çœ‹ä¸€ä¸‹æ•°æ®æ˜¯ä¸æ˜¯æ­£å¸¸çš„ã€‚\næ‹†è£…ç¡¬ç›˜ è¿™ä¸ªå¾ˆç®€å•ï¼ŒåŸºæœ¬å°±æ˜¯æ‹§èºä¸ï¼Œæ‹†ä¸‹æ¥ï¼Œæ¢ä¸Šå»ã€‚\næˆ‘æ‰”äº†ä¸€ä¸ªæ“ä½œè§†é¢‘ç»™æ­»å…šï¼Œä»–è‡ªå·±éƒ½ææ‚äº†ã€‚\næ˜¯çš„ã€‚æœ¬æ¬¡æ“ä½œå…¨ç¨‹ä»–è‡ªå·±å®Œæˆï¼Œæˆ‘åªèƒ½è¿œç¨‹æŒ‡å¯¼ã€‚\nç¬¬ä¸€ä¸ªâ€œé—®é¢˜â€ï¼šNo bootable device æ¢å¥½ç¡¬ç›˜ä¹‹åå¼€æœºï¼Œç›´æ¥æ˜¾ç¤º â€œNo bootable deviceâ€ã€‚\nè¿·ç³Šï¼Œéš¾é“ç¡¬ç›˜æ²¡æ’ç´§ï¼Ÿ\nè®©è€å‹å†æ¬¡æ£€æŸ¥äº†ï¼Œç¡®è®¤ç¡¬ç›˜ç¡®å®æ¥ç´§äº†ã€‚\nè®©ä»–æ¢å›è€ç¡¬ç›˜è¯•è¯•å¼€æœºï¼Œä¸€åˆ‡æ­£å¸¸ã€‚\nå†æ¬¡æ¢å›æ–°ç¡¬ç›˜ï¼Œè¿˜æ˜¯æ˜¾ç¤º â€œNo bootable deviceâ€ã€‚\nå¥ˆä½•ä»–æ‰‹ä¸Šæ²¡æœ‰PE Uç›˜ï¼Œå¤œé‡Œå¤ªæ™šäº†å…ˆä¸æŠ˜è…¾äº†ï¼Œç™½å¤©æä¸ªPEç›˜åœ¨è¯•è¯•ã€‚\nç™½å¤©æƒ³äº†ä¸‹ï¼Œè¿™ä¸ªé—®é¢˜åº”è¯¥æ˜¯å¼•å¯¼é—®é¢˜ï¼Œæ–°ç¡¬ç›˜æ²¡æœ‰å¼•å¯¼ä¿¡æ¯ã€‚\næåˆ°äº†æ–°PEç›˜ä¹‹åï¼Œè¿œç¨‹æŒ‡å¯¼ä»–è¿›å…¥PEç³»ç»Ÿï¼Œç¡®è®¤äº†æ–°ç¡¬ç›˜æ˜¯æ­£å¸¸è¯†åˆ«çš„äº†ï¼Œ\nå®¹é‡å’Œåˆ†åŒºçœ‹èµ·æ¥å’Œè€ç¡¬ç›˜æ˜¯ä¸€è‡´çš„ã€‚\nå…ˆç›´æ¥ç”¨PEè‡ªå¸¦çš„å·¥å…·åšäº†ä¸€æ¬¡å¼•å¯¼ä¿®å¤ã€‚\nå†æ¬¡é‡å¯ï¼Œä¾æ—§è¿˜æ˜¯ä¸€æ ·çš„é”™è¯¯ã€‚\nç¬¬äºŒä¸ªâ€œé—®é¢˜â€ï¼šä¸»å¼•å¯¼è®°å½•ä¸å¤ªå¯¹ï¼Ÿ å†æ¬¡è¿›å…¥PEç³»ç»Ÿï¼Œä½¿ç”¨ diskgenius æ‰‹åŠ¨ä¿®å¤äº†ä¸€ä¸‹ä¸»å¼•å¯¼è®°å½•ã€‚\nå¯åŠ¨ä¹‹åï¼Œè¿˜æ˜¯ä¸€æ ·çš„é”™è¯¯ã€‚\nç¥å¥‡äº†ï¼Œè¿˜å·®ä¸ªä»€ä¹ˆç©æ„å‘¢ã€‚\nçªç„¶æƒ³èµ·äº†è€æ—©ä¹‹å‰çš„æ“ä½œï¼Œè¿ç§»äº†ç£ç›˜ä¹‹åï¼Œæ˜¯ä¸æ˜¯ç»™è¿™ç©æ„ç£ç›˜è½¬æˆGPT æ ¼å¼ã€‚\nå†æ¬¡è¿›å…¥ PE ç³»ç»Ÿï¼Œä½¿ç”¨ diskgenius å°†æ–°ç¡¬ç›˜è½¬æ¢ä¸º GPT æ ¼å¼ã€‚\né‡å¯ï¼Œæ­£å¸¸å¯åŠ¨ã€‚\næ€»ç»“ æç³»ç»Ÿè¿ç§»ï¼Œè¿˜æ˜¯è¦å¤‡å¥½PEå·¥å…·åœ¨æ‰‹ã€‚ ç¡¬ç›˜è¿ç§»ä¹‹åï¼Œè¦æ³¨æ„ç£ç›˜æ ¼å¼é—®é¢˜ã€‚ å‚è€ƒèµ„æ–™ å¦‚ä½•ä½¿ç”¨è€æ¯›æ¡ƒwinpeè¿›è¡Œç£ç›˜åˆ†åŒºå¼•å¯¼ä¿®å¤? MBR(ä¸»å¼•å¯¼è®°å½•)ä»‹ç»åŠä¿®å¤ ","date":"2024-12-27T08:00:00Z","permalink":"https://liguobao.github.io/zh/p/windows-c-disk-move/","title":"Windows æ•´ç›˜å¤‡ä»½è¿ç§»ç®€æ˜“æ•™ç¨‹"},{"content":"æœ€è¿‘åœ¨æŠ˜è…¾GitLabè¿ç§»ï¼Œç”±äºåŸGitLabç‰ˆæœ¬å®åœ¨æ˜¯å¤ªä½äº†ï¼Œ\nåŒæ—¶ä½¿ç”¨çš„æ˜¯è¢«é­”æ”¹è¿‡çš„ï¼Œå®Œå…¨ä¸å¤ªå¯èƒ½ä»è€ç‰ˆæœ¬è·¨å‡ ä¸ªå¤§ç‰ˆæœ¬å‡çº§åˆ°æœ€æ–°ç‰ˆæœ¬ï¼Œ\næ‰€ä»¥æœ€åå†³å®šå†™Pythonè„šæœ¬è°ƒç”¨Gitlab APIå¯¼å‡ºç”¨æˆ·å’Œåˆ†ç»„ä»¥åŠé¡¹ç›®ï¼Œ\næ¥ç€é€šè¿‡Gitlab APIæ·»åŠ åˆ°æ–°çš„Gitlabä¸­ï¼Œç„¶åæŠŠæºç ä»“åº“æ•´ä¸ªæ–‡ä»¶å¤¹æ‹·è´åˆ°æ–°æœåŠ¡å™¨ï¼Œ\nä½¿ç”¨Pythonæ‰§è¡Œshellå‘½ä»¤ï¼ŒæŠŠæ‰€æœ‰çš„git è£¸ä»“åº“ æäº¤åˆ°æ–°çš„Gitlabä¸­ã€‚\nå¯¼å‡ºç”¨æˆ·ã€åˆ†ç»„ã€é¡¹ç›® 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 import requests import json from loguru import logger from datetime import datetime # GitLab åŸŸå gitlab_domain = \u0026#34;gitlab.com\u0026#34; # GitLab é…ç½® GITLAB_URL = f\u0026#39;https://{domain}\u0026#39; # ä½ çš„ GitLab å®ä¾‹çš„ URL API_TOKEN = \u0026#39;xxx\u0026#39; # ä½ çš„ GitLab è®¿é—®ä»¤ç‰Œ # è€ç‰ˆæœ¬çš„Auth Tokenåœ¨ Header HEADERS = {\u0026#39;PRIVATE-TOKEN\u0026#39;: f\u0026#39;{API_TOKEN}\u0026#39;} # è·å–æ‰€æœ‰é¡¹ç›®çš„å‡½æ•° def get_all_projects(): url = f\u0026#34;{GITLAB_URL}/api/v4/projects\u0026#34; params = { \u0026#34;page\u0026#34;: 1, # é»˜è®¤ç¬¬ä¸€é¡µ \u0026#34;per_page\u0026#34;: 100 # æ¯é¡µæœ€å¤šè¿”å›100ä¸ªé¡¹ç›® } projects = [] while True: response = requests.get(url, headers=HEADERS, params=params) if response.status_code != 200: logger.error(f\u0026#34;Error: Unable to fetch data. Status code {response.status_code}\u0026#34;) break data = response.json() if not data: logger.info(\u0026#34;No more projects to fetch.\u0026#34;) break projects.extend(data) params[\u0026#34;page\u0026#34;] += 1 # è·å–ä¸‹ä¸€é¡µ logger.info(f\u0026#34;Fetched {len(data)} projects from page {params[\u0026#39;page\u0026#39;] - 1}.\u0026#34;) return projects # æå–æ‰€éœ€çš„é¡¹ç›®æ•°æ® def extract_project_info(projects, rep_base): user_project_list = [ { \u0026#39;name\u0026#39;: p[\u0026#34;name\u0026#34;], \u0026#39;path_with_namespace\u0026#39;: p[\u0026#34;path_with_namespace\u0026#34;], \u0026#39;default_branch\u0026#39;: p[\u0026#34;default_branch\u0026#34;], \u0026#39;visibility\u0026#39;: p[\u0026#34;visibility\u0026#34;], \u0026#39;ssh_url_to_repo\u0026#39;: p[\u0026#34;ssh_url_to_repo\u0026#34;], \u0026#39;absolute_path\u0026#39;: rep_base + p[\u0026#34;ssh_url_to_repo\u0026#34;].replace(f\u0026#39;git@{gitlab_domain}:\u0026#39;, \u0026#34;\u0026#34;), \u0026#39;new_ssh_url_to_repo\u0026#39;: p[\u0026#34;ssh_url_to_repo\u0026#34;].replace(f\u0026#34;git@{gitlab_domain}:\u0026#34;, \u0026#34;git@127.0.0.1:\u0026#34;), } for p in projects ] return user_project_list # ä¿å­˜æ•°æ®åˆ°æ–‡ä»¶ def save_to_file(data, filename=\u0026#34;old_all_projects.json\u0026#34;): with open(filename, \u0026#34;w\u0026#34;, encoding=\u0026#34;utf-8\u0026#34;) as f: json.dump(data, f, indent=4, ensure_ascii=False) logger.info(f\u0026#34;Projects data has been saved to \u0026#39;{filename}\u0026#39;.\u0026#34;) # ä¸»å‡½æ•° def main(): rep_base = \u0026#34;/var/opt/gitlab/git-data/back_repositories/repositories/\u0026#34; # ä½ è‡ªå·±çš„ä»“åº“è·¯å¾„ logger.info(\u0026#34;Starting the project extraction process.\u0026#34;) try: # è·å–æ‰€æœ‰é¡¹ç›® projects = get_all_projects() if not projects: logger.warning(\u0026#34;No projects found or there was an issue fetching data.\u0026#34;) return # æå–é¡¹ç›®ä¿¡æ¯ user_project_list = extract_project_info(projects, rep_base) # ä¿å­˜é¡¹ç›®åˆ—è¡¨åˆ°æ–‡ä»¶ save_to_file(user_project_list) logger.info(\u0026#34;Process completed successfully.\u0026#34;) except Exception as e: logger.error(f\u0026#34;An error occurred: {e}\u0026#34;) if __name__ == \u0026#34;__main__\u0026#34;: main() åˆ›å»ºç”¨æˆ·ã€åˆ†ç»„ã€é¡¹ç›® 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 import requests import json import random import string from loguru import logger # æ–° GitLab å®ä¾‹çš„ URL å’Œä¸ªäººè®¿é—®ä»¤ç‰Œ NEW_GITLAB_URL = \u0026#39;https://new-gitlab.com\u0026#39; # æ–°çš„ GitLab å®ä¾‹ URL API_TOKEN = \u0026#39;xxxx\u0026#39; # æ–°çš„ GitLab ç®¡ç†å‘˜è®¿é—®ä»¤ç‰Œ # æ–°ç‰ˆæœ¬çš„é‰´æƒHeader ç”¨çš„ Authorization HEADERS = { \u0026#39;Authorization\u0026#39;: f\u0026#39;Bearer {API_TOKEN}\u0026#39; } # éšæœºç”Ÿæˆå¯†ç  def generate_random_password(length=12): characters = string.ascii_letters + string.digits + string.punctuation return \u0026#39;\u0026#39;.join(random.choice(characters) for i in range(length)) # ä» JSON æ–‡ä»¶ä¸­è¯»å–å¤‡ä»½æ•°æ® def load_backup_data(): with open(\u0026#34;dump_gitlab_data.json\u0026#34;, \u0026#34;r\u0026#34;, encoding=\u0026#34;utf-8\u0026#34;) as f: return json.load(f) # åˆ›å»ºç”¨æˆ· def create_user(username, email, password): url = f\u0026#34;{NEW_GITLAB_URL}/api/v4/users\u0026#34; data = { \u0026#34;username\u0026#34;: username, \u0026#34;name\u0026#34;: username, \u0026#34;email\u0026#34;: email, \u0026#34;password\u0026#34;: password, \u0026#34;skip_confirmation\u0026#34;: True, \u0026#34;force_random_password\u0026#34;: True # å¼ºåˆ¶ç”¨æˆ·é¦–æ¬¡ç™»å½•æ—¶ä¿®æ”¹å¯†ç  } try: response = requests.post(url, headers=HEADERS, data=data) response.raise_for_status() logger.info(f\u0026#34;User {username} created successfully.\u0026#34;) return response.json() # è¿”å›åŒ…å«ç”¨æˆ·ä¿¡æ¯çš„ JSON except requests.RequestException as e: logger.error(f\u0026#34;Error creating user {username}: {e}\u0026#34;) return None # åˆ›å»ºé¡¹ç›® def create_project(group_id, project_name): url = f\u0026#34;{NEW_GITLAB_URL}/api/v4/projects\u0026#34; data = { \u0026#34;name\u0026#34;: project_name, \u0026#34;namespace_id\u0026#34;: group_id, # å°†é¡¹ç›®æ”¾å…¥æŒ‡å®šçš„ç»„ \u0026#34;visibility\u0026#34;: \u0026#34;private\u0026#34;, \u0026#34;initialize_with_readme\u0026#34;: False # é»˜è®¤åˆ›å»ºç©ºé¡¹ç›® } try: response = requests.post(url, headers=HEADERS, data=data) response.raise_for_status() logger.info(f\u0026#34;Project {project_name} created successfully in group {group_id}.\u0026#34;) return response.json() # è¿”å›åˆ›å»ºçš„é¡¹ç›®æ•°æ® except requests.RequestException as e: logger.error(f\u0026#34;Error creating project {project_name} in group {group_id}: {e}\u0026#34;) return None # åˆ›å»ºåˆ†ç»„ def create_group(group_name): url = f\u0026#34;{NEW_GITLAB_URL}/api/v4/groups\u0026#34; data = { \u0026#34;name\u0026#34;: group_name, \u0026#34;path\u0026#34;: group_name.lower().replace(\u0026#34; \u0026#34;, \u0026#34;_\u0026#34;) # è‡ªåŠ¨ç”Ÿæˆè·¯å¾„ } try: response = requests.post(url, headers=HEADERS, data=data) response.raise_for_status() logger.info(f\u0026#34;Group {group_name} created successfully.\u0026#34;) return response.json() # è¿”å›åŒ…å«åˆ†ç»„ä¿¡æ¯çš„ JSON except requests.RequestException as e: logger.error(f\u0026#34;Error creating group {group_name}: {e}\u0026#34;) return None # æ·»åŠ ç”¨æˆ·åˆ°åˆ†ç»„å¹¶è®¾ç½®æƒé™ä¸º master def add_user_to_group(group_id, user_id, access_level=40): url = f\u0026#34;{NEW_GITLAB_URL}/api/v4/groups/{group_id}/members\u0026#34; data = { \u0026#34;user_id\u0026#34;: user_id, \u0026#34;access_level\u0026#34;: access_level # æƒé™è®¾ç½®ä¸º master (40) } try: response = requests.post(url, headers=HEADERS, data=data) response.raise_for_status() logger.info(f\u0026#34;User {user_id} added to group {group_id} with master access.\u0026#34;) except requests.RequestException as e: logger.error(f\u0026#34;Error adding user {user_id} to group {group_id}: {e}\u0026#34;) # å¯¼å…¥ç”¨æˆ·ã€åˆ†ç»„å’Œé¡¹ç›® def import_data(): logger.add(\u0026#34;import_gitlab_entities.log\u0026#34;, rotation=\u0026#34;500 MB\u0026#34;, compression=\u0026#34;zip\u0026#34;) # è¯»å–å¤‡ä»½æ•°æ® backup_data = load_backup_data() # å­˜å‚¨ç”¨æˆ·åã€é‚®ç®±ã€å¯†ç  user_passwords = [] # åˆ›å»ºç”¨æˆ· for user in backup_data[\u0026#34;users\u0026#34;]: username = user[\u0026#34;username\u0026#34;] email = user[\u0026#34;email\u0026#34;] password = generate_random_password() user_data = create_user(username, email, password) if user_data: user_id = user_data[\u0026#34;id\u0026#34;] user_passwords.append({\u0026#34;username\u0026#34;: username, \u0026#34;email\u0026#34;: email, \u0026#34;password\u0026#34;: password}) # åˆ›å»ºç”¨æˆ·çš„é¡¹ç›® for project in user[\u0026#34;projects\u0026#34;]: project_name = project[\u0026#34;name\u0026#34;] # æŸ¥æ‰¾é¡¹ç›®æ‰€å±çš„åˆ†ç»„ group_name = project[\u0026#34;namespace\u0026#34;][\u0026#34;name\u0026#34;] # åˆ›å»ºé¡¹ç›®æ—¶éœ€è¦ä½¿ç”¨åˆ†ç»„IDï¼Œé¦–å…ˆè·å–åˆ†ç»„çš„ ID group_id = None for group in backup_data[\u0026#34;groups\u0026#34;]: if group[\u0026#34;name\u0026#34;] == group_name: group_id = create_group(group_name)[\u0026#34;id\u0026#34;] break if group_id: create_project(group_id, project_name) # åˆ›å»ºé¡¹ç›®åï¼Œå°†ç”¨æˆ·æ·»åŠ åˆ°åˆ†ç»„ä¸­ add_user_to_group(group_id, user_id) # åˆ›å»ºåˆ†ç»„å’Œé¡¹ç›® for group in backup_data[\u0026#34;groups\u0026#34;]: group_name = group[\u0026#34;name\u0026#34;] group_data = create_group(group_name) if group_data: group_id = group_data[\u0026#34;id\u0026#34;] # åˆ›å»ºåˆ†ç»„ä¸­çš„é¡¹ç›® for project in group[\u0026#34;projects\u0026#34;]: project_name = project[\u0026#34;name\u0026#34;] create_project(group_id, project_name) # æ·»åŠ å¯¹åº”çš„ç”¨æˆ·åˆ°åˆ†ç»„ï¼Œå¹¶è®¾ç½®ä¸º master æƒé™ for group_user in group[\u0026#34;users\u0026#34;]: add_user_to_group(group_id, group_user[\u0026#34;user_id\u0026#34;]) # å°†ç”¨æˆ·åã€é‚®ç®±ã€å¯†ç ä¿å­˜åˆ° JSON æ–‡ä»¶ with open(\u0026#34;user_passwords.json\u0026#34;, \u0026#34;w\u0026#34;, encoding=\u0026#34;utf-8\u0026#34;) as f: json.dump(user_passwords, f, ensure_ascii=False, indent=4) logger.info(\u0026#34;User passwords have been exported to user_passwords.json\u0026#34;) if __name__ == \u0026#34;__main__\u0026#34;: import_data() æäº¤Git è£¸ä»“åº“ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 import os import subprocess import json from loguru import logger # è¯»å–é…ç½®çš„ JSON æ–‡ä»¶ def load_config(file_path): with open(file_path, \u0026#39;r\u0026#39;, encoding=\u0026#39;utf-8\u0026#39;) as f: return json.load(f) # å°†æ“ä½œç»“æœå†™å…¥åˆ° JSON æ–‡ä»¶ def write_result_to_json(results, output_file): with open(output_file, \u0026#39;w+\u0026#39;, encoding=\u0026#39;utf-8\u0026#39;) as f: json.dump(results, f, indent=4, ensure_ascii=False) # æ¨é€è£¸ä»“åº“åˆ°æ–°è¿œç«¯ def push_bare_repo_to_remote(project, results): absolute_path = project[\u0026#34;absolute_path\u0026#34;] new_ssh_url_to_repo = project[\u0026#34;new_ssh_url_to_repo\u0026#34;] # æ£€æŸ¥ä»“åº“è·¯å¾„æ˜¯å¦åˆæ³• if not os.path.isdir(absolute_path) or not os.path.exists(os.path.join(absolute_path, \u0026#34;HEAD\u0026#34;)): logger.error(f\u0026#34;Invalid bare repository path: {absolute_path}\u0026#34;) results.append({ \u0026#34;project\u0026#34;: project, \u0026#34;status\u0026#34;: \u0026#34;failed\u0026#34;, \u0026#34;message\u0026#34;: f\u0026#34;Invalid bare repository path: {absolute_path}\u0026#34; }) return try: # è¿›å…¥åŸå§‹ä»“åº“ç›®å½• logger.info(f\u0026#34;Accessing local bare repository: {absolute_path}\u0026#34;) os.chdir(absolute_path) # ç¡®ä¿æ˜¯è£¸ä»“åº“ subprocess.run([\u0026#34;git\u0026#34;, \u0026#34;rev-parse\u0026#34;, \u0026#34;--is-bare-repository\u0026#34;], check=True) # è®¾ç½®æ–°çš„è¿œç«¯åœ°å€ logger.info(f\u0026#34;Setting new remote URL: {new_ssh_url_to_repo}\u0026#34;) subprocess.run([\u0026#34;git\u0026#34;, \u0026#34;remote\u0026#34;, \u0026#34;add\u0026#34;, \u0026#34;new-origin\u0026#34;, new_ssh_url_to_repo], check=True) # æ¨é€æ‰€æœ‰åˆ†æ”¯åˆ°æ–°è¿œç«¯ logger.info(\u0026#34;Pushing all branches to the new remote repository\u0026#34;) subprocess.run([\u0026#34;git\u0026#34;, \u0026#34;push\u0026#34;, \u0026#34;new-origin\u0026#34;, \u0026#34;--all\u0026#34;,\u0026#34;-f\u0026#34;], check=True) # æ¨é€æ‰€æœ‰æ ‡ç­¾åˆ°æ–°è¿œç«¯ logger.info(\u0026#34;Pushing all tags to the new remote repository\u0026#34;) subprocess.run([\u0026#34;git\u0026#34;, \u0026#34;push\u0026#34;, \u0026#34;new-origin\u0026#34;, \u0026#34;--tags\u0026#34;], check=True) results.append({ \u0026#34;project\u0026#34;: project, \u0026#34;status\u0026#34;: \u0026#34;success\u0026#34;, \u0026#34;message\u0026#34;: f\u0026#34;Successfully pushed to {new_ssh_url_to_repo}\u0026#34; }) except subprocess.CalledProcessError as e: logger.error(f\u0026#34;Error during git operations: {e}\u0026#34;) results.append({ \u0026#34;project\u0026#34;: project, \u0026#34;status\u0026#34;: \u0026#34;failed\u0026#34;, \u0026#34;message\u0026#34;: f\u0026#34;Error during git operations: {str(e)}\u0026#34; }) except Exception as e: logger.exception(\u0026#34;Unexpected error occurred\u0026#34;) results.append({ \u0026#34;project\u0026#34;: project, \u0026#34;status\u0026#34;: \u0026#34;failed\u0026#34;, \u0026#34;message\u0026#34;: f\u0026#34;Unexpected error: {str(e)}\u0026#34; }) finally: # ç§»é™¤æ–°è¿œç«¯é…ç½®ä»¥ä¿æŒåŸå§‹ä»“åº“æ¸…æ´ try: subprocess.run([\u0026#34;git\u0026#34;, \u0026#34;remote\u0026#34;, \u0026#34;remove\u0026#34;, \u0026#34;new-origin\u0026#34;], check=True) except subprocess.CalledProcessError: logger.warning(\u0026#34;Failed to remove new-origin remote, please check manually.\u0026#34;) # ä¸»å‡½æ•° def main(): config_file = \u0026#39;old_all_projects.json\u0026#39; output_file = \u0026#39;old_all_projects_result_2024.json\u0026#39; projects = load_config(config_file) logger.add(\u0026#34;all_projects_operation_log_2024.log\u0026#34;, rotation=\u0026#34;500 MB\u0026#34;, level=\u0026#34;INFO\u0026#34;, compression=\u0026#34;zip\u0026#34;) results = [] for project in projects: logger.info(f\u0026#34;Processing project: {project[\u0026#39;name\u0026#39;]}\u0026#34;) push_bare_repo_to_remote(project, results) write_result_to_json(results, output_file) logger.info(f\u0026#34;Operation results saved to {output_file}\u0026#34;) if __name__ == \u0026#34;__main__\u0026#34;: main() ","date":"2024-11-25T08:00:00Z","permalink":"https://liguobao.github.io/zh/p/gitlab-migration-low-version/","title":"Gitlab ä½ç‰ˆæœ¬è¿ç§»ç®€æ˜“æ•™ç¨‹"},{"content":"ä»¥ä¸‹å†…å®¹è½¬è½½è‡ªçŸ¥ä¹ï¼Œä¸ä»£è¡¨ä¸ªäººè§‚ç‚¹ã€‚\nå·²å‰ªè¾‘è‡ª:\nhttps://henchat.net/%e5%9c%a8%e6%9c%89%e7%83%ad%e6%ad%a6%e5%99%a8%e5%8e%8b%e5%88%b6%e6%9a%b4%e6%b0%91%e7%9a%84%e7%8e%b0%e4%bb%a3%e5%9b%bd%e5%ae%b6%e7%bb%93%e6%9d%9f%e5%a5%b4%e9%9a%b6%e5%88%b6/\nä»¥ä¸‹å†…å®¹è½¬è½½è‡ªçŸ¥ä¹ï¼Œä¸ä»£è¡¨ä¸ªäººè§‚ç‚¹ã€‚\nç°ä»£å¥´éš¶åˆ¶ä¼šäº¡äºåŸå­åŒ–çš„å›ä¹±ã€‚\næ‰€è°“åŸå­åŒ–å›ä¹±ï¼Œå°±æ˜¯æ²¡æœ‰è·¯çº¿ï¼Œæ²¡æœ‰çº²é¢†ï¼Œæ²¡æœ‰ç»„ç»‡ï¼Œæ²¡æœ‰è¯‰æ±‚ï¼Œå®Œå…¨æ˜¯ä¸€ä¸ªä¸ªåŸå­åŒ–çš„ä¸ªä½“ï¼Œéšæœºçš„å±•å¼€æŠ¥å¤ç¤¾ä¼šçš„è¡ŒåŠ¨ã€‚ä»–ä»¬éšæ€§è€Œèµ·ï¼Œæ²¡æœ‰è§„å¾‹åœ°è¿›æ”»ä»»ä½•è¢«ä»–ä»¬è§†ä½œæ•Œäººçš„å¯¹è±¡ï¼ŒåŒ…æ‹¬ä¸é™äºä»‡äººï¼Œçœ‹ä¸é¡ºçœ¼çš„è·¯äººï¼Œå¦‡å¥³å„¿ç«¥ï¼Œç”šè‡³æ˜¯è‡ªå·±ã€‚ä»–ä»¬å¦‚åŒä¸€ä¸ªä¸ªå ‚å‰è¯ƒå¾·ï¼Œä¸€ä¸ªäººå°±æ˜¯ä¸€æ”¯å›å†›ï¼Œç”¨è‡ªå·±éšæ„æƒ³åˆ°çš„æ–¹å¼æ¥åæŠ—ç¤¾ä¼šçš„ç§©åºï¼Œä¹Ÿå®Œå…¨ä¸åœ¨æ„è¿™ç§åæŠ—ä¼šè‡ªå·±å¸¦æ¥æ€æ ·çš„ç»“æœï¼Œä¸€åˆ‡ä»¥ç»™ç¤¾ä¼šé€ æˆæœ€å¤§ç¨‹åº¦çš„ç ´åä¸ºç›®æ ‡ã€‚\nç°ä»£å¥´éš¶ä¸»çš„çƒ­æ­¦å™¨æ˜¯ä¸“é—¨ä¸ºé•‡å‹å¤§è§„æ¨¡é›†å›¢åŒ–å›ä¹±è€Œè®¾è®¡çš„ï¼Œå› æ­¤é›†ä½“å›ä¹±çš„éš¾åº¦æ¯”å†·å…µå™¨æ—¶ä»£æé«˜äº†å¤ªå¤šï¼Œä½†ä¸ªä½“å›ä¹±çš„éš¾åº¦å´å¹¶æ²¡æœ‰æé«˜å¾ˆå¤šã€‚åŸå­åŒ–å›ä¹±çš„é•‡å‹æˆæœ¬è¿œé«˜äºåŒç­‰è§„æ¨¡é›†ä½“å›ä¹±ã€‚ä¸€ä¸‡ä¸ªæ™®é€šäººé›†åˆèµ·æ¥ï¼Œç»„æˆä¸€æ”¯åæ”¿åºœå†›ï¼Œå é¢†å›ºå®šçš„æ®ç‚¹ï¼Œè¿›æ”»å›ºå®šçš„æˆ˜ç•¥è¦åœ°ï¼Œæ— è®ºå¦‚ä½•ä¹Ÿæ‰“ä¸è¿‡æ‹¥æœ‰æœºæªï¼Œå¦å…‹ï¼Œæ— äººæœºçš„èŒä¸šå†›é˜Ÿã€‚ä½†å¦‚æœä¸€ä¸‡ä¸ªäººåˆ†æ•£åœ¨ä¸€ä¸‡ä¸ªåœ°æ–¹ï¼Œåœ¨ä¸€ä¸‡ä¸ªéšæœºçš„æ—¶é—´ï¼Œéšæœºçš„åœ°ç‚¹ï¼Œæœéšæœºçš„äººç¾¤å‘èµ·éšæœºçš„æ”»å‡»ï¼Œçƒ­æ­¦å™¨é•‡å‹çš„æ•ˆç‡å°±å°†å¤§å¤§ä¸‹é™ï¼Œç”±æ­¤é€ æˆçš„ç ´åä¹Ÿè¿œè¶…è¿‡ä¸€ä¸‡äººç»„æˆçš„é›†å›¢å†›ã€‚æ¯”å¦‚å†…è’™å¤é‚£ä¸ªæ€äº†ä¸€å®¶äº”å£çš„äººï¼Œåœ¨å¦‚æ­¤ä¸¥å¯†çš„ç¤¾ä¼šç›‘æ§ä¸‹ä¹ŸèŠ±äº†åå¤©æ—¶é—´æ‰æ‰¾åˆ°ï¼Œè¿™ç§äººä¸€æ—¦å¤šèµ·æ¥ï¼Œå¸¦æ¥çš„æ²»å®‰æˆæœ¬æ˜¯æ— æ³•æ‰¿å—çš„ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆç°ä»£ç»Ÿæ²»è€…å®³æ€•æ²»å®‰æˆ˜æ›´ç”šäºæ­£é¢æˆ˜äº‰ã€‚\nå½“ç„¶å¥´éš¶ä¸»ä¹Ÿä¼šæœªé›¨ç»¸ç¼ªï¼Œæœ€å¥½çš„åŠæ³•å°±æ˜¯ä½¿ç”¨ç°ä»£ä¿¡æ¯æ‰‹æ®µï¼Œå°†æ¯ä¸ªäººçš„è¡Œè¸ªç›‘è§†èµ·æ¥ï¼Œæå‰ç“¦è§£ä¸€åˆ‡æ½œåœ¨çš„å›ä¹±ã€‚è¿™æ—¶å°±ä½“ç°å‡ºä¸ªä½“åŒ–å›ä¹±çš„å¦ä¸€ä¸ªä¼˜åŠ¿ï¼Œå°±æ˜¯ä»–æ ¹æœ¬æ²¡æœ‰ç»„ç»‡ä¹Ÿæ²¡æœ‰å¾å…†ã€‚ç°ä»£ä¿¡æ¯æŠ€æœ¯å¯ä»¥æ‰¼æ€å¤§å¤šæ•°å¯†è°‹ç»„ç»‡çš„å›ä¹±ï¼Œä½†éš¾ä»¥å¯Ÿè§‰éšæ€§è€Œèµ·çš„æŠ¥å¤ç¤¾ä¼šè¡Œä¸ºã€‚ä¸€ä¸ªäººæ£ç€ä¸€æŠŠæªèµ°åœ¨å¤§è¡—ä¸Šï¼Œæ»¡è¡—çš„æ‘„åƒå¤´ä¹Ÿçœ‹ä¸å‡ºä»–è„‘å­é‡Œåœ¨æƒ³ä»€ä¹ˆã€‚ä½ æŠŠæªç¦äº†ï¼Œä»–å°±ç”¨åˆ€ï¼›ä½ æŠŠåˆ€ç¦äº†ï¼Œä»–å°±å¼€ç€è½¦ä¸Šè¡—åˆ›äººï¼›ä½ æŠŠæ±½è½¦ä¹Ÿç¦äº†ï¼Œä»–å°±æ¡èµ·è·¯è¾¹çš„çŸ³å¤´ç ¸äººï¼›ä½ æŠŠçŸ³å¤´ä¹Ÿå…¨éƒ¨æ¸…ç†å¹²å‡€ï¼Œä»–å°±èµ¤æ‰‹ç©ºæ‹³çš„æäº‹ï¼Œæ¯”å¦‚éŸ©å›½é‚£ä¸ªæ¢¨æ³°é™¢äº‹ä»¶ï¼Œå°±æ˜¯æœ‰äººåœ¨æ¥¼æ¢¯å£æ¨æ¡é€ æˆäººç¾¤è¸©è¸ï¼Œä½ æ€ä¹ˆé¢„é˜²ï¼Ÿè¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œå›ä¹±è€…æ°¸è¿œå¤„äºå…ˆæ‰‹ï¼Œç»Ÿæ²»è€…æ°¸è¿œåœ¨è¢«åŠ¨é˜²å¾¡ï¼Œè¿™ä¸æ˜¯ä½ è£…å‡ å¤„ç›‘æ§ï¼ŒåŠ å‡ å¤„å®‰æ£€å°±èƒ½æœç»çš„ã€‚\nå…¶å®ä¸æ­¢çƒ­æ­¦å™¨ï¼Œæ€æƒ³é•‡å‹çš„æ­¦å™¨ä¹Ÿä¼šå¤±æ•ˆã€‚é¢å¯¹ä¸€ä¸ªæ¥ä¸€ä¸ªéšæœºå‡ºç°çš„å›ä¹±è€…ï¼Œä½ æ— æ³•åœ¨é“ä¹‰ä¸Šæ”»å‡»ä»–ä»¬ï¼Œåœ¨æ€æƒ³ä¸ŠæŠ¹é»‘ä»–ä»¬ï¼Œå› ä¸ºä»–ä»¬æ—¢æ²¡æœ‰é“ä¹‰ä¹Ÿæ²¡æœ‰æ€æƒ³ï¼Œä»–ä»¬ä¸ä¸ºä»»ä½•äººè°‹ç¦åˆ©ï¼Œä¹Ÿä¸å¯»æ±‚è§£æ”¾ä»»ä½•äººï¼Œä»–ä»¬ä¸æƒ®äºæ€å®³å¼±å°å’Œæ— è¾œçš„äººï¼Œä»–ä»¬ä¸å—ä»»ä½•é“å¾·ä¸Šçš„ï¼Œçº²é¢†ä¸Šçš„ï¼Œæ­£ä¹‰ä¸Šçš„çº¦æŸï¼Œå› æ­¤ä»»ä½ å†æ€ä¹ˆç«™åœ¨é“å¾·é«˜åœ°ä¸Šå®¡è§†ä»–ä»¬ï¼Œä»–ä»¬ä¹Ÿè§†ä½ çš„å®¡åˆ¤å¦‚æ— ç‰©ã€‚ä½ ä¹Ÿæ— æ³•åˆ†åŒ–æ‰“å‹ä»–ä»¬ï¼Œä»–ä»¬æœ¬èº«å°±æ˜¯ä¸€ä¸ªä¸ªåŸå­åŒ–çš„ä¸ªä½“ï¼Œä½ è¿˜èƒ½æ€ä¹ˆåˆ†åŒ–ï¼Ÿæ€»ä¸èƒ½æŠŠä¸€ä¸ªæ´»äººåˆ†åŒ–æˆæ— æ•°ä¸ªç»†èƒå§ã€‚ä½ ä¹Ÿæ— æ³•æ‹‰ä¸€æ´¾æ‰“ä¸€æ´¾ï¼Œä»–ä»¬æƒ³èµ·ä¸€å‡ºæ˜¯ä¸€å‡ºï¼Œè‡ªå·±éƒ½ä¸çŸ¥é“è‡ªå·±æ˜¯å“ªæ´¾ï¼Œä½ ç¯é¡¾å››å‘¨ï¼Œä¸ªä¸ªçœ‹èµ·æ¥éƒ½æ˜¯è€å®äººï¼Œä½ æ‰‹æ¡åˆ©å‰‘ï¼Œæ—¢ä¸çŸ¥é“è¯¥æƒ©ç½šè°ï¼Œä¹Ÿä¸çŸ¥é“è¯¥ä¿æŠ¤è°ï¼Œè¿™å°±æ˜¯æ‰€è°“â€œæ‹”å‰‘å››é¡¾å¿ƒèŒ«ç„¶â€ã€‚\nå›ä»¥æ­¤å…´ï¼Œå¿…ä»¥æ­¤äº¡ã€‚å½“å¥´éš¶ä¸»è¯•å›¾æŠŠå¥´éš¶é›†ä¸­èµ·æ¥å‹æ¦¨æ—¶ï¼Œæœ€ç»ˆä¾¿ä¼šäº¡äºé›†ä½“åŒ–çš„å›ä¹±ï¼›å½“å¥´éš¶ä¸»è¯•å›¾æŠŠå¥´éš¶åˆ†å‰²æˆåŸå­åŒ–çš„ä¸ªä½“æ—¶ï¼Œæœ€ç»ˆä¾¿ä¼šäº¡äºåŸå­åŒ–çš„å›ä¹±ã€‚åŸå­åŒ–çš„å›ä¹±è€…ä»¬å°±å¦‚åŒç—…æ¯’ç»†èŒï¼Œä»–ä»¬éšç€ç¤¾ä¼šç—…æ€çš„æ¶åŒ–è€Œæ»‹ç”Ÿï¼Œä¼ æ’­ï¼Œæ‰©å¤§ï¼Œè€Œæœºæªå¤§ç‚®æ˜¯æ€ä¸æ­»ç»†èŒçš„ã€‚\næ–°æ—¶ä»£çš„å›ä¹±ï¼Œæ ¸å¿ƒåœ¨äºâ€œä¹±â€è€Œä¸åœ¨äºâ€œå›â€ã€‚æ–°æ—¶ä»£çš„å›ä¹±è€…ï¼Œå¹¶ä¸éœ€è¦å°†åˆ€åˆºå‘ç»Ÿæ²»è€…æˆ–æ˜¯éš¶å±äºç»Ÿæ²»è€…çš„ä»»ä½•æš´åŠ›æœºå…³ï¼Œä»–ä»¬åªéœ€è¦å°†åˆ€åˆºå‘èº«è¾¹å¤Ÿå¾—ç€çš„äººï¼Œä¸ç®¡æ˜¯æœ‰ä»‡çš„äººè¿˜æ˜¯æ²¡ä»‡çš„äººï¼Œè®¤è¯†çš„äººè¿˜æ˜¯ä¸è®¤è¯†çš„äººï¼Œèº«å¼ºåŠ›å£®çš„äººè¿˜æ˜¯è€å¼±ç—…æ®‹çš„äººï¼Œå®åœ¨æ²¡äººäº†å°±åˆºå‘è‡ªå·±ï¼Œè¿™ç§è¡Œä¸ºæœ¬èº«å°±æ˜¯å¯¹å¥´éš¶åˆ¶ç»Ÿæ²»æ ¹åŸºçš„åŠ¨æ‘‡ã€‚å¥´éš¶åˆ¶å’Œä»»ä½•å¥‘çº¦ç¤¾ä¼šä¸€æ ·ï¼Œä¹Ÿæ˜¯å»ºç«‹åœ¨ç¾¤ä½“çš„å…±åŒä¿¡å¿µçš„åŸºç¡€ä¸Šçš„ï¼Œä»»ä½•å½¢å¼çš„æ··ä¹±éƒ½ä¼šå¯¼è‡´è¿™ç§ä¿¡å¿µçš„å´©å¡Œã€‚æ¯å¤šä¸€ä¸ªæŠ¥å¤ç¤¾ä¼šçš„äººï¼Œæ··ä¹±åº¦å°±å¢åŠ ä¸€åˆ†ï¼Œå¥´éš¶ç¤¾ä¼šä¹Ÿå°±å‘ç€åŸå§‹ä¸›æ—ç¤¾ä¼šæ›´é è¿‘ä¸€æ­¥ã€‚è€Œå½“è¶Šæ¥è¶Šå¤šçš„äººå¼€å§‹å…·æœ‰éšæœºçš„æ”»å‡»æ€§ï¼Œè¶Šæ¥è¶Šå¤šçš„ä¸ªä½“å¦‚åŒå¸ƒæœ—è¿åŠ¨èˆ¬æ¨ªå†²ç›´æ’ï¼Œç»Ÿæ²»è€…æœ€ç»ˆä¼šå‘ç°ï¼Œè‡ªå·±çš„ç¤¾ä¼šè§„åˆ™å†ä¹Ÿæ— æ³•é©¾é©­è¿™ä¸ªä¸æ–­å¢ç†µçš„ä¸–ç•Œï¼Œå¥´éš¶åˆ¶ä¹Ÿå°±èµ°åˆ°äº†å°½å¤´ã€‚\n","date":"2024-11-14T23:09:00Z","permalink":"https://liguobao.github.io/zh/p/how-to-end-sl-avery-in-a-modern-country-where-there-are/","title":"åœ¨æœ‰çƒ­æ­¦å™¨å¯ä»¥å‹åˆ¶æš´æ°‘çš„ç°ä»£å›½å®¶ï¼Œç»“æŸå¥´éš¶åˆ¶éœ€è¦æœ‰ä»€ä¹ˆæ¡ä»¶ï¼Ÿ"},{"content":"åœ¨ Linux æˆ– macOS ç³»ç»Ÿä¸­ï¼Œ\nä½ å¯ä»¥ä½¿ç”¨ du å‘½ä»¤æ¥è·å–å½“å‰æ–‡ä»¶å¤¹ä¸­æ¯ä¸ªä¸€çº§å­ç›®å½•çš„å¤§å°ã€‚å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š\n1 du -h --max-depth=1 -h é€‰é¡¹è¡¨ç¤ºä»¥äººç±»å¯è¯»çš„æ ¼å¼æ˜¾ç¤ºå¤§å°ï¼ˆä¾‹å¦‚ KBã€MB æˆ– GBï¼‰ã€‚ --max-depth=1 è¡¨ç¤ºåªæŸ¥çœ‹å½“å‰ç›®å½•ä¸‹çš„ä¸€çº§å­ç›®å½•çš„å¤§å°ã€‚ å¦‚æœä½ å¸Œæœ›ä»…æŸ¥çœ‹å½“å‰ç›®å½•çš„æ€»å¤§å°ï¼Œå¯ä»¥ä½¿ç”¨ï¼š\n1 du -sh . -s é€‰é¡¹è¡¨ç¤ºæ˜¾ç¤ºæ€»è®¡è€Œä¸æ˜¯é€ä¸ªåˆ—å‡ºæ¯ä¸ªç›®å½•ã€‚ ä¸Šè¿°å‘½ä»¤å¯ä»¥å¸®åŠ©ä½ å¿«é€Ÿäº†è§£å½“å‰æ–‡ä»¶å¤¹ä¸­æ¯ä¸ªå­ç›®å½•çš„å¤§å°ã€‚\n","date":"2024-08-07T08:00:00Z","permalink":"https://liguobao.github.io/zh/p/linux-du/","title":"Linux du å‘½ä»¤"},{"content":"npm.taobao.org https è¯ä¹¦è¿‡æœŸ è¿™ç©æ„è¿‡æœŸä¹Ÿä¸æ˜¯ä¸€ä¸¤å¤©äº†ï¼Œæ‰€æœ‰ç”¨äº†ä¾èµ–è¿™ä¸ªé•œåƒæºçš„éƒ½ä¼šç›´æ¥æŠ¥é”™ã€‚ å‰é˜µå­å› ä¸ºæŸ¥æ„å»ºå¤±è´¥é—®é¢˜ï¼ŒæŠ˜è…¾äº†å¥½å‡ ä¸ªå°æ—¶æ‰æ„è¯†åˆ°æ˜¯è¯ä¹¦è¿‡æœŸäº†ã€‚ ä¸€å¼€å§‹ä»¥ä¸ºæ˜¯è‡ªå·±çš„ç½‘ç»œé—®é¢˜ï¼Œåæ¥å‘ç°æ˜¯æºçš„é—®é¢˜ã€‚ è™½ç„¶è¿™ä¸ªåŸŸåå·²ç»è¢«cnameåˆ° registry.npmmirror.comï¼Œç„¶è€Œåœ¨npmçš„æ—¶å€™ï¼Œå¹¶ä¸ä¼šè‡ªåŠ¨è·³è½¬åˆ°è¿™ä¸ªæ–°çš„åŸŸåã€‚\nSoï¼Œä¾æ—§æ„å»ºå¤±è´¥ã€‚\nè§£å†³æ–¹æ¡ˆ 1 2 npm config set registry registry.npmmirror.com npm config set registry registry.npmjs.org å¦‚æœé¡¹ç›®æ ¹ç›®å½•æœ‰ .npmrc æ–‡ä»¶ï¼Œè®°å¾—è¦æ”¹ä¸‹è¿™ä¸ªæ–‡ä»¶ã€‚\n1 registry=https://registry.npmmirror.com åˆ‡è®° ä¸è¦è¿‡åº¦ä¾èµ–æŸå‚å•†çš„æœåŠ¡ï¼Œå°¤å…¶æ˜¯å›½å†…çš„ã€‚ æœ‰æ—¶å€™ï¼Œä¸å¦‚ç›´æ¥ç”¨å®˜æ–¹æºã€‚ ","date":"2024-08-06T08:00:00Z","image":"https://liguobao.github.io/zh/p/npm-taobao-org-exp/npm_hu_b554f7cef0ad70f3.png","permalink":"https://liguobao.github.io/zh/p/npm-taobao-org-exp/","title":"npm.taobao.org æ·˜å®é•œåƒæºè¯ä¹¦è¿‡æœŸè§£å†³æ–¹æ¡ˆ"},{"content":"ç¤¾åŒºæ•´ä½“ç­–ç•¥ å›ç­”ä¸ºä¸» ä»¥è¿è¥å›¢é˜Ÿä¸ºæ ¸å¿ƒï¼Œäº§ç ”é©±åŠ¨ã€‚\nåˆ›ä½œè€…ä¸ºä¸­å¿ƒï¼Œåˆ›ä½œä¸ºç‹ã€‚\nçŸ¥ä¹ä¸ºæ·±åº¦å†…å®¹ç¤¾åŒºã€‚\näº§ç ”é©±åŠ¨æœ‰ä»€ä¹ˆ å±…å§”ä¼šã€ç­”ä¸»ä¸ºä¸šä¸» æ¨èç®—æ³•å‡çº§ å†·å¯åŠ¨ä¼˜åŒ– ç®—æ³•ç›®çš„è°ƒæ•´ ç¤¾åŒºæ²»ç†ï¼ˆå¼•æˆ˜ã€å¯¹ç«‹ã€å†…å®¹ç®¡æ§ï¼›å¤§æ¦‚2%è¯„è®ºç›´æ¥è¢«æ¸…ç†ã€‚ï¼‰ ç”Ÿæ€ç»“æ„ã€é¼“åŠ±ä¸“ä¸šå‚ç›´ ä»¥å‰ï¼Œæµé‡ä¸ºç‹ï¼ŒPVã€UV ä¸ºæ ¸å¿ƒæŒ‡æ ‡ã€‚\nå½“å‰ï¼Œæ·±åº¦å†…å®¹ã€äº’åŠ¨ä¸ºé‡è¦æŒ‡æ ‡ã€‚\nçƒ­æ¦œä½“éªŒä¼˜åŒ– é™ä½å¼•æˆ˜ã€å¯¹ç«‹ å†…å®¹è¿è¥ç­–ç•¥è°ƒæ•´ äº§å“ä½“éªŒï¼šå–æ¶ˆæŠ˜å ã€æ–°å¢ç²¾é€‰ é—®é¢˜é¡µæ’åºï¼šä½è´¨æ‰“å‹ã€TPRä¼˜åŒ– True Positive Rate 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 TPRæ’åºï¼Œå…¨ç§°ä¸º\u0026#34;True Positive Rate\u0026#34;æ’åºï¼Œæ˜¯ä¸€ç§åœ¨æ•°æ®ç§‘å­¦å’Œæœºå™¨å­¦ä¹ é¢†åŸŸå¸¸ç”¨çš„æ€§èƒ½è¯„ä¼°æ–¹å¼ï¼Œå°¤å…¶åœ¨å¤„ç†åˆ†ç±»ä»»åŠ¡æ—¶ã€‚\u0026#34;True Positive Rate\u0026#34;ï¼ˆçœŸæ­£ä¾‹ç‡ï¼‰ï¼Œä¹Ÿè¢«ç§°ä¸ºæ•æ„Ÿåº¦ï¼ˆSensitivityï¼‰æˆ–å¬å›ç‡ï¼ˆRecallï¼‰ï¼Œæ˜¯ç”¨äºè¡¡é‡æ¨¡å‹æ­£ç¡®è¯†åˆ«æ­£ç±»çš„èƒ½åŠ›ã€‚ åœ¨åˆ†ç±»ä»»åŠ¡ä¸­ï¼Œå°†æ•°æ®é›†åˆ†ä¸ºæ­£ç±»ï¼ˆæˆ‘ä»¬æ„Ÿå……è¶£çš„ç±»ï¼‰å’Œè´Ÿç±»ã€‚å¯¹äºä¸€ä¸ªç»™å®šçš„åˆ†ç±»æ¨¡å‹ï¼š - çœŸæ­£ä¾‹ï¼ˆTrue Positive, TPï¼‰çš„æ•°é‡æ˜¯æ¨¡å‹æ­£ç¡®é¢„æµ‹ä¸ºæ­£ç±»çš„æ ·æœ¬æ•°é‡ã€‚ - å‡æ­£ä¾‹ï¼ˆFalse Positive, FPï¼‰çš„æ•°é‡æ˜¯æ¨¡å‹é”™è¯¯é¢„æµ‹ä¸ºæ­£ç±»çš„æ ·æœ¬æ•°é‡ï¼ˆå®é™…ä¸Šæ˜¯è´Ÿç±»ï¼‰ã€‚ - çœŸè´Ÿä¾‹ï¼ˆTrue Negative, TNï¼‰çš„æ•°é‡æ˜¯æ¨¡å‹æ­£ç¡®é¢„æµ‹ä¸ºè´Ÿç±»çš„æ ·æœ¬æ•°é‡ã€‚ - å‡è´Ÿä¾‹ï¼ˆFalse Negative, FNï¼‰çš„æ•°é‡æ˜¯æ¨¡å‹é”™è¯¯é¢„æµ‹ä¸ºè´Ÿç±»çš„æ ·æœ¬æ•°é‡ï¼ˆå®é™…ä¸Šæ˜¯æ­£ç±»ï¼‰ã€‚ True Positive Rateï¼ˆTPRï¼‰çš„è®¡ç®—æ–¹æ³•å¦‚ä¸‹ï¼š \\[ TPR = \\frac{TP}{TP + FN} \\] è¿™ä¸ªæ¯”ä¾‹åæ˜ äº†æ‰€æœ‰å®é™…æ­£ç±»æ ·æœ¬ä¸­ï¼Œè¢«æ¨¡å‹æ­£ç¡®è¯†åˆ«å‡ºæ¥çš„æ¯”ä¾‹ã€‚TPRè¶Šé«˜ï¼Œè¡¨ç¤ºæ¨¡å‹å¯¹æ­£ç±»çš„è¯†åˆ«èƒ½åŠ›è¶Šå¼ºã€‚ TPRæ’åºå®é™…ä¸Šæ˜¯æ ¹æ®ä¸åŒé…ç½®ã€é˜ˆå€¼æˆ–æ¨¡å‹ä¸‹çš„TPRå€¼æ¥è¿›è¡Œæ’åºï¼Œä»è€Œè¯„ä¼°å’Œé€‰æ‹©æœ€ä¼˜çš„æ¨¡å‹æˆ–è®¾ç½®ã€‚åœ¨æŸäº›åº”ç”¨åœºæ™¯ï¼Œå¦‚ç–¾ç—…ç­›æŸ¥æˆ–æ¬ºè¯ˆæ£€æµ‹ä¸­ï¼Œé«˜TPRå°¤ä¸ºé‡è¦ï¼Œå› ä¸ºæˆ‘ä»¬å¸Œæœ›å°½å¯èƒ½å¤šåœ°è¯†åˆ«å‡ºæ‰€æœ‰å¯èƒ½çš„æ­£ç±»ï¼ˆå¦‚ç—…ä¾‹æˆ–æ¬ºè¯ˆè¡Œä¸ºï¼‰ï¼Œå³ä½¿è¿™æ„å‘³ç€ä¼šæœ‰æ›´å¤šçš„å‡æ­£ä¾‹ï¼ˆFPï¼‰ã€‚ ç»¼ä¸Šï¼ŒTPRæ’åºæ˜¯ä¸€ç§ä»¥æ¨¡å‹æˆ–æ–¹æ³•çš„çœŸæ­£ä¾‹ç‡ä½œä¸ºæ ‡å‡†è¿›è¡Œæ¯”è¾ƒå’Œæ’åºçš„æ–¹æ³•ï¼Œå¹¿æ³›åº”ç”¨äºæ¨¡å‹é€‰æ‹©å’Œæ€§èƒ½æ¯”è¾ƒä¸­ã€‚ ç”¨æˆ·æ²Ÿé€šæœºåˆ¶ åé¦ˆ AIå†…å®¹çš„æ€åº¦ è§‚ç‚¹æå–ã€ç›¸ä¼¼åº¦ã€è´¨é‡ã€å¯ä¿¡åº¦ æŠ„è¢­è¯†åˆ«ä¸æ‰“å‡» åçˆ¬è™«ï¼ˆSEOå±è”½äº†ï¼Ÿï¼‰ AIGCã€Spam è¯†åˆ« -\u0026gt; é™åˆ¶åˆ†å‘ã€å¯¹äºæ¶æ„è´¦å·å¤„ç½®\nAIè‡ªå·±çš„â€œAIç›´ç­”â€å‘¢ï¼Ÿå¼•ç”¨äº†è°çš„å†…å®¹åšäº†ä»€ä¹ˆå›ç­”ï¼Ÿç»™äº†\nFor ä½œè€…ä½“éªŒ å¥½é—®é¢˜ æé—®è¢«å¼±åŒ–äº† é‡å¤é—®é¢˜å‘¢ï¼Ÿåˆ·é—®é¢˜çš„å‘¢ï¼Ÿï¼ˆæˆ‘èƒ½çœ‹åˆ°éƒ¨åˆ†ç”¨æˆ·å‡ åƒä¸ªæé—®å’Œç¼–è¾‘é—®é¢˜ï¼‰ã€‚è¿™å—çš„åä½œå¼Šå‘¢ï¼Ÿ æ¶ˆæ¯æé†’ä¼˜åŒ– ä¸“æ  å‡çº§ã€æ›å…‰ã€å¢åŠ æµé€šã€æ”¯æŒä»˜è´¹ çŸ¥ä¹æ—¥æŠ¥å‘¢ï¼Ÿ SEOå¾ˆé«˜ï¼Œå†…å®¹è´¨é‡å¾ˆé«˜ï¼ˆä»€ä¹ˆæ—¶å€™èƒ½é‡æ–°å¼€æ”¾ï¼Ÿï¼‰ çŸ¥ä¹ç›´ç­”-AIæœç´¢ ? ","date":"2024-07-28T08:00:00Z","permalink":"https://liguobao.github.io/zh/p/zhihu-salon-0728/","title":"çŸ¥ä¹ç›æ²™é¾™-20240728"},{"content":"Visual Studio 2022 é…ç½® Git Bash\nä¸éœ€è¦èµ˜è¨€ how-can-i-use-a-git-bash-terminal-profile-in-visual-studio-2019\nShell Location:C:\\Program Files\\Git\\bin\\sh.exe\nè·¯å¾„\nC:\\Program Files\\Git\\bin\\sh.exe\nå¦‚æœä½ çš„å®‰è£…ç›®å½•ä¸åœ¨è¿™é‡Œï¼Œè‡ªè¡Œè°ƒæ•´å“ˆã€‚\nå‚æ•°\n\u0026ndash;login -i -l\næœ€ç»ˆæ•ˆæœã€‚\n","date":"2024-07-27T08:00:00Z","image":"https://liguobao.github.io/zh/p/vs-git-bash/bash_hu_2b7c3f3d3912770d.jpg","permalink":"https://liguobao.github.io/zh/p/vs-git-bash/","title":"Visual Studio æ·»åŠ Git Bash åˆ°ç»ˆç«¯"},{"content":"éœ€æ±‚ ä¹‹å‰åœ¨C++å®ç°è¿‡ä¸€ä¸ªè·å–ç¡¬ä»¶ä¿¡æ¯çš„æ¥å£ï¼Œ\nç”¨çš„æ˜¯ hwinfo,\nå¤§æ¦‚è¿”å›äº†ä¸‹é¢çš„ç¡¬ä»¶ä¿¡æ¯ã€‚\n1 { \u0026#34;cpuModel\u0026#34;: \u0026#34;12th Gen Intel(R) Core(TM) i7-12700K\u0026#34;, \u0026#34;gpuName\u0026#34;: \u0026#34;Microsoft Remote Display Adapter | NVIDIA GeForce RTX 3070\u0026#34;, \u0026#34;ramVendor\u0026#34;: \u0026#34;A-DATA Technology\u0026#34;, \u0026#34;ramSerialNumber\u0026#34;: \u0026#34;CC500\u0026#34;, \u0026#34;ramTotalSizeBytes\u0026#34;: 34359740000, \u0026#34;ramFreeSizeBytes\u0026#34;: -1, \u0026#34;mainBoardVendor\u0026#34;: \u0026#34;Rev 1.xx\u0026#34;, \u0026#34;mainBoardName\u0026#34;: \u0026#34;PRIME Z690-P D4\u0026#34;, \u0026#34;mainBoardSerialNumber\u0026#34;: \u0026#34;xxx\u0026#34;, \u0026#34;disks\u0026#34;: [ { \u0026#34;model\u0026#34;: \u0026#34;ST12000VN0008-2YS101\u0026#34;, \u0026#34;serialNumber\u0026#34;: \u0026#34; ZRT0DJ\u0026#34;, \u0026#34;size\u0026#34;: \u0026#34;12000132426240\u0026#34;, \u0026#34;freeSize\u0026#34;: \u0026#34;-1\u0026#34; }, { \u0026#34;model\u0026#34;: \u0026#34;Samsung SSD 980 1TB\u0026#34;, \u0026#34;serialNumber\u0026#34;: \u0026#34;0025.\u0026#34;, \u0026#34;size\u0026#34;: \u0026#34;1000202273280\u0026#34;, \u0026#34;freeSize\u0026#34;: \u0026#34;-1\u0026#34; }, { \u0026#34;model\u0026#34;: \u0026#34;WDC WD10EZEX-00BBHA0\u0026#34;, \u0026#34;serialNumber\u0026#34;: \u0026#34; WD-WATM2266\u0026#34;, \u0026#34;size\u0026#34;: \u0026#34;1000202273280\u0026#34;, \u0026#34;freeSize\u0026#34;: \u0026#34;-1\u0026#34; } ], \u0026#34;osOperatingSystem\u0026#34;: \u0026#34;19044\u0026#34;, \u0026#34;osShortName\u0026#34;: \u0026#34;Windows\u0026#34;, \u0026#34;osArchitecture\u0026#34;: \u0026#34;32 bit\u0026#34;, \u0026#34;diskTotalSize\u0026#34;: 14000536972800, \u0026#34;logicDiskTotalFreeSpace\u0026#34;: 0 } ä»£ç æ²¡æ’’çœ‹çš„ï¼ŒåŸºæœ¬éƒ½æ˜¯è°ƒåº“ï¼Œhwinfo çš„æ ·ä¾‹å†™å¾—è¿˜ä¸é”™~\nä¸è¿‡å‰å‡ å¤©å‘ç°è¿™ç©æ„å¶å°”ä¼šå´©æ‰ï¼Œ\né”™è¯¯æ˜¯0000005ï¼Œåº”è¯¥æ˜¯å†…å­˜è®¿é—®é”™è¯¯ï¼Œ\né“ç†æ¥æ˜¯ä¸ªç©ºå¼•ç”¨è§¦å‘çš„ã€‚\nè€æ—©ä¹‹å‰è¿˜ç»™è¿™ä¸ªåº“ä¿®ä¸ªå­—ç¬¦ä¸²ç¼–ç çš„Bugï¼Œ\nåœ¨åé¢è€å“¥åº”è¯¥è¿˜å‡çº§è¿‡å‡ ä¸ªç‰ˆæœ¬ï¼Œ\næˆ‘è‡ªå·±å¤ªå¿™äº†ä¹Ÿå°±æ²¡ç©ºå†æŠ˜è…¾äº†ã€‚\næƒ³äº†ä¸‹ï¼Œ\nç®—äº†ï¼Œå…ˆç”¨Pythonå®ç°ä¸€ä¸ªå§ã€‚\né—®é—®GPTï¼Ÿ Qï¼š 1ã€æˆ‘æƒ³åœ¨Python3 ä¸­å®ç°ç”µè„‘ç¡¬ä»¶ä¿¡æ¯è¯»å–ï¼Œè¿”å›ä¸Šé¢çš„JSONï¼Œè¯·é—®å¦‚ä½•å¤„ç†ã€‚ 2ã€å¸®æˆ‘å…¼å®¹ä¸€ä¸‹ï¼Œå¦‚æœä¸åœ¨Windowså¹³å°çš„è¯ï¼Œå°½å¯èƒ½ç»™è¶³å¤Ÿçš„ä¿¡æ¯å›å»ï¼Œæ²¡æœ‰çš„ä¿¡æ¯ç»™é»˜è®¤å€¼å³å¯ã€‚ 3ã€å¯¹åº”çš„åº“ç‰ˆæœ¬æ˜¯å“ªäº›ï¼Ÿç»™æˆ‘ä¸ªrequirements\nAï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 import psutil import cpuinfo import GPUtil import platform import json def get_cpu_info(): try: cpu = cpuinfo.get_cpu_info() return cpu[\u0026#39;brand_raw\u0026#39;] except Exception as e: return f\u0026#34;Unknown CPU ({e})\u0026#34; def get_gpu_info(): try: gpus = GPUtil.getGPUs() return \u0026#34; | \u0026#34;.join([gpu.name for gpu in gpus]) except Exception as e: return f\u0026#34;Unknown GPU ({e})\u0026#34; def get_ram_info(): try: if platform.system() == \u0026#34;Windows\u0026#34;: import wmi c = wmi.WMI() for memory in c.Win32_PhysicalMemory(): ram_vendor = memory.Manufacturer ram_serial_number = memory.SerialNumber ram_total_size = int(memory.Capacity) ram_free_size = psutil.virtual_memory().available return ram_vendor, ram_serial_number, ram_total_size, ram_free_size else: vm = psutil.virtual_memory() return \u0026#34;Unknown Vendor\u0026#34;, \u0026#34;Unknown Serial\u0026#34;, vm.total, vm.available except Exception as e: return \u0026#34;Unknown Vendor\u0026#34;, \u0026#34;Unknown Serial\u0026#34;, -1, -1 def get_mainboard_info(): try: if platform.system() == \u0026#34;Windows\u0026#34;: import wmi c = wmi.WMI() for board in c.Win32_BaseBoard(): mainboard_vendor = board.Manufacturer mainboard_name = board.Product mainboard_serial = board.SerialNumber return mainboard_vendor, mainboard_name, mainboard_serial else: return \u0026#34;Unknown Vendor\u0026#34;, \u0026#34;Unknown Board\u0026#34;, \u0026#34;Unknown Serial\u0026#34; except Exception as e: return \u0026#34;Unknown Vendor\u0026#34;, \u0026#34;Unknown Board\u0026#34;, f\u0026#34;Unknown Serial ({e})\u0026#34; def get_disk_info(): try: if platform.system() == \u0026#34;Windows\u0026#34;: import wmi c = wmi.WMI() disks = [] for disk in c.Win32_DiskDrive(): model = disk.Model serial_number = disk.SerialNumber.strip() size = int(disk.Size) disks.append({ \u0026#34;model\u0026#34;: model, \u0026#34;serialNumber\u0026#34;: serial_number, \u0026#34;size\u0026#34;: size, \u0026#34;freeSize\u0026#34;: -1 }) return disks else: disks = [] for disk in psutil.disk_partitions(): usage = psutil.disk_usage(disk.mountpoint) disks.append({ \u0026#34;model\u0026#34;: \u0026#34;Unknown Model\u0026#34;, \u0026#34;serialNumber\u0026#34;: \u0026#34;Unknown Serial\u0026#34;, \u0026#34;size\u0026#34;: usage.total, \u0026#34;freeSize\u0026#34;: usage.free }) return disks except Exception as e: return [{\u0026#34;model\u0026#34;: \u0026#34;Unknown\u0026#34;, \u0026#34;serialNumber\u0026#34;: \u0026#34;Unknown\u0026#34;, \u0026#34;size\u0026#34;: -1, \u0026#34;freeSize\u0026#34;: -1}] def get_os_info(): try: os_version = platform.version() os_short_name = platform.system() os_arch = platform.architecture()[0] return os_version, os_short_name, os_arch except Exception as e: return \u0026#34;Unknown\u0026#34;, \u0026#34;Unknown\u0026#34;, \u0026#34;Unknown\u0026#34; def get_total_disk_size_and_free_space(): try: total_size = 0 total_free_space = 0 for partition in psutil.disk_partitions(): try: usage = psutil.disk_usage(partition.mountpoint) total_size += usage.total total_free_space += usage.free except PermissionError: continue # é¿å…æŸäº›ç£ç›˜æ²¡æœ‰æƒé™è®¿é—®å¯¼è‡´çš„é”™è¯¯ return total_size, total_free_space except Exception as e: return -1, -1 def get_hardware_info(): cpu_model = get_cpu_info() gpu_name = get_gpu_info() ram_vendor, ram_serial_number, ram_total_size, ram_free_size = get_ram_info() mainboard_vendor, mainboard_name, mainboard_serial_number = get_mainboard_info() disks = get_disk_info() os_version, os_short_name, os_arch = get_os_info() total_disk_size, total_free_space = get_total_disk_size_and_free_space() return { \u0026#34;cpuModel\u0026#34;: cpu_model, \u0026#34;gpuName\u0026#34;: gpu_name, \u0026#34;ramVendor\u0026#34;: ram_vendor, \u0026#34;ramSerialNumber\u0026#34;: ram_serial_number, \u0026#34;ramTotalSizeBytes\u0026#34;: ram_total_size, \u0026#34;ramFreeSizeBytes\u0026#34;: ram_free_size, \u0026#34;mainBoardVendor\u0026#34;: mainboard_vendor, \u0026#34;mainBoardName\u0026#34;: mainboard_name, \u0026#34;mainBoardSerialNumber\u0026#34;: mainboard_serial_number, \u0026#34;disks\u0026#34;: disks, \u0026#34;osOperatingSystem\u0026#34;: os_version, \u0026#34;osShortName\u0026#34;: os_short_name, \u0026#34;osArchitecture\u0026#34;: os_arch, \u0026#34;diskTotalSize\u0026#34;: total_disk_size, \u0026#34;logicDiskTotalFreeSpace\u0026#34;: total_free_space } if __name__ == \u0026#34;__main__\u0026#34;: hardware_info = get_hardware_info() print(json.dumps(hardware_info, indent=2)) ä¼˜åŒ– get_hardware_info è¿™ä¸ªå‡½æ•°æ‰§è¡Œæ¯”è¾ƒæ…¢ï¼Œèƒ½ä¼˜åŒ–ä¸€ä¸‹å—ï¼Ÿ éƒ¨åˆ†ä¿¡æ¯è·å–ä¹‹ååº”è¯¥æ˜¯å¯ä»¥ç¼“å­˜èµ·æ¥çš„ æˆ‘ä½¿ç”¨çš„lorugu åº“ï¼Œè¯·å¸®æˆ‘åŠ ä¸€äº›æ—¥å¿—ï¼Œç¡®è®¤ä¸€ä¸‹è°ƒç”¨è€—æ—¶ æˆ‘çš„æ—¥å¿—ä½¿ç”¨æ ‡å‡†è¾“å‡ºå³å¯ï¼Œä¸ç”¨å†™æ–‡ä»¶ï¼›lru_cache å¯ä»¥è®¾ç½®è¿‡æœŸæ—¶é—´å—? get_cpu_infoå¤ªæ…¢äº† 2024-07-05 16:24:16.370 | INFO | main:get_cpu_info:54 - get_cpu_info() took 1.1144 seconds\ncpu = cpuinfo.get_cpu_info() ä¸ºå˜›å®ƒè¿™ä¹ˆæ…¢ï¼Œæœ‰å…¶ä»–çš„å®ç°å—ï¼Ÿ\næœ€ç»ˆä»£ç \n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 import psutil import GPUtil import platform import json import time import subprocess from functools import wraps from loguru import logger from datetime import datetime, timedelta # é…ç½® loguru å°†æ—¥å¿—è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡º logger.remove() logger.add(lambda msg: print(msg, end=\u0026#39;\u0026#39;)) # è‡ªå®šä¹‰ç¼“å­˜è£…é¥°å™¨ def timed_lru_cache(seconds: int, maxsize: int = 128): def wrapper(func): cache = {} cache_expiration = {} @wraps(func) def inner(*args): now = datetime.now() # æ¸…é™¤è¿‡æœŸç¼“å­˜ for key in list(cache_expiration): if cache_expiration[key] \u0026lt; now: cache.pop(key, None) cache_expiration.pop(key, None) if args in cache: return cache[args] result = func(*args) cache[args] = result cache_expiration[args] = now + timedelta(seconds=seconds) if len(cache) \u0026gt; maxsize: oldest = min(cache_expiration, key=cache_expiration.get) cache.pop(oldest, None) cache_expiration.pop(oldest, None) return result return inner return wrapper @timed_lru_cache(60) def get_cpu_info(): start_time = time.time() try: if platform.system() == \u0026#34;Windows\u0026#34;: result = subprocess.run([\u0026#39;wmic\u0026#39;, \u0026#39;cpu\u0026#39;, \u0026#39;get\u0026#39;, \u0026#39;Name\u0026#39;], stdout=subprocess.PIPE, stderr=subprocess.PIPE, text=True) cpu_model = result.stdout.split(\u0026#39;\\n\u0026#39;)[1].strip() elif platform.system() == \u0026#34;Linux\u0026#34;: result = subprocess.run([\u0026#39;lscpu\u0026#39;], stdout=subprocess.PIPE, stderr=subprocess.PIPE, text=True) for line in result.stdout.split(\u0026#39;\\n\u0026#39;): if \u0026#39;Model name\u0026#39; in line: cpu_model = line.split(\u0026#39;:\u0026#39;)[1].strip() break elif platform.system() == \u0026#34;Darwin\u0026#34;: result = subprocess.run([\u0026#39;sysctl\u0026#39;, \u0026#39;-n\u0026#39;, \u0026#39;machdep.cpu.brand_string\u0026#39;], stdout=subprocess.PIPE, stderr=subprocess.PIPE, text=True) cpu_model = result.stdout.strip() else: cpu_model = \u0026#34;Unsupported platform\u0026#34; except Exception as e: cpu_model = f\u0026#34;Unknown CPU ({e})\u0026#34; end_time = time.time() logger.info(f\u0026#34;get_cpu_info() took {end_time - start_time:.3f} seconds\u0026#34;) return cpu_model @timed_lru_cache(60) def get_gpu_info(): start_time = time.time() try: gpus = GPUtil.getGPUs() gpu_name = \u0026#34; | \u0026#34;.join([gpu.name for gpu in gpus]) except Exception as e: gpu_name = f\u0026#34;Unknown GPU ({e})\u0026#34; end_time = time.time() logger.info(f\u0026#34;get_gpu_info() took {end_time - start_time:.3f} seconds\u0026#34;) return gpu_name @timed_lru_cache(60) def get_ram_info(): start_time = time.time() try: if platform.system() == \u0026#34;Windows\u0026#34;: import wmi c = wmi.WMI() for memory in c.Win32_PhysicalMemory(): ram_vendor = memory.Manufacturer ram_serial_number = memory.SerialNumber ram_total_size = int(memory.Capacity) ram_free_size = psutil.virtual_memory().available break else: vm = psutil.virtual_memory() ram_vendor, ram_serial_number, ram_total_size, ram_free_size = \u0026#34;Unknown Vendor\u0026#34;, \u0026#34;Unknown Serial\u0026#34;, vm.total, vm.available except Exception as e: ram_vendor, ram_serial_number, ram_total_size, ram_free_size = \u0026#34;Unknown Vendor\u0026#34;, \u0026#34;Unknown Serial\u0026#34;, -1, -1 end_time = time.time() logger.info(f\u0026#34;get_ram_info() took {end_time - start_time:.3f} seconds\u0026#34;) return ram_vendor, ram_serial_number, ram_total_size, ram_free_size @timed_lru_cache(60) def get_mainboard_info(): start_time = time.time() try: if platform.system() == \u0026#34;Windows\u0026#34;: import wmi c = wmi.WMI() for board in c.Win32_BaseBoard(): mainboard_vendor = board.Manufacturer mainboard_name = board.Product mainboard_serial = board.SerialNumber break else: mainboard_vendor, mainboard_name, mainboard_serial = \u0026#34;Unknown Vendor\u0026#34;, \u0026#34;Unknown Board\u0026#34;, \u0026#34;Unknown Serial\u0026#34; except Exception as e: mainboard_vendor, mainboard_name, mainboard_serial = \u0026#34;Unknown Vendor\u0026#34;, \u0026#34;Unknown Board\u0026#34;, f\u0026#34;Unknown Serial ({e})\u0026#34; end_time = time.time() logger.info(f\u0026#34;get_mainboard_info() took {end_time - start_time:.3f} seconds\u0026#34;) return mainboard_vendor, mainboard_name, mainboard_serial @timed_lru_cache(60) def get_disk_info(): start_time = time.time() try: if platform.system() == \u0026#34;Windows\u0026#34;: import wmi c = wmi.WMI() disks = [] for disk in c.Win32_DiskDrive(): model = disk.Model serial_number = disk.SerialNumber.strip() size = int(disk.Size) disks.append({ \u0026#34;model\u0026#34;: model, \u0026#34;serialNumber\u0026#34;: serial_number, \u0026#34;size\u0026#34;: size, \u0026#34;freeSize\u0026#34;: -1 }) else: disks = [] for disk in psutil.disk_partitions(): usage = psutil.disk_usage(disk.mountpoint) disks.append({ \u0026#34;model\u0026#34;: \u0026#34;Unknown Model\u0026#34;, \u0026#34;serialNumber\u0026#34;: \u0026#34;Unknown Serial\u0026#34;, \u0026#34;size\u0026#34;: usage.total, \u0026#34;freeSize\u0026#34;: usage.free }) except Exception as e: disks = [{\u0026#34;model\u0026#34;: \u0026#34;Unknown\u0026#34;, \u0026#34;serialNumber\u0026#34;: \u0026#34;Unknown\u0026#34;, \u0026#34;size\u0026#34;: -1, \u0026#34;freeSize\u0026#34;: -1}] end_time = time.time() logger.info(f\u0026#34;get_disk_info() took {end_time - start_time:.3f} seconds\u0026#34;) return disks @timed_lru_cache(60) def get_os_info(): start_time = time.time() try: os_version = platform.version() os_short_name = platform.system() os_arch = platform.architecture()[0] except Exception as e: os_version, os_short_name, os_arch = \u0026#34;Unknown\u0026#34;, \u0026#34;Unknown\u0026#34;, \u0026#34;Unknown\u0026#34; end_time = time.time() logger.info(f\u0026#34;get_os_info() took {end_time - start_time:.3f} seconds\u0026#34;) return os_version, os_short_name, os_arch @timed_lru_cache(60) def get_total_disk_size_and_free_space(): start_time = time.time() try: total_size = 0 total_free_space = 0 for partition in psutil.disk_partitions(): try: usage = psutil.disk_usage(partition.mountpoint) total_size += usage.total total_free_space += usage.free except PermissionError: continue # é¿å…æŸäº›ç£ç›˜æ²¡æœ‰æƒé™è®¿é—®å¯¼è‡´çš„é”™è¯¯ except Exception as e: total_size, total_free_space = -1, -1 end_time = time.time() logger.info(f\u0026#34;get_total_disk_size_and_free_space() took {end_time - start_time:.3f} seconds\u0026#34;) return total_size, total_free_space def get_hardware_info(): start_time = time.time() cpu_model = get_cpu_info() gpu_name = get_gpu_info() ram_vendor, ram_serial_number, ram_total_size, ram_free_size = get_ram_info() mainboard_vendor, mainboard_name, mainboard_serial_number = get_mainboard_info() disks = get_disk_info() os_version, os_short_name, os_arch = get_os_info() total_disk_size, total_free_space = get_total_disk_size_and_free_space() end_time = time.time() logger.info(f\u0026#34;get_hardware_info() took {end_time - start_time:.3f} seconds\u0026#34;) return { \u0026#34;cpuModel\u0026#34;: cpu_model, \u0026#34;gpuName\u0026#34;: gpu_name, \u0026#34;ramVendor\u0026#34;: ram_vendor, \u0026#34;ramSerialNumber\u0026#34;: ram_serial_number, \u0026#34;ramTotalSizeBytes\u0026#34;: ram_total_size, \u0026#34;ramFreeSizeBytes\u0026#34;: ram_free_size, \u0026#34;mainBoardVendor\u0026#34;: mainboard_vendor, \u0026#34;mainBoardName\u0026#34;: mainboard_name, \u0026#34;mainBoardSerialNumber\u0026#34;: mainboard_serial_number, \u0026#34;disks\u0026#34;: disks, \u0026#34;osOperatingSystem\u0026#34;: os_version, \u0026#34;osShortName\u0026#34;: os_short_name, \u0026#34;osArchitecture\u0026#34;: os_arch, \u0026#34;diskTotalSize\u0026#34;: total_disk_size, \u0026#34;logicDiskTotalFreeSpace\u0026#34;: total_free_space } if __name__ == \u0026#34;__main__\u0026#34;: hardware_info = get_hardware_info() print(json.dumps(hardware_info, indent=2)) requirements.txt 1 2 3 4 5 psutil==5.9.5 gputil==1.4.0 WMI==1.5.1; sys_platform == \u0026#39;win32\u0026#39; pywin32==306; sys_platform == \u0026#39;win32\u0026#39; loguru==0.5.3 æ€»ç»“ æˆ‘ä¸€å¥ä»£ç éƒ½æ²¡å†™ã€‚jpg ç¡®å®GPTè¿‡äºå¼ºå¤§ã€‚jpg GPTç¡®å®éœ€è¦è°ƒæ•™ã€‚jpg ","date":"2024-07-08T08:00:00Z","image":"https://liguobao.github.io/zh/p/how-to-get-hwinfo-by-python/logo_hu_2b170d60a8edc426.png","permalink":"https://liguobao.github.io/zh/p/how-to-get-hwinfo-by-python/","title":"é€šè¿‡Pythonè·å–è®¡ç®—æœºçš„ç¡¬ä»¶ä¿¡æ¯ï¼ŒåŒ…æ‹¬CPUã€GPUã€å†…å­˜ã€ä¸»æ¿ã€ç¡¬ç›˜ã€æ“ä½œç³»ç»Ÿç­‰ã€‚"},{"content":"å‰è¨€ ä¹Ÿä¸è¦é—®ä¸ºä»€ä¹ˆè¦æè¿™ä¸ªäº†ï¼Œ\nä½ éƒ½çœ‹åˆ°è¿™ä¸ªæ–‡ç« çš„è¯ï¼Œ\nè¿˜æœ‰å…´è¶£çœ‹ä¸‹å»çš„è¯ï¼Œ\né‚£å°±æ˜¯ä½ ä¹Ÿæœ‰è¿™ä¸ªéœ€æ±‚äº†ã€‚\nä»€ä¹ˆæ˜¯ Magisk Introduction Magisk is a suite of open source software for customizing Android,\nsupporting devices higher than Android 6.0.\nSome highlight features:\nMagiskSU: Provide root access for applications Magisk Modules: Modify read-only partitions by installing modules MagiskBoot: The most complete tool for unpacking and repacking Android boot images Zygisk: Run code in every Android applications\u0026rsquo; processes Powered by Magisk\næ“ä½œæ­¥éª¤é¢„è§ˆ è§£BLé” å®‰è£… Magisk App ä¸‹è½½å¯¹åº”ç³»ç»Ÿç‰ˆæœ¬çš„ROMåŒ…æå–boot.img ä½¿ç”¨ Magisk ä¿®æ”¹boot.img åˆ·å…¥ä¿®æ”¹åçš„boot.img å®‰è£… Magisk æ¨¡å— äº«å—â€è‡ªç”±æ–°ä¸–ç•Œâ€œ è§£BLé” è›‡æœ‰è›‡è·¯ï¼Œshuæœ‰shuè·¯ï¼Œè‡ªå·±çœ‹ç€åŠäº†ã€‚ å°ç±³è®¾å¤‡å¯ä»¥å‚è€ƒ Xiaomi è§£BLé” ä¸€åŠ è®¾å¤‡å¯ä»¥å‚è€ƒ OnePlus é˜¿æœ¨å¤§ä¾  å…¶ä»–è®¾å¤‡è¯·è‡ªè¡Œæœç´¢ 2024å¹´ï¼Œæœ€å¥½è§£é”çš„è®¾å¤‡ï¼Œæ˜¯ OnePlus äº†ã€‚\nå…¶ä»–çš„ï¼Œéƒ½æ˜¯å¼Ÿå¼Ÿã€‚\nï¼ˆ æœ¬æ¥è€ƒè™‘è¦ä¸ä¹°å°å°ç±³14çš„ï¼Œå› ä¸ºBLé”åŠé€€äº†åå¹´ç±³ç²‰ï¼‰\nå®‰è£… Magisk App ä¸‹è½½ Magisk/releases ä¸‹è½½åï¼Œè‡ªè¡Œå®‰è£…åˆ°æ‰‹æœºä¸Šã€‚\n1 2 adb install Magisk-v26.4.apk æå–boot.img ä¸‹è½½å¯¹åº”ç³»ç»Ÿç‰ˆæœ¬çš„ROMåŒ…æå–boot.img å¦‚æœæ˜¯å¡åˆ·åŒ…ï¼Œå¯ä»¥ç›´æ¥è§£å‹ï¼Œæ‰¾åˆ°boot.img\nå¦‚æœæ˜¯çº¿åˆ·åŒ…ï¼Œè§£å‹ä¹‹åå¾—åˆ°çš„æ˜¯ playload.binï¼Œéœ€è¦ä½¿ç”¨å·¥å…·è§£å‹ã€‚\nWindowsä¸Šå¯ä»¥ä½¿ç”¨FastbootEnhanceå·¥å…·ï¼ŒMac/Linuxä¸Šå¯ä»¥ä½¿ç”¨payload_dumperå·¥å…·ã€‚\nåŸºæœ¬å¤§åŒå°å¼‚ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 ## ä½¿ç”¨ Magisk ç”Ÿæˆä¿®è¡¥åçš„boot.img - Magisk App -\u0026gt; Install -\u0026gt; Install -\u0026gt; Select and Patch a File -\u0026gt; é€‰æ‹©boot.img - ç­‰å¾…ç”Ÿæˆä¿®è¡¥åçš„boot.imgï¼Œè‡ªåŠ¨ä¿å­˜åˆ° /sdcard/Download/magisk_patched-xxx.img ## åˆ·å…¥ä¿®æ”¹åçš„boot.img - æ‰‹æœºè¿›å…¥Fastbootæ¨¡å¼ï¼Œè¿æ¥ç”µè„‘ ```sh # æ£€æŸ¥è®¾å¤‡æ˜¯å¦è¿æ¥æˆåŠŸ fastboot devices; # åˆ·å…¥ä¿®æ”¹åçš„boot.img fastboot flash boot /sdcard/Download/magisk_patched-xxx.img åˆ·å…¥å®Œæˆåï¼Œé‡å¯æ‰‹æœºã€‚\nMagisk æ¿€æ´» é‡å¯æ‰‹æœºä¹‹åï¼Œé‡æ–°æ‰“å¼€Magisk Appï¼Œç¬¬ä¸€æ¬¡åº”è¯¥ä¼šæç¤ºéœ€è¦å¯åŠ¨ä¿®å¤ã€‚\næ­£å¸¸æƒ…å†µä¸‹ï¼Œä¿®å¤å®Œæˆåä¼šé‡å¯æ‰‹æœºï¼Œå†æ¬¡å¼€æœºåå°±å®Œäº‹äº†ã€‚\nå®‰è£… Magisk æ¨¡å— ä¸‹è½½é¢å…·æ¨¡å—ï¼Œåœ¨æœ¬åœ°å®‰è£…å³å¯ã€‚ å¤§ä½“æµç¨‹åŸºæœ¬å¦‚æ­¤ã€‚\nå¸¸ç”¨å‘½ä»¤åˆ—è¡¨ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 # è¿›å…¥Fastbootæ¨¡å¼ adb reboot bootloader # æ£€æŸ¥fastbootè®¾å¤‡æ˜¯å¦è¿æ¥æˆåŠŸ fastboot devices #è§£é” fastboot oem unlock # å…¶ä»–è®¾å¤‡è§£BLé” fastboot flashing unlock # åˆ·å…¥boot.img fastboot flash boot ./Download/magisk_patched-xxx.img # é‡å¯ fastboot reboot LineageOS Build Archive ä¸‹è½½ LineageOS è€ç‰ˆæœ¬ lineageos æœ€æ–°ç‰ˆæœ¬ LineageOS è®¾ç½®ç½‘ç»œæ¢æµ‹åœ°å€ æ›´æ¢ captive è¿æ¥éªŒè¯æœåŠ¡å™¨\n1 2 3 4 5 6 7 8 adb shell settings delete global captive_portal_https_url adb shell settings delete global captive_portal_http_url adb shell settings put global captive_portal_https_url https://connect.rom.miui.com/generate_204 adb shell settings put global captive_portal_http_url http://connect.rom.miui.com/generate_204 ","date":"2024-07-05T08:00:00Z","image":"https://liguobao.github.io/zh/p/android-magisk-install/logo_hu_4faf4a02431817ba.png","permalink":"https://liguobao.github.io/zh/p/android-magisk-install/","title":"ç”¨ Magisk å¼€å§‹ä½ çš„å®‰å“æŠ˜è…¾ä¹‹è·¯"},{"content":"å‰è¨€ å¤§æ¦‚åœ¨å»å¹´è¿˜æ˜¯å‰å¹´çš„æ—¶å€™ï¼Œå› ä¸ºæ‰‹æœºæ¢æˆäº†iOSï¼Œæ²¡æœ‰å°çˆ±åŒå­¦äº†ä¹‹åï¼Œ\nåªèƒ½ä½¿ç”¨ç±³å®¶Appæ¥æ§åˆ¶ç±³å®¶è®¾å¤‡å®åœ¨è›‹ç–¼ï¼Œ\näºæ˜¯é‚£é˜µå­å°±æŠ˜è…¾è¿‡ HomeAssistant æ–¹æ¡ˆï¼Œ äºæ˜¯å†™è¿‡è¿™æ ·çš„æ–‡ç« ã€‚\nçŸ¥ä¹ä¸“æ ï¼šHome Assistant æ™ºèƒ½å®¶å±…ç³»ç»Ÿæ­å»ºæŒ‡å—ï¼ˆç±³å®¶+Siriï¼‰\nè¿™ä¸ªæ–¹æ¡ˆé…åˆHomePodéŸ³å“ï¼ŒåŸºæœ¬æ»¡è¶³äº†æˆ‘çš„éœ€æ±‚äº†ã€‚\nåé¢å®¶é‡ŒåŸºæœ¬æ˜¯å°±æ˜¯å„ç§è®¾å¤‡éƒ½æœ‰ä¸€ç‚¹ï¼ŒHomePodåŸºæœ¬å°±æ˜¯å…¨å±‹ä¸­æ§çš„å­˜åœ¨äº†ã€‚\nHome Assistant åœ¨å®¶é‡Œçš„ä¸»æœº24å°æ—¶è·‘ç€ï¼ŒåŸºæœ¬ä¹Ÿæ²¡å‡ºä»€ä¹ˆå²”å­ï¼Œä¹Ÿå°±å¾ˆä¹…ç»§ç»­æŠ˜è…¾äº†ã€‚\nåˆä¸€ä¸ªâ€œæ–°éœ€æ±‚â€ å¹´åˆæœ‰ä¸ªå¤§ä½¬æ‰¾è¿‡æˆ‘ï¼Œå’¨è¯¢èƒ½ä¸èƒ½åŸºäºç°åœ¨çš„ç±³å®¶æˆ–è€…å…¶ä»–ç¡¬ä»¶è®¾å¤‡ï¼Œè‡ªå·±åšå…¬å¯“çš„æ™ºèƒ½å®¶å±…æ–¹æ¡ˆã€‚\nåŸºäºä¸Šé¢çš„ä¸€äº›ç»éªŒï¼Œæˆ‘ä¹Ÿå°±ç»™äº†ä¸€äº›å»ºè®®ï¼Œä½†æ˜¯ä¹Ÿæ²¡æ·±å…¥å»ç ”ç©¶ã€‚\né‚£é˜µå­è®©æŸäºŒåå¹´è€å¸ˆå»æŠ˜è…¾äº†ä¸€ä¸‹DIYæ§åˆ¶ç±³å®¶è®¾å¤‡çš„æ–¹æ¡ˆï¼Œ\nè¿™æœ‹å‹çš„è¿›åº¦ä¸é‚£ä¹ˆç†æƒ³ï¼Œæœ€åä¹Ÿæ²¡å‡ºä»€ä¹ˆæˆæœã€‚\nåªæ˜¯é‚£é˜µå­çŸ¥é“äº†æœ‰ä¸€ä¸ª\ngithub.com/rytilahti/python-miio çš„å¥½å·¥å…·ã€‚\nPython library \u0026amp; console tool for controlling Xiaomi smart appliances ä¸€ä¸ªç”¨äºæ§åˆ¶å°ç±³æ™ºèƒ½å®¶å±…è®¾å¤‡çš„Pythonåº“å’Œæ§åˆ¶å°å·¥å…· å¾ˆæœ‰è¶£ï¼ŒMark ä¸€ä¸‹ã€‚\næœ€è¿‘çš„å®è·µ æœ€è¿‘å˜›ï¼Œåˆå› ä¸ºä¸€äº›å¥‡å¥‡æ€ªæ€ªçš„éœ€æ±‚ï¼Œéœ€è¦â€œæ­£å„¿å…«ç»â€æ¥æŠ˜è…¾ç±³å®¶è®¾å¤‡æ§åˆ¶æ–¹æ¡ˆäº†ã€‚\næœ€æ—©åšæ–¹æ¡ˆéªŒè¯çš„æ—¶å€™ï¼Œç”šè‡³æ˜¯ç”¨Appiumæ¥æ¨¡æ‹Ÿæ“ä½œç±³å®¶App\nä½†æ˜¯å˜›ï¼Œå¡é¡¿ï¼Œæ…¢ï¼Œä¸ç¨³å®š\u0026hellip;\nåˆ°äº†è¿™ä¸¤å‘¨å¼€å§‹è¿›å…¥æ­£å¼çš„å®è·µé˜¶æ®µï¼Œå†³å®šè¿˜æ˜¯ç”¨ python-miio æ¥æäº†ï¼Œ\nè™½ç„¶Hackï¼Œä½†æ˜¯è‚¯å®šæ¯”Appiumæ¥çš„ç¨³å®šã€‚\nSoï¼Œè®©æˆ‘ä»¬å¼€å§‹å§ã€‚\npython-miio èµ·æ‰‹ é¦–å…ˆï¼Œæˆ‘ä»¬å…ˆåœ¨æœ¬åœ°å®‰è£… python-miio\n1 2 3 4 5 6 7 # åˆ‡è®°ï¼Œè¯·ä¸è¦ç›´æ¥å®‰è£… pip install python-miio # é»˜è®¤çš„Releaseç‰ˆæœ¬æ˜¯0.5.12ï¼Œ22å¹´çš„ç‰ˆæœ¬äº† pip install python-miio==0.6.0.dev0 # æˆ–è€…ç›´æ¥ä»Githubä¸Šå®‰è£…æœ€æ–°çš„ç‰ˆæœ¬ pip install git+https://github.com/rytilahti/python-miio.git è¿™ä¸ªå®‰è£…å¥½äº†ä¹‹åï¼Œæœ¬åœ°å‘½ä»¤è¡Œç¯å¢ƒåº”è¯¥æœ‰äº† miiocli è¿™ä¸ªå‘½ä»¤è¡Œå·¥å…·äº†ã€‚\n1 2 3 4 5 6 7 8 âœ ~ miiocli --help Usage: miiocli [OPTIONS] COMMAND [ARGS]... Options: -d, --debug -o, --output [default|json|json_pretty] --version Show the version and exit. --help Show this message and exit. æ­£å¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åº”è¯¥å¯ä»¥é€šè¿‡ miiocli æ¥æ§åˆ¶æˆ‘ä»¬çš„ç±³å®¶è®¾å¤‡äº†ã€‚\né¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦æ‰¾åˆ°æˆ‘ä»¬çš„è®¾å¤‡çš„IPåœ°å€å’ŒTokenã€‚\nåé¢çš„æ‰€æœ‰æ“ä½œï¼Œéƒ½æ˜¯åŸºäºè¿™ä¸¤ä¸ªä¿¡æ¯æ¥è¿›è¡Œçš„ã€‚\nè·å–è®¾å¤‡IPåœ°å€å’ŒToken 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 âœ ~ miiocli cloud Username: ä½ çš„å°ç±³è´¦å· Password: ä½ çš„å¯†ç  == Xiaomi Smart Camera C400 (Device online ) == Model: chuangmi.camera.039a01 Token: XXX IP: 192.168.31.170 (mac: 94:F8:27:05:5B:AA) DID: 1029838640 Locale: cn == Xiaomiæ™ºèƒ½æ‘„åƒæœº (Device online ) == Model: chuangmi.camera.029a02 Token: XXX IP: 192.168.31.233 (mac: 60:7E:A4:C0:E6:26) DID: 525571884 Locale: cn == æ™ºèƒ½æ’åº§-Ubuntu (Device online ) == Model: chuangmi.plug.212a01 Token: XXX IP: 192.168.31.141 (mac: 58:B6:23:EB:11:EF) DID: 433609370 Locale: cn è¿™é‡ŒåŸºæœ¬èƒ½çœ‹åˆ°è‡ªå·±è´¦å·ä¸‹çš„è®¾å¤‡äº†ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥é€šè¿‡ miiocli å‘½ä»¤æ¥æ§åˆ¶è¿™äº›è®¾å¤‡äº†ã€‚\næ§åˆ¶è®¾å¤‡ 1 2 3 4 5 6 7 8 9 # è¿™æ˜¯ä¸€ä¸ªæ‘„åƒå¤´è®¾å¤‡ âœ ~ miiocli device --ip 192.168.31.170 --token xxxx info Running command info Model: chuangmi.camera.039a01 Hardware version: Linux Firmware version: 5.1.6_0420 Supported using: GenericMiot Command: miiocli genericmiot --ip 192.168.31.170 --token xxxx Supported by genericmiot: True è¿™é‡Œéœ€è¦æ¯”è¾ƒå…³æ³¨çš„ä¸œè¥¿æ˜¯ Supported by genericmiot ,\næœ‰è¿™ä¸ªçš„è¯ï¼ŒåŸºæœ¬å°±å¯ä»¥é€šè¿‡ miiocli genericmiot æ¥æ§åˆ¶è¿™ä¸ªè®¾å¤‡äº†ã€‚\n1 2 3 4 5 6 # Supported by genericmiot: True Note that the command field which gives you the direct command to use for controlling the device. If the device is supported by the genericmiot integration as stated in the output, you can also use miiocli genericmiot for controlling it. ä»¥ä¸‹æ–‡æ¡£ä»å®˜æ–¹æ–‡æ¡£ä¸­æ‘˜å½•ç¿»è¯‘ã€‚\næ§åˆ¶ç°ä»£ï¼ˆMIoTï¼‰è®¾å¤‡ å¤§å¤šæ•°ç°ä»£(MIoT)è®¾å¤‡éƒ½ä¼šè‡ªåŠ¨å—åˆ° genericmiot é›†æˆçš„æ”¯æŒã€‚\nåœ¨å†…éƒ¨ï¼Œå®ƒä½¿ç”¨(\u0026ldquo;miot spec\u0026rdquo;)æ–‡ä»¶æ¥äº†è§£æ”¯æŒçš„åŠŸèƒ½ï¼Œå¦‚ä¼ æ„Ÿå™¨ã€è®¾ç½®å’Œæ“ä½œã€‚\nhttps://home.miot-spec.com/spec/xiaomi.controller.86v1\nç±³å®¶äº§å“åº“ï¼ˆéå®˜æ–¹ï¼‰\næ­¤è®¾å¤‡å‹å·ç‰¹å®šæ–‡ä»¶å°†åœ¨æ‚¨é¦–æ¬¡ä½¿ç”¨ genericmiot é›†æˆæ—¶ä¸‹è½½ï¼ˆå¹¶åœ¨æœ¬åœ°ç¼“å­˜ï¼‰ã€‚\næ‰€æœ‰æ”¯æŒè®¾å¤‡çš„åŠŸèƒ½éƒ½å¯ä»¥ä½¿ç”¨å¸¸è§å‘½ä»¤æ¥æ§åˆ¶ï¼š\nstatus ï¼ˆæ˜¾ç¤ºè®¾å¤‡çŠ¶æ€ï¼‰ã€ set ï¼ˆæ›´æ”¹è®¾ç½®ï¼‰ã€ actions åˆ—å‡ºå¯ç”¨æ“ä½œ\nå’Œ call æ‰§è¡Œæ“ä½œã€‚\nè®¾å¤‡çŠ¶æ€ æ‰§è¡Œ status å°†æ˜¾ç¤ºå½“å‰è®¾å¤‡çŠ¶æ€ï¼Œä»¥åŠè®¾ç½®çš„å¯æ¥å—å€¼ï¼ˆæ ‡æœ‰è®¿é—® RW ï¼‰ï¼š\n1 2 3 4 5 6 miiocli genericmiot --ip 127.0.0.1 --token 00000000000000000000000000000000 status Service Light (light) Switch Status (light:on, access: RW): False (\u0026lt;class \u0026#39;bool\u0026#39;\u0026gt;, ) Brightness (light:brightness, access: RW): 60 % (\u0026lt;class \u0026#39;int\u0026#39;\u0026gt;, min: 1, max: 100, step: 1) Power Off Delay Time (light:off-delay-time, access: RW): 1:47:00 (\u0026lt;class \u0026#39;int\u0026#39;\u0026gt;, min: 0, max: 120, step: 1) æ›´æ”¹è®¾ç½® è¦æ›´æ”¹è®¾ç½®ï¼Œæ‚¨éœ€è¦æä¾›è®¾ç½®çš„åç§°ï¼ˆä¾‹å¦‚ï¼Œåœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ light:brightness ï¼‰ï¼š\n1 2 3 miiocli genericmiot --ip 127.0.0.1 --token 00000000000000000000000000000000 set light:brightness 0 [{\u0026#39;did\u0026#39;: \u0026#39;light:brightness\u0026#39;, \u0026#39;siid\u0026#39;: 2, \u0026#39;piid\u0026#39;: 3, \u0026#39;code\u0026#39;: 0}] ä½¿ç”¨åŠ¨ä½œ å¤§å¤šæ•°è®¾å¤‡è¿˜å°†æä¾›æ“ä½œï¼š\n1 2 3 4 5 6 miiocli genericmiot --ip 127.0.0.1 --token 00000000000000000000000000000000 actions Light (light) light:toggle Toggle light:brightness-down Brightness Down light:brightness-up Brightness Up è¿™äº›å¯ä»¥ä½¿ç”¨ call å‘½ä»¤æ‰§è¡Œï¼š\n1 2 3 miiocli genericmiot --ip 127.0.0.1 --token 00000000000000000000000000000000 call light:toggle {\u0026#39;code\u0026#39;: 0, \u0026#39;out\u0026#39;: []} ä½¿ç”¨ miiocli genericmiot \u0026ndash;help è·å–æ›´å¤šå¯ç”¨å‘½ä»¤ã€‚\nè¯¦ç»†çš„æ–‡æ¡£åœ¨è¿™é‡Œï¼š\nä¸€è¡Œä»£ç æ§åˆ¶ä½ çš„ç±³å®¶è®¾å¤‡ åŸºäºä¸Šé¢çš„è¿™äº›æ“ä½œï¼Œ\nè¿™ä¸€è¡Œä»£ç å¤§æ¦‚å‡ºæ¥äº†ã€‚\n1 2 3 4 5 6 7 8 9 # è·å–å¯ä»¥æ‰§è¡Œçš„å‘½ä»¤ miiocli genericmiot --ip 192.168.31.170 --token xxxx actions ## æ‰§è¡Œæ“ä½œ miiocli genericmiot --ip 192.168.31.170 --token xxxx call camera:record-start ## æ›´æ”¹å±æ€§ miiocli genericmiot --ip 192.168.31.170 --token xxxx set camera:record-mode 1 å½“ç„¶å¦‚æœä½ éœ€è¦è‡ªå·±å†™ç‚¹ä»£ç çš„è¯ï¼Œ\nå¤§æ¦‚æ˜¯è¿™æ ·çš„ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 from miio import Device, DeviceFactory, DeviceStatus from loguru import logger class MiIotDevice(): def __init__(self, ip, token) -\u0026gt; None: self.device: Device = DeviceFactory.create(ip, token) self.device_info = self.get_info() logger.info(f\u0026#34;Device: {ip}-{token} created\u0026#34;) def load_status(self): if self.device is None: return None d_status: DeviceStatus = self.device.status() return d_status.data def get_info(self): return { \u0026#34;ip\u0026#34;: self.device.ip, \u0026#34;model\u0026#34;: self.device.model, \u0026#34;device_id\u0026#34;: \u0026#34;nx_\u0026#34;+str(self.device.device_id), \u0026#34;mi_device_id\u0026#34;: self.device.device_id } def call_action(self, name, args): if self.device is None: raise Exception(\u0026#34;Device not ready\u0026#34;) call_result = self.device.call_action(name, args) logger.info( f\u0026#34;call_action: {name}-{args} result: {call_result}\u0026#34;) return call_result def set_properties(self, properties): if self.device is None: raise Exception(\u0026#34;Device not ready\u0026#34;) call_result = self.device.send(\u0026#34;set_properties\u0026#34;, properties) logger.info( f\u0026#34;set_properties: {properties} finish, result: {call_result}\u0026#34;) return call_result å¤§æ¦‚ï¼Œ\nå¦‚ä¸Šã€‚\næ€»ç»“ python-miio æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å·¥å…·ï¼Œå¯ä»¥ç”¨æ¥æ§åˆ¶ç±³å®¶è®¾å¤‡\né€šè¿‡ miiocli å¯ä»¥å¾ˆæ–¹ä¾¿çš„æ¥æ§åˆ¶è®¾å¤‡ é€šè¿‡ miiocli genericmiot å¯ä»¥æ§åˆ¶ç°ä»£è®¾å¤‡ é€šè¿‡ miiocli genericmiot actions å¯ä»¥æŸ¥çœ‹è®¾å¤‡æ”¯æŒçš„æ“ä½œ é€šè¿‡ miiocli genericmiot status å¯ä»¥æŸ¥çœ‹è®¾å¤‡çš„çŠ¶æ€ é€šè¿‡ miiocli genericmiot set å¯ä»¥æ›´æ”¹è®¾å¤‡çš„å±æ€§ é€šè¿‡ miiocli genericmiot call å¯ä»¥æ‰§è¡Œè®¾å¤‡çš„æ“ä½œ é€šè¿‡ miiocli genericmiot \u0026ndash;help å¯ä»¥æŸ¥çœ‹æ›´å¤šå‘½ä»¤ åŒæ—¶å¯ä»¥è‡ªå·±å†™ä»£ç æ¥æŠ˜è…¾ä¸€ä¸‹å…·ä½“çš„ä¸€äº›è®¾å¤‡ï¼Œ\nè‡ªå·±å»æä¸€äº›è‡ªåŠ¨åŒ–çš„ä¸œè¥¿ä¹Ÿå¾ˆç®€å•äº†ã€‚\nç¥å¤§å®¶ç©å¾—å¼€å¿ƒ~\nå‚è€ƒ python-miio miot-spec ç±³å®¶è®¾å¤‡å±æ€§æŸ¥è¯¢ï¼ˆéå®˜æ–¹ï¼‰ ","date":"2024-06-27T08:00:00Z","image":"https://liguobao.github.io/zh/p/one-line-code-control-mi-iot-diy/mi-iot-diy_hu_d4ccb214c5fa2dc8.png","permalink":"https://liguobao.github.io/zh/p/one-line-code-control-mi-iot-diy/","title":"ä¸€è¡Œä»£ç æ§åˆ¶ä½ çš„ç±³å®¶è®¾å¤‡"},{"content":"WebCamera åŸºäºWebRTCçš„ç‚¹å¯¹ç‚¹ç½‘ç»œæ‘„åƒå¤´ å‰å‡ å¤©é€›æ¨ï¼Œçœ‹åˆ°æœ‰ä¸ªå¤§ä½¬å¼€æºäº†ä¸ªå°é¡¹ç›®ï¼ŒåŸºäºWebRTCçš„ç‚¹å¯¹ç‚¹ç½‘ç»œæ‘„åƒå¤´ã€‚\ngithub.com/ShouChenICU/WebCamera é¡ºæ‰‹çœ‹äº†ä¸€çœ¼ä»£ç å’Œæ–‡æ¡£ï¼Œå‘ç°è¿™ä¸ªé¡¹ç›®è¿˜æ˜¯æŒºæœ‰æ„æ€çš„ï¼Œ\näºæ˜¯è‡ªå·±éƒ¨ç½²äº†ä¸€ä¸ªï¼Œç”¨ä¸‹æ¥æœ‰ç‚¹æ„æ€ï¼Œäºæ˜¯å†™ä¸ªæ–‡ç« åˆ†äº«ä¸€ä¸‹~\né¡¹ç›®ä»‹ç» WebCamera æ˜¯ä¸€ä¸ªåŸºäº WebRTC æŠ€æœ¯çš„ç½‘ç»œæ‘„åƒå¤´å·¥å…·ç«™ï¼Œä½¿ç”¨ Nuxt.js æ¡†æ¶å¼€å‘ï¼Œå¹¶é€šè¿‡ Yarn è¿›è¡ŒåŒ…ç®¡ç†ã€‚ ç‰¹æ€§ å®æ—¶è§†é¢‘æµ: ä½¿ç”¨ WebRTC æŠ€æœ¯å®ç°é«˜æ•ˆçš„å®æ—¶è§†é¢‘æµã€‚ è·¨å¹³å°æ”¯æŒ: å…¼å®¹å¤šç§æµè§ˆå™¨å’Œè®¾å¤‡ã€‚ æ˜“äºå¼€å‘: åŸºäº Nuxt.js æ¡†æ¶ï¼Œæ–¹ä¾¿æ‰©å±•å’Œç»´æŠ¤ã€‚ æ¨¡å—åŒ–è®¾è®¡: ä¾¿äºåŠŸèƒ½çš„æ‰©å±•å’Œé›†æˆã€‚ éšç§å®‰å…¨: ä½¿ç”¨ç‚¹å¯¹ç‚¹åŠ å¯†è¿æ¥ï¼Œä¿æŠ¤éšç§å®‰å…¨ã€‚ dockeréƒ¨ç½² ccr.ccs.tencentyun.com/liguobao/tools:web-camera æ˜¯æˆ‘æ„å»ºçš„é•œåƒï¼Œæ‰˜ç®¡åœ¨è…¾è®¯äº‘å®¹å™¨é•œåƒæœåŠ¡ä¸Šã€‚ è‡ªè¡Œæ„å»ºå¦‚ä¸‹ï¼š\n1 2 docker build -t webcamera . docker run -d -p 3000:3000 webcamera k8s éƒ¨ç½² 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 --- apiVersion: apps/v1 kind: Deployment metadata: name: web-camera labels: app: web-camera spec: replicas: 1 selector: matchLabels: app: web-camera template: metadata: labels: app: web-camera spec: containers: - name: web-camera image: ccr.ccs.tencentyun.com/liguobao/tools:web-camera ports: - containerPort: 3000 resources: requests: memory: \u0026#34;512Mi\u0026#34; cpu: \u0026#34;500m\u0026#34; limits: memory: \u0026#34;2048Mi\u0026#34; cpu: \u0026#34;1000m\u0026#34; readinessProbe: httpGet: path: / port: 3000 initialDelaySeconds: 120 periodSeconds: 60 env: - name: DOCKER_ENABLE_SECURITY value: \u0026#34;false\u0026#34; dnsPolicy: ClusterFirst restartPolicy: Always terminationGracePeriodSeconds: 30 --- apiVersion: v1 kind: Service metadata: name: web-camera spec: selector: app: web-camera ports: - protocol: TCP port: 3000 targetPort: 3000 type: ClusterIP --- apiVersion: networking.k8s.io/v1 kind: Ingress metadata: annotations: cert-manager.io/cluster-issuer: letsencrypt-prod kubernetes.io/tls-acme: \u0026#34;true\u0026#34; generation: 1 name: ingress-web-camera spec: ingressClassName: traefik rules: - host: xxx.yyy.cn http: paths: - backend: service: name: web-camera port: number: 3000 path: / pathType: Prefix tls: - hosts: - xxx.yyy.cn secretName: xxx-yyy-cn-tls åç»­ å’Œå¤§ä½¬èŠäº†ä¸‹ï¼Œåç»­å¯èƒ½ä¼šåšä¸ªç®€å•çš„åœ¨çº¿è§†é¢‘ä¼šè®®çš„é¡¹ç›®ï¼Œå¯ä»¥æœŸå¾…ä¸€ä¸‹~\nå‚è€ƒ WebCamera WebRTC é˜®ä¸€å³°ï¼šWebRTC æ–‡æ¡£ WebRTC è¿™ä¸ªåè®®æœ‰ç‚¹æ„æ€ï¼Œæœ‰å…´è¶£çš„æœ‹å‹å¯ä»¥å¤šäº†è§£ä¸€ä¸‹~\næ¯•ç«Ÿå¤§ä½¬éƒ½è¯´ä¹Ÿå°±çœ‹äº†ä¸¤å¤©ï¼Œå°±å†™å‡ºæ¥äº†~\n","date":"2024-06-12T08:00:00Z","image":"https://liguobao.github.io/zh/p/open-source-web-camera/web-c_hu_4da7fac45bdbd69a.png","permalink":"https://liguobao.github.io/zh/p/open-source-web-camera/","title":"WebCamera åŸºäºWebRTCçš„ç‚¹å¯¹ç‚¹ç½‘ç»œæ‘„åƒå¤´"},{"content":"VS Codeçš„C#æ’ä»¶å¥½åƒä¸å¤ªæ­£å¸¸ æœ€è¿‘èµ·äº†ä¸ªæ–°çš„C#é¡¹ç›®ï¼Œæƒ³ç€å¤šä¸ªProject æŒ‰æ–‡ä»¶å¤¹åˆ’åˆ†ï¼Œ\nåœ¨æ ¹ç›®å½•æ‰”ä¸€ä¸ªsolutionå°±å®Œäº‹äº†ï¼Œä½†æ˜¯åœ¨VS Codeé‡Œé¢æ‰“å¼€çš„æ—¶å€™ï¼Œ\nå‘ç°åœ¨Project æºç é‡Œé¢å¼•ç”¨ä¿¡æ¯å’Œæç¤ºéƒ½ä¸å¤ªæ­£å¸¸ï¼Œ\nè¿·ï¼Œä¸€ç›´éƒ½æ˜¯è¿™æ ·ç”¨çš„ï¼Œä¸åº”è¯¥æœ‰ä»€ä¹ˆé—®é¢˜å˜›ã€‚\næœäº†ä¸€æ³¢å‘ç°ï¼Œæœ‰äº›æœ‹å‹ä¹Ÿé‡åˆ°äº†ç±»ä¼¼çš„é—®é¢˜ã€‚\n[VS Code] è§£å†³C#ä»£ç F12æ— æ•ˆ VSCode C# è½¬åˆ°å®šä¹‰(F12)å’Œctrl+é¼ æ ‡å·¦é”®æ— æ•ˆçš„è§£å†³æ–¹æ¡ˆ è¯´åˆ°çš„åŸºæœ¬éƒ½æ˜¯ï¼ŒOmniSharpæ’ä»¶ä¸å¤ªæ­£å¸¸ï¼Œéœ€è¦æ‰‹åŠ¨æŒ‡å®šä¸€ä¸‹ã€‚\nä½†æ˜¯\u0026hellip;\nomnisharp-vscode:This repository has been archived by the owner on Jun 22, 2023. It is now read-only.\nè‡ªç„¶ï¼Œè¿™ä¸ªæ–¹æ³•ä¹Ÿæ˜¯æ²¡ç”¨çš„äº†ã€‚\nä¸è¿‡å˜›ã€‚\ndotnet/vscode-csharp å·²ç»æ˜¯è¢«å®˜æ–¹æ”¯æŒçš„äº†ã€‚\nA Visual Studio Code extension that provides rich language support for C# and is shipped along with C# Dev Kit. Powered by a Language Server Protocol (LSP) server, this extension integrates with open source components like Roslyn and Razor to provide rich type information and a faster, more reliable C# experience.\næ‰€ä»¥ï¼Œæ˜¯ä¸æ˜¯è¯´åº”è¯¥å®‰è£…ä¸€ä¸‹è¿™ç©æ„å°±å¥½äº†ï¼Ÿ\nC# Dev Kit\næœ€åéªŒè¯äº†ä¸€ä¸‹ï¼Œç¡®å®æ˜¯è¿™æ ·çš„ã€‚\nC# Dev Kit æ’ä»¶æ”¯æŒäº†slnçš„åŠ è½½ï¼Œå®‰è£…å¥½äº†ä¹‹åæ‰‹åŠ¨ç¡®è®¤å“ªä¸ªslnæ–‡ä»¶å°±å¯ä»¥äº†ã€‚\nä¸€åˆ‡å›å½’æ­£å¸¸ã€‚\næ°´å®Œã€‚\n","date":"2024-06-10T08:00:00Z","image":"https://liguobao.github.io/zh/p/vscode-support-csharp-sln/code_hu_8262bb9eaf7719fa.png","permalink":"https://liguobao.github.io/zh/p/vscode-support-csharp-sln/","title":"VS Code æ”¯æŒ C# è§£å†³æ–¹æ¡ˆæ–‡ä»¶"},{"content":"èƒŒæ™¯ï¼šæŸäº‘APIç½‘å…³è¦è·‘è·¯å•¦ å¬è¿‡è…¾è®¯äº‘APIç½‘å…³è¦ä¸‹çº¿äº†ï¼Œä¹‹å‰çš„é¡¹ç›®éƒ½ï¼ˆbuï¼‰æ˜¯ï¼ˆshiï¼‰ç”¨çš„è¿™ä¸ªï¼Œç°åœ¨è¦æ¢æˆä»€ä¹ˆå‘¢ï¼Ÿ\nã€é‡è¦ã€‘API ç½‘å…³äº§å“åœæ­¢å”®å–å…¬å‘Š\nè¿™ç©æ„å½“å¹´æˆ‘è¿˜åœ¨ç™½å«–è…¾è®¯äº‘k8s masteré›†ç¾¤çš„æ—¶å€™ï¼Œ\næŸä¸€æ¬¡å‡çº§ä¹‹åä»–ä»¬æŠŠk8sçš„service åˆ‡æˆäº†APIç½‘å…³ï¼Œ\nç„¶åå¼€å§‹è¦æ±‚æˆ‘æŒ‰é‡ä»˜è´¹ã€‚\næ¥ç€æˆ‘å°±å¼€å§‹ç ”ç©¶æ€ä¹ˆæŠŠè¿™ä¸ªä¸œè¥¿ç»™æ›¿æ¢æ‰~\nåˆ°ä»Šå¤©ç»ˆäºå¯ä»¥æ‰¬çœ‰åæ°”äº†ï¼ï¼ï¼\næ–¹æ¡ˆä¸€ï¼šè…¾è®¯äº‘é›†ç¾¤ + nodePort é›†ç¾¤è¿˜æ˜¯ä¸€æ ·çš„é›†ç¾¤ï¼Œè‡ªå·±çš„æœºå™¨ä½œä¸ºworkerèŠ‚ç‚¹æ¥å…¥é›†ç¾¤ ç›´æ¥åˆ æ‰æ‰€æœ‰å¸¦å†…ç½‘IPçš„serviceï¼Œå…¨éƒ¨ä½¿ç”¨nodePortæš´éœ²æœåŠ¡ã€‚ åœ¨workerèŠ‚ç‚¹ä¸Šå®‰è£…NGINXï¼Œä½¿ç”¨NGINXçš„åå‘ä»£ç†åŠŸèƒ½ï¼Œå°†è¯·æ±‚è½¬å‘åˆ°nodePortä¸Šã€‚ è¿™ä¸ªæ–¹æ¡ˆè·‘äº†å¤§æ¦‚ä¸€å¹´å¤šå·¦å³ï¼Œé›†ç¾¤ä¹Ÿå¼€å§‹æ”¶è´¹äº†ï¼Œç¾åæ›°ç®¡ç†è´¹~\nç®—ä¸‹æ¥ä¸€ä¸ªæœˆå‡ åå—ï¼Œä¸€å¹´å‡ ç™¾å—ï¼Œå¹¶ä¸èƒ½æ¥å—è¿™ä¸ªä»·æ ¼ã€‚\né‚ï¼Œæ–¹æ¡ˆè¿ç§»~\næ–¹æ¡ˆäºŒï¼šSuperEdge è‡ªå»ºé›†ç¾¤ + nodePort + nginx è‡ªå»ºé›†ç¾¤å˜›ï¼Œä»€ä¹ˆæ–¹ä¾¿ä»€ä¹ˆæ¥ã€‚\næ‰€ä»¥å½“å¹´è¿˜å†™è¿‡è¿™äº›æ–‡ç« ï¼š\nçŸ¥ä¹ä¸“æ ï¼šè¾¹ç¼˜è®¡ç®—k8sé›†ç¾¤SuperEdgeåˆä½“éªŒ\nçŸ¥ä¹ä¸“æ ï¼šSuperEdgeè¾¹ç¼˜è®¡ç®—é›†ç¾¤æŒ‚è½½NFS\nå¦¥å¦¥ç®—æ˜¯ä»–ä»¬çš„ä¸€ä¸ªè‡ªæ¥æ°´äº†ã€‚\nç„¶è€Œ\u0026hellip;\nå¤§æ¦‚æ˜¯åœ¨å»å¹´çš„æ—¶å€™ï¼ŒSuperEdge å¾®ä¿¡ç¾¤è€ç¾¤è¯´è¿ç§»ï¼Œæ–°ç¾¤åŠ è¿›å»æ²¡äººç®¡äº†ã€‚\nç§èŠäº†ä¸€ä¸‹ä¹‹å‰ç†Ÿæ‚‰çš„æŠ€æœ¯ï¼Œè¯´é¡¹ç›®è¿›å…¥ç»´æŠ¤çŠ¶æ€äº†ã€‚\nå•§å•§å•§\u0026hellip;\né—®é¢˜æ˜¯ï¼Œè¿™ç©æ„è¯ä¹¦è¿‡æœŸæ²¡æ³•renewå•Šï¼Œæˆ‘çš„é›†ç¾¤ç›´æ¥å´©äº†ã€‚\nçœŸå¿ƒç´¯äº†ï¼Œå›½å†…çš„å¤§å‚çš„å¼€æºé¡¹ç›®ï¼Œå¤§å¤šé€ƒä¸è¿‡KPIçš„å‘½è¿ã€‚\nç©ä¸èµ·ä¸å¥½è¿›åœºï¼Œç©ä¸è½¬å°±åªèƒ½è¢«æ·˜æ±°ã€‚\nçœŸçš„ï¼Œå†ä¿¡å›½å†…çš„å¤§å‚å¼€æºé¡¹ç›®ï¼Œæˆ‘å°±æ˜¯çŒªå¤´ï¼ï¼!\næ¥ç€å¼€å§‹è€ƒå¯Ÿæ–°çš„æ–¹æ¡ˆï¼š\nä¾æ—§æ˜¯All In K8s ä¾æ—§æ˜¯è‡ªå»ºé›†ç¾¤ ä¾æ—§æ˜¯ä¸èŠ±ä¸€åˆ†é’± ç„¶åï¼Œå‘ç° k3s è¿™ä¸ªä¸œè¥¿ï¼ŒçœŸé¦™~\næœ€ç»ˆæ–¹æ¡ˆï¼šk3s + ingress-nginx éƒ¨ç½²æ–¹æ¡ˆè§ï¼šçŸ¥ä¹ä¸“æ ï¼šã€k3sã€‘å¹´åº¦æœ€ä½³è¾¹ç¼˜è®¡ç®—é›†ç¾¤æ–¹æ¡ˆ\nnodeèŠ‚ç‚¹å¤§æ¦‚å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 NAME STATUS ROLES AGE VERSION aliyun-bj-199 Ready \u0026lt;none\u0026gt; 34d v1.29.4+k3s1 haru Ready \u0026lt;none\u0026gt; 6d16h v1.29.4+k3s1 t7610 Ready \u0026lt;none\u0026gt; 6d2h v1.29.4+k3s1 vm-16-12-ubuntu Ready control-plane,etcd,master 75d v1.28.7+k3s1 vm-28-17-ubuntu Ready,SchedulingDisabled control-plane,etcd,master 75d v1.28.7+k3s1 zj-hc1 Ready \u0026lt;none\u0026gt; 33d v1.29.4+k3s1 åœ¨ä¸Šé¢å…¶å®å¯ä»¥çœ‹åˆ°ï¼Œmaster èŠ‚ç‚¹å°±ä¸¤å°ï¼Œvm-16-12-ubuntu å’Œ vm-28-17-ubuntu ï¼Œ\nä¸¤å°æœºå™¨åœ¨äº‘ç«¯ï¼Œå†…ç½‘äº’é€šï¼Œéƒ½æœ‰å…¬ç½‘IPã€‚ï¼ˆåˆ’é‡ç‚¹ï¼‰\nå…¶ä»–çš„æœºå™¨éƒ¨åˆ†åœ¨æœ¬åœ°ï¼Œéƒ¨åˆ†åœ¨å…¶ä»–äº‘ï¼Œéƒ¨åˆ†åœ¨è¾¹ç¼˜è®¾å¤‡ä¸Šï¼Œå†…ç½‘äº’é€šï¼Œä½†æ˜¯ä¸ä¸€å®šæœ‰å…¬ç½‘IPã€‚\nç…§ç€ä»¥å‰çš„é€»è¾‘ï¼Œæˆ‘ä»¬æ˜¯éœ€è¦ä¸€ä¸ªAPI ç½‘å…³ï¼ŒæŠŠæµé‡è½¬å‘åˆ°åˆ°workerèŠ‚ç‚¹ä¸Šã€‚\nè¿™ä¹Ÿæ˜¯ç°åœ¨æŸäº‘çš„APIç½‘å…³çš„åŠŸèƒ½ï¼Œä½†æ˜¯æˆ‘ä»¬ç°åœ¨æ²¡æœ‰äº†ã€‚\nä¸è¿‡ï¼Œæ²¡æœ‰äº†APIç½‘å…³ï¼Œæˆ‘ä»¬è¿˜æœ‰ ingress-nginxã€‚\nk3s é›†ç¾¤ä¸­ï¼Œæœ‰å…¬ç½‘IPçš„èŠ‚ç‚¹ï¼Œå…¶å®éƒ½å¯ä»¥ç›´æ¥ä½œä¸ºæµé‡å…¥å£ã€‚\nç„¶åï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ ingress-nginx çš„é…ç½®ï¼Œå°†æµé‡è½¬å‘åˆ°workerèŠ‚ç‚¹ä¸Šã€‚\néœ€è¦çš„æ“ä½œåªæ˜¯åœ¨ server or agent å¯åŠ¨çš„æ—¶å€™ï¼ŒåŠ ä¸Š --node-external-ip å‚æ•°ï¼ŒæŒ‡å®šå…¬ç½‘IPã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 # server ExecStart=/usr/local/bin/k3s \\ server \\ --node-external-ip å…¬ç½‘IP \\ --flannel-backend wireguard-native \\ \u0026#39;--tls-san\u0026#39; \\ \u0026#39;å…¬ç½‘IP\u0026#39; \\ \u0026#39;--node-name\u0026#39; \\ \u0026#39;vm-16-12-ubuntu\u0026#39; \\ \u0026#39;--server\u0026#39; \\ \u0026#39;https://10.0.28.17:6443\u0026#39; \\ # agent ExecStart=/usr/local/bin/k3s \\ agent --node-name zj-hc1 \\ --lb-server-port 5443 \\ --node-ip 10.42.4.1 \\ -node-external-ip å…¬ç½‘IP \\ --server https://server:6443 \\ --token=\u0026#34;YOUR_TOKEN\u0026#34; \\ æ­¤æ—¶ï¼Œè¿™ä¸ªèŠ‚ç‚¹çš„443ç«¯å£å’Œ80ç«¯å£å°±å¯ä»¥ç›´æ¥æ¥å—å¤–éƒ¨æµé‡äº†ã€‚ï¼ˆå½“ç„¶ï¼Œéœ€è¦é˜²ç«å¢™å¼€æ”¾ï¼‰\nç„¶åæˆ‘ä»¬æŠŠå¯¹åº”çš„åŸŸåè§£æåˆ°è¿™ä¸ªèŠ‚ç‚¹çš„å…¬ç½‘IPä¸Šï¼Œå°±å¯ä»¥ç›´æ¥è®¿é—®äº†ã€‚\nä¸€ä¸ªå®Œæ•´çš„éƒ¨ç½²ä¾‹å­ å¸¦åŸŸåè¯ä¹¦è‡ªç­¾å ä»»æ„æœ‰å…¬ç½‘IPçš„èŠ‚ç‚¹éƒ½å¯ä»¥ä½œä¸ºå…¥å£ å¦‚æœéœ€è¦è´Ÿè½½IPè´Ÿè½½å‡è¡¡ï¼Œå¯ä»¥åœ¨DNSè§£ææ—¶ä½¿ç”¨å¤šä¸ªAè®°å½•ï¼Œæˆ–è€…ä½¿ç”¨DNSè´Ÿè½½å‡è¡¡æœåŠ¡ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 apiVersion: v1 kind: PersistentVolume metadata: name: stirling-pdf spec: capacity: storage: 30Gi accessModes: - ReadWriteOnce persistentVolumeReclaimPolicy: Delete storageClassName: local-storage local: path: /mnt/cfs-a4nopkhh/stirling-pdf nodeAffinity: required: nodeSelectorTerms: - matchExpressions: - key: kubernetes.io/hostname operator: In values: - zj-hc1 --- kind: PersistentVolumeClaim apiVersion: v1 metadata: name: stirling-pdf spec: accessModes: - ReadWriteOnce resources: requests: storage: 30Gi storageClassName: local-storage --- apiVersion: apps/v1 kind: Deployment metadata: name: stirling-pdf labels: app: stirling-pdf spec: replicas: 1 selector: matchLabels: app: stirling-pdf template: metadata: labels: app: stirling-pdf spec: containers: - name: stirling-pdf image: ccr.ccs.tencentyun.com/liguobao/s-pdf:ustc ports: - containerPort: 8080 resources: requests: memory: \u0026#34;512Mi\u0026#34; cpu: \u0026#34;500m\u0026#34; limits: memory: \u0026#34;2048Mi\u0026#34; cpu: \u0026#34;1000m\u0026#34; readinessProbe: httpGet: path: / port: 8080 initialDelaySeconds: 120 periodSeconds: 60 env: - name: DOCKER_ENABLE_SECURITY value: \u0026#34;false\u0026#34; - name: INSTALL_BOOK_AND_ADVANCED_HTML_OPS value: \u0026#34;false\u0026#34; - name: UI_APP_NAME value: \u0026#34;R2049 PDF\u0026#34; - name: ALLOW_GOOGLE_VISIBILITY value: \u0026#34;true\u0026#34; - name: LANGS value: \u0026#34;zh_CN\u0026#34; - name: APP_LOCALE value: \u0026#34;zh_CN\u0026#34; volumeMounts: - mountPath: /configs subPath: configs name: data - mountPath: /usr/share/tessdata subPath: tessdata name: data - mountPath: /customFiles/ subPath: customFiles name: data volumes: - name: data persistentVolumeClaim: claimName: stirling-pdf imagePullSecrets: - name: regcred dnsPolicy: ClusterFirst restartPolicy: Always terminationGracePeriodSeconds: 30 --- apiVersion: v1 kind: Service metadata: name: stirling-pdf-service spec: selector: app: stirling-pdf ports: - protocol: TCP port: 8080 targetPort: 8080 type: ClusterIP --- apiVersion: networking.k8s.io/v1 kind: Ingress metadata: annotations: cert-manager.io/cluster-issuer: letsencrypt-prod kubernetes.io/tls-acme: \u0026#34;true\u0026#34; generation: 1 name: ingress-pdf-house2048 spec: ingressClassName: traefik rules: - host: pdf.house2048.cn http: paths: - backend: service: name: stirling-pdf-service port: number: 8080 path: / pathType: Prefix tls: - hosts: - pdf.house2048.cn secretName: pdf-house2048-cn-tls ","date":"2024-06-03T08:00:00Z","image":"https://liguobao.github.io/zh/p/q-cloud-api-down-k3s-up/qcloud_hu_35618731670e260d.png","permalink":"https://liguobao.github.io/zh/p/q-cloud-api-down-k3s-up/","title":"è…¾è®¯äº‘APIç½‘å…³åºŸäº†ï¼Ÿé›†ç¾¤å¼€æºæ–¹æ¡ˆå¹³æ›¿"},{"content":"GPT2077 é€ŸæŠ¥~\nGPT2077 å…è´¹GPT4ç«™ç‚¹~ å›½å†…é«˜é€Ÿï¼Œå…æ¢¯å­ï¼Œå®‰å…¨é«˜æ•ˆã€‚\næ”¯æŒ GPT3.5ã€GPT4ã€è®ºæ–‡æ¶¦è‰²ï¼ŒæŒ‰é‡ä»˜è´¹ã€‚\nGPT 2077å¼ºåŠ›é©±åŠ¨~\nå›½å†…ç½‘ç»œï¼Œé‚®ç®±æ³¨å†Œæ¿€æ´»ç«‹å³å¯ç”¨ã€‚\nGPT4ã€GPT3.5ã€\nGPT-4oã€\nGoogle Gemini-Proã€\nDALL-E3-Imageæ–‡æœ¬ç”Ÿæˆå›¾ç‰‡æ¨¡å‹\néƒ½èƒ½ç”¨~\nè®ºæ–‡è§£è¯»ã€SiriGPTã€\nè®ºæ–‡æ¶¦è‰²ã€APIè°ƒç”¨\nç­‰ç­‰åŠŸèƒ½éƒ½æœ‰~\næŒ‰é‡ä»˜è´¹ï¼ŒæŒ‰éœ€ä½¿ç”¨ã€‚\næ¯æ—¥ç­¾åˆ°é€10W Tokenï¼Œ\né‚€è¯·å¥½å‹æ¯ä½èµ é€30W Tokenã€‚\nå››èˆäº”å…¥å°±æ˜¯ä¸èŠ±é’±ç›´æ¥ç”¨~\næ‰«ç æ³¨å†Œ\nå›¾ç‰‡\né‚€è¯·ç æ³¨å†Œ\næ¬¢è¿ä½¿ç”¨æˆ‘çš„é‚€è¯·ç ã€9NBE3XJ9ã€‘æ³¨å†ŒGPT2077ï¼Œ\nç«‹å³è·å¾—50W Tokenå¥–åŠ±\nï¼ˆGPT4ã€3.5æ¨¡å‹é€šç”¨ï¼‰ã€‚\nç‚¹å‡»é“¾æ¥æ³¨å†Œï¼š\nhttps://chat.r2049.cn/user/login?inviteCode=9NBE3XJ9\nGPT4 ç»å…¸é—®é¢˜\nQï¼šé²è¿…æ‰“äº†å‘¨æ ‘äººï¼Œè¿™ä¸ªæ˜¯æ­£å¸¸çš„å—ï¼Ÿ\nä¸‰ç§ä¸åŒæ¨¡å‹çš„å›ç­”~\nâ€œæ¯æ—¥ç­¾åˆ°â€ å…¥å£ï¼šä¸ªäººä¿¡æ¯é¡µ ç­¾åˆ°Tokenå¥–åŠ±é¢åº¦ä¸º10W â€œé‚€è¯·ç â€åŠŸèƒ½ GPT 2077 é‚€è¯·ç  å½“å‰é‚€è¯·äººå¥–åŠ± 30W Tokené¢åº¦ï¼Œè¢«é‚€è¯·çš„æ–°ç”¨æˆ·å¥–åŠ± 50W Token é¢åº¦ã€‚ Siri GPT å¦‚ä½•åœ¨Siriä¸­ä½¿ç”¨GPTå¯¹è¯~ GPT3.5 ã€GPT4 å¯¹æ¯” GPT3.5ã€GPT4å¯¹æ¯” ","date":"2024-05-29T08:00:00Z","image":"https://liguobao.github.io/zh/p/gpt2077-free-gpt4/girl_hu_b042573a578e1c7e.png","permalink":"https://liguobao.github.io/zh/p/gpt2077-free-gpt4/","title":"GPT2077 å…è´¹GPT4ç«™ç‚¹~"},{"content":"å‰å‡ å¤©åœ¨ç½‘ä¸Šå†²æµªï¼Œ çœ‹åˆ°äº†æœ‰ç‚¹æ„æ€çš„æ’ä»¶ â€œSlax Readerâ€ï¼Œ å€¼å¾—æ¨èä¸€ä¸‹~\nAn AI-powered browser extension that generates outlines and highlights key points to enhance your web reading experience. An AI-powered browser extension that generates outlines and highlights key points to enhance your web reading experience.\nhttps://chromewebstore.google.com/detail/slax-reader/gdnhaajlomjkhahnmiijphnodkcfikfd â€‹chromewebstore.google.com/detail/slax-reader/gdnhaajlomjkhahnmiijphnodkcfikfd\nChromeæ’ä»¶ï¼Œå®‰è£…éœ€è¦è‡ªè¡Œè§£å†³~ åŸæ¨åœ°å€ï¼šhttps://x.com/wulujia/status/1791680166382727541\nä¸‹é¢çš„ä¸€äº›æ•ˆæœå›¾~\nåŸæ–‡ï¼šæˆ‘ä»¬ä¸ºä»€ä¹ˆç›¸çˆ±ï¼Œåˆä¸ºä»€ä¹ˆåˆ†å¼€https://mp.weixin.qq.com/s/r9wSD-Yâ€81My7â€6J_74A5d4g\nzhihuæŸä¸ªåµæ¶å›ç­”~\nå‰å‡ å¤©æˆ‘å†™å¾—Pythonå­¦ä¹ ~\nè€æ—©ä¹‹å‰å†™çš„~\næš‚æ—¶æ’ä»¶æ²¡æœ‰æ”¶è´¹ï¼Œä½œè€…è¯´å¤§å®¶ç”¨é‡ä¸å¤§æ— æ‰€è°“äº†ã€‚\næ®è¯´ç”¨çš„æ˜¯openai æ¥å£ï¼Œç®—ä¸‹æ¥åº”è¯¥ä¸ç®—ä¾¿å®œäº†ã€‚\nå¿«è¯»ã€é€Ÿè¯»å†…å®¹ï¼Œæ•´ä½“è§‚æ„Ÿè¿˜æ˜¯å¾ˆå¥½çš„~\nå¤§æ¦‚å¦‚æ­¤ã€‚\næœ‰ç‚¹æ„æ€ï¼Œåˆä¸€æ¬¡å¯ä»¥å·æ‡’äº†ã€‚\n","date":"2024-05-21T08:00:00Z","image":"https://liguobao.github.io/zh/p/slax-reader-ai-mind-map/ai_hu_1c6e9ef2b4f06164.png","permalink":"https://liguobao.github.io/zh/p/slax-reader-ai-mind-map/","title":"Slax Readerï¼šAIé©±åŠ¨çš„æ€ç»´å¯¼å›¾æ’ä»¶"},{"content":"PSï¼šåŠ³åŠ¨èŠ‚ä¸åŠ³åŠ¨ï¼ŒçŠ¯æ³•çš„ï¼\næ‰‹åŠ¨ç‹—å¤´~\nã€ç¼–ç¨‹æŠ€æœ¯ä¸“åŒºåŠé€€æç¤ºã€‘\næœ€è¿‘æœ‰å°æœåŠ¡å™¨è¦åˆ°æœŸäº†ï¼Œé—®äº†ä¸‹IDCæœºæˆ¿ç»­è´¹ï¼ŒæŠ¥ä»·è¯´2500ã€‚\nä¾›åº”å•†è¯´å»å¹´ä¹Ÿæ˜¯è¿™ä¸ªä»·æ ¼ã€‚\né“ç†å€’æ²¡é”™ï¼Œç¡®å®å»å¹´æ˜¯ä»˜äº†é’±çš„ã€‚\nåªæ˜¯\u0026hellip;.ä»Šå¹´å˜›ï¼Œæ—¥å­éƒ½ä¸å¤ªå¥½è¿‡ã€‚\nç®—äº†ï¼Œå»å£•å„ç§äº‘ç¾Šæ¯›ç®—æ±‚äº†ã€‚\nå¾ˆå¿«å°±ä¹°äº†æœºå™¨ï¼Œæƒ³ç€ä¸€ä¸åšäºŒä¸ä¼‘â€”â€”æƒ³æé›†ç¾¤æ–¹æ¡ˆã€‚\näºæ˜¯ï¼Œç›¯ä¸Šäº†k3sã€‚\nä¹‹å‰ç”¨è¿‡SuperEdgeä¹‹ç±»çš„è¾¹ç¼˜é›†ç¾¤æ–¹æ¡ˆï¼Œæ²¡æœ‰releaseå°±å†ç”¨äº†ã€‚\nç„¶åä»Šå¹´ä»–ä»¬å›¢é˜Ÿ\u0026hellip;åŸºæœ¬å±äºä¸æ›´æ–°çŠ¶æ€äº†ã€‚\næœç„¶å›½å†…å¤§å‚å¼€æºéƒ½åŸºæœ¬æ˜¯KPIé¡¹ç›®ï¼Œæˆ‘å†ä¿¡ä»–ä»¬æˆ‘å°±æ˜¯ç‹—ã€‚\nk3sä¸€ç›´éƒ½æœ‰ç‚¹å…³æ³¨ï¼Œ\næ¯•ç«Ÿrancherè¿™å…¬å¸åœ¨17ã€18å¹´å¯æ˜¯æˆ‘ä»¬éƒ¨ç½²k8sé›†ç¾¤çš„æ•‘æ˜Ÿï¼Œ\nä»–ä»¬å¼€æºçš„é¡¹ç›®ä¸€ç›´éƒ½ç®—æ˜¯é è°±çš„ã€‚\nä¸ºä»€ä¹ˆå« K3s?\næˆ‘ä»¬å¸Œæœ›å®‰è£…çš„ Kubernetes åªå ç”¨ä¸€åŠçš„å†…å­˜ã€‚Kubernetes æ˜¯ä¸€ä¸ª 10 ä¸ªå­—æ¯çš„å•è¯ï¼Œç®€å†™ä¸º K8sã€‚ Kubernetes çš„ä¸€åŠå°±æ˜¯ä¸€ä¸ª 5 ä¸ªå­—æ¯çš„å•è¯ï¼Œå› æ­¤ç®€å†™ä¸º K3sã€‚ K3s æ²¡æœ‰å…¨ç§°ï¼Œä¹Ÿæ²¡æœ‰å®˜æ–¹çš„å‘éŸ³ã€‚https://docs.k3s.io/zh/\nå¯¹å˜›ï¼Œå¤šæœ‰æ„æ€ã€‚\nåŒæ—¶ï¼Œéº»é›€è™½å°ï¼Œåº”ç”¨å°½æœ‰ã€‚\nç›´æ¥å¹²ã€‚\nï¼ˆç„¶åæˆ‘æŠŠè¿™æ´»æ‰”ç»™äº†æµ·å“¥ï¼Œæµ·å“¥èŠ±äº†ä¸€ä¸‹åˆæŠŠé›†ç¾¤è·‘èµ·æ¥äº†ã€‚\nï¼ˆæ¥ç€æˆ‘ä»¬æ™šä¸Šå¼€å§‹è¿ç§»æœåŠ¡ï¼ŒæŠ˜è…¾äº†ä¸‰ä¸ªåŠå°æ—¶ã€‚\nï¼ˆæœŸé—´ä¸¢å¤±äº†ä¸€æ¬¡Redsiç¼“å­˜æ•°æ®ï¼ˆæˆ‘è¯¯åˆ \nï¼ˆå¾ˆâ€œé¡ºåˆ©â€å°±ä¸Šçº¿äº†\nvm-16-12-ubuntu Ready 42d v1.28.7+k3s1\nvm-28-17-ubuntu Ready 42d v1.28.7+k3s1\nä¸¤ä¸ªèŠ‚ç‚¹çš„å¯’é…¸é›†ç¾¤~\nè¿™é˜µå­å¿™ç€æGPT2077å˜›ï¼ŒåŸºæœ¬æœºå™¨å°±æ²¡å’‹æäº†ã€‚\nï¼ˆæ’æ’­å¹¿å‘Šï¼šGPT2077ï¼šæ”¯æŒè®ºæ–‡è§£è¯»ã€é‚€è¯·å¥½å‹å‡çº§~\nè¿™ä¸¤å¤©æ²¡é‚£ä¹ˆå¿™äº†ï¼Œåˆé‡ä¸ŠæœåŠ¡å™¨åˆ°æœŸç»­è´¹ï¼Œä¹Ÿæ˜¯æƒ³ç€å¼€å§‹æŠ˜è…¾ä¸‹äº†ã€‚\nå¼€æã€‚\nå®‰è£…ä»€ä¹ˆçš„ï¼Œçœ‹å®˜ç½‘æ–‡æ¡£å°±å¥½ã€‚\nhttps://docs.k3s.io/zh/quick-start\ncurl -sfL https://rancher-mirror.rancher.cn/k3s/k3s-install.sh \\\ncn user\ncurl -sfL https://rancher-mirror.rancher.cn/k3s/k3s-install.sh | INSTALL_K3S_MIRROR=cn sh -\nè¿™é‡Œä¸»è¦æ˜¯è®²å‡ ä¸ªæ³¨æ„äº‹é¡¹ã€‚\nä¸€ã€å®‰è£…äº‹é¡¹\nä¸Šé¢çš„è„šæœ¬å®‰è£…åœ¨æœ¬åœ°å®‰è£…å®Œæˆä¹‹åï¼Œ\né»˜è®¤ç›´æ¥è£…äº†ä¸€ä¸ªk3s.serviceï¼ŒåŒæ—¶ä¹ŸæŠŠk3s cliè£…å¥½äº†ï¼Œ\nè‡³äºè¿™ä¸ªèŠ‚ç‚¹æ˜¯ä¸ªserverè¿˜æ˜¯ä¸ªagentï¼Œ\nä¸»è¦å°±çœ‹è‡ªå·±æ€ä¹ˆå»æ”¹k3s.serviceçš„é…ç½®äº†ã€‚\né»˜è®¤è¿™ä¸ªæ˜¯å¯åŠ¨serverï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®éœ€æ±‚å¯åŠ¨æˆagentï¼Œ\næˆ–è€…ä½¿ç”¨å…¶ä»–çš„å‚æ•°é…ç½®ã€‚\näºŒã€è¾¹ç¼˜è®¡ç®—ç½‘ç»œ\næˆ‘è¿™è¾¹çš„Serveræ˜¯ä¸¤å°äº‘ç«¯çš„æœåŠ¡å™¨ï¼Œä»–ä»¬åœ¨åŒä¸€ä¸ªå±€åŸŸç½‘äº’é€šï¼Œé…ç½®èµ·æ¥å¾ˆç®€å•ã€‚\nä½†æ˜¯å…¶ä»–çš„æœºå™¨ï¼Œå¯èƒ½æ˜¯åœ¨æ²¡æœ‰å…¬ç½‘IPçš„æœ¬åœ°ï¼Œä¹Ÿå¯èƒ½æ˜¯å…¶ä»–äº‘çš„å•æœºå™¨ã€‚è¿™æ ·ä¸€æ¥ï¼Œè‚¯å®šå°±æ²¡åŠæ³•ç›´æ¥åšå†…ç½‘é€šè®¯äº†ã€‚\næŸ¥äº†ä¸€äº›èµ„æ–™ä¹‹åå‘ç°ï¼ŒWireGuard æ˜¯ä¸€ä¸ªå¾ˆä¸é”™çš„æ–¹æ¡ˆã€‚\nä»€ä¹ˆæ˜¯ WireGuardï¼Ÿ WireGuard æ˜¯ä¸€ä¸ªæ˜“äºé…ç½®ã€å¿«é€Ÿä¸”å®‰å…¨çš„å¼€æº VPNï¼Œå®ƒåˆ©ç”¨äº†æœ€æ–°çš„åŠ å¯†æŠ€æœ¯ã€‚ç›®çš„æ˜¯æä¾›ä¸€ç§æ›´å¿«ã€æ›´ç®€å•ã€æ›´ç²¾ç®€çš„é€šç”¨ VPNï¼Œå®ƒå¯ä»¥è½»æ¾åœ°åœ¨æ ‘è“æ´¾è¿™ç±»ä½ç«¯è®¾å¤‡åˆ°é«˜ç«¯æœåŠ¡å™¨ä¸Šéƒ¨ç½²ã€‚ WireGuard æœ€åˆæ˜¯ä¸º Linux å¼€å‘çš„ï¼Œä½†ç°åœ¨å¯ç”¨äº Windowsã€macOSã€BSDã€iOS å’Œ Androidã€‚å®ƒä»åœ¨æ´»è·ƒå¼€å‘ä¸­ã€‚ https://zhuanlan.zhihu.com/p/108365587\næœ€æ—©å‚è€ƒçš„æ˜¯ï¼š\nä½¿ç”¨ k3s å’Œ WireGuard ç½‘ç»œéƒ¨ç½² Kubernetes é›†ç¾¤ï¼šhttps://einverne.github.io/post/2021/12/kubernetes-cluster-multiple-clouds-using-k3s-netmaker-wireguard.html æŠ˜è…¾ä¸‹æ¥å‘ç°ï¼ŒNetmaker æ˜¯ä»˜è´¹é¡¹ç›®ï¼Œé…ç½®èµ·æ¥è¿˜æœ‰ä¸€äº›æ¦‚å¿µéœ€è¦ç†è§£ã€‚\nåæ­£ç¬¬ä¸€æ¬¡å¹¶æ²¡æœ‰æˆåŠŸï¼Œè€Œä¸”è¿™æ˜¯21å¹´çš„åšå®¢æ–‡ç« äº†,æœ‰ç‚¹è¿‡æ—¶ä¹Ÿæœ‰å¯èƒ½ã€‚\næ²¡æ­»å¿ƒï¼Œç»§ç»­æ‰¾èµ„æ–™æŠ˜è…¾ã€‚\näºæ˜¯çœ‹åˆ°äº† ã€æ¨æ–Œã€‘å¤§ä½¬çš„ä¸“æ æ–‡ç« ï¼š\nKubernetes å…¥é—¨åˆ°å®è·µï¼šå€ŸåŠ© WireGuard è·¨äº‘æ­å»º K3s é›†ç¾¤ç¯å¢ƒï¼šhttps://zhuanlan.zhihu.com/p/584998631 çœ‹äº†ä¸€åœˆä¸‹æ¥å‘ç°åº”è¯¥æ˜¯é€‚åˆæˆ‘è¿™è¾¹çš„ã€‚\nç”±äºæˆ‘çš„äº‘ä¸»æœºåˆ†å¸ƒåœ¨ä¸åŒçš„äº‘æœåŠ¡å•†ï¼Œæ‰€ä»¥ä¸èƒ½é€šè¿‡æœåŠ¡å•†çš„å†…ç½‘ç¯å¢ƒäº’ç›¸è®¿é—®ï¼Œè¿™é‡Œéœ€è¦å€ŸåŠ© WireGuard å®Œæˆå¼‚åœ°ç»„ç½‘ã€‚ç”±äº K3s é€šè¿‡ Flannel å·²ç»é›†æˆäº† WireGuardï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€äº›ç®€å•çš„é…ç½®å³å¯è½»æ¾å®Œæˆç»„ç½‘ã€‚https://zhuanlan.zhihu.com/p/584998631\næ‰€ä»¥æ–¹æ¡ˆå¤§ä½“æ˜¯ï¼š\nWireGuard å·¥å…·\nk3s Flannelåˆ‡æ¢æˆ wireguard-native\né‡å¯é›†ç¾¤éªŒè¯\nå®‰è£… WireGuard\nå®‰è£… WireGuard apt install wireguard resolvconf -y\nå¼€å¯ IPV4 IPè½¬å‘ echo \u0026ldquo;net.ipv4.ip_forward = 1\u0026rdquo; \u0026raquo; /etc/sysctl.conf sysctl -p\næˆ–è€…\ncentos7 sudo yum install epel-release elrepo-release -y; sudo yum install yum-plugin-elrepo -y; sudo yum install kmod-wireguard wireguard-tools systemd-resolved -y;\nå¼€å¯ IPV4 IPè½¬å‘ echo \u0026ldquo;net.ipv4.ip_forward = 1\u0026rdquo; \u0026raquo; /etc/sysctl.conf sysctl -p Centos é…ç½®å¥½äº†ä¹‹åå¯èƒ½éœ€è¦é‡å¯ä¸€ä¸‹æœºå™¨ï¼Œæ¯•ç«Ÿå†…æ ¸æ–‡ä»¶ä¹Ÿæ›´æ–°äº†ã€‚\nk3s Flannelåˆ‡æ¢\nä¿®æ”¹service å¯åŠ¨å‘½ä»¤ sudo vi /etc/systemd/system/k3s.service\nsudo systemctl daemon-reload sudo systemctl restart k3s\n/etc/systemd/system/k3s.service ExecStart=/usr/local/bin/k3s server \u0026ndash;node-external-ip å…¬ç½‘IP \u0026ndash;flannel-backend wireguard-native \u0026ndash;flannel-external-ip å…¬ç½‘Ip \u0026lsquo;\u0026ndash;tls-san\u0026rsquo; \u0026lsquo;å…¬ç½‘Ip\u0026rsquo; \u0026lsquo;\u0026ndash;node-name\u0026rsquo; \u0026lsquo;vm-16-12-ubuntu\u0026rsquo; \u0026lsquo;\u0026ndash;server\u0026rsquo; \u0026lsquo;https://å†…ç½‘IP:6443\u0026rsquo; \\\nå¤§æ¦‚å¦‚ä¸Šã€‚\næ²¡æœ‰é—®é¢˜çš„è¯ï¼Œé‡å¯è¿™ä¸ªæœåŠ¡å°±å¥½ã€‚\næœ‰é—®é¢˜å°±å»çœ‹æ—¥å¿—äº†ï¼Œé‡ç¥æ‹œç¥~\nserver æ²¡ä»€ä¹ˆé—®é¢˜çš„è¯ï¼Œæ¥ä¸‹æ¥å°±åˆ°äº†æŠ˜è…¾Agentçš„æ—¶å€™äº†ã€‚\nAgentä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„è¾¹ç¼˜èŠ‚ç‚¹äº†ã€‚\nAgent èŠ‚ç‚¹é…ç½®\nä¾æ—§è¿˜æ˜¯æ”¹k3s.service\né¦–å…ˆï¼Œä½ å¾—å…ˆçŸ¥é“ wireguard ä¼šç»™ä½ å“ªä¸ªåœ°å€ã€‚\næˆ‘ä¸€èˆ¬éƒ½æ˜¯å…ˆç›´æ¥ç”¨k3s agent å‘½ä»¤çœ‹ä¸‹è¿è¡Œè¾“å‡ºï¼Œæœ‰é—®é¢˜ä¹Ÿèƒ½é©¬ä¸Šçœ‹åˆ°ã€‚\nk3s agent \u0026ndash;node-name zj-hc1 \u0026ndash;lb-server-port 5443 \u0026ndash;server https://serverçš„å…¬ç½‘IP:6443 \u0026ndash;token=\u0026ldquo;ä½ çš„Token\u0026rdquo; ä¸Šé¢lb-server-port é»˜è®¤çš„6443ç«¯å£è¢«å…¶ä»–åº”ç”¨å ç”¨äº†ï¼Œæ‰€ä»¥æˆ‘æ”¹æˆäº†5443ï¼Œæ­£å¸¸æƒ…å†µä¸‹ä¸éœ€è¦åŠ ~\næ›´å¤šçš„é…ç½®é¡¹ç›®å¯ä»¥å‚è€ƒé…ç½®æ–‡æ¡£ï¼š\nhttps://docs.rancher.cn/docs/k3s/installation/install-options/agent-config/_index/\næ²¡ä»€ä¹ˆé—®é¢˜é—®é¢˜çš„ï¼Œåº”è¯¥èƒ½çœ‹åˆ°æ–°çš„èŠ‚ç‚¹ä¸Šæ¥äº†ã€‚\nOkçš„è¯ï¼Œ\nå» vi /etc/systemd/system/k3s.service æ”¹ä¸‹ï¼Œ\nç„¶åé‡å¯k3sã€‚\nsudo systemctl daemon-reload sudo systemctl restart k3s\nåŸºæœ¬å®Œäº‹ã€‚\nä¸€ä¸ªå®Œæ•´çš„k3s.service å¯åŠ¨å‘½ä»¤æ ¸å¿ƒå¦‚ä¸‹\nExecStart=/usr/local/bin/k3s agent \u0026ndash;node-name zj-hc2 \u0026ndash;lb-server-port 5443 \u0026ndash;node-ip 10.42.5.1 -node-external-ip å¤–ç½‘IPï¼Œå¦‚æœéœ€è¦Ingressè¦å†™ \u0026ndash;server https://ä½ çš„ServerIp:6443 \u0026ndash;token=\u0026ldquo;ä½ çš„Token\u0026rdquo;\nåˆ°è¿™é‡Œï¼Œæˆ‘ä»¬çš„é›†ç¾¤åŸºæœ¬ææ‚äº†ã€‚\nç®€å•æµ‹è¯•äº†ä¸€ä¸‹é€Ÿåº¦~\nåŸºæœ¬èƒ½è·‘å¾—èµ·æ¥éæ•æ„Ÿæ—¶å»¶çš„æœåŠ¡äº†ã€‚\nå®Œäº‹ã€‚\nå…¨æ–‡åœ¨é£é©°çš„é«˜é“ä¸Šå®Œæˆï¼Œè¿˜æ˜¯å€¼å¾—ä¸€ä¸ªèµçš„~\næ‰‹åŠ¨ç‹—å¤´~\nç¥å¤§å®¶å‡æœŸå¿«ä¹~\n","date":"2024-05-01T08:00:00Z","image":"https://liguobao.github.io/zh/p/k3s-edge-computing-cluster/k3s_hu_14ccdc70feded138.png","permalink":"https://liguobao.github.io/zh/p/k3s-edge-computing-cluster/","title":"ã€k3sã€‘å¹´åº¦æœ€ä½³è¾¹ç¼˜è®¡ç®—é›†ç¾¤æ–¹æ¡ˆ"},{"content":"ä½†æ˜¯ï¼Œéº»çƒ¦åˆ«äººæ€»æ˜¯ä¸å¤ªå¥½çš„ï¼Œæ¯•ç«Ÿæˆ‘ä¹Ÿæ²¡ç»™é’±\u0026hellip;.\nåæ­£æŠ€æœ¯é—®é¢˜ï¼Œé‚£ä¹ˆå°±ç”¨æŠ€æœ¯æ¥è§£å†³å‘—ã€‚\næ²¡ä»€ä¹ˆç¥å¥‡çš„ç©æ„ï¼Œå°±ä¸€å¥ä»£ç ã€‚\næ‰“å¼€å¯¹åº”çš„å›ç­”é¡µé¢ï¼Œå¦‚\nå‡å®šæ‰€æœ‰ç¨‹åºå‘˜å†™çš„ä»£ç éƒ½ä¸å‡ºbugï¼Œ ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ\nåœ¨è¿™ä¸ªé¡µé¢ï¼ŒF12æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°ï¼Œè¾“å…¥ä¸‹é¢è¿™ä¸€è¡Œä»£ç ã€‚\n1 2 document.getElementsByClassName(\u0026#34;RichContent RichContent--unescapable\u0026#34;)[0].innerText ç„¶åå¤§æ¦‚èƒ½çœ‹åˆ°ã€‚\nå¯¹ç€æ–‡æœ¬å³é”®ï¼Œé€‰æ‹© â€œCopy string contentsâ€ï¼Œç„¶åç²˜è´´åˆ°ä½ æƒ³è¦ç²˜è´´çš„åœ°æ–¹ã€‚\nå®Œäº‹ã€‚\n","date":"2024-04-27T08:00:00Z","image":"https://liguobao.github.io/zh/p/how-to-copy-zhihu-content/gqj_hu_bf9acab92d4ae1bd.png","permalink":"https://liguobao.github.io/zh/p/how-to-copy-zhihu-content/","title":"å¦‚ä½•åœ¨çŸ¥ä¹å¤åˆ¶ä¸€äº›ä¸é‚£ä¹ˆå¥½å¤åˆ¶çš„å†…å®¹~"},{"content":"By é™ˆé‡äº®-å¦‚ä½•è¯„ä»·å®«å´éªæ–°ä½œã€Šä½ æƒ³æ´»å‡ºæ€æ ·çš„äººç”Ÿã€‹ï¼Ÿ\næœ€è¿‘å› ä¸ºç²¾ç¥çŠ¶æ€é—®é¢˜ï¼Œåœ¨çŸ¥ä¹å†™å›ç­”å¯¹æˆ‘æ¥è¯´è¶Šæ¥è¶Šæˆä¸ºä¸€ä»¶è´Ÿæ‹…ï¼Œä½†æ˜¯åœ¨ç”µå½±é™¢ï¼Œå®«å´éªç»™äº†æˆ‘æ²¡æœ‰çƒ¦æ¼çš„ä¸¤ä¸ªå°æ—¶ï¼Œå›å®¶åçœ‹çŸ¥ä¹å›ç­”ï¼Œçœ‹ç€çœ‹ç€ï¼Œçªç„¶è§‰å¾—ï¼Œæˆ‘åº”è¯¥ç”¨æˆ‘çš„å®¡ç¾å’ŒçŸ¥è¯†å‚¨å¤‡ï¼Œæ¥ä¸ºè¿™ä¸ªä¸–ç•Œåšç‚¹ä»€ä¹ˆï¼Œå³ä½¿è¿™ä»¶äº‹å¯¹æˆ‘æ¥è¯´å¹¶ä¸æ„‰å¿«ã€‚\nã€Šä½ æƒ³æ´»å‡ºæ€æ ·çš„äººç”Ÿã€‹å¯¹äºå®«å´éªæ¥è¯´ï¼Œå°±æ˜¯ä¸€éƒ¨ä¸æ„‰å¿«çš„ä½œå“ï¼Œæˆ‘ç›¸ä¿¡çœ‹çš„æ—¶å€™è§‚ä¼—éƒ½èƒ½æ„Ÿå—åˆ°ã€‚\nåŒæ ·æ˜¯ä¸€ä½å°‘å¹´ã€ä¸€ä½å°‘å¥³ã€å¥‡å¹»çš„ä¸–ç•Œã€ä¸€åœºç››å¤§çš„å†’é™©ï¼Œåœ¨ã€Šåƒä¸åƒå¯»ã€‹ã€Šå¤©ç©ºä¹‹åŸã€‹ç­‰ä½œå“ä¸­ï¼Œæ•´ä½“ä¸Šæ˜¯è½»æ¾æ„‰æ‚¦çš„ã€‚ä¸»äººå…¬å†…å¿ƒå¹¶æ²¡æœ‰å¿ƒç»“ï¼Œåœ¨é¢å¯¹æœªæ¥æ—¶å¿ƒå¿µæ˜ç¡®ï¼Œçœ¼ç¥åšå®šã€‚\nä½†æ˜¯ã€Šä½ æƒ³æ´»å‡ºæ€æ ·çš„äººç”Ÿã€‹å°±å®Œå…¨ä¸ä¸€æ ·ï¼Œè™½ç„¶ä¸»äººå…¬çœ¼ç¥ä¾æ—§åšå®šï¼Œç›®æ ‡ä¾ç„¶æ˜ç¡®ï¼Œä½†ä»–å§‹ç»ˆæœ‰å¿ƒç»“ã€‚\nä»–çš„æ•Œäººä¸å†å…·æœ‰å®ä½“ï¼Œä¸æ˜¯åå¦ˆï¼Œä¸æ˜¯æ€ªé¸Ÿï¼Œä¸æ˜¯å¹½çµï¼Œä¸æ˜¯å ¡ä¸»ï¼Œä¸æ˜¯é¹¦é¹‰ï¼Œä¸»è§’éœ€è¦é¢å¯¹çš„éš¾é¢˜ååˆ†å¤æ‚ï¼Œä¸æ˜¯æŠŠåˆ€æ–©å‘è°ï¼Œæˆ–è€…æŠŠæªå¯¹å‡†è°ï¼Œé—®é¢˜å°±èƒ½å¾—åˆ°è§£å†³ã€‚ä»–ä¸èƒ½ç¦»å¼€ï¼Œä¹Ÿæ— æ³•æˆ˜æ–—ï¼Œå³ä½¿è§åˆ°æ¯äº²ä¹Ÿæ¯«æ— åŠæ³•ï¼Œå³ä½¿è§åˆ°å ¡ä¸»ä¹Ÿæ— æµäºäº‹ï¼Œä¸–ç•Œçš„å´©æºƒæ˜¯å¿…ç„¶ï¼Œä»–åªä¸è¿‡æ˜¯è§è¯è€Œå·²ã€‚\né‚£ä¹ˆï¼Œä¸ºä»€ä¹ˆå®«å´éªè¦æ‹ä¸€éƒ¨ä¸æ„‰å¿«çš„ç”µå½±å‘¢ï¼Ÿ\nå› ä¸ºè¿™éƒ¨ç‰‡å­ï¼Œä»–åˆ€åˆƒå¯¹ç€è‡ªå·±ã€‚\nè§£å‰–è‡ªå·±ä»æ¥ä¸æ˜¯è½»æ¾çš„äº‹ã€‚\nè¿™ç‰‡å­å®é™…ä¸Šè®²äº†ä¸€ä¸ªéå¸¸ç›´ç™½çš„æ•…äº‹ï¼Œåªè¦çœ‹æ‡‚å°±èƒ½æ˜ç™½ä»–ä¸ºä½•è¦ç•™ä¸‹ä¸€ä¸ªä¸è½»æ¾çš„å©é—®ã€‚æƒ³è¦çœ‹æ‡‚ç‰‡å­ï¼Œéœ€è¦æ­£ç¡®ç†è§£ç‰‡å­é‡Œçš„å‡ ä¸ªéšå–»ã€‚\nè¿™éƒ¨ç‰‡å­æœ‰æ— æ•°ä¸ªéšå–»ï¼Œä½†æ˜¯æˆ‘åªæ‹£å…¶ä¸­å…­ä¸ªï¼Œç»„æˆåŸºæœ¬è„‰ç»œï¼Œåˆ†ä¸ºä»¥ä¸‹å…­ä¸ªç« èŠ‚ï¼Œæ¥è®²æ¸…æ¥šè¿™åˆ°åº•æ˜¯ä¸ªä»€ä¹ˆæ•…äº‹ã€‚\n1ã€å¡”\nã€Šä½ æƒ³æ´»å‡ºæ€æ ·çš„äººç”Ÿã€‹åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼Œä¸€éƒ¨åˆ†æ˜¯1944å¹´æ—¶æœŸçš„æ—¥æœ¬ï¼Œè¿™æ˜¯ç°å®ä¸–ç•Œï¼Œå¦ä¸€éƒ¨åˆ†åˆ™æ˜¯å¡”é‡Œçš„ä¸–ç•Œï¼Œè¿™æ˜¯ä¸ªå¹»æƒ³ä¸–ç•Œã€‚\nè¿é€šä¸¤ä¸ªä¸–ç•Œçš„æ¡¥æ¢ï¼Œå°±æ˜¯å¡”ã€‚\nå…³äºå¡”çš„å­˜åœ¨ï¼Œç”µå½±é‡Œæœ‰ä¸¤ç§è¯´æ³•ï¼Œä¸€ç§æ˜¯ç»§æ¯å¤å­æä¾›çš„ï¼Œè¯´æ˜¯ä¸€ä½èªæ˜çš„å”å…¬å»ºèµ·æ¥çš„ã€‚å¦ä¸€ç§åˆ™æ˜¯ä½£äººä»¬é€éœ²çš„ï¼Œè¯´å¡”å…¶å®æ˜¯ä»å¤©è€Œé™ï¼Œèªæ˜çš„å”å…¬åªæ˜¯åœ¨å¤–å›´åŒ…è£¹èµ·äº†ä¸€å±‚å›´å¢™è€Œå·²ï¼Œæœ€ç»ˆå½¢æˆäº†ä¸€åº§å¡”ï¼Œåœ¨å»ºé€ å¡”çš„æ—¶å€™ï¼Œå‘ç”Ÿäº†å¾ˆå¤šæ€ªäº‹ï¼Œæ­»äº†å¾ˆå¤šäººã€‚\næƒ³è¦ç†è§£â€œå¡”â€éšå–»ç€ä»€ä¹ˆï¼Œéœ€è¦ç†Ÿæ‚‰æ—¥æœ¬è¿‘ä»£å†å²ã€‚\næ—¥æœ¬æˆ˜å›½æ—¶ä»£ç»“æŸåï¼Œè¿›å…¥äº†ç”±å¾·å·å¹•åºœç»Ÿæ²»çš„æ±Ÿæˆ·æ—¶ä»£ï¼Œéšç€é”å›½ä»¤çš„å®è¡Œï¼Œæ—¥æœ¬è¿›å…¥äº†é•¿è¾¾200å¤šå¹´çš„é—­å…³é”å›½æ—¶æœŸã€‚\næ‰“ç ´é”å›½ä»¤çš„æ˜¯è‘—åçš„â€œé»‘èˆ¹äº‹ä»¶â€ã€‚1854å¹´ï¼Œç¾å›½å‡†å°†é©¬ä¿®ä½©é‡Œé©¾é©¶èˆ°é˜Ÿè¿›å…¥æ±Ÿæˆ·æ¹¾ï¼Œä»¥ç‚®èˆ°å¨èƒå¾·å·å¹•åºœæ‰“å¼€å›½é—¨ï¼Œä¹‹åæ—¥æœ¬ç­¾è®¢äº†ã€Šæ—¥ç¾äº²å–„æ¡çº¦ã€‹ï¼Œè¿™æ˜¯æ—¥æœ¬ä¸è¥¿æ–¹å›½å®¶ç­¾è®¢çš„ç¬¬ä¸€ä¸ªæ¡çº¦ã€‚æ—¥æœ¬è¢«å¼ºè¿«çå¼€çœ¼çœ‹ä¸–ç•Œã€‚\néšç€æ—¥æœ¬å’Œä¸–ç•Œæ¥è½¨ï¼Œæ—¥æœ¬å›½å†…ä¸€éƒ¨åˆ†æœ‰è¯†ä¹‹å£«å¼€å§‹è°‹æ±‚å˜é©ï¼Œç»“åˆæ—¥æœ¬å›½å†…çš„ä¸‹çº§æ­¦å£«ä»¥åŠæœ‰å®åŠ›çš„è¥¿å—å„è—©ï¼Œå¼€å¯äº†è½°è½°çƒˆçƒˆçš„å€’å¹•è¿åŠ¨ï¼Œæœ€ç»ˆæ¨ç¿»äº†å¾·å·å¹•åºœï¼Œä»æ­¤ä¹‹åï¼Œå¤§æ”¿å¥‰è¿˜ç»™å¤©çš‡ï¼Œä¹Ÿå°±æ˜¯æ˜æ²»å¤©çš‡ã€‚ä»è¿™æ—¶èµ·ï¼Œå¼€å§‹äº†â€œæ˜æ²»ç»´æ–°â€ï¼Œä¹Ÿå¼€å¯äº†æ—¥æœ¬çš„è¿‘ä»£åŒ–ã€‚\nä»å¤©è€Œé™çš„å¡”ï¼Œæµ‘èº«æ¼†é»‘çš„å¤–è¡¨ï¼Œå®é™…ä¸Šæ˜¯æš—å–»ç€â€œé»‘èˆ¹äº‹ä»¶â€ï¼Œæ›´è¿›ä¸€æ­¥çš„è¯´ï¼Œæ˜¯æŒ‡è¥¿æ–¹ä¼ æ¥çš„è¿‘ä»£åŒ–æ€æƒ³ã€‚\næ‰€è°“â€œèªæ˜çš„å¤ªèˆ…å…¬â€ï¼ŒæŒ‡çš„ä¾¿æ˜¯ç»´æ–°æ´¾ã€‚æ˜æ²»ç»´æ–°ï¼Œå°±æ˜¯ä»¥è¥¿æ–¹æ€æƒ³ä¸ºå†…æ ¸ï¼Œå¤–é¢åŒ…è£¹ä¸Šæ—¥æœ¬åŒ–çš„ä¸œè¥¿ï¼Œæœ€åé€ å‡ºäº†ä¸€åº§æ´‹ä¸æ´‹ã€åœŸä¸åœŸçš„å¡”ã€‚\nä½†æ˜¯å¡”ä½œä¸ºæ²Ÿé€šä¸¤ä¸ªä¸–ç•Œçš„æ¡¥æ¢ï¼Œæˆ‘è®¤ä¸ºè‚¯å®šä¸æ˜¯æŒ‡æ˜æ²»ç»´æ–°ï¼Œå…¶éšå–»è¿˜è¦æ›´æ·±ä¸€å±‚ï¼šå®ƒåº”è¯¥æ˜¯æ˜æ²»ç»´æ–°åï¼Œæ—¥æœ¬æ”¿æ²»ã€å†å²ã€æ–‡åŒ–ä½“ç³»çš„é›†åˆä½“ã€‚æ­£å¦‚å¤§å®¶æ‰€è¯´ï¼Œâ€œå¡”çš„ä¸‹é¢æ˜¯ä¸€ä¸ªè¿·å®«â€ã€‚\nè¿›å…¥è¿™åº§å¡”ï¼Œå‡ºç°äº†ä¸€ä¸ªå¥‡å¹»ç‘°ä¸½çš„ä¸–ç•Œï¼Œåœ¨è¿™ä¸ªä¸–ç•Œé‡Œï¼Œä¸ªä¸ªåŠ¨ç‰©éƒ½æœ‰éšå–»ï¼Œåœ¨å¡”é‡Œï¼Œæ—¥æœ¬çš„æ”¿æ²»æ˜¯å¯è§†åŒ–çš„ã€‚å› æ­¤ï¼Œæˆ‘æ›´å€¾å‘äºè®¤ä¸ºâ€œå¡”â€ä»£è¡¨ç€æ—¥æœ¬çš„æ•´ä¸ªä½“åˆ¶ã€‚\n2ã€å¢“ä¸»äºº\nè¿™é‡Œè¦å°†å¢“ä¸»äººä½œä¸ºç¬¬äºŒä¸ªç« èŠ‚ã€‚å› ä¸ºæˆ‘çœ‹äº†ç½‘ä¸Šå¾ˆå¤šè§£æï¼Œå…¨éƒ½æ²¡æœ‰è§£é‡Šæ¸…æ¥šå¢“ä¸»äººçš„éšå–»ã€‚\nè€Œå¢“ä¸»äººçš„éšå–»åˆç›¸å½“é‡è¦ï¼Œå®ƒæ˜¯æ•´ä¸ªå¡”æ¥¼ä¸–ç•Œå´©æºƒçš„æ ¹æºï¼Œæ˜¯æ±¡æŸ“çš„æ¥æºï¼Œæ˜¯ä¸€åˆ‡çš„èµ·ç‚¹ã€‚\nç›¸ä¿¡ä¸å°‘äººçœ‹åˆ°è¿™é‡Œï¼Œä¼šä¸€å¤´é›¾æ°´ï¼šå¢“ä¸»äººæ˜¯è°ï¼Ÿæ€ä¹ˆå®Œå…¨æ²¡æœ‰å°è±¡äº†ï¼Ÿ\nç»™å¤§å®¶æä¸ªé†’ã€‚\nåœ¨çœŸäººæ¥åˆ°è¿™ä¸ªå¥‡å¹»ä¸–ç•Œæ—¶ï¼Œç¬¬ä¸€ä¸ªè§åˆ°çš„ï¼Œå°±æ˜¯è¿™åº§åŸå¢“ã€‚\nå¤–é¢ç”¨å›´å¢™å›´ç€ï¼Œæœ‰ç€ä¸€æ‰‡é‡‘è‰²çš„å¤§é—¨ï¼Œé—¨å†…å´æ˜¯ç”¨çŸ³å¤´æ­æˆçš„å¢“ç©´ï¼Œéå¸¸ç®€é™‹ã€‚\nåœ¨é—¨ä¸Šï¼Œè¿˜å†™ç€ä¸€è¡Œå­—ï¼šâ€œå­¦æˆ‘è€…æ­»â€ã€‚\nå¯¹äºè¿™åº§å¢“ï¼Œå¼ºå¤§çš„é›¾å­éƒ½å¦‚ä¸´å¤§æ•Œï¼Œé¹ˆé¹•ä»¬å´‡æ‹œä½†æ˜¯åªèƒ½å‘å¾®åœ°ä¼åœ¨é—¨å¤–ï¼Œè€Œè‡ªå§‹è‡³ç»ˆï¼Œè¿™åº§å¢“çš„ä¸»äººéƒ½æœªæ›¾å‡ºæ¥è¿‡ã€‚\nä¸ºä»€ä¹ˆå®«å´éªè¦åœ¨å¹»æƒ³å†’é™©çš„å¼€å¤´éƒ¨åˆ†å®‰æ’è¿™æ ·ä¸€ä¸ªæƒ…èŠ‚ï¼Œä¸ºä»€ä¹ˆä»–åé¢åˆæ²¡æœ‰æåˆ°è¿™åº§å¢“äº†ï¼Œæ˜¯ä»–å¿˜è®°äº†å—ï¼Ÿ\næƒ³è¦ç ´è§£è¿™ä¸ªéšå–»ï¼Œéœ€è¦äº†è§£ä¸–ç•Œå†å²ã€‚\n1500å¹´å·¦å³ï¼Œæ¬§æ´²äººå¼€å¯äº†åœ°ç†å¤§å‘ç°æ—¶ä»£ï¼Œæ‰€è°“åœ°ç†å¤§å‘ç°ï¼Œæ˜¯ç«™åœ¨æ¬§æ´²äººçš„è§†è§’ï¼Œâ€œå‘ç°â€äº†å¾ˆå¤šä¹‹å‰å¯¹äºä»–ä»¬æ¥è¯´â€œä¸å­˜åœ¨â€çš„åœ°æ–¹ã€‚\nè™½ç„¶è¯´æ˜¯åœ°ç†å¤§å‘ç°ï¼Œä½†æ˜¯ç»™å…¨ä¸–ç•Œå¸¦æ¥äº†å·¨å¤§ç¾éš¾ã€‚\næ¬§æ´²äººåœ¨éæ´²è´©å–å»‰ä»·å•†å“ï¼ŒæŒ‘åŠ¨éƒ¨æ—å†…æˆ˜ï¼Œæ”¶å‰²é»‘å¥´ï¼Œåœ¨ç¾æ´²ä¼ æ’­ç˜Ÿç–«ï¼Œå± æ€å°ç¬¬å®‰äººï¼Œåœ¨äºšæ´²æ›´ä¸å¿…è¯´ï¼Œå¼ºè¿«è½åå°å»ºç‹æœç­¾è®¢ä¸å¹³ç­‰æ¡çº¦ï¼Œæ‰¶æ¤ä»£ç†æ”¿åºœã€‚\nåœ¨â€œåœ°ç†å¤§å‘ç°â€çš„åˆæœŸï¼Œæ¬§æ´²ä»å¯è’™æ—¶ä»£è¿›å…¥èµ„æœ¬ä¸»ä¹‰é˜¶æ®µï¼Œåœ¨â€œåœ°ç†å¤§å‘ç°â€çš„æœ«æœŸï¼Œä»–ä»¬å®Œæˆäº†èµ„æœ¬ä¸»ä¹‰çš„è¡€è…¥åŸå§‹ç§¯ç´¯ï¼Œå…¨çƒä¸»è¦èµ„æœ¬ä¸»ä¹‰å›½å®¶è¿›å…¥å¸å›½ä¸»ä¹‰é˜¶æ®µã€‚\næ‰€è°“å¸å›½ä¸»ä¹‰ï¼Œå³æ˜¯â€œå„æ–­èµ„æœ¬ä¸»ä¹‰â€ï¼Œæ˜¯æŒ‡é€šè¿‡èµ„æœ¬è¾“å‡ºï¼Œåˆ©ç”¨å…¶å®ƒå›½å®¶çš„åŠ³åŠ¨åŠ›ã€åŸæ–™ï¼Œä¸ºæœ¬å›½èµšå–åˆ©æ¶¦ã€‚\nç”±æ®–æ°‘åœ°æä¾›åŸæ–™ï¼Œç”±è¡€æ±—å·¥å‚è¿›è¡Œç”Ÿäº§ï¼Œå†å€¾é”€åˆ°å…¨çƒï¼Œé€šè¿‡è¿™ä¸ªå¾ªç¯ï¼Œèµ„æœ¬å®¶è·å–äº†å·¨é¢åˆ©æ¶¦ã€‚\nè¿™æœ¬è´¨ä¸Šï¼Œæ˜¯å…ˆè¿›åœ°åŒºå¯¹è½ååœ°åŒºçš„å‰¥å‰Šï¼Œæ˜¯èµ„äº§é˜¶çº§å¯¹æ— äº§é˜¶çº§çš„å‰¥å‰Šã€‚\næœ‰äººä¼šè¯´ï¼Œè¿™ç§ä½“åˆ¶æ˜¯å…¬å¹³çš„å‘€ï¼Œä½ æœ‰èµ„æœ¬ï¼Œä½ ä¹Ÿå¯ä»¥å»å‰¥å‰Šè½ååœ°åŒºï¼Œä½ è¦æ˜¯å…ˆè¿›ï¼Œä½ ä¹Ÿå¯ä»¥å»æ®–æ°‘å…¶ä»–åœ°æ–¹ã€‚\nç¡®å®ã€‚å¾·å›½ä¹Ÿæ˜¯è¿™æ ·æƒ³çš„ã€‚\nåœ¨æ®–æ°‘ä¸»ä¹‰ç››è¡Œçš„æ—¶æœŸï¼Œå…ˆå‘å›½å®¶å¯¹äºåå‘å›½å®¶çš„ä¼˜åŠ¿æ˜¯æ¯‹åº¸ç½®ç–‘çš„ï¼Œå€¾é”€ä¸è¢«å€¾é”€ï¼Œå‰¥å‰Šä¸è¢«å‰¥å‰Šï¼Œä¸åœ¨é¤æ¡Œä¸Šï¼Œå°±åœ¨èœå•ä¸Šã€‚å†æ¥å¦‚æ­¤ã€‚\nç«™åœ¨ä¸œæ–¹è§†è§’ï¼Œæ¬§æ´²äººå¼€å¯çš„æ®–æ°‘æ—¶ä»£ï¼Œå®é™…ä¸Šæ˜¯ç»™è¿™ä¸ªä¸–ç•Œé‡æ–°è®¢ç«‹äº†ä¸€ä¸ªè¡€è…¥çš„è§„åˆ™ï¼šå¿…é¡»ä¾é æš´åŠ›æ¥æ‰©å¼ ï¼Œä¹‹åè·å¾—æ›´å¤§èµ„æœ¬çš„ç«™åœ¨ç”Ÿæ€é«˜ä½ï¼Œä¾¿æœ‰æƒå‰¥å‰Šä¸‹å±‚çš„å›½å®¶ã€äººæ°‘ã€‚\nå¢“ä¸»äººçš„éšå–»ï¼Œå…³é”®åœ¨äºé‡‘è‰²å¤§é—¨ä¸Šçš„é‚£è¡Œå­—ï¼š\nâ€œå­¦æˆ‘è€…æ­»â€ã€‚\nè¿™å¥è¯æ˜¯å®«å´éªä¸€è¯­é“ç ´äº†å¸å›½ä¸»ä¹‰çš„æœ¬è´¨ã€‚è¿™å¥è¯ä¸æ˜¯å¢“ä¸»äººçš„å¥½å¿ƒè§„åŠï¼Œè€Œæ˜¯å¢“ä¸»äººåˆ‡å®çš„å¨èƒï¼šå­¦æˆ‘è€…æ­»ã€‚\næˆ‘å¯ä»¥åœ¨å…¨çƒèŒƒå›´å±•å¼€æ®–æ°‘ï¼Œä½ ä¸å¯ä»¥ã€‚\næˆ‘å¯ä»¥åˆ©ç”¨èµ„æœ¬æ”¶å‰²å…¨çƒï¼Œä½ ä¸å¯ä»¥ã€‚\né‚£åº§å¤–è¡¨é‡‘å…‰ç¿ç¿çš„å¢“åœ°ï¼Œå…¶éšå–»ï¼Œå°±æ˜¯æŒ‡è¿™ä¸€ç¾¤æ­»è€Œä¸åƒµçš„è€ä¸œè¥¿ã€‚\nè€ç‰Œå¸å›½ä¸»ä¹‰ã€‚old moneyã€‚\næ‰€æœ‰äººéƒ½æ€•ä»–ä»¬ï¼Œæ‰€æœ‰äººéƒ½ä¸æ•¢å¾—ç½ªä»–ä»¬ã€‚æ˜¯ä»–ä»¬å¼€å¯äº†ç½ªæ¶çš„å¾ªåï¼Œä¹Ÿæ˜¯ä»–ä»¬å¤ºå–äº†æœ€å¤§çš„åˆ©ç›Šï¼Œæ˜¯ä»–ä»¬åˆ¶å®šäº†è§„åˆ™ã€‚\nå¦‚æœæ²¡æœ‰ä»–ä»¬ï¼Œå…¨ä¸–ç•Œéƒ½è¿˜ç”Ÿæ´»åœ¨ç”°å›­ç‰§æ­Œçš„ä¸–ç•Œå½“ä¸­ï¼Œäººç±»ä¸ä¼šé™·å…¥æ³¢åŠå…¨çƒçš„é«˜çƒˆåº¦æˆ˜äº‰ã€‚ä¹Ÿæ˜¯å› ä¸ºä»–ä»¬çš„è¿™ä¸€å¥—â€œèµ„æœ¬â€çš„ç©æ³•ï¼Œè®©å…¨çƒé™·å…¥äº’ç›¸åå™¬çš„æ€ªåœˆå½“ä¸­ï¼Œä¸ºäº†é‡‘é’±è€Œç–¯ç‹‚ã€‚\nä»–ä»¬æ˜¯æ±¡æŸ“çš„æºå¤´ã€‚\n3ã€é¹ˆé¹•\nè¿™æ˜¯ä¸€ç¾¤å¯æ€œçš„å®¶ä¼™ã€‚å®ƒä»¬è´ªå©ªï¼Œå®ƒä»¬èƒ†æ€¯ï¼Œå®ƒä»¬ä»å¢“ä¸»äººé‚£é‡Œå­¦åˆ°äº†â€œåƒäººâ€ã€‚\nå®ƒä»¬åƒä¸äº†æµ·é‡Œçš„é±¼ï¼Œäºæ˜¯å°±è·‘å»åƒå“‡å•¦å“‡å•¦ã€‚\né¹ˆé¹•éšå–»ç€æ˜æ²»ç»´æ–°ä¹‹åï¼Œæ—¥æœ¬å›½å†…çš„æ–°å…´åŠ¿åŠ›ï¼Œä¹Ÿå°±æ˜¯çœŸäººçš„çˆ¸çˆ¸é‚£ä¸ªé˜¶å±‚ã€‚\næ°‘è¥èµ„æœ¬ã€‚\nè¿™äº›æ°‘è¥èµ„æœ¬ä»è€ç‰Œå¸å›½ä¸»ä¹‰é‚£é‡Œå­¦åˆ°äº†æ‰©å¼ å’Œèµ„æœ¬æ»šé›ªçƒï¼Œä½†æ˜¯â€œæµ·é‡Œçš„é±¼å¤§éƒ¨åˆ†æŠ“ä¸äº†â€ï¼Œæ²¡é‚£ä¸ªèƒ½åŠ›ã€‚\né±¼æ˜¯å¡”å†…ä¸–ç•Œé‡Œå”¯ä¸€ä¸ä¼šè¯´è¯çš„ï¼Œè¿å£°éŸ³éƒ½ä¸æ›¾å‘å‡ºï¼Œå› æ­¤å¯ä»¥è®¤ä¸ºå®ƒä»¬ä¸æŒ‡ä»£ä»»ä½•å®é™…ç‰©ï¼Œæˆ‘è®¤ä¸ºï¼Œæµ·é±¼åº”è¯¥æ˜¯æŒ‡â€œä¼ ç»Ÿçš„è‡ªç„¶ç»æµâ€ã€‚\nå‡ºæµ·æ•é±¼ï¼Œæˆ‘åƒè‚‰ï¼Œé±¼æ²¹æµå‡ºæ¥åˆ†ç»™å“‡å•¦å“‡å•¦ï¼Œå“‡å•¦å“‡å•¦åƒé¥±åå°±å¯ä»¥é£åˆ°å¤©ä¸Šå»æŠ•èƒï¼Œæˆä¸ºä¸–ç•Œçš„æœªæ¥ã€‚\nè¿™æ˜¯åœ¨å¸å›½ä¸»ä¹‰æ€æ½®ä¼ å…¥æ—¥æœ¬ä¹‹å‰ï¼Œæ—¥æœ¬åŸæœ¬çš„è‡ªç„¶ç»æµæ¨¡å¼ï¼Œå“‡å•¦å“‡å•¦å³æ˜¯äººæ°‘ã€‚åªæœ‰äººæ°‘èƒ½ç”Ÿç”Ÿä¸æ¯ï¼Œæ•´ä¸ªä¸–ç•Œæ‰èƒ½ç»´æŒè¿è½¬ã€‚\nä½†æ˜¯é¹ˆé¹•è¿™ç§ç”Ÿç‰©æ˜¯è¢«å¼ºè¡Œå¡è¿›æ¥çš„ã€‚å°±å¦‚åŒæ˜æ²»åæ—¥æœ¬çš„èµ„æœ¬ä¸»ä¹‰ä¸€æ ·ï¼Œå®ƒä»¬æ²¡æœ‰ç»å†è¿‡è¥¿æ–¹èµ„æœ¬ä¸»ä¹‰èŒèŠ½â€”â€”åŸå§‹èµ„æœ¬ç§¯ç´¯â€”â€”å½¢æˆåºå¤§åŠ¿åŠ›è¿™ä¸ªé˜¶æ®µï¼Œæ‰€ä»¥å®ƒä»¬ä¸èƒ½åƒä¼ ç»Ÿçš„è‡ªç„¶ç»æµä¸€æ ·è¿ä½œï¼Œåˆæ²¡åŠæ³•å»åŠ¨å¢“ä¸»äººçš„è›‹ç³•ï¼Œèƒ½åšçš„ï¼Œä¾¿åªæœ‰å‘å†…å‹è¿«å“‡å•¦å“‡å•¦ã€‚\né¹ˆé¹•ä¹ŸçŸ¥é“åƒå“‡å•¦å“‡å•¦ä¼šæ–­é€æœªæ¥ï¼Œä½†æ˜¯å¢“ä¸»äººå¸¦æ¥çš„æ³•åˆ™ä¾¿æ˜¯â€œä¸æ‰©å¼ å°±ä¼šæ¶ˆäº¡â€ï¼Œæ‰€ä»¥é¹ˆé¹•åªèƒ½é åƒå“‡å•¦å“‡å•¦æ¥ç›²ç›®æ‰©å¼ ï¼Œå¯æ˜¯å³ä½¿è¿™æ ·è¿˜æ˜¯ä¸å¤Ÿï¼Œæ–°ç”Ÿçš„é¹ˆé¹•å·²ç»ä¸ä¼šé£äº†ã€‚\näºæ˜¯ï¼Œé¹ˆé¹•å˜æˆäº†é¹¦é¹‰ã€‚\nçœŸäººçš„çˆ¸çˆ¸ç”Ÿäº§é›¶å¼æˆ˜æ–—æœºçš„å¤–å£³ï¼Œè¿™å°±æ˜¯é¹ˆé¹•å’Œé¹¦é¹‰æ²†ç€£ä¸€æ°”çš„å®è´¨è¯æ®ã€‚\n4ã€é¹¦é¹‰\né¹¦é¹‰æ˜¯æ•´éƒ¨ç”µå½±é‡Œæœ€æ˜æ˜¾çš„ä¸€ä¸ªéšå–»ï¼Œå°±æ˜¯å†›å›½ä¸»ä¹‰ã€‚\nå®«å´éªæ€•ä½ çœ‹ä¸æ‡‚ï¼Œå°±å·®æŠŠå«ç”Ÿèƒ¡è´´åœ¨é¹¦é¹‰è„¸ä¸Šäº†ã€‚\né‚£ä¹ˆå†›å›½ä¸»ä¹‰æ˜¯æ€ä¹ˆæ¥çš„å‘¢ï¼Ÿ\né¹ˆé¹•æ•ä¸äº†æµ·é‡Œçš„é±¼ï¼Œå¢“ä¸»äººåˆè¯´å­¦æˆ‘è€…æ­»å¾—ç½ªä¸èµ·ï¼Œé‚£ä¹ˆæ—¥æœ¬åªèƒ½ä»¥ç›´æ¥æš´åŠ›ï¼Œèµ°ä¸Šæ‰©å¼ çš„æ‰‹æ®µï¼Œå‚ä¸åˆ°ç“œåˆ†è½ååœ°åŒºçš„ç‹‚æ½®å½“ä¸­ã€‚\n1874å¹´ï¼Œæ—¥æœ¬å‘åŠ¨ä¾µå å°æ¹¾çš„æˆ˜äº‰ï¼ŒåŒæ¸…æ”¿åºœç­¾è®¢ã€ŠåŒ—äº¬ä¸“çº¦ã€‹ï¼Œè·å¾—50ä¸‡ä¸¤ç™½é“¶çš„æˆ˜äº‰èµ”æ¬¾ã€‚\n1875å¹´ï¼Œå…¥ä¾µæœé²œæ±Ÿåå²›ï¼Œè¿«ä½¿æœé²œç­¾è®¢ã€Šæ±Ÿåæ¡çº¦ã€‹ã€‚\n1894å¹´ï¼Œå‘åŠ¨ä¸­æ—¥ç”²åˆæˆ˜äº‰ã€‚\n1900å¹´ï¼Œå‚ä¸å…«å›½è”å†›ä¾µåã€‚\n1904å¹´ï¼Œä¸ä¿„å›½çˆ†å‘æ—¥ä¿„æˆ˜äº‰ã€‚\n1914å¹´ï¼Œä¸€æˆ˜ä¸­ï¼Œå¯¹å¾·å®£æˆ˜ï¼Œå é¢†é’å²›ã€èƒ¶å·æ¹¾ã€æµå—ï¼Œè¿«ä½¿åŒ—æ´‹æ”¿åºœç­¾è®¢ã€ŠäºŒåä¸€æ¡ã€‹ã€‚\n1918å¹´ï¼Œå‡ºå…µè¥¿ä¼¯åˆ©äºšã€‚1927å¹´ï¼Œä¾µå ä¸œåŒ—ã€‚1939å¹´ï¼Œå‘åŠ¨å¤ªå¹³æ´‹æˆ˜äº‰ã€‚\nåœ¨ä¸€æ¬¡æ¬¡æˆ˜äº‰ä¸­ï¼Œé¹¦é¹‰çš„åŠ¿åŠ›è¶Šæ¥è¶Šåºå¤§ã€‚æœ€åˆçš„å‡ åœºæˆ˜äº‰å®é™…ä¸Šéƒ½æ˜¯èµŒå›½è¿çš„æˆ˜äº‰ï¼Œæ—¥æœ¬è°¨æ…åˆå°å¿ƒï¼Œæ…¢æ…¢èš•é£Ÿï¼Œç›´åˆ°åæ¥èƒƒå£è¶Šæ¥è¶Šå¤§ï¼Œé‡å¿ƒè¶Šæ¥è¶Šè†¨èƒ€ã€‚\né¹¦é¹‰è†¨èƒ€çš„é‡å¿ƒå’Œå‚²æ…¢ï¼Œæœ€ç»ˆå¯¼è‡´äº†è¿™ä¸ªä¸–ç•Œçš„æ¯ç­ã€‚\n5ã€å ¡ä¸»\nå ¡ä¸»çš„éšå–»ä¹Ÿå¾ˆæ˜æ˜¾ï¼Œæ˜¯å®«å´éªè‡ªå·±ã€‚\nä»–çš„åä¸‰å—ç§¯æœ¨ï¼Œå¯¹åº”ç€ä»–çš„13éƒ¨ä½œå“ã€‚\nä»–æ‰€åšçš„ï¼Œåœ¨å½±ç‰‡é‡Œè¯´å¾—ä¹Ÿå¾ˆæ¸…æ¥šâ€œå¯»æ‰¾å¹²å‡€çš„çŸ³å¤´ï¼Œæ¥æ­å»ºç§¯æœ¨â€ã€‚æ­£å¦‚ä»–çš„ä½œå“ä¸€æ ·ã€‚å®«å´éªçš„ä½œå“é‡Œä»æ¥æ²¡æœ‰è¡€è…¥ã€æš´åŠ›ã€æ€æˆ®ã€‚\nä»–æŠŠé‚£äº›æ²¡æœ‰è¢«ä¸–ç•Œç¤¾ä¼šè§„åˆ™æ±¡æŸ“è¿‡çš„ç«¥çœŸã€æ¢¦æƒ³ã€å¹»æƒ³ï¼Œå…¨éƒ½æ¡èµ·æ¥ï¼Œæ‹¼æˆä¸€åº§å¡”ï¼Œç»´æŒå¿ƒçµä¸–ç•Œã€‚\nä½†æ˜¯ä»–ä¹Ÿæ˜¯æ‚²è§‚çš„ï¼Œç”šè‡³ç»æœ›äº†ï¼Œå› ä¸ºæ²¡æœ‰è¢«æ±¡æŸ“è¿‡çš„çŸ³å¤´è¶Šæ¥è¶Šå°‘äº†ã€‚\nåœ¨å®«å´éªçš„ä¸–ç•Œè§‚é‡Œï¼Œç”±å¢“ä¸»äººå¼€å¯çš„è¿™ç§æ±¡æŸ“ï¼Œå®é™…ä¸Šç¬¦åˆæ ¹æ¤äºäººç±»æœ¬æ€§ä¸­çš„è´ªå©ªï¼Œæœ€ç»ˆå½¢æˆçš„è¿™å¥—ç¤¾ä¼šè§„åˆ™ï¼Œå¼ºè¿«äººä»¬ä»¥è´¢å¯Œã€èµ„æœ¬è¡¡é‡äººç”Ÿæ˜¯å¦æˆåŠŸçš„æ ‡å¿—ã€‚\nå³ä½¿å¿ƒçµå†çº¯çœŸçš„å­©å­ï¼Œé•¿å¤§åå†ä¸æ„¿æ„åŠ å…¥è¿™å¥—è§„åˆ™ï¼Œä¹Ÿå¿…é¡»å‘è¿™å¥—è§„åˆ™ä½å¤´ã€‚\nå°±æ¯”å¦‚å®«å´éªè‡ªå·±ï¼Œä»–æ‹¼å‡‘å‡ºæ¥çš„ç§¯æœ¨çœŸçš„æ²¡æœ‰è¢«æ±¡æŸ“å—ï¼Ÿä»–æ­å»ºå‡ºæ¥çš„ä½œå“ï¼Œç…§æ ·è¦æœä»å•†ä¸šæ€§ï¼Œè®©ä½œå“å–å‡ºæ›´å¤šçš„é’±ï¼Œè¿™æ ·æ‰èƒ½å¤Ÿæ‹ä¸‹ä¸€éƒ¨ä½œå“ã€‚\næ±¡æŸ“æ˜¯æ— æ­¢å¢ƒçš„ã€‚\nä»–æƒ³åšçš„ï¼Œæ˜¯å°½é‡æ‹¼å‡ºä¸€ä¸ªç¨³å®šçš„ï¼Œä¸ä¼šå€’å¡Œçš„å¡”ï¼Œä½†è¿™æ³¨å®šæ˜¯ä¸æˆåŠŸçš„ï¼Œåœ¨é¹¦é¹‰å¤§ç‹çœ¼é‡Œï¼Œè¿™æœ¬å°±æ˜¯å¾ˆè’å”çš„äº‹æƒ…â€”â€”ä¸–ç•Œæ€ä¹ˆå¯èƒ½å› ä¸ºä½ æ‹¼å‡ºæ¥çš„è¿™åº§å¡”è€Œæ”¹å˜å‘¢ï¼Ÿ\næ‰€ä»¥æœ€åï¼Œé¹¦é¹‰å¤§ç‹éšä¾¿æ‹¼äº†ä¸€åº§å¡”ï¼Œå‘ç°ä¸å¯¹åŠ²åï¼Œç›´æ¥ä¸€åˆ€åŠˆäº†ï¼Œéšåä¸–ç•Œå°±æ¯ç­äº†ã€‚\nä¸¤é¢—åŸå­å¼¹è½ä¸‹ï¼ŒäºŒæˆ˜ç»“æŸï¼Œæ—¥æœ¬æ— æ¡ä»¶æŠ•é™ï¼Œæ–°çš„æ—¥æœ¬è¯ç”Ÿäº†ã€‚\nå½“æ‰€æœ‰åŠ¨ç‰©éƒ½æ…Œæ…Œå¼ å¼ åœ°ä»å¡”é‡Œé€ƒå‡ºæ¥æ—¶ï¼Œé¹¦é¹‰ä¹Ÿè·Ÿç€ä¸€èµ·å‡ºæ¥äº†ï¼Œåˆšåˆšå‡ºæ¥ï¼Œç¬é—´åŒ–èº«æˆä¸ºæ— å®³çš„å°é¸Ÿï¼Œå¯çˆ±åœ°ä¾ååœ¨äººä»¬è‚©å¤´ï¼Œå¹¶ä¸”é£ç¿”å‡ºå»ï¼Œåœ¨äººä»¬è„¸ä¸Šæ‹‰ä¸‹ä¸€å¨å¨å±ã€‚\nç›¸ä¿¡å¾ˆå¤šè§‚ä¼—æ³¨æ„åˆ°äº†ï¼ŒçœŸäººä»å¡”é‡Œå‡ºæ¥æ—¶ï¼Œè„¸ä¸Šæ²¾äº†é¹¦é¹‰å±ï¼Œå…¶ä»–äººèº«ä¸Šæˆ–å¤šæˆ–å°‘éƒ½æ²¾äº†é¹¦é¹‰å±ã€‚\nä¸ºä»€ä¹ˆå®«å´éªè¦ç”»è¿™æ ·çš„é•œå¤´ï¼Œæ˜¯æç¬‘ï¼Ÿæ˜¯ä¸¥è°¨ï¼Ÿè¿˜æ˜¯éšä¾¿ç”»çš„ï¼Ÿ\nè¿™ä¹ˆé•¿çš„ç”µå½±ï¼Œæ‰€æœ‰çš„é•œå¤´éƒ½æ²¡æœ‰éšä¾¿ã€‚ä»–æ˜¯åˆ»æ„è¦ç”»è¿™äº›é¹¦é¹‰å±çš„ã€‚\nä¸€å‡ºäº†å¡”ï¼Œé¹¦é¹‰é©¬ä¸Šå˜å¾—å½¬å½¬æœ‰ç¤¼èµ·æ¥ï¼Œå¹¶ä¸”æ¯«æ— æƒ©ç½šåœ°é£èµ°äº†ã€‚è¿™ä¸æ˜¯å®«å´éªå–œæ¬¢è¿™äº›é¹¦é¹‰ï¼Œä¸æ˜¯å®«å´éªåªåæˆ˜è´¥ä¸åæˆ˜ã€‚\nè¿™æ˜¯äº‹å®ã€‚\nç»è¿‡æ”¹é€ åçš„æ—¥æœ¬ï¼Œå½“åˆé‚£äº›å‘åŠ¨æˆ˜äº‰çš„æˆ˜çŠ¯å—åˆ°æƒ©ç½šæ²¡æœ‰å‘¢ï¼Ÿæ²¡æœ‰ã€‚ç”šè‡³è¿˜æ´»å¾—ç›¸å½“å¥½ã€‚\nå°±è¿å¤©çš‡ï¼Œä½œä¸ºå›½å®¶çš„å…ƒé¦–ï¼Œéƒ½æ ¹æœ¬æ²¡æœ‰å—åˆ°æƒ©ç½šã€‚\nåœ¨å†å²ä¸­ï¼Œæ˜­å’Œå¤©çš‡è¢«åŒ…è£…æˆâ€œæ²¡æœ‰æ’æ‰‹ï¼Œä¸è¿‡æ²³â€ï¼Œå®é™…ä¸Šï¼Œæ˜æ²»ç»´æ–°åæ—¥æœ¬çš„ä½“åˆ¶å°±æ˜¯æ“æŒåœ¨å¤©çš‡ä¸€äººæ‰‹ä¸­ï¼Œæ‰ä¸æ˜¯åƒè¥¿æ–¹é‚£æ ·çš„æ ·å­è´§ã€‚\nåœ¨æ—¥æœ¬çš„æ–°æ”¿åºœä¸­ï¼Œå¤šå°‘äººéƒ½æ˜¯å‘äº†æˆ˜äº‰è´¢ï¼Œå®‰ç„¶æ— æ™åœ°æ´»åˆ°æ–°æ—¶ä»£ï¼Ÿå¹¶ä¸”å­å­å­™å­™ï¼Œéƒ½ç»§æ‰¿å®¶æ—è¡£é’µï¼Ÿ\nå°±æ¯”å¦‚æ—¥æœ¬ç°ä»»è‡ªæ°‘å…šå‰¯æ€»è£éº»ç”Ÿå¤ªéƒï¼Œä»–çš„çˆ¶äº²éº»ç”Ÿå¤ªè´ºå‰å°±æ˜¯ç…¤çŸ¿èµ·å®¶ï¼Œåœ¨äºŒæˆ˜æœŸé—´ï¼Œå¼ºå¾æœé²œåŠ³å·¥ï¼Œèµšå¾—ç›†æ»¡é’µæ»¡ï¼Œå¹¶ä¸”å¨¶äº†å‰ç”°èŒ‚çš„å¥³å„¿ï¼Œä¸ºå‰ç”°èŒ‚æä¾›äº†æ— æ•°æ”¿æ²»é‡‘ã€‚éšåï¼Œéº»ç”Ÿå¤ªéƒæœ¬äººä¹Ÿå¨¶äº†é“ƒæœ¨é¦–ç›¸çš„å¥³å„¿ï¼Œä¹‹åè‡ªå·±ä¹Ÿå½“ä¸Šè¿‡é¦–ç›¸ã€‚\nåƒéº»ç”Ÿå¤ªéƒè¿™æ ·çš„ä¸æ˜¯ä¸ªä¾‹ï¼Œå¾ˆå¤šå¾ˆå¤šã€‚\né¹¦é¹‰æ‹‰çš„å±ï¼Œå¹³ç­‰åœ°è½åœ¨æ¯ä¸€ä¸ªäººè„¸ä¸Šã€‚\nè¯´å›ç”µå½±ï¼Œåœ¨å½±ç‰‡æœ€åï¼Œæ‰€æœ‰åŠ¨ç‰©éƒ½ä»å¡”é‡Œå‡ºæ¥äº†ï¼Œå‡ ä¹æ‰€æœ‰åŠ¨ç‰©éƒ½å‘ç”Ÿäº†å˜å½¢ï¼Œé¹¦é¹‰æ˜¯å˜åŒ–æœ€å¤§çš„ï¼Œç›´æ¥æˆä¸ºäº†æ— å®³çš„å°é¸Ÿï¼Œé›¾å­ä»äººå¶å˜æˆäº†äººï¼Œä½†é¹ˆé¹•ï¼Œæ²¡æœ‰å˜åŒ–ã€‚\nçœŸäººçˆ¸çˆ¸å°±æ˜¯é¹ˆé¹•ã€‚é¹ˆé¹•é¸¡è´¼çš„åœ°æ–¹åœ¨äºï¼Œé¹¦é¹‰èµ¢ä¹Ÿå¥½ï¼Œè¾“ä¹Ÿå¥½ï¼Œä»–ä»¬éƒ½ä¼šå¾—åˆ©ã€‚\nå¼€å¤´çœŸäººçš„çˆ¸çˆ¸æœ‰ä¸€å¥å°è¯â€œå¡ç­å²›çš„å¤±è´¥åè€Œå¯¼è‡´äº†å·¥å‚é”€é‡æš´å¢â€ï¼Œåœ¨æˆ˜åï¼Œé¹ˆé¹•åå€’æˆäº†æœ€å¤§çš„èµ¢å®¶ï¼Œè¿æ¥äº†è“¬å‹ƒçš„å‘å±•ã€‚\né¹ˆé¹•ä¹Ÿä¾ç„¶ç›˜æ—‹åœ¨ä»Šæ—¥çš„å¤©ç©ºä¸­ï¼Œä¾ç„¶åœ¨åƒäººã€‚\n6ã€çœŸäººÂ·ä¼¤å£\nå›åˆ°æœ€åˆçš„èµ·ç‚¹ï¼Œåœ¨æœ¬æ–‡å¼€å¤´æˆ‘è¯´è¿‡ï¼Œè¿™éƒ¨ç”µå½±å¯¹äºå®«å´éªæ¥è¯´æ˜¯ä¸€éƒ¨ä¸æ„‰å¿«çš„ä½œå“ã€‚\næœ€ä¸æ„‰å¿«çš„åœ°æ–¹ï¼Œæ˜¯å¼€å¤´æ®µè½çš„ä¸€éƒ¨åˆ†è’™å¤ªå¥‡ã€‚\nçœŸäººåœ¨å­¦æ ¡å’ŒåŒå­¦å‘ç”Ÿäº‰åµï¼Œä»–ç”¨çŸ³å¤´ç ¸äº†è‡ªå·±çš„å¤´ã€‚\nåœ¨è¿™ä¸€æ®µä¸­ï¼Œå…¨ç¨‹æ²¡æœ‰ç°åœºå£°éŸ³ï¼Œæ²¡æœ‰çœŸäººçš„ç‹¬ç™½ï¼Œä¹Ÿæ²¡æœ‰äº‰åµçš„è¿‡ç¨‹ï¼Œè€Œæ˜¯ç”¨éŸ³ä¹é“ºè¿‡å»äº†ã€‚\nè¿™ä¸€æ®µå¤„ç†å¾—ååˆ†å¥‡æ€ªã€‚\nä¸€èˆ¬è¿™æ ·å¤„ç†çš„è’™å¤ªå¥‡ï¼Œéƒ½æ˜¯ç”¨æ¥å±•ç°ä¸»è§’ç”Ÿæ´»â€œä¸é‡è¦â€æ—¥å¸¸ç‰‡æ®µçš„ã€‚ç”µå½±ç”¨æ¥è¦†ç›–å£°éŸ³çš„é…ä¹ä¹Ÿå¾ˆè½»ã€‚ä½†æ˜¯å°±å†…å®¹è€Œè¨€ï¼Œè¿™æ®µç›¸å½“é‡è¦ã€‚\nè¿™ç»™äººçš„æ„Ÿè§‰å°±å¥½åƒæ˜¯ï¼Œä¸€ä¸ªäººåœ¨è®²æ•…äº‹ï¼Œè®²åˆ°ä»–æ›¾ç»åšè¿‡çš„é”™äº‹æ—¶ï¼Œè½»ææ·¡å†™åœ°ç•¥è¿‡å»äº†ï¼Œå¥½åƒåªæ˜¯ä¸€ä¸ªæ— å…³ç´§è¦çš„å°äº‹ã€‚\né‚£ä¹ˆï¼Œæ˜¯ä¸æ˜¯å®«å´éªæƒ³éšç’è‡ªå·±çš„é”™è¯¯å‘¢ï¼Ÿ\nä¸æ˜¯çš„ã€‚\nå¦‚æœä»–æƒ³éšç’ï¼Œä»–æ ¹æœ¬æ²¡å¿…è¦æŠŠè¿™æ®µæ”¾åˆ°ç”µå½±é‡Œã€‚è€Œä¸”æ•´éƒ¨ç”µå½±ï¼ŒçœŸäººçš„å¤´ä¸Šéƒ½ç§ƒäº†ä¸€å—ï¼Œä¸¤è¾¹çš„æ¯›ä¸å¯¹ç§°ï¼Œçœ‹ä¸Šå»ååˆ†ä¸å’Œè°ã€‚\nç§ƒçš„è¿™ä¸€å—æ—¶æ—¶åˆ»åˆ»éƒ½åœ¨æé†’ç€è§‚ä¼—ï¼ŒçœŸäººåšè¿‡é”™äº‹ã€‚\nä»–ç ¸ç ´è‡ªå·±çš„å¤´ï¼Œæ•…æ„ä¸è¯´å®è¯ï¼Œä»¥æ­¤æ¢å–çˆ¶æ¯çš„å…³å¿ƒï¼Œæ”¾ä»»çˆ¶äº²å»æ‰¾åŒå­¦éº»çƒ¦ã€‚\nåœ¨æˆ‘ä»¬çœ‹æ¥ï¼Œå°å­©å­åšè¿™ç§äº‹ä¹Ÿæ²¡ä»€ä¹ˆï¼Œä½†å®«å´éªå¯¹è¿™ç§è¡Œä¸ºçš„å®šä¹‰æ˜¯ï¼Œè¿™æ˜¯å‘åŠ£çš„ã€‚\nåœ¨æœ€åï¼Œå¡”ä¸»æƒ³å°†çŸ³å¤´äº¤ç»™çœŸäººï¼ŒçœŸäººå´è¯´ï¼Œæˆ‘ä¸æ˜¯çº¯æ´çš„ï¼Œè¿™ä¸ªä¼¤å£æ˜¯æˆ‘å‘åŠ£çš„è¯æ˜ï¼Œæˆ‘æ¥è¿‡çŸ³å¤´çš„è¯ï¼ŒçŸ³å¤´ä¹Ÿä¼šè¢«æ±¡æŸ“ã€‚\nè¿™æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿ\nçœŸäººçš„çˆ¶äº²å‘æˆ˜äº‰è´¢ï¼ŒçœŸäººæ˜¯åœ¨è¿™æ ·çš„å®¶åº­ä¸­æˆé•¿èµ·æ¥çš„ã€‚ä»–è‡ªå·±å¿ƒä¸­ä¹Ÿæœ‰å‘åŠ£çš„æ€æƒ³ï¼Œä»–ä¸æ˜¯å®«å´éªä»¥å¾€æ•…äº‹é‡Œé‚£ç§çº¯ç²¹è€Œæ­£ç›´çš„ä¸»äººå…¬ï¼Œä»–æ˜¯ä¸€ä¸ªâ€œçœŸäººâ€ã€‚\næ­ç§¯æœ¨éšå–»åˆ›é€ ä½œå“ï¼Œç§¯æœ¨åˆ™æ˜¯ç”Ÿæ´»çš„ç‚¹ç‚¹æ»´æ»´ï¼Œæ˜¯å¯¹ä¸–ç•Œçš„çœ‹æ³•ï¼Œè‰ºæœ¯åˆ›ä½œå°±æ˜¯é‡‡æ’·ç”Ÿæ´»ä¸­çš„ç§ç§ï¼Œæ‹¼å‡‘å‡ºè‡ªå·±çš„ä½œå“ã€‚\nä½†æ˜¯çœŸäººè®¤ä¸ºè‡ªå·±æ˜¯å‘åŠ£çš„ï¼Œæ‰€ä»¥ä»–çœ¼ä¸­çš„ä¸–ç•Œï¼Œéƒ½ä¼šè¢«è¿™ç§å‘åŠ£æ„ŸæŸ“ï¼Œæœ€ç»ˆåˆ›ä½œå‡ºæ‰­æ›²çš„ä½œå“ã€‚\nè¿™æ˜¯å®«å´éªå¯¹æ—¥æœ¬çš„æ‹…å¿§ã€‚\nçœŸäººéšå–»ç€ä¸‹ä¸€ä»£çš„å­©å­ã€‚æ—¥æœ¬äººéƒ½æ˜¯åƒçœŸäººè¿™æ ·ï¼ŒèƒŒè´Ÿç€åŸç½ªæ´»ä¸‹æ¥çš„ï¼Œä»–ä»¬éƒ½æ˜¯æ±²å–ç€ä¾é æˆ˜äº‰ã€æš´åŠ›ã€æ€æˆ®çš„è¥å…»ï¼Œæˆé•¿åˆ°ç°åœ¨ã€‚\nå½“ç¾éš¾è¢«é—å¿˜ï¼Œä»–ä»¬æ˜¯å¦è¿˜èƒ½ä¿æŒçº¯æ´ï¼Ÿä»–ä»¬è¿˜èƒ½åˆ¶ä½œå‡ºç¨³å®šç‰¢å›ºçš„ä½œå“å—ï¼Ÿ\næœ€åï¼Œä½œä¸ºä¸€ä¸ªå—åˆ°è¿‡æ—¥æœ¬ä¾µå®³å›½çš„å›½æ°‘ï¼Œæˆ‘æ— æ„å»è§£å¼€æ—¥æœ¬äººçš„å¿ƒç»“ï¼Œä¹Ÿæ— æ„å»å¼€å¯¼ä»–ä»¬ã€‚\nåœ¨æ—¥æœ¬ä¾µåæˆ˜äº‰ä¸­ï¼Œæˆ‘çš„ç¥–çˆ¶ã€å¤–ç¥–çˆ¶é‚£ä¸€ä»£ï¼Œéƒ½å—åˆ°è¿‡ä¼¤å®³ï¼Œæèµ·æ—¥æœ¬äººï¼Œä»–ä»¬ä¼šç”Ÿç†æ€§åœ°åŒæ¶ã€‚\næ¯å¹´9æœˆï¼Œæˆ‘çš„åŸå¸‚ä¼šå“èµ·é˜²ç©ºè­¦æŠ¥ï¼Œè¿™ä¸€å¤©æ˜¯æˆ‘ä»¬åŸå¸‚çš„æ²¦é™·æ—¥ã€‚è¿™è­¦æŠ¥å°±æ˜¯æé†’äººä»¬å‹¿å¿˜å›½è€»ã€‚\nä½†æ˜¯æš´åŠ›çš„å—å®³è€…ï¼Œä¸ä¸€å®šå°±èƒ½é¿å…æš´åŠ›ã€‚\nåœ¨æˆ‘ä»¬çš„ç¤¾ä¼šä¸­ï¼Œä¹Ÿæµè¡Œç€è¿™æ ·è¢«æ±¡æŸ“çš„è§„åˆ™ï¼Œä¾ç„¶åœ¨åƒäººã€‚\næˆ‘ä»¬çš„ä½œå“ä¸­ï¼Œå¯¹äºé‡‘é’±çš„æ¸´æœ›ï¼Œå¯¹äºæƒåŠ›ã€åœ°ä½ã€æš´åŠ›çš„å´‡æ‹œå’Œå…¨èº«å¿ƒè·ªæœï¼Œå¯¹æ¶ˆè´¹ä¸»ä¹‰çš„ç‹‚ä¿¡ï¼Œææ€•æ¯”æ—¥æœ¬è¦æ›´å¤šã€‚\næˆ‘ä»¬çš„å›½å®¶æ²¡æœ‰é¹¦é¹‰ï¼Œä½†æ˜¯æœ‰å¾ˆå¤šé²¶é±¼ã€‚ä»–ä»¬åƒäººçš„æ–¹å¼æ›´åŠ ä¼˜é›…ï¼Œæ›´åŠ éšç§˜ï¼Œæ›´åŠ ä¸å¯æ’¼åŠ¨ã€‚\nå¯¹äºå®«å´éªçš„ç†æƒ³ï¼Œå¯¹äºä»–è¿½æ±‚çš„ä¸œè¥¿ï¼Œæˆ‘å‘è‡ªå†…å¿ƒçš„è®¤å¯ã€‚\nå¯¹äºä»–ç•™ä¸‹çš„é—®é¢˜ï¼Œæˆ‘æ— æ³•è§£ç­”ã€‚\nç¼–è¾‘äº 2024-04-17 09:19ãƒ»IP å±åœ°æ¹–åŒ—\n","date":"2024-04-17T09:19:00Z","permalink":"https://liguobao.github.io/zh/p/how-to-evaluate-the-new-work-of-hayao-miyazaki/","title":"å¦‚ä½•è¯„ä»·å®«å´éªæ–°ä½œã€Šä½ æƒ³æ´»å‡ºæ€æ ·çš„äººç”Ÿã€‹ï¼Ÿ"},{"content":"æ¥æºï¼šå¦‚ä½•åŒæ—¶åˆ é™¤çŸ¥ä¹ä¸Šè‡ªå·±çš„æ‰€æœ‰å›ç­”åŠæƒ³æ³•ï¼Ÿ\nå¤‡ç”¨ã€‚\nä¸æ—¶ä¹‹éœ€ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 // åˆ é™¤å•ä¸ªå›ç­” function deleteAnswer(answerId) { var xhr = new XMLHttpRequest(); xhr.withCredentials = true; xhr.addEventListener(\u0026#34;readystatechange\u0026#34;, function () { if (this.readyState === 4) { console.log(this.responseText); } }); xhr.open(\u0026#34;DELETE\u0026#34;, \u0026#34;https://www.zhihu.com/api/v4/answers/\u0026#34; + answerId); xhr.setRequestHeader(\u0026#34;authority\u0026#34;, \u0026#34;www.zhihu.com\u0026#34;); xhr.setRequestHeader(\u0026#34;accept\u0026#34;, \u0026#34;*/*\u0026#34;); xhr.setRequestHeader(\u0026#34;accept-language\u0026#34;, \u0026#34;zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7\u0026#34;); xhr.send(); console.log(\u0026#39;delete answer: \u0026#39; + answerId + \u0026#39; success\u0026#39;); } // æ¸…ç†æ•´é¡µå›ç­”ï¼ˆå°äº100å­—ï¼‰ function clearAllAnswers(longer_than = 100) { let answerItemList = document.querySelectorAll(\u0026#39;.AnswerItem\u0026#39;); for (let answerItem of answerItemList) { let answerContentDev = answerItem.querySelector(\u0026#39;.RichContent-inner\u0026#39;); if (!answerContentDev) { continue; } let ans_id = answerItem.getAttribute(\u0026#39;name\u0026#39;); let answerContent = answerContentDev.innerText; if (answerContent.length \u0026gt;= longer_than) { console.log(`answer:${ans_id} is too long, skip`); continue } console.log(`delete answerContent: ${answerContent}`); deleteAnswer(ans_id); } } å®šä½åˆ°å›ç­”åˆ—è¡¨é¡µï¼Œæ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°ï¼ˆF12ï¼‰ï¼Œ\næŠŠä¸Šé¢çš„ä»£ç å¤åˆ¶åˆ° Console è¾“å…¥å¤„ï¼Œå›è½¦ã€‚\nç„¶åè¾“å‡º clearAllAnswers(50) ï¼Œå›è½¦ã€‚\nPS: 50ä»£è¡¨æŠ„è¿‡50å­—çš„å›ç­”ä¸å¤„ç†ã€‚\nä¸æ–­åˆ‡é¡µï¼Œé‡å¤è¾“å…¥\nclearAllAnswers(50)\nå®Œäº‹ã€‚\n","date":"2024-03-01T08:00:00Z","permalink":"https://liguobao.github.io/zh/p/how-to-delete-all-answers-on-zhihu/","title":"å¦‚ä½•åŒæ—¶åˆ é™¤çŸ¥ä¹ä¸Šè‡ªå·±çš„æ‰€æœ‰å›ç­”åŠæƒ³æ³•ï¼Ÿ"},{"content":"æ¥æºï¼šä¸ºä»€ä¹ˆç¨‹åºå‘˜ä¸‹ç­ååªå…³æ˜¾ç¤ºå™¨ä»ä¸å…³ç”µè„‘ï¼Ÿ\nä¸ºä»€ä¹ˆç¨‹åºå‘˜ä¸‹ç­ååªå…³æ˜¾ç¤ºå™¨ä»ä¸å…³ç”µè„‘ï¼Ÿ äº²çˆ±çš„ä¸¤è„šå…½ï¼Œæ¬¢è¿æ¥åˆ°å¤§å‹æ‰“å·¥äººå…¬å¸ç°åœº~\næˆ‘ä»¬è¿™é‡Œæœ‰å„ç§ç±»çš„ç¤¾ç•œï¼Œç¤¾ç•œä»¬éƒ½å®‰åˆ†å®ˆå·±å…¢å…¢ä¸šä¸šï¼Œå¸Œæœ›æ–°æ¥çš„ä¸¤è„šå…½åœ¨å…¬å¸é‡Œé¢ç©çš„æ„‰å¿«ã€‚åœ¨å…¬å¸ç¤¾ç•œæ‰®æ¼”è¿‡ç¨‹ä¸­ï¼Œè¯·ä¸¤è„šå…½åŠ¡å¿…éµå¾ªä»¥ä¸‹å®ˆåˆ™ï¼Œç¡®ä¿è‡ªèº«å®‰å…¨ï¼Œå¦åˆ™åæœè‡ªè´Ÿã€‚\n1ã€æœ¬å…¬å¸24å°æ—¶ä¸é—´æ–­ä¾›ç”µï¼Œ å¤–éƒ¨ä¾›ç”µä¸­æ­¢æƒ…å†µä¸‹ä¼šæŸ´æ²¹å‘ç”µæœºä¼šè‡ªåŠ¨å‘åŠ¨ï¼Œä¸å­˜åœ¨ä»»ä½•çš„æ–­ç”µé£é™©ï¼Œè¯·å¤§å®¶å®‰å¿ƒå·¥ä½œã€‚å¦‚æœå‘ç°ä¾›ç”µæˆ¿é—´æœ‰å“äº®æ’å‡»å£°ï¼Œè¯·ä¸ç”¨æƒŠæ…Œï¼Œè¯·å‹¿é è¿‘æˆ¿é—´ã€‚å¦‚æœå‘ç°æœ‰è¤è‰²æ¶²ä½“æµ¸å‡ºï¼Œè¯·é€šçŸ¥è¡Œæ”¿å¤„ï¼Œä¼šæœ‰ä¸“äººå¤„ç†ã€‚\n2ã€æ‰€æœ‰çš„ç”µè„‘ä¸»æœºå¼€æœºé”®éƒ½åœ¨æœºç®±ä¸Šæ–¹ï¼Œä¸”åªæœ‰ä¸€ä¸ªæŒ‰é’®ã€‚å¦‚æœæ‚¨çš„ä¸»æœºå¼€æœºé”®ä½äºæ­£å‰æ–¹ï¼Œè¯·ä¸è¦å¼€æœºï¼Œè¿…é€Ÿç¦»å¼€åŠå…¬ä½ï¼Œè¯·å°½é‡æå‰ä¸‹ç­ã€‚\n3ã€å…¬å¸é…å¤‡äº†19å¯¸MacbookProä¾›éƒ¨åˆ†å¼€å‘äººå‘˜ä½¿ç”¨ï¼Œå¦‚æœ‰éœ€è¦å¯ä»¥å‘ITç”³è¯·ã€‚è¯·æ³¨æ„MacBookProé¢œè‰²åªæœ‰é“¶è‰²ï¼Œç»å¯¹ä¸å¯èƒ½æœ‰é»‘è‰²ã€‚å¦‚æœæ‹¿åˆ°äº†é»‘è‰²çš„MacBookProï¼Œè¯·ä¸è¦å¼€æœºï¼Œç›´æ¥å½’è¿˜ITéƒ¨ã€‚\n4ã€èŒ¶æ°´é—´æ²¡æœ‰å¯å£å¯ä¹å”®å–ï¼Œæœ¬å…¬å¸æä¾›ç™¾äº‹æ— ç³–å…è´¹é¢†å–ã€‚å¦‚æœåœ¨å”®å–åŒºåŸŸçœ‹åˆ°å¯å£å¯ä¹ï¼Œè¯·ä¸è¦å°è¯•ï¼Œç›´æ¥é€šçŸ¥è¡Œæ”¿äººå‘˜åˆ°åœºå¤„ç†ã€‚å¦‚æœä¸æ³¨æ„å–åˆ°äº†å¯å£å¯ä¹ï¼Œè¯·å°½å¿«å‰å¾€åŒ»ç–—å¤„å°±è¯Šã€‚\n5ã€ä¸‹ç­ç¦»å¼€å…¬å¸å‰è¯·ä¸»åŠ¨å…³é—­æ˜¾ç¤ºå™¨ç”µæºï¼ŒèŠ‚çœç”µæºã€‚\n6ã€ä¸‹ç­ç¦»å¼€å…¬å¸è¯·ä¸è¦å…³é—­ç”µè„‘ä¸»æœºç”µæºï¼Œæå‡æ•ˆç‡ã€‚\n7ã€å¦‚æœåˆ°å²—ä¸Šç­å‘ç°ç”µè„‘ä¸»æœºè‡ªåŠ¨å…³æœºï¼Œå¯ä»¥é•¿æŒ‰ç”µæºé”®å¼€æœºã€‚å¦‚æœæ— æ³•å¼€æœºï¼Œè¯·å’ŒITå¤„è”ç³»ã€‚è¯·ä¸è¦ç§è‡ªæ‰“å¼€æœºç®±æˆ–è€…æ–­å¼€ä¸»æœºç”µæºã€‚\n8ã€å¦‚æœä½ æ—©ä¸Šçœ‹åˆ°æœ‰å…¶ä»–æ˜¾ç¤ºå™¨æ˜¯ç‚¹äº®çš„ï¼Œè¯·è®°ä½ç¼–å·å°½å¿«è¿œç¦»æ­¤åŒºåŸŸï¼Œå¿…è¦æƒ…å†µä¸‹ä¸»åŠ¨æ±‡æŠ¥ç»™è¡Œæ”¿ã€‚\n9ã€åŠå…¬åŒºåŸŸæ²¡æœ‰æœºæ¢°ç‹—ã€‚å¦‚æœå‘ç°æœ‰ç±»ä¼¼å™¨ç‰©ï¼Œè¯·è¿œç¦»å®ƒå¹¶ä¸”æ±‡æŠ¥ç»™è¡Œæ”¿äººå‘˜ã€‚\n10ã€å…¬å¸çš„ç¨‹åºå‘˜å¤§å¤šå†…å‘æ•æ„Ÿï¼Œéå¿…è¦æƒ…å†µè¯·ä¸è¦æ­è®ªã€‚å¦‚æœé‡åˆ°ä¸»åŠ¨å’Œä½ æ­è®ªçš„ç¨‹åºå‘˜ï¼Œè¯·è®°ä½ä»–çš„ç¼–å·æ±‡æŠ¥ç»™è¡Œæ”¿ã€‚\n11ã€å…¬å¸çš„æ‰€æœ‰é—¨ç¦å’Œäººè„¸è¯†åˆ«ç³»ç»Ÿä¸ºäº†ç¡®ä¿ç»å¯¹å®‰å…¨å‡ä¸ºå†…éƒ¨å¼€å‘ï¼Œåªæœ‰å†…éƒ¨å·¥å¡ï¼Œä¸å­˜åœ¨å¤–éƒ¨äººå‘˜å¯ä»¥è¿›å…¥å…¬å¸ã€‚\n\u0026hellip;..\næƒ³çœ‹å†ç»­ï¼Œæ¬¢è¿è¡¥å……ã€‚jpg\n```javascript ","date":"2024-02-29T08:00:00Z","permalink":"https://liguobao.github.io/zh/p/why-dont-programmers-turn-off-their-computers-after-work/","title":"ä¸ºä»€ä¹ˆç¨‹åºå‘˜ä¸‹ç­ååªå…³æ˜¾ç¤ºå™¨ä»ä¸å…³ç”µè„‘ï¼Ÿ"},{"content":"æ¥æºï¼šæœåŠ¡å™¨æœ€çŸ­å¯ä»¥ä¹°å¤šä¹…ï¼Œå¯ä»¥åªä¹°ä¸€å‘¨çš„æœåŠ¡å™¨å—?\næœåŠ¡å™¨æœ€çŸ­å¯ä»¥ä¹°å¤šä¹…ï¼Œå¯ä»¥åªä¹°ä¸€å‘¨çš„æœåŠ¡å™¨å—? æˆ‘æƒ³ä¹°ä¸€å°æœåŠ¡å™¨ï¼Œä½†æ˜¯æˆ‘åªæƒ³ä¹°ä¸€å‘¨ï¼Œä¸æƒ³ä¹°ä¸€å¹´ï¼Œæœ‰è¿™ç§æœåŠ¡å—ï¼Ÿ\nå›ç­” 1. æœ‰è¿™ç§æœåŠ¡å—ï¼Ÿ æœ‰ã€‚æŒ‰é‡ä»˜è´¹å³å¯ã€‚\nåŸºæœ¬å¤§éƒ¨åˆ†çš„äº‘äº§å“éƒ½æœ‰ç±»ä¼¼çš„æŒ‰é‡ä»˜è´¹çš„æœåŠ¡ã€‚\nå¤§éƒ¨åˆ†äº‘å‚å•†éƒ½æœ‰ç±»ä¼¼çš„äº§å“éœ€æ±‚ã€‚\nä¸è¿‡å›½å†…çš„å‚å•†ï¼Œæˆ‘è®°å¾—æ˜¯è¦æ±‚å®åä¹‹åï¼Œ\nå……å€¼å¤§äº 100 å—æ‰èƒ½ç»™ä½ å¼€é€šæŒ‰é‡ä»˜è´¹çš„æƒé™ã€‚\nå¾ˆé¸¡è´¼çš„æ“ä½œã€‚\n2. æœ‰æ²¡æœ‰â€çœé’±â€œçš„æ–¹æ¡ˆï¼Ÿ æœ‰ã€‚\nGithub Page è¿™ç§ç©æ„ï¼Œæœ€ç®€å•äº†ã€‚\né™æ€é¡µé¢å˜›ï¼Œæ‰”ä¸Šå»å°±èƒ½ç©ã€‚\næˆ‘å‰é˜µå­å†™è¿‡ç±»ä¼¼çš„æ–‡ç« ï¼Œå¯ä»¥å‚è€ƒä¸€ä¸‹ï¼š\nå¦‚ä½•é…ç½® Github Page é¡µé¢\næˆ‘æƒ³æŠŠæœ¬åœ°çš„ç½‘ç«™è®©å…¬ç½‘å¯è®¿é—®ï¼Œæœ‰ä»€ä¹ˆå¥½çš„æ–¹æ¡ˆå—ï¼Ÿ æœ‰ã€‚ æœ€ç®€å•çš„æ˜¯ frp å†…ç½‘ç©¿é€ã€‚\nï¼ˆ ä½†æ˜¯è¿™é‡Œéœ€è¦ä½ æœ‰ä¸€å°å…¬ç½‘æœåŠ¡å™¨ã€‚å“ˆå“ˆå“ˆ\u0026hellip;\næˆ‘å‰é˜µå­å†™è¿‡ç±»ä¼¼çš„æ–‡ç« ï¼Œ\nå¯ä»¥å‚è€ƒä¸€ä¸‹ï¼š\nå¦‚ä½•é…ç½® frp å®ç°å†…ç½‘ç©¿é€\nä¸è¿‡ï¼Œä¹Ÿæœ‰å…¶ä»–çš„æœåŠ¡å•†æä¾›äº†ç±»ä¼¼çš„åŠŸèƒ½ã€‚\næˆ‘è®°å¾—æˆ‘åœ¨ç© stable-diffusion-webui çš„æ—¶å€™ï¼Œ\nä»–ä»¬æ˜¯ä¼šç›´æ¥æä¾›ä¸€ä¸ªå…¬ç½‘åœ°å€çš„ï¼Œ\næŸ¥äº†ä¸‹åº”è¯¥æ˜¯ç”¨è¿‡ â€https://www.gradio.app/â€œ æ¥åšçš„ï¼Œ\nä½ å½“ç„¶ä¹Ÿæ˜¯å¯ä»¥ç”¨ç±»ä¼¼çš„æœåŠ¡æ¥å®ç°æŠŠæœ¬åœ°çš„ä¸€ä¸ªæœåŠ¡ï¼Œ\næš´éœ²æˆä¸€ä¸ªä¸´æ—¶çš„å…¬ç½‘åœ°å€~\nç±»ä¼¼çš„æ–‡æ¡£åœ¨ï¼š\ngradio.app: Sharing Your App\næœ€åã€‚\nç¥ç©å¾—å¼€å¿ƒ~\n","date":"2024-01-29T08:00:00Z","permalink":"https://liguobao.github.io/zh/p/how-long-can-i-buy-a-server/","title":"æœåŠ¡å™¨æœ€çŸ­å¯ä»¥ä¹°å¤šä¹…ï¼Œå¯ä»¥åªä¹°ä¸€å‘¨çš„æœåŠ¡å™¨å—?"},{"content":"ä¸Šä¸€ä¸ªç‰ˆæœ¬å¤§æ¦‚æ˜¯ 22 å¹´æœ«äº†ï¼Œ\nåé¢ä¹Ÿæ²¡ä»€ä¹ˆå¥½çš„æƒ³æ³•ï¼Œä¸€ç›´ä¹Ÿå°±æ”¾ç€å®ƒï¼Œ\nä¸é—´æ–­å¶å°”ç»´æŠ¤ä¸€ä¸‹æ•°æ®æŠ“å–~\n( ä¹Ÿæ˜¯çœ‹ç²¾åŠ›ï¼Œæ¯•ç«Ÿç”¨çˆ±å‘ç”µ\u0026hellip;\nä¸Šä¸ªæœˆæŸç“£ä¸‹çº¿äº†è€çš„åŠ å¯†ç›´æ¥ä¹‹åï¼Œæ•°æ®å°±å°‘äº†å¾ˆå¤šäº†ã€‚\näºæ˜¯å‰å‡ å¤©é‡æ–°å’Œå°ä¼™ä¼´ææ‚äº†æŸç“£çš„å°ç»„æ•°æ®ã€‚\nè¿™ä¸¤å¤©ç™»é™†äº†å°ç¨‹åºåå°å‘ç°æœ‰ç›†å‹åé¦ˆè¯´æ— æ³•â€œå¤åˆ¶é“¾æ¥â€äº†ã€‚\nå›¾ç‰‡\næœ‰ç‚¹ç¥å¥‡~\næ‰¾å‰ç«¯å¤§ä½¬å¸®å¿™çœ‹äº†ä¸‹ï¼Œå‰ç«¯å¤§ä½¬è¯´\u0026hellip;\næˆ‘ä»¬ç”¨çš„å°ç¨‹åºæ¡†æ¶æ–‡æ¡£éƒ½æ— äº†ã€‚\nå›¾ç‰‡\nä¸äºæ˜¯\u0026hellip;\nåˆè·‘è·¯äº†ä¸€ä¸ªæ¡†æ¶\u0026hellip;\nå¾ˆéš¾è¯„ã€‚\nä¸è¿‡è¿˜æ˜¯å¾—è¯´ï¼Œå¤§å‚çš„ KPI æ¡†æ¶å°‘ç‚¹ç¢°ã€‚\næŠ˜è…¾äº†ä¸€æ³¢ä¹‹åï¼Œé¡¹ç›®èƒ½æ­£å¸¸è·‘èµ·æ¥äº†ã€‚\nå¤§ä½¬ç ”ç©¶äº†ä¸€æ³¢ç¡®è®¤åº”è¯¥æ˜¯éšç§æ¡æ¬¾æœ‰å˜æ›´ï¼Œ\næˆ‘ä»¬ä¹‹å‰çš„å¤åˆ¶åˆ°ç²˜è´´æ¿ API è¢«ç¦ç”¨äº†~\nSo\u0026hellip;\nç®€å•æ›´æ–°ä¸€ç‰ˆåº”è¯¥å°±å¥½äº†ã€‚\nåŒæ—¶ä¿®å¤äº†ä¸€ä¸‹è¿›å…¥åˆ—è¡¨é¡µçš„è‡ªåŠ¨åˆ·æ–°é—®é¢˜ã€‚\nåŒæ—¶ä¿®å¤äº†ä¸€ä¸‹ç¼“å­˜å‘½ä¸­çš„é—®é¢˜ï¼Œè®¿é—®é€Ÿåº¦è¿˜ç®—ä¸é”™çš„ã€‚\nï¼ˆ å¤šçº§ç¼“å­˜çœŸçš„è¢«æˆ‘ç”¨åˆ°æè‡´äº†ï¼Œå¯¼è‡´é‡åˆ°æ‡µé€¼ä¸­\u0026hellip;\nå¤§æ¦‚è¿‡å‡ ä¸ªæ˜ŸæœŸæœ‰ç©ºçš„è¯ä¼šå¯åŠ¨æ¡†æ¶è¿ç§»ï¼Œ\nåº”è¯¥ä¹Ÿä¼šåšä¸€ä¸ªæ–°çš„æ”¹ç‰ˆ~\nï¼ˆ è®©æˆ‘å†æ€è€ƒæ€è€ƒä¸€ä¸‹\u0026hellip;\nï¼ˆäº§å“èƒ½åŠ›çœŸçš„æ˜¯å¼±é¸¡\u0026hellip;\nåŒæ—¶å¸Œæœ›äºŒæœˆä»½èƒ½æœ‰ç©ºæŠŠ NLP æ–‡æœ¬åˆ†ç±»è·‘èµ·æ¥äº†ï¼Œ\nå…ˆåšä¸€ç‰ˆå¹¿å‘Šå¸–å­åˆ†ç±»ï¼Œå†åšä¸€ç‰ˆè¯„åˆ†ï¼Œ\nè¿™ä¸ªå·¥ä½œå¯èƒ½ä¸é‚£ä¹ˆå¿«ï¼Œå¸Œæœ›å¹´ä¸­ä¹‹å‰èƒ½ä¸Šçº¿~\nå›¾ç‰‡\nä»Šå¤©è¯•äº†ä¸‹æäº†ä¸‹ xhsï¼Œæ•°æ®å€’æ˜¯è·‘é€šäº†ï¼Œåªæ˜¯\u0026hellip;.\nä¸çŸ¥é“ä¼šä¸ä¼šæŠŠè‡ªå·±é€è¿›å»ï¼Œå“ˆå“ˆå“ˆã€‚\næ°´å®Œã€‚\næ”¶å·¥ã€‚\næœŸå¾…ä¸‹ä¸€æ¬¡æ›´æ–°ã€‚\næˆ–è€…æ˜¯å‘Šåˆ«ã€‚\näººç”Ÿå¤§æŠµå¦‚æ­¤ã€‚\næ‹œäº†æ‹œ~\nåŸæ–‡é“¾æ¥\n","date":"2024-01-13T23:09:00Z","permalink":"https://liguobao.github.io/zh/p/house-map-bug-fix/","title":"å¤ªä¹…æ²¡æ›´æ–°ä»¥è‡³äºBugçº·é£çš„åœ°å›¾æœç§Ÿæˆ¿~"},{"content":"æ¥æºï¼šäºŒæœ¬å…¬åŠè®¡ç®—æœºæ¯•ä¸šå·¥ä½œä¸€å¹´ï¼Œå¦‚ä½•ä»å°å…¬å¸è·³åˆ°å¤§å‚ï¼Ÿ\né¦–å…ˆï¼Œå…ˆè¯´ä¸€ä¸‹è·¯å¾„ã€‚\nå­¦å†æƒ…å†µ æ­£å„¿å…«ç»çš„æœ¬ç§‘ï¼Œé“ç†æ¥è¯´è‡³å°‘ä¸ä¼šè¢«å¡å­¦å†ã€‚\nï¼ˆä¹Ÿä¸å¥½è¯´ï¼Œè¿™ä¸¤å¹´å¸‚åœºæœ‰ç‚¹å˜æ€\u0026hellip;\n( æœ‰äº› HR å°±æ˜¯ç›´æ¥å¡å­¦å†ï¼Œæ— è§£\u0026hellip;\nè¿™ä¸ªçœ‹äººå“çœ‹è„¸çœ‹è¿æ°”ï¼Œåªèƒ½è¯´è¯•è¯•çœ‹ï¼Œä¸å¼ºæ±‚ã€‚\nè·¯å¾„æ–¹å‘ ä»å°å‚å¾€å¤´éƒ¨å°å‚è·³ã€‚\nä»å¤´éƒ¨å°å‚å¾€ä¸­å‚è·³ã€‚\nä»ä¸­å‚å¾€å¤§å‚è·³ã€‚\nè¿™ç§æ“ä½œæ˜¯æ¯”è¾ƒç¨³å¦¥çš„ï¼Œå°±æ˜¯æ•´ä¸ªç»å†æ¯”è¾ƒæ¼«é•¿ã€‚\nç”šè‡³äºå¯èƒ½ä¼šé”™è¿‡ä¸€äº›äº‹æƒ…ï¼Œä¹Ÿä¸ä¸€å®šèµ¶å¾—ä¸Šâ€œå¿«è½¦â€ã€‚\nç®€å†é—®é¢˜ å¥½å¥½å†™ç®€å†ã€‚\nå†™å®Œäº†è®©æœ‹å‹ä»¬å¸®å¿™çœ‹çœ‹ã€‚è™šå¿ƒæ¥å—æœ‹å‹çš„æ„è§ï¼Œå¯¹ä¸åŒçš„å²—ä½å†™ä¸åŒçš„ç®€å†ã€‚ä¸ç„¶ï¼Œç®€å†ç­›é€‰éƒ½å¯èƒ½è¿‡ä¸å»ã€‚æ‰‹ä¸Šè¦æœ‰ç‚¹æ‹¿å¾—å‡ºæ‰‹ä¾ƒä¾ƒè€Œè°ˆçš„é¡¹ç›®ï¼Œå°±æ˜¯è¦è®©åˆ«äººçœ‹èµ·æ¥å°±è§‰å¾—å¾ˆæœ‰æ„æ€ï¼Œå°±æ˜¯è¦çœ‹èµ·æ¥å°±å¾ˆç‰›é€¼ï¼ŒèŠä¸‹æ¥ä¹Ÿè¦ç»™åˆ«äººç‚¹æ„æ€ã€‚\nå†…æ¨èƒŒä¹¦ å°½é‡å‹¾æ­äººå¸®ä½ èƒŒä¹¦ã€‚æ‹›äººçš„æ—¶å€™ï¼Œå¤§å®¶å¹¶ä¸ä»‹æ„åˆ°å¤„æç®€å†ã€‚æœ‰æœ‹å‹æ¨ç®€å†è¿‡æ¥ï¼Œæ˜¯æˆ‘çš„è¯è‡³å°‘ä¼šçœ‹ä¸€çœ¼è¯„ä¼°ä¸€ä¸‹åˆä¸åˆé€‚ï¼Œä¹Ÿä¼šæ¯”è¾ƒè¯šå®å›å¤æ˜¯ä¸æ˜¯ä¸åŒ¹é…ã€‚ç”šè‡³äºå¦‚æœè§‰å¾—å¾ˆåˆé€‚ï¼Œå¤§å¤šè¿˜æ˜¯ä¼šç¾è¨€å‡ å¥ï¼Œå°½é‡ç»™ä¸ªæœºä¼šã€‚\nè¿™ç§äº‹æƒ…å˜›ï¼Œåšç€è„¸åœ¨ç½‘ä¸Šå¤šè®¤è¯†ç‚¹äººï¼Œæ€»æœ‰è·¯å­çš„ã€‚\nè¿™ä¸ªæˆ‘å€’å»ºè®®é¿å¼€ä¸€äº›å†…æ¨è´©å­ï¼Œå°±å½“è®¤è¯†å¤šæœ‹å‹å°±å¥½ã€‚\nç§°å‘¼äººå¤šï¼Œå¾—ç½ªäººå°‘ï¼Œæ€»æœ‰äººæ„¿æ„ä½ æ­ä¸€æ‰‹çš„ã€‚\nå°±å¦‚å®å“¥è¿™é‡Œï¼Œè°ä¸æ„¿æ„ç§°å‘¼ä¸€å£°å®å“¥å•Šï¼ˆæ¯•ç«Ÿå¹³æ—¥çº¢åŒ…ä¹Ÿæ²¡å°‘å‘ï¼Œå¯¹å§ã€‚\nå†…æ¨è´©å­è¿™ä¸ªæˆ‘å¯ä»¥å¯ä»¥å¤šèŠå‡ å¥ï¼š\næŸä¸ªç¨‹åº¦ä¸Šä½ åªæ˜¯ä¸€ä¸ªèµ„æºï¼Œäººå®¶å¤§å¤šå¾ˆéš¾è¯´ç»™ä½ ç‚¹ä»€ä¹ˆå…³ç…§ã€‚\næœ‹å‹çš„è¯è¿˜èƒ½ä¸Šå¿ƒä¸€ç‚¹ï¼Œå¤§æ¦‚å¦‚æ­¤ã€‚\nåˆ·é¢˜ + å…«è‚¡æ–‡ æ²¡åŠæ³•ã€‚\nåˆ·é¢˜æ²¡åŠæ³•ï¼ŒæŸäº›å‚å­å°±æ˜¯å–œæ¬¢è¿™ç©æ„ã€‚\nç¡¬ç€åˆ·å°±å®Œäº‹äº†ï¼Œç†Ÿèƒ½ç”Ÿå·§ã€‚\nï¼ˆé ï¼Œæˆ‘éƒ½å¿«å¿˜å…‰äº†\u0026hellip;\nå…«è‚¡æ–‡ï¼Œè§ä»è§æ™ºã€‚\nå¦‚æœä½ é‡åˆ°æˆ‘ï¼Œå¤§æ¦‚æ˜¯ä¸å¤ªä¼šèŠå¾—åˆ°è¿™ç§ç©æ„çš„ã€‚\nå¦‚æœä½ å»æŸå›¢ï¼Œå¤§æ¦‚ç‡æœ‰ä¸€åŠçš„å†…å®¹åœ¨èŠè¿™äº›ä¸œè¥¿ã€‚\nå¤šå‡†å¤‡ï¼Œæ²¡ä»€ä¹ˆå¥½è¯´çš„ã€‚\nå¤§æ¦‚å¦‚æ­¤ã€‚\nå½©è›‹ æ‰€ä»¥ï¼Œä»–ç”šè‡³ä¸æ„¿æ„ç§°å‘¼æˆ‘ä¸€å£°å®å“¥~\n","date":"2024-01-08T15:00:00Z","permalink":"https://liguobao.github.io/zh/p/how-to-jump-from-small-company-to-big-company/","title":"äºŒæœ¬å…¬åŠè®¡ç®—æœºæ¯•ä¸šå·¥ä½œä¸€å¹´ï¼Œå¦‚ä½•ä»å°å…¬å¸è·³åˆ°å¤§å‚ï¼Ÿ"},{"content":"æ¥æºï¼šæˆ‘å›½ç”µè§†å¼€æœºç‡è‡ª 2016 å¹´çš„ 70% è·Œè‡³ 30% ï¼Œç”µè§†å¼€æœºç‡ä¸ºä½•ä¼šæ–­å´–å¼ä¸‹è·Œï¼Ÿ\nè¿™ä¸ªäº‹æƒ…å¾ˆæœ‰è¶£ï¼Œå‰é˜µå­æ€è€ƒè¿‡ä¸€äº›â€œåœºæ™¯â€ï¼Œæƒ³åˆ°å“ªå†™åˆ°å“ªäº†ã€‚\nâ€œæ–­å±‚â€æ•ˆåº” æƒ³æƒ³ï¼Œç°åœ¨åœ¨å¤–çš„æ‰“å·¥äººæœ‰å¤šå°‘ï¼Œæ‰“å·¥äººå“ªé‡Œæœ‰æ¡ä»¶çœ‹ä»€ä¹ˆç”µè§†ã€‚ç§Ÿçš„æˆ¿å­å¤§éƒ¨åˆ†å®¢å…éƒ½æ²¡æœ‰ï¼Œæœ‰å®¢å…çš„è¯å¯èƒ½è¿˜æ²¡æœ‰ç”µè§†ï¼Œæœ‰ç”µè§†è‡³å°‘æœ‰ç½‘æ‰èƒ½çœ‹ä¸€äº›å†…å®¹ï¼Œæœ‰ç½‘å¤§æ¦‚ç‡åªèƒ½çœ‹ç½‘ç»œç”µè§†ï¼Œæœ‰çº¿ç”µè§†æ˜¯å¦å¤–åŠç†çš„ï¼Œä¸€å±‚å±‚å¾—\u0026quot;ç­›é€‰\u0026quot;ä¸‹æ¥æ¥ï¼Œåºå¤§çš„ç¾¤ä½“å°±åªå‰©ä¸‹ä¸€ç‚¹ç‚¹äººäº†ã€‚å½“ç„¶ï¼Œè¿™ä¸ªè¯´èµ·æ¥å’Œ 16 å¹´ä¹‹åçš„æ–­å´–ä¸‹é™å…³è”æ€§ä¸å¤§ï¼Œä½†æ˜¯å¤§æ¦‚ä¹Ÿæ˜¯å¯ä»¥è¯´æ˜ç‚¹é—®é¢˜çš„ã€‚\nå†…å®¹æä¾› æ€»æ‰€å‘¨çŸ¥ï¼Œç”µè§†èŠ‚ç›®åœ¨è¿™å‡ å¹´æ¥è¯´ï¼Œè¶Šå‘çš„\u0026hellip;.ä¸å¥½çœ‹äº†ã€‚å¦‚æœä½ ä»¬è¿˜æœ‰æœºä¼šæ‰“å¼€ä¸€ä¸‹ä»¥å‰çœ‹çš„ XX å°ï¼Œå¤§æ¦‚ä¼šå‘ç°ç¡®å®è´¨é‡å¤ªå·®äº†ã€‚æ›´æœ‰è¶£çš„äº‹æƒ…åœ¨äºï¼Œåœ¨ç”µè§†ä¸ŠæŠ•æ”¾çš„å¹¿å‘Šï¼Œè¶Šå‘åŒè´¨åŒ–äº†ã€‚å¯¹æ¯”æˆ‘å°æ—¶å€™çœ‹åˆ°çš„ç”µè§†å¹¿å‘Šï¼Œç°åœ¨çš„è¿™äº›ç©æ„çœŸçš„\u0026hellip;.åƒåœ¾ä¸­çš„æˆ˜æ–—æœºã€‚ä¸ºå˜›è¦æ‰¯å¹¿å‘Šå‘¢ï¼ŸåŸå› å¾ˆç®€å•ï¼Œç”µè§†èŠ‚ç›®çš„æ”¶å…¥ï¼ŒåŸºæœ¬éƒ½æ¥æºäºè¿™äº›ç©æ„ã€‚æ²¡é’± -\u0026gt; ä¹°ä¸åˆ°å¥½çš„ä½œå“ -\u0026gt;æ²¡äººçœ‹ -\u0026gt; æ²¡å¹¿å‘Šæ”¶å…¥~æ¶æ€§å¾ªç¯äº†ã€‚å½“ç„¶ï¼Œæ‰€è°“çš„äº’è”ç½‘ç”µè§†ä¹Ÿä¸æ˜¯ä»€ä¹ˆå¥½ä¸œè¥¿ã€‚é™¤äº†é˜¿ B çš„ TV ç«¯ï¼Œå…¶ä»–å®¶çš„çœ‹èµ·æ¥å’Œå¹¿å‘Šè½¯ä»¶æ²¡æ’’åŒºåˆ«ã€‚äº‘è§†å¬å°ç”µè§†ä¹Ÿä¸æ˜¯ä»€ä¹ˆå¥½ä¸œè¥¿ï¼Œä½†æ˜¯è´µåœ¨åŒè¡Œæ‰¿æ‰˜ã€‚å¦‚æœæœ‹å‹ä»¬æœ‰æœºä¼šèƒ½ç›´æ¥æ‰“å¼€å¥ˆé£ TV ç«¯ï¼Œå¤§æ¦‚èƒ½çœ‹åˆ°ä¸€ä¸ªæ­£å„¿å…«ç»çš„å½±è§†ç”µè§†ç«¯æ˜¯ä»€ä¹ˆæ ·çš„ã€‚æ‰€ä»¥æˆ‘åªæƒ³è¯´ï¼Œä¸æ˜¯é’ˆå¯¹è°ï¼Œåœ¨åº§çš„å„ä½å†…å®¹æœåŠ¡å•†éƒ½é¡¶å‘±å‘±çš„ã€‚\nç”¨æˆ·ä¹ æƒ¯ æŸä¸ªç¨‹åº¦ä¸Šï¼Œæ–°ä¸€ä»£çš„æœ‹å‹å¹¶æ²¡æœ‰å»¶ç»­çœ‹ç”µè§†çš„ä¹ æƒ¯ä¸‹æ¥ã€‚æ²¡æœ‰æ¡ä»¶æ˜¯ä¸€éƒ¨åˆ†ï¼Œæ²¡æœ‰å†…å®¹ä¹Ÿæ˜¯ä¸€éƒ¨åˆ†ã€‚ç”šè‡³äºç†åº”æœ‰æ–°çš„åœºæ™¯ï¼Œä½†æ˜¯çœ‹èµ·æ¥å¥½åƒè¢«æ›¿ä»£äº†ã€‚å°±å¦‚ï¼Œæœ¬æ¥æˆ‘ä»¬çš„ç°ä»£åŒ–å‘å±•åˆ°ç°åœ¨çš„è¯ï¼Œå¤§æ¦‚æ¸¸æˆäº§ä¸šå¼€å§‹å‘å±•èµ·æ¥çš„äº† ï¼Œå¤§å‹æ¸¸æˆæ˜¯æœ‰å¯èƒ½ä¼šä¿ƒè¿›ç”µè§†çš„åˆä¸€æ¬¡â€œé‡å¯â€çš„ã€‚ç„¶è€Œï¼Œç…§ç€å›½å†…çš„æƒ…å†µæ¥è¯´ï¼Œå…ˆæ˜¯é¡µæ¸¸ï¼Œå†æ˜¯ç½‘æ¸¸ï¼Œç„¶åæ‰‹æ¸¸ã€‚æˆ‘ä»¬çš„ä¸»æœºæ¸¸æˆç©å®¶ï¼Œåªæœ‰å­˜é‡å¾ˆå°‘å¢é‡äº†ã€‚é‚£ç¡®å®å¾ˆéš¾æœ‰äººæœ‰æœºä¼šä½“éªŒåˆ°â€œæ›´å¥½â€æ¸¸æˆä½“éªŒäº†ã€‚ï¼ˆä¸ç”¨æ ï¼Œä½ è¯´å¾—éƒ½å¯¹ï¼‰ã€‚ã€ŠåŸç¥ã€‹å·²ç»ç«äº†å¾ˆå¤šå¹´äº†ï¼Œä½†æ˜¯çŸ¥é“èƒ½åœ¨ PS4ã€5 ä¸Šé¢ç”¨æ‰‹æŸ„ç©çš„äººä¸å¤šå§ï¼ˆæ‰‹åŠ¨ç‹—å¤´ï¼‰ã€‚ç›¸ä¿¡æˆ‘ï¼Œ60 å¯¸å¤§å±ç”¨æ¸¸æˆæ‰‹æŸ„ç©æ¸¸æˆï¼Œæ¯”æˆ³æ‰‹æœºå±å¹•èˆ’æœå¤šäº†ã€‚\néšä¾¿æ‰¯æ‰¯ æœ‰äº›äº‹ç‰©å¤§æ¦‚ç‡ä¼šæ¶ˆäº¡ï¼Œå¤§æ¦‚ä¹Ÿå°±è®©å®ƒæ¶ˆäº¡å§ã€‚äººæ°‘ç¾¤ä¼—å–œæ¬¢ï¼Œå°±çœŸçš„æ˜¯å–œæ¬¢å•Šã€‚\n","date":"2024-01-07T21:44:00Z","permalink":"https://liguobao.github.io/zh/p/our-tv-open-rate-fall/","title":"æˆ‘å›½ç”µè§†å¼€æœºç‡è‡ª 2016 å¹´çš„ 70% è·Œè‡³ 30% ï¼Œç”µè§†å¼€æœºç‡ä¸ºä½•ä¼šæ–­å´–å¼ä¸‹è·Œï¼Ÿ"},{"content":"æ¥æºï¼šQ: 985 æœ¬ï¼Œåäº”ç ”ä¸€ï¼Œè®¡ç®—æœºç›¸å…³ä¸“ä¸šï¼Œä½†æ˜¯ä»£ç æŠ€æœ¯èƒ½åŠ›åä½ï¼Œç ”ç©¶æ–¹å‘ä¸é€‚åˆæ‰¾å·¥ä½œï¼Œåº”è¯¥è½¬å“ªä¸ªæ–¹å‘å·¥ä½œï¼Ÿ\nAï¼š\næœ‹å‹ã€‚\nå¦‚æœè¿™ä¸ªä¸–ç•Œä¸Šåˆ«äººæŒ‡æ˜äº†å¥½èµ°çš„è·¯ï¼Œ\nè¿™ä¸ªæ—¶å€™æ˜¯ä¸æ˜¯è¦é—®ä¸‹è‡ªå·±ï¼š\né…ä¸é…å¾—ä¸Šè¿™æ¡è·¯ï¼Ÿ\nå¯¹å§ã€‚\næ‰€ä»¥å…ˆç›´æ¥å‘Šè¯‰ä½ ä¸€ä¸ªç­”æ¡ˆã€‚\nå¦‚æœä½ è‡ªè®¤ç¼–ç èƒ½åŠ›åä½ï¼Œ\nåˆä¸æ‰“ç®—æ”¹å˜è¿™ä¸ªäº‹å®ï¼Œ\né‚£ä¹ˆï¼Œç»å¤§å¤šæ•°çš„æ–¹å‘ä½ éƒ½æä¸æ‚ã€‚\nå¾ˆç®€å•çš„é“ç†ï¼Œç¼–ç èƒ½åŠ›å°±æ˜¯åŸºç¡€åŠŸï¼Œ\nåŸºç¡€åŠŸä¸è¡Œï¼Œåˆ«çš„éƒ½æ˜¯ç©ºè°ˆã€‚\n","date":"2024-01-02T21:44:00Z","permalink":"https://liguobao.github.io/zh/p/985-huawu-find-job/","title":"985æœ¬ï¼Œåäº”ç ”ä¸€ï¼Œè®¡ç®—æœºç›¸å…³ä¸“ä¸šï¼Œä½†æ˜¯ä»£ç æŠ€æœ¯èƒ½åŠ›åä½ï¼Œç ”ç©¶æ–¹å‘ä¸é€‚åˆæ‰¾å·¥ä½œï¼Œåº”è¯¥è½¬å“ªä¸ªæ–¹å‘å·¥ä½œï¼Ÿ"},{"content":"Q: ç¨‹åºå‘˜ä¸‹ç­åæ¥ç§æ´»å—?\nèº«ä¸ºç¨‹åºå‘˜çš„ä½ ä»¬ä¸‹ç­åæ¥ç§æ´»å—ï¼Ÿ\næœ‰æ²¡æœ‰ä¸€èµ·åšçš„å‘¢ï¼Ÿå¹³å¸¸å¦‚æœæ¥åˆ°ä¸€ä¸ªäººåšä¸è¿‡æ¥æ€ä¹ˆåŠå‘¢ï¼Ÿ\nA:\nâ€œæ€§ä»·æ¯”â€ ç§æ´»è¿™ç§ç©æ„ï¼Œæ˜¯è¦çœ‹æ€§ä»·æ¯”çš„ã€‚\næˆ‘æ˜¯ä»æ¥ä¸åšæ¯•è®¾ç›¸å…³çš„é‚£äº›ç©æ„çš„ã€‚\nåŸå› å¾ˆç®€å•ï¼Œäº‹å¤šé’±å°‘ï¼Œ\né‚£ç¾¤ç©·å­¦ç”Ÿï¼Œä¸€åˆ†é’±éƒ½èˆä¸å¾—èŠ±ï¼Œè¿˜è¦æ±‚ä½ åšçš„è·Ÿç™¾åº¦ä¸€æ ·ã€‚\nçœŸçš„æ˜¯åˆèœåˆçˆ±ç©çš„å…¸å‹ã€‚\nç„¶è€Œï¼Œè¿™å¯èƒ½æ˜¯å¸‚é¢ä¸Šèƒ½çœ‹åˆ°æœ€å¤šçš„ä¸€äº›ç©æ„ã€‚\næˆ‘ä¸ªäººçš„ç»éªŒæ˜¯ï¼Œè¿™ç§ç©æ„ï¼Œä¸è¦åšã€‚\nä½œä¸šè¿˜æ˜¯è‡ªå·±å®Œæˆå§ã€‚\nä¸€èµ·åšï¼Ÿ å®è¯è®²ï¼Œç»å¤§å¤šæ•°çš„äººï¼Œ\nå¹¶æ²¡æœ‰èƒ½å’Œåˆ«äººæ­æ‰‹å¥½å¥½å¹²æ´»çš„èƒ½åŠ›ã€‚\nä¹Ÿæ²¡æœ‰è§„åˆ’å¥½ä¸€ä¸ªé¡¹ç›®çš„èƒ½åŠ›ã€‚\nè¿™ä¸ªæ—¶å€™ï¼Œè‡ªå·±é¡¶ç€ä¸Šæ˜¯æœ€å¥½çš„é€‰æ‹©ã€‚\nå‰ç«¯åç«¯è¿ç»´æœåŠ¡å™¨å…¨æ˜¯ä½ ä¸€ä¸ªäººå¹²ï¼Œ\nè¦ä»€ä¹ˆè‡ªè¡Œè½¦ï¼Œèƒ½è·‘èµ·æ¥å°±è¡Œã€‚\nåšä¸è¿‡æ¥ï¼Ÿ ä¸€ä¸ªäººåƒé¥±ï¼Œä¸¤ä¸ªäººé¥¿æ­»ã€‚\nå¤§éƒ¨åˆ†çš„æ—¶å€™ï¼Œä½ æ˜¯æ˜¯è¯·ä¸èµ·å¦ä¸€ä¸ªæœ‹å‹æ¥å¹²æ´»çš„ã€‚\næ‰€ä»¥ï¼Œä½ åªèƒ½è‡ªå·±å¹²ã€‚\nå½“ç„¶å¦‚æœä½ è§‰å¾—éƒ½åšä¸è¿‡æ¥äº†ï¼Œ\nåˆ©æ¶¦è¿™ä¹ˆé«˜äº†ï¼Œå¯ä»¥è€ƒè™‘æ‹‰äººæˆ–è€…ç›´æ¥è¯·äººäº†ï¼Œ\nå¯ä»¥è€ƒè™‘å¼€å§‹å‹æ¦¨å‰©ä½™ä»·å€¼äº†~\nå¾ˆéš¾è¯´æœ‰ä»€ä¹ˆé•¿æœŸçš„å¤–åŒ…ä¼™ä¼´å…³ç³»ï¼Œ\nå¤§å®¶éƒ½æœ‰è‡ªå·±çš„äº‹æƒ…è¦åšï¼Œ\nå¤§å®¶ä¸åŒæ—¶é—´æ®µçš„å·¥ä½œå¼ºåº¦ä¹Ÿä¸å¤ªä¸€æ ·ï¼Œ\nä¸å¯æ§çš„å› ç´ å®åœ¨æ˜¯å¤ªå¤šäº†ã€‚\næœ€å è®°å¾—ã€‚\nå…ˆå®šé‡‘ã€‚\nå†äº¤ä»˜ã€‚\nç‹—å¤´æŠ¤ä½“ã€‚\n","date":"2024-01-02T20:00:00Z","permalink":"https://liguobao.github.io/zh/p/programmer-do-freelance-after-work/","title":"ç¨‹åºå‘˜ä¸‹ç­åæ¥ç§æ´»å—?"},{"content":"Q: 2024 å¹´ï¼Œæˆ‘ä»¬å¦‚ä½•æŒæ¡äººç”Ÿçš„èŠ‚å¥æ„Ÿï¼Ÿ\nç°ä»£äººå¸¸å¸¸å› ä¸ºã€Œç¤¾ä¼šæ—¶é’Ÿã€çš„é€¼è¿«è€Œé™·å…¥ç„¦è™‘ã€‚ å¦‚ä½•æ‰èƒ½å…‹æœè¿‡ã€Œæ ‡é…ã€äººç”Ÿçš„æƒ³æ³•ï¼Œ é‡æ–°æ‹¿å›äººç”Ÿçš„ä¸»åŠ¨æƒï¼Ÿ\nA:\næ ‡é…æ˜¯ä¸€ç§â€œå®‰ç¨³â€ ä¸ç®¡ä¿¡ä¸ä¿¡ï¼Œæ‰€è°“çš„ã€Œæ ‡é…ã€ï¼Œå…¶å®æ˜¯æœ€å®‰ç¨³çš„é€‰æ‹©ã€‚\nâ€œæ ‡é…â€äººç”Ÿï¼Œå¾€å¾€æ˜¯æœ€ä½çš„é£é™©ï¼Œæœ€å®¹æ˜“è¾¾æˆçš„ç›®æ ‡ã€‚\næŸä¸ªç¨‹åº¦ä¸Šï¼Œç¤¾ä¼šæ˜¯é¼“åŠ±ä½ è¿‡ã€Œæ ‡é…ã€äººç”Ÿçš„ã€‚\nå› ä¸ºè¿™æ ·çš„äººç”Ÿï¼Œæ˜¯æœ€å®¹æ˜“è¢«ç¤¾ä¼šæ¥å—çš„ã€‚\n","date":"2024-01-02T16:00:00Z","permalink":"https://liguobao.github.io/zh/p/how-to-grasp-your-life/","title":"2024 å¹´ï¼Œæˆ‘ä»¬å¦‚ä½•æŒæ¡äººç”Ÿçš„èŠ‚å¥æ„Ÿï¼Ÿ"},{"content":"Q: è¯´çœŸçš„è®¡ç®—æœºæ˜¯ä¸æ˜¯ä¸èƒ½å†å…¥è¡Œäº†ï¼Ÿ\nA:\næˆ‘ä»¬åœ¨è°ˆè®ºä»€ä¹ˆï¼Ÿ å¹¿ä¹‰ä¸Šï¼Œæˆ‘ä»¬åœ¨è°ˆè®ºçš„æ˜¯ä¸€ä¸ªè¡Œä¸šçš„æœªæ¥ã€‚\nç‹­ä¹‰ä¸Šï¼Œæˆ‘ä»¬åœ¨è°ˆè®ºçš„æ˜¯ä¸€ä¸ªèŒä¸šçš„æœªæ¥ã€‚\né‚£ä¹ˆä¹…è¡Œä¸šçš„æœªæ¥è€Œè¨€ï¼Œè®¡ç®—æœºè¿™ä¸ªè¡Œä¸šï¼Œ\næ˜¯ä¸æ˜¯çœŸçš„å·²ç»åˆ°äº†å°½å¤´äº†å‘¢ï¼Ÿ\næš‚æ—¶æ¥è¯´å¹¶æ²¡æœ‰ã€‚\nä¿¡æ¯åŒ–é©å‘½ä¾æ—§è¿˜åœ¨ç»§ç»­ã€‚\nä¿¡æ¯åŒ–ä¾æ—§è¿˜åœ¨ç»§ç»­æé«˜æ•ˆç‡ã€‚\né‚£ä¹ˆå¹¿ä¹‰ä¸Šçš„è®¡ç®—æœºè¡Œä¸šï¼Œ\nä¾æ—§è¿˜æ˜¯æœ‰æœªæ¥çš„ã€‚\nç‹­ä¹‰ä¸Šæ¥è¯´ï¼ŒçŸ­æ—¶é—´å†…æ—¥å­ä¼šè¶‹äºå¹³ç¨³ã€‚\næˆ–è€…æŸä¸ªæ—¶é—´èŠ‚ç‚¹æ¥è¯´ï¼Œå¯èƒ½è¿˜æ˜¯è‰°éš¾çš„ã€‚\næ²¡ä»€ä¹ˆåŠæ³•ï¼Œå‘å±•æœ‰æ—¶å€™å°±æ˜¯èºæ—‹ä¸Šå‡çš„ã€‚\nä»¥å‰çœ‹åˆ°çš„é‚£ç§æŒ‡æ•°çˆ†å‘ï¼Œ\nå¯èƒ½æœ‰ç”Ÿä¹‹å¹´éƒ½ä¸ä¼šå†çœ‹åˆ°äº†ã€‚\næ‰€ä»¥ã€‚\nè¿™ä¸ªæ—¶å€™åªèƒ½è€å¿ƒï¼ŒåŠªåŠ›ï¼Œç­‰å¾…ã€‚\nâ€œæ­£ç»ç­”æ¡ˆâ€ ä½ éƒ½è¿™æ ·é—®äº†ï¼Œ\næˆ‘è§‰å¾—ä½ å·²ç»ä¸é€‚åˆçš„ã€‚\nå¾ˆç®€å•çš„é“ç†ã€‚\nä½ çš„æƒ³æ³•æ˜¯å¥”ç€äº’è”ç½‘çº¢åˆ©å»çš„ã€‚\né‚£ä¹ˆåœ¨çº¢åˆ©æ¶ˆå¤±ä¹‹åçš„æ—¶é—´é‡Œï¼Œ\nä½ æ˜¯ä¸å¤ªèƒ½æ¥å—è¿™ä¸ªè¡Œä¸šç°çŠ¶çš„ã€‚\næ‰€ä»¥ï¼Œä½ è¿˜æ˜¯å»åšä½ å–œæ¬¢çš„äº‹æƒ…å§ã€‚\n","date":"2024-01-02T16:00:00Z","permalink":"https://liguobao.github.io/zh/p/can-not-join-computer/","title":"è¯´çœŸçš„è®¡ç®—æœºæ˜¯ä¸æ˜¯ä¸èƒ½å†å…¥è¡Œäº†ï¼Ÿ"},{"content":"Q: ä¸ºä»€ä¹ˆç”µè„‘è¿˜æ²¡æœ‰è¢«æ‰‹æœºæ·˜æ±°æ‰ï¼Ÿ\nA:\né¦–å…ˆï¼Œä¹Ÿä¸èƒ½è¯´æ²¡æœ‰å§ã€‚\nå°±å¦‚èå…¥æ—¥å¸¸çš„çŸ­è§†é¢‘æ¥è¯´ï¼Œå¤§éƒ¨åˆ†çš„å†…å®¹éƒ½åœ¨æ‰‹æœºä¸Šå®Œæˆäº†ã€‚\nå¾ˆå¤šå‰ªè¾‘ç±»å‹çš„Appè¿æ‹å¸¦å‰ªéƒ½ç»™ä½ å®ç°äº†ï¼Œ\nç”šè‡³äºè¿˜èƒ½ç›´æ¥å‘å¸ƒåˆ°äººå®¶çš„å¹³å°ä¹‹ä¸Š~\næŸä¸ªç¨‹åº¦ä¸Šï¼Œè¿™ä¸ªåœºåˆä¹‹ä¸­æ‰‹æœºè®¾å¤‡å·²ç»æŠŠç”µè„‘æ·˜æ±°æ‰äº†ã€‚\nAppleå…¬å¸æ¯å¹´éƒ½ä¼šå‘å¸ƒä¸€äº›ç”¨iPhoneæ‹æ‘„çš„å¤§ç‰‡ï¼Œ\nå…¨ç¨‹iPhoneæ‹æ‘„å’Œå‰ªè¾‘ï¼Œè¿™ä¸ªç§€è‚Œè‚‰çš„æ“ä½œä¸€ç›´éƒ½å¾ˆé…·ã€‚\nå¯¹å§ã€‚è¿™ä¸ªåœºåˆä¸‹ï¼Œç”µè„‘è¿˜çœŸä¸å¦‚æ‰‹æœºã€‚jpg\næˆ‘ä¸æ˜¯ç‰¹æŒ‡è°ï¼Œæˆ‘æ˜¯è¯´åœ¨åº§çš„å„ä½ï¼Œ\néƒ½\u0026hellip;ç®—æ˜¯ç”µè„‘å•Šã€‚\næ‰“ä¸è¿‡å˜›ï¼Œå°±åŠ å…¥å¯¹æ–¹ã€‚jpg\næ‰€æœ‰çš„æ‰‹æœºï¼Œåœ¨å¹¿ä¹‰ä¸Šéƒ½ç®—æ˜¯ç”µè„‘ï¼Œ\néƒ½å±äºè®¡ç®—æœºç±»åˆ«ä¸‹çš„è®¾å¤‡ã€‚\nè¿™ç‚¹å…¶å®æ˜¯å¯ä»¥æ­£å„¿å…«ç»æ‰¿è®¤çš„ã€‚\né‚£ä¸€ä¸ªå½¢æ€å–ä»£å¦ä¸€ä¸ªå½¢æ€ï¼Œ\nä¹Ÿæ˜¯å¾ˆæ­£å¸¸çš„äº‹æƒ…ã€‚\nå½“ç„¶ï¼Œè¿™ä¸ªæé—®ä¸‹ï¼Œæƒ³é—®çš„åº”è¯¥æ˜¯ï¼š\nä¸ºä»€ä¹ˆä¸ªäººç”µè„‘è¿˜æ²¡è¢«æ‰‹æœºå–ä»£æ‰ï¼Ÿ\né‚£ä¹ˆæˆ‘æ­£å„¿å…«ç»çš„æƒ³æ³•æ˜¯ï¼š\n1ã€ ç®—åŠ›ä¸å¤Ÿã€‚\n2ã€äº¤äº’ä¸å¤Ÿã€‚\n3ã€ç”Ÿæ€ä¸å¤Ÿã€‚\næ€»ä½“æ¥è¯´ï¼Œ\nè¿˜éœ€è¦æ–°çš„ä¸€åœºé©å‘½ï¼Œ\nä¸è¿‡å¯èƒ½é©å‘½ç»“æœæ˜¯ä¸€èµ·å®Œè›‹ã€‚\næ‰‹åŠ¨ç‹—å¤´ã€‚\n","date":"2023-12-31T08:00:00Z","permalink":"https://liguobao.github.io/zh/p/why-pc-not-replaced-by-mobile-test/","title":"ä¸ºä»€ä¹ˆç”µè„‘è¿˜æ²¡æœ‰è¢«æ‰‹æœºæ·˜æ±°æ‰ï¼Ÿ"},{"content":"Q: å¦‚æœç¨‹åºå‘˜å·¥èµ„æ²¡æœ‰é‚£ä¹ˆé«˜ï¼ˆåŠ ç­ç­‰æ¡ä»¶ä¸å˜ï¼‰ä½ è¿˜ä¼šå»åšç¨‹åºå‘˜å—ï¼Ÿ\nA:\næˆ‘è§‰å¾—è¿™ä¸ªé—®é¢˜æœ‰ç‚¹åƒæ˜¯é—®ï¼š\nä½ ä¼šä¸ä¼šå› ä¸ºçˆ±å¥½è€Œå»åšä¸€ä»¶äº‹æƒ…ï¼Ÿ\næˆ–è€…è¯´ï¼Œä½ ä¼šä¸ä¼šå‡ºäºçˆ±å¥½å»é€‰æ‹©ä¸€ä»½å·¥ä½œï¼Ÿ\né‚£ç­”æ¡ˆæ˜¯è‚¯å®šçš„å•Šã€‚\nä¼šçš„å•Šã€‚\nå†™ç¨‹åºï¼Œå¯¹äºæˆ‘æ¥è¯´çœŸçš„å¾ˆå¿«ä¹ã€‚\nè¿™ä»½å¿«ä¹ï¼Œå¤§æ¦‚æ˜¯æ¥æºäºåˆ›é€ äº‹ç‰©å¾—åˆ°çš„æˆå°±æ„Ÿã€‚\nåŒæ—¶è®¡ç®—æœºçš„ä¸–ç•Œï¼Œ0 å°±æ˜¯ 0ï¼Œ1 å°±æ˜¯ 1ï¼Œæ²¡æœ‰æ¨¡ç³Šçš„åœ°æ–¹ã€‚\nè¿™ç§ä¸¥è°¨çš„ä¸–ç•Œï¼Œè®©æˆ‘è§‰å¾—å¾ˆèˆ’æœã€‚\nä¸€ä¸ªè¢«æ•°å­¦è¯æ˜çš„äº‹ç‰©ï¼Œä¸€ä¸ªè¢«æ•°å­¦è¯æ˜çš„ç©ºé—´ï¼Œç€å®è®©äººç€è¿·ã€‚\næˆ‘è§‰å¾—ï¼Œè¿™å°±æ˜¯æˆ‘å–œæ¬¢å†™ç¨‹åºçš„åŸå› ã€‚\nå¦‚æœå®ƒä¸èƒ½å…»æ´»æˆ‘çš„èº«ä½“ï¼Œ\nè‡³å°‘å®ƒæ˜¯æ¿€åŠ±æˆ‘çš„çµé­‚çš„ã€‚\næˆ‘è§‰å¾—ï¼Œè¿™å°±å¤Ÿäº†ã€‚\nä¸€ä¸ªèƒ½å¸¦æ¥å¿«ä¹çš„äº‹æƒ…ï¼Œè‚¯å®šæ˜¯å€¼å¾—å»åšçš„ã€‚\n","date":"2023-12-30T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/if-programmer-salary-is-not-high/","title":"å¦‚æœç¨‹åºå‘˜å·¥èµ„æ²¡æœ‰é‚£ä¹ˆé«˜ï¼ˆåŠ ç­ç­‰æ¡ä»¶ä¸å˜ï¼‰ä½ è¿˜ä¼šå»åšç¨‹åºå‘˜å—ï¼Ÿ"},{"content":"Q:2023 å¹´äº’è”ç½‘å¤§å‚é›†ä½“å˜ã€Œç˜¦ã€ï¼Œæœªæ¥è¿˜èƒ½ã€Œèƒ–ã€èµ·æ¥å—ï¼Ÿ\nA: éš¾è¯´ã€‚\nå¢é•¿ç‚¹ æœ¬è´¨ä¸Šæ˜¯æ²¡æœ‰å¢é•¿ç‚¹äº†ã€‚\nå¤§å®¶ä¹Ÿä¸æ„¿æ„ç»§ç»­æŠ•èµ„æºçš„æ¢ç´¢ã€‚\nå…¬å¸å€’æ˜¯æœ‰é’±ï¼Œä½†æ˜¯ä¸æ•¢èŠ±ã€‚æƒ³æƒ³ï¼Œæ˜¯ä¸æ˜¯åƒæäº†æŸäº›åœºæ™¯~\næ‰€ä»¥è¦å›ç­”è¿™ä¸ªé—®é¢˜ï¼Œåˆ°åº•æ¥è¯´è¿˜æ˜¯ï¼Œçœ‹ä½ æ˜¯ä¸æ˜¯ç›¸ä¿¡è¿™ä¸ªè¡Œä¸šçš„æœªæ¥ã€‚\næˆ–è€…è¯´ï¼Œæ˜¯ä¸æ˜¯è¿˜èƒ½çœ‹åˆ°å¯’å†¬çš„å°½å¤´ï¼Ÿ\næ‰€ä»¥ï¼Œè¿™æ ·æ¥è¯´èƒ½ç†è§£ä¸ºä»€ä¹ˆ GPT å‡ºæ¥ä¹‹åï¼Œæ•´ä¸ªäº’è”ç½‘éƒ½æ²¸è…¾äº†å—ï¼Ÿ\nå› ä¸ºå¤§å®¶éƒ½çœ‹åˆ°äº†å¸Œæœ›ï¼š\næ–°çš„æ–¹æ³•è®ºï¼Œæ–°çš„å¢é•¿ç‚¹ï¼Œæ–°çš„é¢†åŸŸã€‚\nç”šè‡³äºï¼Œæ–°çš„é©å‘½ã€‚\nä½†æ˜¯ï¼Œè¿™ä¸ªå¸Œæœ›æ˜¯ä¸æ˜¯çœŸçš„å­˜åœ¨å‘¢ï¼Ÿ\næ²¸è…¾äº†ä¸€å¹´ä¹‹åå¤§æ¦‚ä¹ŸçœŸçœ‹åˆ°ç»“æœäº†ã€‚\nå¹¶æ²¡æœ‰é‚£ä¹ˆä¹è§‚ã€‚\nç¥å¥‡æµ·èº æ‰€ä»¥ï¼Œæˆ‘è§‰å¾—ï¼Œè¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬è®¨è®ºå’Œé—®ç¥å¥‡æµ·èºä¸€æ ·ã€‚\nä½ é—®å®ƒï¼Œæœªæ¥è¿˜èƒ½ã€Œèƒ–ã€èµ·æ¥å—ï¼Ÿ\nå®ƒå›ç­”ä½ ï¼šã€Œæœªæ¥è¿˜èƒ½ã€Œèƒ–ã€èµ·æ¥.ã€\nè¿™ä¸ªé—®é¢˜å¹¶ä¸ä¼šæœ‰ç¥å¥‡çš„ç­”æ¡ˆã€‚\nä½†æ˜¯ï¼Œæˆ‘è§‰å¾—ï¼Œè¿™ä¸ªé—®é¢˜çš„èƒŒåï¼Œ\nå…¶å®æ˜¯æœ‰ä¸€ä¸ªæ›´å¤§çš„é—®é¢˜:\nè´µå›½çš„äº’è”ç½‘å…¬å¸ï¼Œç©¶ç«Ÿæ˜¯æœ‰å¤šå°‘çš„éƒ¨é—¨ï¼Œæ˜¯æœ¬æ¥å°±ä¸åº”è¯¥å»åšçš„ã€‚\næˆ–è€…è¯´ï¼Œç©¶ç«Ÿè¿™ç§æ‰€è°“çš„èƒ–ï¼Œæ˜¯ä¸æ˜¯æœ¬æ¥å°±æ˜¯ä¸€ç§é”™è§‰ã€‚\nå¤§éƒ¨åˆ†å…¬å¸å…¶å®éƒ½æ˜¯äº’è”ç½‘æ”¶ç§Ÿ,\nå’Œç°åœ¨æ”¶ç§Ÿçš„æˆ¿ä¸œæ²¡ä»€ä¹ˆåŒºåˆ«ã€‚\né‚£ä¹ˆï¼Œé‚£ç¡®å®å°±æ˜¯\u0026hellip;.\né¢ä¸´ä¸€æ ·çš„å›°å¢ƒå’Œé—®é¢˜ã€‚\næˆ‘åªèƒ½è¯´ï¼Œ\nç¥å¥½è¿äº†~\nè¿˜æœ‰ä»€ä¹ˆæƒ³æ³• é“ç†ä¸Šæ¥è¯´ï¼Œå°½åŠ›è€Œä¸ºã€‚\nç†æ™ºä¸Šæ¥è¯´ï¼Œå¤§æµªæ·˜æ²™ã€‚\næƒ…æ„Ÿä¸Šæ¥è¯´ï¼Œçˆ±å’‹å’‹åœ°ã€‚\n","date":"2023-12-29T17:00:00Z","permalink":"https://liguobao.github.io/zh/p/2023-big-company-change/","title":"2023å¹´äº’è”ç½‘å¤§å‚é›†ä½“å˜ã€Œç˜¦ã€ï¼Œæœªæ¥è¿˜èƒ½ã€Œèƒ–ã€èµ·æ¥å—ï¼Ÿ"},{"content":"å…·ä½“æ•™ç¨‹ï¼šé…ç½® GitHub Pages ç«™ç‚¹çš„å‘å¸ƒæº\né‡ç‚¹æ˜¯ï¼š\nè®¾ç½®å¯¹åº”ä»“åº“çš„åˆ†æ”¯ã€‚\nä¸€èˆ¬æˆ‘ä»¬ä½¿ç”¨Hugoä¹‹ç±»çš„æ¨¡æ¿ï¼Œ\néƒ½æ˜¯ç”Ÿæˆäº†ä¸€ä¸ªpublic é™æ€æ–‡ä»¶å¤¹çš„ã€‚\nç„¶åä½¿ç”¨Github Actionç”Ÿæˆé™æ€æ–‡ä»¶ï¼Œ\nä¸€èˆ¬æ˜¯å‘å¸ƒåˆ°å½“å‰ä»»åŠ¡çš„ç‹¬ç«‹åˆ†æ”¯ã€‚\næˆ‘çš„ä¾‹å­ æˆ‘çš„ä»“åº“æ˜¯ï¼š\niguobao/liguobao.github.io ä¸»åˆ†æ”¯ master å°±æ˜¯æˆ‘çš„é…ç½®å’Œæ–‡ç« ï¼Œ\né™æ€æ–‡ä»¶åˆ†æ”¯æ˜¯ï¼š\nliguobao.github.io/tree/gh-pages\nè¿™ä¸ªæ—¶å€™ï¼Œå°±éœ€è¦åœ¨\nGithub é¡¹ç›®ä¸­ settings/pages è®¾ç½®æˆ‘çš„ \u0026ldquo;Your GitHub Pages site\u0026rdquo;\nåˆ†æ”¯ä¸º gh-pages\nç„¶åã€‚\nå®Œäº‹ã€‚\nPhoto by Pawel Czerwinski on Unsplash\n","date":"2023-12-19T13:34:08Z","image":"https://liguobao.github.io/zh/p/how-to-set-github-page/cover_hu_62e5471eb76ae943.png","permalink":"https://liguobao.github.io/zh/p/how-to-set-github-page/","title":"å¦‚ä½•é…ç½®Github Pageé¡µé¢"},{"content":"æ¥æºï¼šQ: æ˜¯ä»€ä¹ˆæé«˜ç”Ÿäº§åŠ›çš„åŠŸèƒ½è®©ä½ æ”¾å¼ƒ iPhone è½¬æŠ•åä¸ºï¼Ÿ\nå“ˆï¼Ÿ æˆ‘åˆšåˆšä»æ³¥å‘é‡Œé¢çˆ¬å‡ºæ¥åˆè®©æˆ‘èººå›å»å—ï¼Ÿ\nä¸ä¸ä¸ï¼Œæˆ‘ä¸éœ€è¦ã€‚\nè®ºæ‰‹æœºç”Ÿäº§åŠ›ï¼Œæˆ‘è§‰å¾—æ²¡äººæ¯”è€ç½—çš„ TNT æ›´æ‡‚å§ã€‚\nè€Œæˆ‘ï¼Œæ˜¯çœŸçš„ç”¨è¿‡ TNT çš„\u0026hellip;.\nå³ä½¿ä½œä¸ºä¸€ä¸ªæŒºå–œæ¬¢é”¤å­æ‰‹æœºçš„äººï¼Œ\nå°±é‚£ç©æ„æˆ‘åªèƒ½è¯´ï¼Œå‡‘åˆèƒ½ç”¨éƒ½ä¸ç®—ã€‚\né‚£å…¶ä»–çš„å‘¢ï¼Ÿ\næˆ‘åªèƒ½è¯´æ‹œæ‰˜äº†ï¼Œæ‰‹æœºçœŸçš„åªæ˜¯æ‰‹æœºå‘€ã€‚\næ‰€ä»¥ã€‚\nå¤§ä½¬è§‰å¾—ä»€ä¹ˆæ˜¯ç”Ÿäº§åŠ›å‘¢ï¼Ÿ\nWO\næŸä¸ªç¨‹åº¦ä¸Šæ¥è¯´ã€‚\næ‰€è°“çš„ç”Ÿäº§åŠ›æ˜¯ä¸æ˜¯ä»…ä»…æ˜¯ä¸€ä¸ªç¡¬ä»¶æˆ–è€…è½¯ä»¶ç³»ç»Ÿå‘¢ï¼Ÿ\nå¯èƒ½çš„ç­”æ¡ˆæ˜¯ï¼šä¸å…¨æ˜¯ã€‚\nå¦‚ä½•æœ‰æ•ˆç®¡ç†è‡ªå·±çš„æ—¶é—´å’Œç²¾åŠ›ï¼Œ\nå¦‚ä½•æ‰¾åˆ°åˆé€‚çš„å·¥ä½œæ–¹å¼ï¼Œä¹Ÿç®—æ˜¯ä¸€ç§ç­”æ¡ˆã€‚\næ‰€ä»¥æœ‰æ—¶å€™ä¼šå‘ç°ï¼Œæœ‰äº›è€ƒç ”çš„æœ‹å‹å–œæ¬¢æŠŠè‡ªå·±çš„æ‰‹æœºæ¢æˆåŠŸèƒ½æœºï¼Œ\nç›´æ¥æœç»äº†æ‰€æœ‰çš„å¨±ä¹å¯èƒ½æ€§ï¼Œç›´æ¥æé«˜äº†è‡ªå·±çš„å­¦ä¹ æ•ˆç‡ã€‚\né‚£ç…§ç€è¿™ä¸ªæƒ³æ³•æ¥è¯´ï¼ŒæŸä¸ªè®¾å¤‡æ»¡è¶³è‡ªå·±çš„å½“å‰éœ€æ±‚ï¼Œ\né‚£å€’ä¹Ÿç®—æ˜¯èƒ½æé«˜ç”Ÿäº§åŠ›~\né‚£æš‚æ—¶æ¥è¯´ï¼Œ\nåä¸ºæˆ–è€…è¯´é¸¿è’™ï¼Œå¹¶æ²¡æœ‰èƒ½ç»™æˆ‘ç±»ä¼¼çš„ä½“éªŒã€‚\niOS æ•´ä¸ªç”Ÿæ€ï¼Œå€’æ˜¯è¶³å¤Ÿçš„èˆ’é€‚å’Œå¥½ç”¨ã€‚\né‚£å¤§æ¦‚å¾ˆé•¿ä¸€æ®µæ—¶é—´æ¥è¯´ï¼Œæˆ‘åº”è¯¥æ˜¯æ²¡æœ‰éç”¨ä¸å¯çš„æƒ…å†µçš„ã€‚\nå¦‚æœæ˜¯è¯´é iOS ç”Ÿæ€ä¸‹çš„è¯ï¼Œæˆ‘å¯èƒ½ä¾æ—§è¿˜æ˜¯é€‰æ‹© Androidã€‚\næ‰€ä»¥æˆ‘æ‰‹ä¸Šæ˜¯æ‹¿ç€å¦ä¸€å°çº¢ç±³ K50ï¼Œä»·æ ¼å¤§æ¦‚æ˜¯åä¸ºé¸¿è’™æœºå™¨çš„å››åˆ†ä¹‹ä¸€ã€‚\nå¯¹äºæˆ‘æ¥è¯´ï¼ŒK50 ä¸Šèƒ½æ»¡è¶³æˆ‘ç»å¤§éƒ¨åˆ†çš„éœ€æ±‚äº†ã€‚\nå±•æœ› å¥½åƒå¹¶æ²¡æœ‰å±•æœ›ã€‚\nå¤§å®¶éƒ½è„šè¸å¼ï¼Œ\nå¥½å¥½åŠªåŠ›å’¯ã€‚\nPhoto by Pawel Czerwinski on Unsplash\n","date":"2023-12-19T00:00:00Z","image":"https://liguobao.github.io/zh/p/why-do-you-mo-to-huawei/cover_hu_9e6bcf9cfe9a9448.jpg","permalink":"https://liguobao.github.io/zh/p/why-do-you-mo-to-huawei/","title":"æ˜¯ä»€ä¹ˆæé«˜ç”Ÿäº§åŠ›çš„åŠŸèƒ½è®©ä½ æ”¾å¼ƒiPhoneè½¬æŠ•åä¸ºï¼Ÿ"},{"content":"Q: ç¨‹åºå‘˜è¿™ä¸ªç¾¤ä½“æŠ½çƒŸã€å–é…’ã€æ‰“ç‰Œå‡ ç‡é«˜å—ï¼Ÿ\nA:\nèº«è¾¹æƒ…å†µ æˆ‘å…ˆè¯´èº«è¾¹çš„æƒ…å†µã€‚\næˆ‘èº«è¾¹çš„ç¨‹åºå‘˜æœ‹å‹ï¼Œæœ‰æŠ½çƒŸæƒ…å†µçš„ï¼Œå¤§æ¦‚æ˜¯æ˜¯ä¸€ä¸ªåŠã€‚\nä¸€ä¸ª + åŠä¸ªï¼Œä¸€ä¸ªæ˜¯å¸¸å¹´æŠ½çƒŸï¼ŒåŠä¸ªæ˜¯å¶å°”æŠ½çƒŸã€‚\nå–é…’çš„è¯ï¼Œä¸å®Œå…¨ç»Ÿè®¡ï¼Œè¿™ä¸ªæ•°é‡å¤§æ¦‚åœ¨ 20%-30%å·¦å³ã€‚\næ‰“ç‰Œçš„è¯ï¼Œæˆ–è€…è¯´æ˜¯çƒ­è¡·äºæ‰“ç‰Œçš„è¯ï¼Œæˆ‘æ²¡ä»€ä¹ˆå°è±¡ï¼Œéšä¾¿ä¼°ä¸€ä¸‹ 5%ã€‚\næŠŠæ‰“ç‰Œæ¢æˆæ‰“æ¸¸æˆçš„è¯ï¼Œè¿™ä¸ªå¤§æ¦‚èƒ½å˜æˆ 70%ã€‚\nè¿™ä¸ªæƒ…å†µæœ‰è¶£çš„åœ¨äºã€‚\nå…¶å®æŠŠç¨‹åºå‘˜èº«ä»½å»æ‰çš„è¯ï¼Œ\nä¸Šé¢çš„æ¯”åˆ—ä¹Ÿæ²¡ä»€ä¹ˆå¤§çš„åŒºåˆ«ã€‚\nèƒ½ç†è§£å‘ç”Ÿäº†ä»€ä¹ˆäº‹æƒ…å—ï¼Ÿ\næœ¬é—®é¢˜æœ€å¤§çš„é—®é¢˜æ˜¯ï¼šåšäº†æ— å…³çš„é¢„è®¾ã€‚\næˆ–è€…è¯´ï¼Œå…ˆé—®æ˜¯ä¸æ˜¯å†é—®ä¸ºä»€ä¹ˆæ‰å¯¹ã€‚\né‚£ä¹ˆè¿™ä¸ªé—®é¢˜å¦‚æœè¢«è¡¨è¾¾æˆï¼š\nåœ¨å¤§åŸå¸‚çš„ä½ ï¼Œèº«è¾¹æŠ½çƒŸå–é…’æ‰“ç‰Œçš„å‡ ç‡é«˜å—ï¼Ÿ\né‚£åº”è¯¥æ˜¯ä¸€ä¸ªæ¯”è¾ƒæœ‰æ„æ€çš„é—®é¢˜äº†ã€‚\næ‰©å±•å›ç­” é‚£ä¹ˆï¼Œæˆ‘æ¥å›ç­”ä¸€ä¸‹æ‰©å±•æé—®ã€‚\né¡ºä¾¿è¯´æ˜ä¸Šé¢äººç¾¤çš„æ›´å¤šä¿¡æ¯ã€‚\nè¿˜æ˜¯åˆšåˆšçš„äººç¾¤ã€‚\næŠ½çƒŸçš„å“¥ä»¬å¤§æ¦‚é«˜ä¸­å°±æœ‰ç±»ä¼¼çš„éœ€æ±‚ï¼Œä¸€ç›´åˆ°ç°åœ¨ã€‚\nå–é…’çš„æœ‹å‹å‘¢ï¼Œå°±å¾ˆæœ‰åœ°æ–¹ç‰¹è‰²äº†ã€‚\nåŸºæœ¬å–é…’çš„éƒ½æ˜¯å®¶é‡Œæœ‰é‚£ä¹ˆç‚¹ä¹ æƒ¯çš„ï¼Œç”šè‡³äºæ˜¯æœ¬åœ°å°±äº§é…’ã€‚\nä»–ä»¬çš„èº«ä½“ä¹Ÿæ˜¯èƒ½æ¶ˆåŒ–é…’ç²¾çš„ï¼Œæ‰€ä»¥å–é…’çš„å‡ ç‡å°±é«˜äº†ã€‚\nï¼ˆæˆ‘ä¸ªäººæ˜¯ä¸å–é…’çš„ï¼Œå®¶é‡Œæœ‰è¿‡æ•åŸºå› ï¼‰\nè‡³äºä»–ä»¬ä¸Šå­¦ã€å·¥ä½œä¹‹åï¼Œå’Œæœ‹å‹ä»¬åŸºæœ¬ä¹Ÿæ˜¯èƒ½å–å°±å–ã€‚\næ‰“ç‰Œçš„æœ‹å‹ï¼Œè¿™ä¸ªæˆ‘å¾ˆéš¾è¯´ï¼Œå› ä¸ºæˆ‘ä¸å¤ªäº†è§£ã€‚\nçœ‹èµ·æ¥æ˜¯ä»–ä»¬çš„ä¸€ç§ç¤¾äº¤éœ€æ±‚ï¼Œå€’ä¸æ˜¯ä¸ºäº†èµŒé’±ã€‚\næ‰“æ¸¸æˆçš„æœ‹å‹ï¼Œè¿™ä¸ªå°±å¾ˆå¥½ç†è§£äº†ã€‚\nè¿™å¹´å¤´å“ªæœ‰ä¸æ‰“æ¸¸æˆçš„å¹´è½»äººã€‚jpg\nå¤§æ¦‚å¦‚æ­¤ã€‚\n","date":"2023-12-15T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/programmer-smoke-drink-play-cards/","title":"ç¨‹åºå‘˜è¿™ä¸ªç¾¤ä½“æŠ½çƒŸã€å–é…’ã€æ‰“ç‰Œå‡ ç‡é«˜å—ï¼Ÿ"},{"content":"Q:ç¨‹åºå‘˜å’Œå¤–å–å‘˜ï¼Œæœ‰å•¥å…±åŒç‚¹ï¼Ÿ\nè¿™ä¸ªé—®é¢˜å¾ˆæœ‰è¶£çš„ã€‚\næ­£ç»ç‚¹æ¥è¯´ï¼š\nä»–ä»¬éƒ½æ˜¯åŠ³åŠ¨è€…ã€‚\nè¿™ä¸ªè¯´æ³•è°éƒ½æŒ‘ä¸å‡ºæ¯›ç—…~\nä½†æ˜¯ï¼Œæ˜æ˜¾è¿™ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ç­”æ¡ˆã€‚\né£å£ä¸Šçš„çŒª é‚£ä¹ˆæœ‰åˆ«çš„è¯´æ³•å—ï¼Ÿ\næˆ‘è§‰å¾—æœ‰ã€‚\né¦–å…ˆï¼š\nä»–ä»¬éƒ½æ›¾ç»æ˜¯é£å£ä¸­çš„è¡Œä¸šã€‚\nç¨‹åºå‘˜æ˜¯äº’è”ç½‘é£å£ä¸­ä¸Šé£çš„çŒªï¼Œ\nå¤–å–å‘˜æ˜¯é¤é¥®ä¿¡æ¯åŒ–é£å£ä¸­ä¸Šé£çš„çŒªã€‚\nå› æ­¤ä»–ä»¬éƒ½æ›¾ä»Šå› æ­¤æ‹¿åˆ°è¿‡å¾ˆä¸é”™çš„æ”¶å…¥ã€‚\näº’è”ç½‘çš„é£è¿˜åœ¨å¹ï¼Œè™½ç„¶å·²ç»æœ‰ç‚¹ä¸‹å¡è·¯çš„æ ·å­ã€‚\nä¿¡æ¯åŒ–çš„è¿›ç¨‹è¿˜åœ¨ç»§ç»­ï¼Œæ²¡æœ‰ä¸‹ä¸€åœºé©å‘½ä¹‹å‰ï¼Œä¼°è®¡è¿˜èƒ½ç»§ç»­è‹Ÿã€‚\nå¤–å–çš„é£ä½™æ¸©è¿˜åœ¨ï¼Œä½†æ˜¯å·²ç»ä¸æ˜¯å½“åˆçš„æ ·å­äº†ã€‚\né¤é¥®è¡Œä¸šçš„â€œæ”¹é€ â€å·®ä¸å¤šåˆ°å°½å¤´äº†ï¼Œå¤–å–çš„å¸‚åœºä¹Ÿå·²ç»é¥±å’Œäº†ã€‚\né‚£ä¹ˆå¤–å–å‘˜ç¡®å®æœ‰ç‚¹é£å…‰ä¸å†äº†ã€‚\næ¬è¿å·¥ å¯¹å§ã€‚\nç¨‹åºå‘˜å¤§å¤šéƒ½åªæ˜¯ä»£ç çš„æ¬è¿å·¥ï¼Œ\nå¤–å–å‘˜å¤§å¤šéƒ½æ˜¯é¤é¥®çš„æ¬è¿å·¥ã€‚\næŸä¸ªç¨‹åº¦ä¸Šï¼Œ\nä»–ä»¬éƒ½æ˜¯åœ¨åšç€é‡å¤çš„å·¥ä½œã€‚\nå½“ç„¶ç¨‹åºå‘˜çš„å·¥ä½œè¿˜æ˜¯æ¯”å¤–å–å‘˜çš„å·¥ä½œè¦å¥½ä¸€äº›çš„ã€‚\nå› ä¸ºç¨‹åºå‘˜çš„å·¥ä½œæ˜¯åœ¨ç”µè„‘å‰å®Œæˆçš„ï¼Œ\nè€Œå¤–å–å‘˜çš„å·¥ä½œæ˜¯åœ¨æˆ·å¤–å®Œæˆçš„ã€‚\nè‡³äºèƒ½åˆ›é€ å‡ºæ–°äº‹ç‰©çš„ç¨‹åºå‘˜ï¼Œ\næŸä¸ªç¨‹åº¦ä¸Šæ¥è¯´ä¹Ÿä¸èƒ½çº¯ç²¹è¯´æ˜¯ç¨‹åºå‘˜äº†ã€‚\nç‡ƒæ–™ æŸä¸ªç¨‹åº¦ä¸Šæ¥è¯´ã€‚\nä»–ä»¬éƒ½æ˜¯åŸå¸‚çš„ç‡ƒæ–™ã€‚\nç¨‹åºå‘˜æ˜¯åŸå¸‚ä¿¡æ¯åŒ–çš„ç‡ƒæ–™ï¼Œ\nå¤–å–å‘˜æ˜¯åŸå¸‚äººå£çš„ç‡ƒæ–™ã€‚\nå¾ˆæ˜¯ç»æœ›ã€‚\n","date":"2023-12-14T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/programmer-and-deliveryman/","title":"ç¨‹åºå‘˜å’Œå¤–å–å‘˜ï¼Œæœ‰å•¥å…±åŒç‚¹ï¼Ÿ"},{"content":"çœ‹äº†ä¸‹æˆ‘çš„æ—¥å¸¸ä½œæ¯ï¼ŒiPhone å¸®æˆ‘ç»Ÿè®¡çš„æ•°æ®æ˜¯è¿™æ ·çš„ï¼š\nåŸºæœ¬åœ¨åä¸€ç‚¹åˆ°ä¸¤ç‚¹ä¹‹é—´å§åºŠï¼Œ\nç„¶åä¸ƒç‚¹åˆ°ä¹ç‚¹ä¹‹é—´èµ·æ¥ã€‚\nç¡çœ æ—¶é—´å¹³å‡åœ¨ä¸ƒä¸ªåŠå°æ—¶å·¦å³ã€‚\nèµ·åºŠæ—¶é—´å–å†³äºä¸Šç­æ—¶é—´ï¼Œå¶å°”æ‹–å»¶ã€‚\nç²¾ç¥çŠ¶å†µè¿˜ç®—ä¸é”™ï¼Œå¶å°”ä¼šæœ‰ç–²åŠ³æ„Ÿã€‚\nå…¥ç¡æ—¶é—´å°±ä¸å¥½è¯´äº†ã€‚\nå¤§éƒ¨åˆ†æ—¶å€™åŸºæœ¬åäºŒç‚¹å‰ç»“æŸäº†å·¥ä½œå’Œå­¦ä¹ ï¼Œ\nå¶å°”ä¼šå› ä¸ºçœ‹èµ„æ–™æˆ–è€…çœ‹ä¹¦æ™šä¸€ç‚¹åˆ°ä¸€ç‚¹å¤šï¼Œ\nå‘¨äº”å‘¨å…­æ¯”è¾ƒæ”¾è‚†ï¼Œå¯èƒ½ä¼šåˆ°ä¸¤ç‚¹å¤šæˆ–è€…ä¸‰ç‚¹ã€‚\nå°±å¦‚æˆ‘ä¹‹å‰åœ¨å¦ä¸€ä¸ªå›ç­”è¯´çš„ï¼š\nç™½å¤©æ°¸è¿œéƒ½æ˜¯å¿™å¿™ç¢Œç¢Œï¼Œ\nå¤œæ™šå®Œå…¨å±äºè‡ªå·±ã€‚\nå¹¶ä¸å¥½è¯´æ•´ä¸ªä¹ æƒ¯æ˜¯å¤šå¥½ã€‚\nå°±æ™šç¡æ¥è¯´ï¼ŒåŸºæœ¬æ˜¯ä»é«˜ä¸­å¼€å§‹çš„ä½œæ¯äº†ã€‚\nä»¥å‰è¯´ä»€ä¹ˆå‹¤å¥‹å­¦ä¹ ï¼Œå…¶å®æ™šä¸Šæ•ˆç‡ä¹Ÿä¸é«˜ã€‚\næœ€è¿‘å‡ å¹´ç»ˆäºèƒ½å¾ˆå¹³é™çš„çœ‹ä¹¦å­¦ä¹ ï¼Œæ™šä¸Šç¡®å®å°±æ˜¯ä¸€ä¸ªå¾ˆèˆ’æœçš„æ—¶é—´äº†ã€‚\næ²¡æœ‰æ‰“æ‰°ï¼Œæ²¡æœ‰æ¶ˆæ¯ï¼Œæ²¡æœ‰ç”µè¯ï¼Œæ²¡æœ‰äººæ¥æ‰¾ä½ ã€‚\nåªæœ‰ä½ è‡ªå·±ï¼Œä½ çš„ä¹¦ï¼Œä½ çš„ç”µè„‘ï¼Œä½ çš„ä»£ç ã€‚\nä¸€åˆ‡éƒ½å±äºä½ è‡ªå·±ã€‚\nè¿˜æœ‰ä¸ªæœ‰è¶£çš„äº‹æƒ…ã€‚\nå¦‚æœä½ æ˜¯ä¸€ä¸ªç¨‹åºå‘˜ï¼Œä½ ä¼šå‘ç°ä½ çš„ç¨‹åºå‘˜æœ‹å‹ä»¬ï¼Œå¤§éƒ¨åˆ†éƒ½æ˜¯æ™šç¡çš„ã€‚\nç„¶åï¼Œä½ è¦æ˜¯èƒ½ä¸Šä¸€ä¸ªç¥å¥‡çš„ç½‘ç«™ï¼Œå…³æ³¨æŸäº›æ­£åœ¨ä½¿ç”¨çš„å¼€æºä»“åº“ã€‚\næœ‰æœºä¼šåœ¨ä¸Šé¢åé¦ˆä¸€äº› issue çš„è¯ï¼Œå¤§æ¦‚ä¼šå‘ç°å¤§å¤šæ•°æ—¶å€™ï¼Œ\nå¾ˆå¤š issue ä¼šåœ¨å‡Œæ™¨è¢«å›å¤ã€‚ï¼ˆ è™½ç„¶ï¼Œæœ‰ä¸€éƒ¨åˆ†æƒ…å†µæ˜¯å› ä¸ºæ—¶åŒº~\nå¤§æ¦‚å¦‚æ­¤ã€‚\næœ€åã€‚\n","date":"2023-12-10T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/programmer-sleep-time/","title":"ä½œä¸ºä¸€ä¸ªç¨‹åºå‘˜ï¼Œä½œæ¯å‡ ç‚¹ç¡è§‰æ¯”è¾ƒåˆé€‚?"},{"content":"æŸä¸ªå°é¡¹ç›®éœ€è¦æ”¯æŒä¸€ä¸‹ MySQL å…¨åº“å¤‡ä»½ï¼Œ\næœ¬æ¥æƒ³ç€è¦ä¸åšä¸ªä»åº“ä¹‹ç±»çš„å®Œäº‹äº†ï¼Œ\nä½†æ˜¯æœ¬æ¥æ•°æ®åº“ä¹Ÿå°±å‡ ä¸‡æ¡æ•°æ®ï¼Œ\næè¿™ç©æ„å®åœ¨æ˜¯è›‹ç–¼ã€‚\nåˆæƒ³ç€è¦ä¸ç›´æ¥å¯å®šæ—¶ä»»åŠ¡ï¼Œ\nç”¨ MySQL dump å‘½ä»¤è¡ŒæŠ˜è…¾ä¸€ä¸‹ç®—äº†ï¼Œ\nä½†æ˜¯\u0026hellip;.\nè¿˜æ˜¯è§‰å¾—æ‡’ã€‚\nè¦ä¸çœ‹ä¸‹æœ‰æ²¡æœ‰äººå°äº†åº“ï¼Ÿ\nSO\næ‰¾åˆ°äº†\u0026hellip;\nä»£ç \n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 Backup/Export a MySQL Database string constring = \u0026#34;server=localhost;user=root;pwd=qwerty;database=test;\u0026#34;; string file = \u0026#34;C:\\\\backup.sql\u0026#34;; using (MySqlConnection conn = new MySqlConnection(constring)) { using (MySqlCommand cmd = new MySqlCommand()) { using (MySqlBackup mb = new MySqlBackup(cmd)) { cmd.Connection = conn; conn.Open(); mb.ExportToFile(file); conn.Close(); } } } Import/Restore a MySQL Database string constring = \u0026#34;server=localhost;user=root;pwd=qwerty;database=test;\u0026#34;; string file = \u0026#34;C:\\\\backup.sql\u0026#34;; using (MySqlConnection conn = new MySqlConnection(constring)) { using (MySqlCommand cmd = new MySqlCommand()) { using (MySqlBackup mb = new MySqlBackup(cmd)) { cmd.Connection = conn; conn.Open(); mb.ImportFromFile(file); conn.Close(); } } } ä»£ç å†™å¾—å¾ˆæ¸…æ™°ï¼Œåæ­£æŠ„ä¸€ä¸‹å°±å¥½ã€‚ ç”Ÿäº§å¯ç”¨ä»£ç  using System; using System.Collections.Generic; using System.Linq; using System.Net; using System.Net.Mail; using System.Text; using System.Threading.Tasks; using Microsoft.Extensions.Logging; using Microsoft.Extensions.Options; using MySql.Data.MySqlClient; namespace DatabasePro.Service { public class BackFileInfo { public int Id { get; set; } public string FileName { get; set; } public string FilePath { get; set; } public string FileSize { get; set; } public string FileSizeMB { get { var size = Convert.ToDouble(FileSize); return (size / 1024 / 1024).ToString(\u0026#34;0.00\u0026#34;); } } public string CreateTime { get; set; } } public class DBBackService : IService { private AppConfiguration configuration; private ILogger\u0026lt;DBBackService\u0026gt; _logger; public DBBackService(IOptions\u0026lt;AppConfiguration\u0026gt; options, ILogger\u0026lt;DBBackService\u0026gt; logger) { configuration = options.Value; _logger = logger; } public string ExportToFile() { string baseDir = configuration.StoredFilesPath + \u0026#34;/backup\u0026#34;; _logger.LogInformation(\u0026#34;Start backup database.\u0026#34;); var conString = configuration.QCloudMySQL; var today = DateTime.Now; string importFileName = $\u0026#34;{baseDir}/{today.ToString(\u0026#34;yyyyMMdd_HHmm\u0026#34;)}.sql\u0026#34;; _logger.LogInformation($\u0026#34;Backup file name: {importFileName}\u0026#34;); using (MySqlConnection conn = new MySqlConnection(conString)) { _logger.LogInformation($\u0026#34;ConnectionTimeout:{conn.ConnectionTimeout}\u0026#34;); using (MySqlCommand cmd = new MySqlCommand()) { cmd.CommandTimeout = 3600; using (MySqlBackup mb = new MySqlBackup(cmd)) { cmd.Connection = conn; conn.Open(); mb.ExportToFile(importFileName); conn.Close(); } } } _logger.LogInformation($\u0026#34;Backup database to {importFileName} successfully.\u0026#34;); return importFileName; } public string ImportFromFile(string filePath) { var conString = configuration.QCloudMySQL; _logger.LogInformation($\u0026#34;ImportFromFile filePath: {filePath} start.\u0026#34;); using (MySqlConnection conn = new MySqlConnection(conString)) { using (MySqlCommand cmd = new MySqlCommand()) { cmd.CommandTimeout = 3600; using (MySqlBackup mb = new MySqlBackup(cmd)) { cmd.Connection = conn; conn.Open(); mb.ImportFromFile(filePath); conn.Close(); } } } _logger.LogInformation($\u0026#34;ImportFromFile {filePath} successfully, user: {userInfo?.UserName}\u0026#34;); return filePath; } public void DeleteFile(string filePath) { if (string.IsNullOrEmpty(filePath)) { return; } if (!filePath.Contains(\u0026#34;backup\u0026#34;)) { _logger.LogInformation($\u0026#34;DeleteFile filePath: {filePath} not in backup folder, ignore.\u0026#34;); return; } if (System.IO.File.Exists(filePath)) { System.IO.File.Delete(filePath); } _logger.LogInformation($\u0026#34;DeleteFile {filePath} successfully, user: {userInfo?.UserName}\u0026#34;); } public QueryResult\u0026lt;BackFileInfo\u0026gt; LoadBackupList() { var fileList = new List\u0026lt;BackFileInfo\u0026gt;(); string baseDir = configuration.StoredFilesPath + \u0026#34;/backup\u0026#34;; _logger.LogInformation(\u0026#34;Start load backup list.\u0026#34;); if (!System.IO.Directory.Exists(baseDir)) { System.IO.Directory.CreateDirectory(baseDir); } var files = System.IO.Directory.GetFiles(baseDir); var index = 1; foreach (var file in files) { var fileInfo = new System.IO.FileInfo(file); var backFileInfo = new BackFileInfo(); backFileInfo.Id = index; backFileInfo.FileName = fileInfo.Name; backFileInfo.FilePath = file; backFileInfo.FileSize = fileInfo.Length.ToString(); backFileInfo.CreateTime = fileInfo.CreationTime.ToString(\u0026#34;yyyy-MM-dd HH:mm:ss\u0026#34;); fileList.Add(backFileInfo); index = index + 1; } var result = new QueryResult\u0026lt;BackFileInfo\u0026gt;(); result.list = fileList.OrderByDescending(x =\u0026gt; x.CreateTime).ToList(); result.total = fileList.Count; return result; } } } æ³¨é‡Šä¹Ÿæ²¡å†™ï¼Œåæ­£æ²¡å‡ è¡Œä»£ç ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 using Microsoft.AspNetCore.Mvc; using DatabasePro.Filters; using DatabasePro.RestAPI.Helpers; using DatabasePro.Service; using Swashbuckle.AspNetCore.Annotations; namespace DatabasePro.Controllers { [ApiController] public class DBBackController : ApiControllerBase { private readonly DBBackService \\_dbBackService; public DBBackController(DBBackService dbBackService) { _dbBackService = dbBackService; } /// \u0026lt;summary\u0026gt; /// /// \u0026lt;/summary\u0026gt; [HttpGet] [Route(\u0026#34;/v1/admin/db-back-list\u0026#34;)] [ServiceFilter(typeof(AdminTokenAttribute))] [SwaggerResponse(200, \u0026#34;successfully.\u0026#34;)] public IActionResult LoadBackupList() { var fileList = _dbBackService.LoadBackupList(); return Wrapper(fileList); } /// \u0026lt;summary\u0026gt; /// å¯¼å‡ºåˆ°å¤‡ä»½æ–‡ä»¶ /// \u0026lt;/summary\u0026gt; [HttpGet] [Route(\u0026#34;/v1/admin/db-back-export\u0026#34;)] [ServiceFilter(typeof(AdminTokenAttribute))] public IActionResult ExportToFile() { var backSQLFile = _dbBackService.ExportToFile(); return Ok(new { data = backSQLFile, code = 0 }); } /// \u0026lt;summary\u0026gt; /// å¯¼å…¥å¤‡ä»½æ–‡ä»¶ /// \u0026lt;/summary\u0026gt; [HttpGet] [Route(\u0026#34;/v1/admin/db-back-import\u0026#34;)] [ServiceFilter(typeof(AdminTokenAttribute))] public IActionResult ExportToFile([FromQuery] string filePath) { var backSQLFile = _dbBackService.ImportFromFile(filePath); return Ok(new { data = backSQLFile, code = 0 }); } /// \u0026lt;summary\u0026gt; /// åˆ é™¤å¤‡ä»½æ–‡ä»¶ /// \u0026lt;/summary\u0026gt; [HttpDelete] [Route(\u0026#34;/v1/admin/db-back-delete\u0026#34;)] [ServiceFilter(typeof(AdminTokenAttribute))] public IActionResult DeleteFile([FromQuery] string filePath) { _dbBackService.DeleteFile(filePath); return Ok(new { data = new { }, code = 0 }); } } } æ¥å£å¤§æ¦‚æ˜¯ä¸Šé¢ï¼Œè‡ªå·±ç…§ç€è°ƒæ•´ä¸€ä¸‹å®Œäº‹ã€‚\nç³Šä¸ªé¡µé¢\nå¤§æ¦‚ï¼Œå°±è¿™æ ·ã€‚\nå½©è›‹æ—¶é—´ å¯èƒ½ä¼šé‡åˆ° MySQL è¿æ¥è¶…æ—¶é”™è¯¯ã€‚\nçœ‹æƒ…å†µè®¾ç½®ä¸€ä¸‹â€connect-timeoutâ€œ å‚æ•°ã€‚\nconnect-timeout=3600\nå¯¼å…¥æ•°æ®çš„æ—¶å€™ï¼Œå¯èƒ½ä¼šé‡åˆ°â€mysql Packets larger than max_allowed_packet are not allowed.â€œ\néœ€è¦è°ƒæ•´ â€max_allowed_packetâ€œ å‚æ•°ã€‚\nmax-allowed-packet=1073741824\nå¦‚æœä½ çš„ MySQL ä¹Ÿæ˜¯ docker-compose éƒ¨ç½²çš„ï¼Œå¯ä»¥å‚è€ƒè¿™ä¸ª~\nargs: - --lower-case-table-names=1 - --max-connections=4000 - --connect-timeout=3600 - --max-allowed-packet=1073741824 - --sql-mode=STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION è¿˜æœ‰å½©è›‹\nå¦‚æœä½ æƒ³å®ç°ä¸€ä¸ªå®šæ—¶å¤‡ä»½ï¼Œ\nåœ¨ dotnet core ä¸­å¯ä»¥ç”¨ IHostService å®ç°ï¼Œ\nä»£ç å¤§æ¦‚æ˜¯\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 using System; using System.Collections.Generic; using System.Linq; using System.Threading.Tasks; using Microsoft.Extensions.Hosting; using System.Threading; namespace DatabasePro.Service { public class DBBackupTimeHostedService : IHostedService, IDisposable { private readonly DBBackService _dbBackService; private Timer _timer; public DBBackupTimeHostedService(DBBackService dBBackService) { _dbBackService = dBBackService; } public Task StartAsync(CancellationToken cancellationToken) { // å¯åŠ¨å®šæ—¶å™¨ _timer = new Timer(DoWork, null, GetDelayTo3AM(), TimeSpan.FromDays(1)); Serilog.Log.Information($\u0026#34;DBBackupTimeHostedService: StartAsync\u0026#34;); return Task.CompletedTask; } private void DoWork(object state) { try { var filePath = _dbBackService.ExportToFile(); Serilog.Log.Information($\u0026#34;DBBackupTimeHostedService: DoWork finish, filePath:{filePath}\u0026#34;); } catch (Exception ex) { Serilog.Log.Error($\u0026#34;DBBackupTimeHostedService: DoWork error, {ex.Message}\u0026#34;); } } public Task StopAsync(CancellationToken cancellationToken) { // åœæ­¢å®šæ—¶å™¨ _timer?.Change(Timeout.Infinite, 0); return Task.CompletedTask; } public void Dispose() { _timer?.Dispose(); } // åŒ—äº¬æ—¶é—´å‡Œæ™¨3ç‚¹æ‰§è¡Œï¼ˆUTC 19ç‚¹ï¼‰ private TimeSpan GetDelayTo3AM() { DateTime nowInUTC = DateTime.UtcNow; DateTime next7PMInUTC = nowInUTC.Date.AddHours(19); if (nowInUTC.Hour \u0026gt;= 19) { next7PMInUTC = next7PMInUTC.AddDays(1); } return next7PMInUTC - nowInUTC; } } } services.AddHostedService\u0026lt;DBBackupTimeHostedService\u0026gt;(); å®Œäº‹ã€‚\nç»“å°¾\nç®€å•ç²—æš´çš„æ–¹æ¡ˆæ€»æœ‰é£é™©ï¼Œ\nè‹Ÿä½è‹Ÿä½~\n","date":"2023-10-26T23:09:00Z","permalink":"https://liguobao.github.io/zh/p/dotnet-core-mysql-backup/","title":"dotnet core å®ç°MySQLæ•°æ®åº“å¤‡ä»½å’Œè¿˜åŸ"},{"content":"å¥‡æ€ªçš„æ•…éšœ å®¶é‡Œçš„å°å¼æœºä¸Šæœ‰ä¸¤ä¸ªç½‘å¡ï¼Œ\nä¸»æ¿è‡ªå¸¦æœ‰çº¿ç½‘å¡ï¼ŒPCIE ä¸Šæ’äº†ä¸€ä¸ªæ— çº¿ç½‘å¡ã€‚\nä¸Šæ¬¡æ æå›½å®ï¼šTesla P40 æ˜¾å¡ 2023 å¹´ 9 æœˆè·³å‘æŒ‡å—\nè¿™ç©æ„çš„æ—¶å€™ï¼Œæ‹†è£…è¿‡ä¸»æ¿å’Œæœºç®±ï¼Œ\nç³»ç»Ÿé‡æ–°å¼€å§‹ä¹‹åå°±æœ‰çº¿ç½‘å¡å°±æ‰çº¿äº†ã€‚\nå¾ˆæ˜¯å¥‡æ€ªã€‚\nå†æ—©ä¸€äº›æ—¶é—´ä¹Ÿé‡åˆ°è¿‡ç±»ä¼¼çš„é—®é¢˜ï¼Œ\næ¯æ¬¡éƒ½æ˜¯æŠŠæ‰‹åŠ¨æŠŠä¹‹å‰çš„ Ubuntu çš„ WLAN æœ‰çº¿ç½‘å¡åˆ æ‰ä¹‹åï¼Œ\né‡æ–°æ·»åŠ å›æ¥ï¼Œç„¶åå°±æ­£å¸¸å·¥ä½œäº†ã€‚\nä½†æ˜¯ç°åœ¨\u0026hellip;\né‡åˆ°äº†é—®é¢˜ã€‚\næˆ‘æ‰‹ä¸Šæ²¡æœ‰æ˜¾ç¤ºå™¨äº†ã€‚\nï¼ˆPSï¼šä¹‹å‰çš„å€Ÿç»™æœ‹å‹ç”¨äº†ï¼‰\nå€’æ˜¯å®¢å…æœ‰ç”µè§†æœºï¼Œä½†\u0026hellip;.\nç½‘çº¿æ‹‰ä¸è¿‡å»ã€‚å¾ˆæ˜¯å°´å°¬ã€‚\näºæ˜¯ï¼Œæ— çº¿ç½‘å‡‘åˆç”¨äº†å¥½ä¸€é˜µå­äº†ã€‚\nè¿·ã€‚\nè¯´å¥½çš„è®¡ç®—æœºä¸–ç•Œæ²¡æœ‰ç„å­¦ã€‚\né“ç†ä¸Šã€‚\nåªéœ€è¦é‡ç½®è¿™ä¸ªç½‘å¡å°±å®Œäº‹äº†ã€‚\nåœ¨ ifconfig é‡Œé¢ï¼Œæ­£å¸¸çš„ç½‘å¡é…ç½®é•¿è¿™æ ·ã€‚\næ— çº¿ç½‘å¡\nä¸€èˆ¬çš„è™šæ‹Ÿç½‘ç»œé•¿è¿™æ ·ã€‚\nä¸æ­£å¸¸çš„ç½‘å¡ã€‚\nPSï¼šæ²¡æœ‰ inet å­—æ®µï¼Œå› ä¸ºç³»ç»Ÿè¯†åˆ«å¼‚å¸¸ã€‚\nifconfig down \u0026amp; up ç¦ç”¨ä¹‹åå†å¯ç”¨ç½‘å¡æ˜¯ä½¿ç”¨ ifconfig å‘½ä»¤çš„ã€‚\nä½†æ˜¯åœ¨è¿™é‡Œæ— æ•ˆã€‚\nå‚è€ƒï¼šLinux ä¸­å›½ï¼šLinux ä¸­å¦‚ä½•å¯ç”¨å’Œç¦ç”¨ç½‘å¡ï¼Ÿ\nè¿˜æœ‰åˆ«çš„åŠæ³•å—ï¼Ÿ\nLinux ä¸­å›½ï¼šLinux ä¸­å¦‚ä½•å¯ç”¨å’Œç¦ç”¨ç½‘å¡ï¼Ÿ\nåœ¨ä¸Šé¢è¿™ä¸ªæ–‡ç« å†™è¿‡æœ‰ nmtui å·¥å…·ã€‚\nnmtui\nnmtui æ˜¯ä¸€ä¸ªä¸ NetworkManager äº¤äº’çš„ã€åŸºäº curses å›¾å½¢åº“çš„ç»ˆç«¯ UI åº”ç”¨ã€‚\nåœ¨å¯ç”¨ nmtui çš„æ—¶å€™ï¼Œå¦‚æœç¬¬ä¸€ä¸ªå‚æ•°æ²¡æœ‰ç‰¹åˆ«æŒ‡å®šï¼Œå®ƒä¼šå¼•å¯¼ç”¨æˆ·é€‰æ‹©å¯¹åº”çš„æ“ä½œå»æ‰§è¡Œã€‚\næ‰§è¡Œä»¥ä¸‹å‘½ä»¤æ‰“å¼€ mntui ç•Œé¢ã€‚é€‰æ‹© â€œActive a connectionâ€ ç„¶åç‚¹å‡» â€œOKâ€ã€‚\nPSï¼š è¿™é‡Œéƒ½æ˜¯æ­£å¸¸çš„é…ç½®äº†ã€‚\nå¼‚å¸¸é…ç½®çš„æƒ…å†µä¸‹ï¼ŒDevice æ˜¾ç¤ºçš„æ˜¯ä¸€ä¸ªæ— æ•ˆçš„ç½‘å¡ id\né€‰ä¸­ç½‘å¡ï¼Œé€‰æ‹© deleteã€‚\nç„¶åé‡æ–° Add ä¸€ä¸ªæ–°çš„ç½‘ç»œã€‚\nå¡«å…¥æˆ‘ä»¬åœ¨ ifconfig çœ‹åˆ°çš„ç½‘å¡ Idã€‚\né€‰æ‹© okã€‚\nå®Œäº‹ã€‚\nå›é¡¾é—®é¢˜\nåˆ°è¿™é‡Œçªç„¶æƒ³æ˜ç™½äº†ã€‚\nè¿™ä¸ªç©æ„æ˜¯å› ä¸ºï¼Œç¡¬ä»¶å˜æ›´ç³»ç»Ÿé‡æ–°åˆå§‹åŒ–ä¹‹åï¼Œ\nç»™ä¸»æ¿ç½‘å¡åˆ†é…äº†ä¸€ä¸ªæ–°çš„è®¾å¤‡ Idï¼Œ\nç„¶åç³»ç»Ÿç½‘ç»œé…ç½®ä½¿ç”¨çš„è¿˜æ˜¯æ—§çš„è®¾å¤‡ Idï¼Œ\näºæ˜¯\u0026hellip;.\nç½‘ç»œæ²¡åŠæ³•æ­£å¸¸å·¥ä½œäº†ã€‚\né‡ç½®ç½‘å¡è®¾å¤‡å¯¹å®ƒæ˜¯æ— æ•ˆçš„ã€‚\nåªèƒ½é‡æ–°åˆå§‹åŒ–ç½‘ç»œé…ç½®ã€‚\nSo\u0026hellip;\nå¦‚ä¸Šã€‚\n","date":"2023-09-22T00:00:00Z","image":"https://liguobao.github.io/zh/p/ubuntu-wifi-loss/xiaohei_hu_4c4dd5882325198c.png","permalink":"https://liguobao.github.io/zh/p/ubuntu-wifi-loss/","title":"Ubuntu æœ‰çº¿ç½‘å¡æ‰çº¿é‡å¯å¤‡å¿˜"},{"content":"This article offers a sample of basic Markdown syntax that can be used in Hugo content files, also it shows whether basic HTML elements are decorated with CSS in a Hugo theme.\nHeadings The following HTML \u0026lt;h1\u0026gt;â€”\u0026lt;h6\u0026gt; elements represent six levels of section headings. \u0026lt;h1\u0026gt; is the highest section level while \u0026lt;h6\u0026gt; is the lowest.\nH1 H2 H3 H4 H5 H6 Paragraph Xerum, quo qui aut unt expliquam qui dolut labo. Aque venitatiusda cum, voluptionse latur sitiae dolessi aut parist aut dollo enim qui voluptate ma dolestendit peritin re plis aut quas inctum laceat est volestemque commosa as cus endigna tectur, offic to cor sequas etum rerum idem sintibus eiur? Quianimin porecus evelectur, cum que nis nust voloribus ratem aut omnimi, sitatur? Quiatem. Nam, omnis sum am facea corem alique molestrunt et eos evelece arcillit ut aut eos eos nus, sin conecerem erum fuga. Ri oditatquam, ad quibus unda veliamenimin cusam et facea ipsamus es exerum sitate dolores editium rerore eost, temped molorro ratiae volorro te reribus dolorer sperchicium faceata tiustia prat.\nItatur? Quiatae cullecum rem ent aut odis in re eossequodi nonsequ idebis ne sapicia is sinveli squiatum, core et que aut hariosam ex eat.\nBlockquotes The blockquote element represents content that is quoted from another source, optionally with a citation which must be within a footer or cite element, and optionally with in-line changes such as annotations and abbreviations.\nBlockquote without attribution Tiam, ad mint andaepu dandae nostion secatur sequo quae. Note that you can use Markdown syntax within a blockquote.\nBlockquote with attribution Don\u0026rsquo;t communicate by sharing memory, share memory by communicating.\nâ€” Rob Pike1\nTables Tables aren\u0026rsquo;t part of the core Markdown spec, but Hugo supports supports them out-of-the-box.\nName Age Bob 27 Alice 23 Inline Markdown within tables Italics Bold Code italics bold code A B C D E F Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus ultricies, sapien non euismod aliquam, dui ligula tincidunt odio, at accumsan nulla sapien eget ex. Proin eleifend dictum ipsum, non euismod ipsum pulvinar et. Vivamus sollicitudin, quam in pulvinar aliquam, metus elit pretium purus Proin sit amet velit nec enim imperdiet vehicula. Ut bibendum vestibulum quam, eu egestas turpis gravida nec Sed scelerisque nec turpis vel viverra. Vivamus vitae pretium sapien Code Blocks Code block with backticks 1 2 3 4 5 6 7 8 9 10 \u0026lt;!doctype html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;utf-8\u0026#34;\u0026gt; \u0026lt;title\u0026gt;Example HTML5 Document\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;p\u0026gt;Test\u0026lt;/p\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; Code block indented with four spaces \u0026lt;!doctype html\u0026gt; \u0026lt;html lang=\u0026quot;en\u0026quot;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026quot;utf-8\u0026quot;\u0026gt; \u0026lt;title\u0026gt;Example HTML5 Document\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;p\u0026gt;Test\u0026lt;/p\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; Diff code block 1 2 3 4 5 [dependencies.bevy] git = \u0026#34;https://github.com/bevyengine/bevy\u0026#34; rev = \u0026#34;11f52b8c72fc3a568e8bb4a4cd1f3eb025ac2e13\u0026#34; - features = [\u0026#34;dynamic\u0026#34;] + features = [\u0026#34;jpeg\u0026#34;, \u0026#34;dynamic\u0026#34;] One line code block 1 \u0026lt;p\u0026gt;A paragraph\u0026lt;/p\u0026gt; List Types Ordered List First item Second item Third item Unordered List List item Another item And another item Nested list Fruit Apple Orange Banana Dairy Milk Cheese Other Elements â€” abbr, sub, sup, kbd, mark GIF is a bitmap image format.\nH2O\nXn + Yn = Zn\nPress CTRL + ALT + Delete to end the session.\nMost salamanders are nocturnal, and hunt for insects, worms, and other small creatures.\nThe above quote is excerpted from Rob Pike\u0026rsquo;s talk during Gopherfest, November 18, 2015.\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n","date":"2023-09-07T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/markdown-syntax-guide/","title":"Markdown Syntax Guide"},{"content":"Hugo theme Stack supports the creation of interactive image galleries using Markdown. It\u0026rsquo;s powered by PhotoSwipe and its syntax was inspired by Typlog.\nTo use this feature, the image must be in the same directory as the Markdown file, as it uses Hugo\u0026rsquo;s page bundle feature to read the dimensions of the image. External images are not supported.\nSyntax 1 ![Image 1](1.jpg) ![Image 2](2.jpg) Result Photo by mymind and Luke Chesser on Unsplash\n","date":"2023-08-26T00:00:00Z","image":"https://liguobao.github.io/zh/p/image-gallery/2_hu_5b8da187865385db.jpg","permalink":"https://liguobao.github.io/zh/p/image-gallery/","title":"Image gallery"},{"content":"For more details, check out the documentation.\nBilibili video Tencent video YouTube video Generic video file Your browser doesn't support HTML5 video. Here is a link to the video instead. Gist GitLab Quote Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.\nâ€• A famous person, The book they wrote Photo by Codioful on Unsplash\n","date":"2023-08-25T00:00:00Z","image":"https://liguobao.github.io/zh/p/shortcodes/cover_hu_4b8e0b1c00bd9fd1.jpg","permalink":"https://liguobao.github.io/zh/p/shortcodes/","title":"Shortcodes"},{"content":"Stack has built-in support for math typesetting using KaTeX.\nIt\u0026rsquo;s not enabled by default side-wide, but you can enable it for individual posts by adding math: true to the front matter. Or you can enable it side-wide by adding math = true to the params.article section in config.toml.\nInline math This is an inline mathematical expression: $\\varphi = \\dfrac{1+\\sqrt5}{2}= 1.6180339887â€¦$\n1 $\\varphi = \\dfrac{1+\\sqrt5}{2}= 1.6180339887â€¦$ Block math $$ \\varphi = 1+\\frac{1} {1+\\frac{1} {1+\\frac{1} {1+\\cdots} } } $$\n1 2 3 $$ \\varphi = 1+\\frac{1} {1+\\frac{1} {1+\\frac{1} {1+\\cdots} } } $$ $$ f(x) = \\int_{-\\infty}^\\infty\\hat f(\\xi),e^{2 \\pi i \\xi x},d\\xi $$\n1 2 3 $$ f(x) = \\int_{-\\infty}^\\infty\\hat f(\\xi)\\,e^{2 \\pi i \\xi x}\\,d\\xi $$ ","date":"2023-08-24T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/math-typesetting/","title":"Math Typesetting"},{"content":"Python Flaskæœ€ä½³å®è·µï¼šä¸€ã€é¡¹ç›®åˆå§‹åŒ– å‰è¨€ Python Flask æ˜¯ä¸€ä¸ªå¾ˆç®€å•æ–¹ä¾¿çš„Webæ¡†æ¶ï¼Œ\nè½»è½»æ¾æ¾å°±å¯ä»¥å®Œæˆä¸€ä¸ªWeb æˆ–è€…çº¯Web APIã€‚\nå‰é˜µå­éœ€è¦èµ·ä¸€ä¸ªç®€å•çš„Web + è„šæœ¬é¡¹ç›®ï¼ŒæŠ˜è…¾flaskçš„æ—¶å€™å‘ç°æ²¡æ‰¾åˆ°æ¯”è¾ƒé¡ºæ‰‹çš„è„šæ‰‹æ¶æ•™ç¨‹ã€‚\næ‘¸ç´¢äº†å¥½ä¸€äº›çŸ¥è¯†ï¼Œè¸©äº†ä¸€ä¸‹å‘ä»€ä¹ˆçš„ï¼Œ\næœ€åç«™åœ¨å·¨äººè‚©è†€ä¸Šæ›´æ–°ä¸ªæ•™ç¨‹ã€‚\nä»£ç é¡¹ç›®ç»“æ„ æ­£å„¿å…«ç»ä¸€ä¸ªé¡¹ç›®å·¥ç¨‹ï¼Œéµå¾ª ä¸‰å±‚æ¶æ„ + MVCæ¨¡å‹ å¯¹é¡¹ç›®ä»£ç æœ‰ä¸¥æ ¼çš„åˆ’åˆ†ï¼Œ\nå¯¹è¿™ä¸¤ä¸ªæ¦‚å¿µä¸å¤ªäº†è§£çš„æœ‹å‹å¯ä»¥è‡ªè¡Œè¯¾åè¡¥ä¹ ä¸€ä¸‹ã€‚\nè¯´æ˜å¦‚ä¸‹:\nsrc æ‰€æœ‰çš„é¡¹ç›®ä»£ç æ–‡ä»¶ src/service é€»è¾‘å±‚ä»£ç  src/model ä¸šåŠ¡å®ä½“ src/db æ•°æ®åº“ç›¸å…³ï¼ŒåŒ…æ‹¬modelå®šä¹‰å’Œdao SQLæŸ¥è¯¢ src/sdk ä¾èµ–çš„å¤–éƒ¨æ¥å£ src/job åå°è¿›ç¨‹å¯åŠ¨çš„Jobï¼Œä¸€èˆ¬éƒ½æ˜¯é€šè¿‡APIå¯åŠ¨çš„åå°ä»»åŠ¡ src/utils å·¥å…·ç±»ï¼Œconfig é…ç½®ç±»ä¹Ÿåœ¨é‡Œé¢ src/app.py flask app å¯åŠ¨é¡¹ manage.py flask.cli å¯åŠ¨å…¥å£ api + job Dockerfile Dockeræ‰“åŒ…æµç¨‹ debug.py æœ¬åœ°debug å¯åŠ¨å…¥å£ requirements.txt æ‰€æœ‰çš„ä¾èµ–åŒ… .vscode/launch.json vs code debug é…ç½® å¼€æ åºŸè¯å¤šè¯´ä¸¤å¥ï¼Œæˆ‘æ¯”è¾ƒå–œæ¬¢requirementsè¿™ç§åŒ…ç»„ç»‡æ–¹å¼ï¼Œå…¶ä»–çš„å°±çœ‹è‡ªå·±äº†ã€‚\nrequirements.txt 1 2 3 4 5 6 7 8 9 10 flask flask-swagger flask-swagger-ui flask-bootstrap SQLAlchemy pymysql pydantic requests loguru gunicorn ç®€å•è¯´æ˜\nflaskæ˜¯æ ¸å¿ƒåŒ…ï¼Œflask-swagger + flask-swagger-ui æ˜¯ç”¨æ¥åšSwagger UIçš„ï¼Œflask-bootstrap ç”¨æ¥ä¹±ç³Š HTMLé¡µé¢çš„ SQLAlchemy + pymysql + ä¸€ä¸ªæ˜¯æ•°æ®åº“ORMæ¡†æ¶ï¼Œä¸€ä¸ªæ˜¯æ•°æ®åº“é©±åŠ¨ pydantic ç”¨æ¥é…åˆSQLAlchemyå®ŒæˆModelæ•°æ®è½¬æ¢ï¼Œè§£å†³ä¸€äº›å¥‡æ€ªçš„åºåˆ—åŒ–ååºåˆ—åŒ–é—®é¢˜ requests ç”¨æ¥å¯¹æ¥å¤–éƒ¨HTTPæ¥å£æˆ–è€…å†™çˆ¬è™«è„šæœ¬ loguru ç®€æ˜“æ—¥å¿—æ¡†æ¶ï¼Œfrom loguru import logger å°±å®Œäº‹äº† gunicorn å¤šè¿›ç¨‹éƒ¨ç½² ","date":"2021-09-05T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/python-flask%E4%B8%80%E9%A1%B9%E7%9B%AE%E5%88%9D%E5%A7%8B%E5%8C%96/","title":"Python Flaskï¼šä¸€ã€é¡¹ç›®åˆå§‹åŒ–"},{"content":"QCloud Serverless å¦‚ä½•çœ‹å¾…è…¾è®¯äº‘.äº‘å¼€å‘æ¨å‡ºä½ä»£ç å¼€å‘å¹³å°ï¼Ÿæœªæ¥çœŸçš„æœ‰å¯èƒ½äººäººéƒ½æ˜¯â€œå¼€å‘è€…â€å—ï¼Ÿ ä½ä»£ç å¹³å°ä¸ç®—å¤§æ–°é—»ï¼Œèµ¶çš„æ™šçš„è…¾è®¯äº‘æœ‰è‡ªå·±çš„æ–¹æ¡ˆ è®²è¿°ä¸€ä¸‹ serverless çš„å†å²ï¼Œä»ç®€å•è®²è®²äº‘ä¸»æœºçš„å†å²ï¼Œç„¶åä» AWS lambda å¹³å°è®²èµ·ï¼ŒæåŠä¸€ä¸‹é˜¿é‡Œäº‘ï¼Œæœ€åè®²è…¾è®¯äº‘ Serverless èƒ½åŠ› è¿™é‡Œåªèƒ½è®²åˆ° Serverless ç›¸æ¯”æ‰˜ç®¡ä¸»æœºã€å®¹å™¨é›†ç¾¤çš„å¥½å¤„ æåŠå¯¹å¼€å‘æ¨¡å¼çš„æ”¹å˜ä»€ä¹ˆï¼Œè¿˜æœ‰è®²ä¸‹è…¾è®¯äº‘çš„ä¼˜åŠ¿ï¼Œä¸å¤ªèƒ½éå¸¸çªå‡ºä½ä»£ç å¹³å°ä»€ä¹ˆçš„ è…¾è®¯äº‘çš„å°ç¨‹åºäº‘å¼€å‘æœ‰ä»€ä¹ˆç‰¹åˆ« äº‘æ•°æ®åº“ã€äº‘å­˜å‚¨éƒ½å¯ä»¥ç€é‡è®²ä¸€ä¸‹ï¼Œè¿™éƒ¨åˆ†æ˜¯æ¯”è¾ƒé“ä¸½çš„ï¼Œå…¶ä»–å®¶éƒ½æ²¡æœ‰ç›´æ¥é›†æˆçš„ï¼ˆæ®æˆ‘æ‰€çŸ¥ï¼‰ å¾®ä¿¡ç”Ÿæ€ + è…¾è®¯ç”Ÿæ€çš„ä¾¿æ·æ¥å…¥ï¼Œæ”¯ä»˜ã€åœ°å›¾ã€èº«ä»½è®¤è¯ç›¸å…³ï¼Œå¤„å¤„å¿«äººä¸€æ­¥ å…¶ä»–å·¥å…· VS Code æ’ä»¶ + å¾®ä¿¡å°ç¨‹åºå¼€å‘å·¥å…· + è¿ç»´é›†æˆç›¸å…³ äººäººå¼€å‘è€…ï¼Ÿ è®²è®²è½¯ä»¶å¼€å‘æ˜¯ä»€ä¹ˆï¼Ÿå¼€å‘è€…ä¸»è¦åšä»€ä¹ˆï¼Ÿï¼ˆè¿™é‡Œè¦é€šä¿—ç‚¹ï¼Œåˆå¾—è®²çš„æ¸…æ¥šï¼‰ è…¾è®¯äº‘å¼€å‘èƒ½ä¸ºé™ä½å¼€å‘è€…é—¨æ§›åšäº†ä»€ä¹ˆï¼Ÿï¼ˆä¸èƒ½å¤ªå¹å¾—å¤ªå‰å®³ï¼Œä¸è¿‡å¹ä¸€ä¸‹å°æ­¥å¿«è·‘å¿«é€ŸéªŒè¯äº§å“è¿˜æ˜¯å¯ä»¥çš„ï¼‰ å±•æœ›ä¸€ä¸‹æœªæ¥ï¼ˆè¿™ä¸ªçœ‹è¦å†™ç‚¹æ’’äº†ï¼‰ å¦‚ä½•çœ‹å¾…å°ç¨‹åºäº‘å¼€å‘æŠŠç¨‹åºå‘˜çš„å‡†å…¥é—¨æ§›é™ä½ï¼Ÿé‚£å¦‚ä½•è¡¡é‡ä¸€ä¸ªç¨‹åºå‘˜çš„ä»·å€¼ï¼Ÿ å…ˆæŠŠé—¨æ§›ç”»å‡ºæ¥ å¼€å‘æ˜¯ä»€ä¹ˆï¼Ÿä¸€ä¸ªäº§å“ä¸Šçº¿è¦åšä»€ä¹ˆï¼Ÿï¼ˆå¯èƒ½éœ€è¦æ ·ä¾‹ï¼Œä¹Ÿéœ€è¦ä¸€äº›ç®€å•çš„ç†è®ºï¼‰ è®²æ¸…æ¥šé—¨æ§›æ˜¯æ€ä¹ˆäº§ç”Ÿçš„ï¼Œåœ¨åé¢å°½å¯èƒ½åœ†å›æ¥ å°ç¨‹åºåšäº†ä»€ä¹ˆï¼Ÿï¼ˆå°½é‡æœ€åä¸­æ€§è¯„ä»·å§ï¼Œè¿™ä¸ªæœ‰ç‚¹éš¾ï¼‰ å…ˆéª‚ä¸€ä¸‹ï¼ˆè‡ªæˆä½“ç³»ï¼Ÿæ€§èƒ½ä¸€èˆ¬ï¼Ÿï¼‰ å†è¡¨æ‰¬ä¸€ä¸‹(éšç”¨éšèµ°ã€å¼€å‘é—¨æ§›ä½ã€å¤šç«¯ç»Ÿä¸€ã€è´¨é‡ä¿è¯) å°ç¨‹åºäº‘å¼€å‘åšäº†ä»€ä¹ˆï¼Ÿ å’Œå°ç¨‹åºé«˜åº¦é›†æˆ æä¾›äº†æ•°æ®åº“å’Œå­˜å‚¨èƒ½åŠ› éƒ¨åˆ†åœºæ™¯å¯ä»¥åšåˆ°æ— åç«¯æˆ–è€…å¼±åç«¯ï¼Œç”šè‡³ä¸éœ€è¦è‡ªå·±çš„æœåŠ¡å™¨ï¼ˆæˆæœ¬ä¹Ÿå¯ä»¥è®²è®²ï¼‰ åæ­£è¿™éƒ¨åˆ†å°½é‡è¡¨æ‰¬å’Œå°½å¯èƒ½è¡¨è¾¾ æˆ‘ä»¬è¯´çš„é—¨æ§›ä½äº†ï¼Œé‚£ä¹ˆç¨‹åºå‘˜çš„ä»·å€¼ç©¶ç«Ÿæ˜¯ä»€ä¹ˆ åšäº§å“é—¨æ§›ä½äº†ï¼Œè¯•é”™çš„æˆæœ¬ä½äº†ï¼Œåšæˆä¸€ä¸ªé¡¹ç›®çš„é—¨æ§›è¿˜æ˜¯åœ¨çš„ å¤æ‚çš„ä¸–ç•Œé‡Œé¢ï¼Œè®¡ç®—æœºç†è®ºè¦ç”¨åœ¨å“ªï¼ŸçœŸçš„å¯ä»¥æ‰”æ‰å—ï¼Ÿ å¤šå¿«å¥½çœçš„å¼€å‘æ¨¡å¼ç©¶ç«Ÿåº”è¯¥æ€ä¹ˆç©ï¼Ÿ æœ€æœ€åæ€»ç»“ä¸€ä¸‹ ","date":"2020-11-29T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/qcloud-serverless/","title":"QCloud Serverless"},{"content":"ä¸€æ¬¡ä¾èµ–æ³¨å…¥ä¸æ…å¼•å‘çš„ä¸€è¿ä¸²äº‹æ•…ã€‚\nèµ·å› å’Œç°è±¡ å¶å°”ä¼šçœ‹åˆ°çº¿ä¸ŠæœåŠ¡å¯åŠ¨çš„æ—¶å€™ç¬¬ä¸€æ³¢æµé‡è¿›æ¥ä¹‹åï¼Œ\nè¿Ÿè¿Ÿæ²¡æœ‰ä»»ä½•çš„å“åº”ï¼ŒåŒæ—¶æœåŠ¡çš„ç›‘æ§æ£€æŸ¥æ¥å£æ­£å¸¸ï¼Œ\næ‰€ä»¥ K8S é›†ç¾¤è®¤ä¸ºæœåŠ¡æ­£å¸¸ï¼Œç»§ç»­æ”¾å…¥æµé‡ã€‚\næŸ¥çœ‹æ—¥å¿—åŸºæœ¬å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 [2020-06-05T13:00:30.7080743+00:00 Microsoft.AspNetCore.Hosting.Diagnostics INF] Request starting HTTP/1.0 GET http://172.16.2.52/v1/user/test [2020-06-05T13:00:30.7081525+00:00 Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware DBG] The request path /v1/user/test/account-balance does not match a supported file type [2020-06-05T13:00:31.7074253+00:00 Microsoft.AspNetCore.Server.Kestrel DBG] Connection id \u0026#34;0HM09A1MAAR21\u0026#34; started. [2020-06-05T13:00:31.7077051+00:00 Microsoft.AspNetCore.Hosting.Diagnostics INF] Request starting HTTP/1.0 GET http://172.16.2.52/v1/user/test/account-balance [2020-06-05T13:00:31.7077942+00:00 Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware DBG] The request path /v1/user/test/account-balance does not match a supported file type [2020-06-05T13:00:32.2103440+00:00 Microsoft.AspNetCore.Server.Kestrel DBG] Connection id \u0026#34;0HM09A1MAAR22\u0026#34; started. [2020-06-05T13:00:32.2118432+00:00 Microsoft.AspNetCore.Hosting.Diagnostics INF] Request starting HTTP/1.0 GET http://172.16.2.52/v1/user/test/account-balance [2020-06-05T13:00:32.2125894+00:00 Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware DBG] The request path /v1/user/test/account-ba\u0026#39;lan\u0026#39;ce does not match a supported file type [2020-06-05T13:00:33.2223942+00:00 Microsoft.AspNetCore.Server.Kestrel DBG] Connection id \u0026#34;0HM09A1MAAR23\u0026#34; started. [2020-06-05T13:00:33.2238736+00:00 Microsoft.AspNetCore.Hosting.Diagnostics INF] Request starting HTTP/1.0 GET http://172.16.2.52/v1/user/test/account-balance [2020-06-05T13:00:33.2243808+00:00 Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware DBG] The request path /v1/user/test/account-balance does not match a supported file type [2020-06-05T13:00:34.2177528+00:00 Microsoft.AspNetCore.Server.Kestrel DBG] Connection id \u0026#34;0HM09A1MAAR24\u0026#34; started. [2020-06-05T13:00:34.2189073+00:00 Microsoft.AspNetCore.Hosting.Diagnostics INF] Request starting HTTP/1.0 GET http://172.16.2.52/v1/user/test/account-balance [2020-06-05T13:00:34.2193483+00:00 Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware DBG] The request path /v1/user/test/account-balance does not match a supported file type [2020-06-05T13:00:35.2169806+00:00 Microsoft.AspNetCore.Server.Kestrel DBG] Connection id \u0026#34;0HM09A1MAAR25\u0026#34; started. [2020-06-05T13:00:35.2178259+00:00 Microsoft.AspNetCore.Hosting.Diagnostics INF] Request starting HTTP/1.0 GET http://172.16.2.52/v1/user/test/account-balance [2020-06-05T13:00:35.2181055+00:00 Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware DBG] The request path /v1/user/test/account-balance does not match a supported file type [2020-06-05T13:00:36.2183025+00:00 Microsoft.AspNetCore.Server.Kestrel DBG] Connection id \u0026#34;0HM09A1MAAR26\u0026#34; started. [2020-06-05T13:00:36.2195050+00:00 Microsoft.AspNetCore.Hosting.Diagnostics INF] Request starting HTTP/1.0 GET http://172.16.2.52/v1/user/test/account-balance [2020-06-05T13:00:36.2199702+00:00 Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware DBG] The request path /v1/user/test/account-balance does not match a supported file type [2020-06-05T13:00:37.2373822+00:00 Microsoft.AspNetCore.Server.Kestrel DBG] Connection id \u0026#34;0HM09A1MAAR27\u0026#34; started. å¼•å‘çš„å‡ ç§åæœ å®¢æˆ·ç«¯è°ƒç”¨è¶…æ—¶ ç»è¿‡äº† 30S ç”šè‡³æ›´é•¿æ—¶é—´åçœ‹åˆ°å¤§é‡çš„æ•°æ®åº“è¿æ¥è¢«åˆå§‹åŒ–ï¼Œç„¶åå¼€å§‹é›†ä¸­å¼è¿”å›ã€‚\næ­¤æ—¶å¯èƒ½å¯¹äºå®¢æˆ·ç«¯è°ƒç”¨æ¥è¯´è¿™ä¸€æ‰¹è¯·æ±‚éƒ½æ˜¯è¶…æ—¶çš„ï¼Œ\nä¸¥é‡å½±å“ç”¨æˆ·ä½“éªŒå’ŒæŸäº›ä¾èµ–äºæ­¤çš„å…¶ä»–æ¥å£ã€‚\næ•°æ®åº“è¿æ¥æš´æ¶¨ å› ä¸ºåŒæ—¶è¿›å…¥å¤§é‡æ•°æ®åº“æŸ¥è¯¢è¯·æ±‚è§¦å‘æ•°æ®åº“ DbContextPool å¤§é‡åˆ›å»ºï¼Œ\nè¿æ¥æ•°éšä¹‹æš´æ¶¨ï¼Œæ•°æ®åº“æŸ¥è¯¢æ€§èƒ½æ€¥é€Ÿä¸‹é™ï¼Œå¯èƒ½å¼•å‘å…¶ä»–çš„åº”ç”¨é—®é¢˜ã€‚\nå¼•å‘æœåŠ¡â€œé›ªå´©â€æ•ˆåº”ï¼ŒæœåŠ¡ä¸å¯ç”¨ è¯·æ±‚å †ç§¯çš„æƒ…å†µä¸‹ï¼Œ\nhealth-check æ¥å£å“åº”å¼‚å¸¸ï¼Œ\nå¯¼è‡´ k8s ä¸»åŠ¨é‡å¯æœåŠ¡ï¼Œé‡å¯åç»§ç»­ä¸Šè¿°æƒ…å†µï¼Œ\nä¸æ–­æ¶åŒ–æœ€åå¯¼è‡´æœåŠ¡ä¸å¯ç”¨ã€‚\næ’æŸ¥é—®é¢˜ æ•°æ®åº“çš„é—®é¢˜ ï¼Ÿ å½“ç„¶ï¼Œé¦–å…ˆæ€€ç–‘çš„å°±æ˜¯æ•°æ®åº“äº†ã€‚\nå­˜åœ¨æ€§èƒ½ç“¶é¢ˆï¼Ÿæ…¢æŸ¥è¯¢å¯¼è‡´ä¸å“åº”ï¼Ÿå‘å¸ƒæœŸé—´å­˜åœ¨å…¶ä»–çš„å¼‚å¸¸ï¼Ÿ\nè¿™ç±»çš„é—®é¢˜éƒ½æ„ä¹‰æ’æŸ¥èµ·æ¥äº†ã€‚\næœ€åå‘ç°ï¼Œ\nè¿™ç§æƒ…å†µå‘ç”Ÿçš„æ—¶å€™ï¼Œæ•°æ®åº“ç›‘æ§é‡Œé¢ä¸€ç‰‡ç¥¥å’Œã€‚\næ•°æ®åº“ IOã€CPUã€å†…å­˜éƒ½æ­£å¸¸ï¼Œ\nè¿æ¥æ•°æš´æ¶¨æ˜¯è¿™ç§æƒ…å†µå‘ç”Ÿçš„æ—¶å€™å¸¦æ¥çš„ï¼Œ\nè€Œä¸æ˜¯è¿æ¥æ•°æš´æ¶¨ä¹‹åå¯¼è‡´äº†æ­¤æƒ…å†µã€‚\næ•°æ®åº“é©±åŠ¨æˆ–è€… EF Core æ¡†æ¶çš„é—®é¢˜ï¼Ÿ æ˜¯çš„ï¼Œ\nè¿™ä¸ªæ€€ç–‘ä¸€ç›´éƒ½å­˜åœ¨äºè„‘æµ·ä¸­ã€‚\næœ€ç»ˆï¼Œ\næ˜¨å¤©å¸¦ç€â€œè¢«æŒ¨éª‚çš„æƒ…å†µâ€å»é—®äº†ä¸‹â€œPomelo.EntityFrameworkCore.MySqlâ€çš„ä½œè€…ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 æ˜¥å¤©çš„ç†Š 18:34:08 æŸšå­å•Šï¼Œæˆ‘è¿™è¾¹çš„.NET CoreæœåŠ¡åˆšèµ·æ¥ï¼Œå»ºç«‹MySQLè¿æ¥çš„æ—¶å€™å¥½æ…¢ï¼Œç„¶ååŒä¸€æ‰¹è¯·æ±‚å¯èƒ½æ— æ³•æ­£å¸¸å“åº”ï¼Œè¿™ä¸ªæœ‰ä»€ä¹ˆå¥½çš„è§£å†³æ€è·¯å—ï¼Ÿ Yukoä¸¶æŸšå­ 18:34:29 Min Pool Size = 200 Yukoä¸¶æŸšå­ 18:34:32 æ”¾è¿æ¥å­—ç¬¦ä¸²é‡Œ æ˜¥å¤©çš„ç†Š 18:34:53 è¿™ä¸ªå­—æ®µæ”¯æŒäº†å—ï¼Ÿ Yukoä¸¶æŸšå­ 18:35:07 ä¸€ç›´éƒ½æ”¯æŒ æ˜¥å¤©çš„ç†Š 18:35:56 ç­‰ç­‰ï¼Œ public static IServiceCollection AddDbContextPool\u0026lt;TContext\u0026gt;([NotNullAttribute] this IServiceCollection serviceCollection, [NotNullAttribute] Action\u0026lt;DbContextOptionsBuilder\u0026gt; optionsAction, int poolSize = 128) where TContext : DbContext; æ˜¥å¤©çš„ç†Š 18:36:13 è¿™é‡Œä¸æ˜¯é»˜è®¤æœ€å¤§çš„128ä¹ˆï¼Ÿ Yukoä¸¶æŸšå­ 18:36:18 ä½ è¿™ä¸ªpool sizeæ˜¯dbcontextçš„ Yukoä¸¶æŸšå­ 18:36:21 æˆ‘è¯´çš„æ˜¯mysqlè¿æ¥å­—ç¬¦ä¸²çš„ Yukoä¸¶æŸšå­ 18:36:28 dbcontextçš„poolæœ‰ä»€ä¹ˆç”¨ æ˜¥å¤©çš„ç†Š 18:43:13 æˆ‘é—®ä¸ªè®¨æ‰“çš„é—®é¢˜ï¼Œdbcontext æ˜¯å…·ä½“çš„é“¾æ¥å®ä¾‹ï¼ŒEFç”¨çš„ï¼ŒMin Pool Size æŒ‡çš„æ˜¯è¿™ä¸€ä¸ªå®ä¾‹ä¸Šé¢çš„è¿æ¥æ± å—â€œï¼Ÿ Yukoä¸¶æŸšå­ 18:44:07 ä½ åœ¨è¯´ä»€ä¹ˆã€‚ã€‚ã€‚ Yukoä¸¶æŸšå­ 18:45:58 æ”¾åˆ°mysqlçš„è¿æ¥å­—ç¬¦ä¸²ä¸Š Yukoä¸¶æŸšå­ 18:46:14 è¿™æ ·ç¬¬ä¸€æ¬¡è°ƒç”¨MySqlConnectionçš„æ—¶å€™å°±ä¼šå»ºç«‹200ä¸ªè¿æ¥ æ˜¥å¤©çš„ç†Š 18:46:56 é»˜è®¤æ˜¯å¤šå°‘æ¥çš„ï¼Ÿ100å—ï¼Ÿ Yukoä¸¶æŸšå­ 18:48:33 0 Yukoä¸¶æŸšå­ 18:48:40 maxé»˜è®¤æ˜¯100 Yukoä¸¶æŸšå­ 18:52:50 DbContextPoolè¦è§£å†³çš„é—®é¢˜ä½ éƒ½æ²¡ææ¸…æ¥š æ˜¥å¤©çš„ç†Š 18:53:23 DbContextPoolè¦è§£å†³çš„æ˜¯å°½é‡ä¸å»é‡å¤åˆ›å»ºDbContext Yukoä¸¶æŸšå­ 18:53:34 ä¸ºä»€ä¹ˆä¸è¦é‡å¤åˆ›å»ºDbContext æ˜¥å¤©çš„ç†Š 18:53:50 å› ä¸ºæ¯ä¸ªDbContextåˆ›å»ºçš„ä»£ä»·å¾ˆé«˜ï¼Œè€Œä¸”å¾ˆæ…¢ Yukoä¸¶æŸšå­ 18:54:01 åˆ›å»ºDbContextæœ‰ä»€ä¹ˆä»£ä»· Yukoä¸¶æŸšå­ 18:54:03 å“ªé‡Œæ…¢äº† Yukoä¸¶æŸšå­ 18:54:06 éƒ½æ˜¯æ¯«ç§’çº§çš„ Yukoä¸¶æŸšå­ 18:54:20 ä»–çš„ä»£ä»·ä¸åœ¨äºåˆ›å»º è€Œåœ¨äºå›æ”¶ Yukoä¸¶æŸšå­ 18:54:25 DbContextPoolè¦è§£å†³çš„é—®é¢˜æ˜¯ å› ä¸ºDbContextå±äºè¾ƒå¤§çš„å¯¹è±¡ï¼Œè€Œä¸”æ˜¯é¢‘ç¹è¢«newï¼Œè€Œä¸”ç»å¸¸å¤±å»å¼•ç”¨å¯¼è‡´GCé¢‘ç¹å·¥ä½œã€‚ Yuko å¤§å¤§è¯´çš„æƒ…å†µæ„Ÿè§‰ä¼šæ˜¯ä¸€ä¸ªæ€è·¯ï¼Œ\næ‰€ä»¥ç¬¬ä¸€ååº”å°±æ˜¯åŠ äº†å‚æ•°æ§åˆ¶è¿æ¥æ± ã€‚\nä¸è¿‡ï¼Œæ— æœã€‚\n5 ä¸ªå®ä¾‹ï¼Œ\næœ‰ 3 ä¸ªå®ä¾‹æ­£å¸¸å¯åŠ¨ï¼Œ\n2 ä¸ªå®ä¾‹ä¼šé‡å¤â€œé›ªå´©â€æ•ˆåº”ï¼Œæœ€ç»ˆæ— æ³•æ­£å¸¸å¯åŠ¨ã€‚\nè¿™ä¸ªå°è¯•æ“ä½œé‡å¤äº†å¥½å¤šæ¬¡ï¼Œ\næ ¹æ®æ–‡æ¡£å’Œ Yuko å¤§å¤§æŒ‡å¯¼ç»§ç»­åŠ äº†ä¸å°‘ MySQL é“¾æ¥å‚æ•°ï¼Œ\næœ€åï¼Œ\né‡æ–°å­¦ä¹ äº†ä¸€æ³¢é“¾æ¥å‚æ•°çš„ä¼˜åŒ–æ„ä¹‰ï¼Œ\næ— æœã€‚\nç©¶ç«Ÿæ•°æ®åº“é©±åŠ¨æœ‰æ²¡æœ‰é—®é¢˜ï¼Ÿ æ²¡ä»€ä¹ˆå¥½çš„æ€è·¯äº†ï¼Œ\nè¿œç¨‹åˆ°å®¹å™¨é‡Œé¢ Debug åŸºæœ¬ä¸å¤ªç°å®ï¼ˆé‡æ–°æ‰“åŒ… + å®¹å™¨åŒ–æ‰“åŒ… + k8s + äººè‚‰å’ŒæœåŠ¡å™¨å®å¤§æ´‹ï¼‰ï¼Œ\nè¦ä¸ï¼Œè¯•è¯•æŠŠæ—¥å¿—ç™»å½•è°ƒèŠ‚åˆ° Debug çœ‹çœ‹æ‰€æœ‰çš„è¡Œä¸ºï¼Ÿ\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 { \u0026#34;Using\u0026#34;: [\u0026#34;Serilog.Sinks.Console\u0026#34;], \u0026#34;MinimumLevel\u0026#34;: { \u0026#34;Default\u0026#34;: \u0026#34;Debug\u0026#34;, \u0026#34;Override\u0026#34;: { \u0026#34;Microsoft\u0026#34;: \u0026#34;Debug\u0026#34; } }, \u0026#34;WriteTo\u0026#34;: [ { \u0026#34;Name\u0026#34;: \u0026#34;Console\u0026#34;, \u0026#34;Args\u0026#34;: { \u0026#34;outputTemplate\u0026#34;: \u0026#34;[{Timestamp:o} {SourceContext} {Level:u3}] {Message:lj}{NewLine}{Exception}\u0026#34; } } ] } å½“ç„¶ï¼Œè¿™ä¸ªäº‹æƒ…æ²¡æœ‰ç›´æ¥åœ¨æ­£å¸¸çš„ç”Ÿäº§ç¯å¢ƒæ‰§è¡Œã€‚\nè¿™é‡Œæ˜¯ä½¿ç”¨æ–°é…ç½®ï¼Œé‡æ–°èµ·æ–°å®ä¾‹æ¥æ“ä½œã€‚\nç„¶åæˆ‘ä»¬çœ‹åˆ°ç¨‹åºå¯åŠ¨çš„æ—¶å€™æ‰§è¡Œ EFMigration çš„æ—¶å€™ï¼Œ\nç¨‹åºå’Œæ•´ä¸ªæ•°æ®åº“äº¤äº’çš„å®Œæ•´æ—¥å¿—ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 [2020-06-05T12:59:56.4147202+00:00 Microsoft.EntityFrameworkCore.Database.Connection DBG] Opening connection to database \u0026#39;user_pool\u0026#39; on server \u0026#39;aliyun-rds\u0026#39;. [2020-06-05T12:59:56.4159970+00:00 Microsoft.EntityFrameworkCore.Database.Connection DBG] Opened connection to database \u0026#39;user_pool\u0026#39; on server \u0026#39;a\u0026#39;li\u0026#39;yun\u0026#39;. [2020-06-05T12:59:56.4161172+00:00 Microsoft.EntityFrameworkCore.Database.Command DBG] Executing DbCommand [Parameters=[], CommandType=\u0026#39;Text\u0026#39;, CommandTimeout=\u0026#39;30\u0026#39;] SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=\u0026#39;user_pool\u0026#39; AND TABLE_NAME=\u0026#39;__EFMigrationsHistory\u0026#39;; [2020-06-05T12:59:56.4170776+00:00 Microsoft.EntityFrameworkCore.Database.Command INF] Executed DbCommand (1ms) [Parameters=[], CommandType=\u0026#39;Text\u0026#39;, CommandTimeout=\u0026#39;30\u0026#39;] SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=\u0026#39;user_pool\u0026#39; AND TABLE_NAME=\u0026#39;__EFMigrationsHistory\u0026#39;; [2020-06-05T12:59:56.4171630+00:00 Microsoft.EntityFrameworkCore.Database.Connection DBG] Closing connection to database \u0026#39;user_pool\u0026#39; on server \u0026#39;aliyun-rds\u0026#39;. [2020-06-05T12:59:56.4172458+00:00 Microsoft.EntityFrameworkCore.Database.Connection DBG] Closed connection to database \u0026#39;user_pool\u0026#39; on server \u0026#39;aliyun-rds\u0026#39;. [2020-06-05T12:59:56.4385345+00:00 Microsoft.EntityFrameworkCore.Database.Command DBG] Creating DbCommand for \u0026#39;ExecuteReader\u0026#39;. [2020-06-05T12:59:56.4386201+00:00 Microsoft.EntityFrameworkCore.Database.Command DBG] Created DbCommand for \u0026#39;ExecuteReader\u0026#39; (0ms). [2020-06-05T12:59:56.4386763+00:00 Microsoft.EntityFrameworkCore.Database.Connection DBG] Opening connection to database \u0026#39;user_pool\u0026#39; on server \u0026#39;aliyun-rds\u0026#39;. [2020-06-05T12:59:56.4400143+00:00 Microsoft.EntityFrameworkCore.Database.Connection DBG] Opened connection to database \u0026#39;user_pool\u0026#39; on server \u0026#39;aliyun-rds\u0026#39;. [2020-06-05T12:59:56.4404529+00:00 Microsoft.EntityFrameworkCore.Database.Command DBG] Executing DbCommand [Parameters=[], CommandType=\u0026#39;Text\u0026#39;, CommandTimeout=\u0026#39;30\u0026#39;] SELECT `MigrationId`, `ProductVersion` FROM `__EFMigrationsHistory` ORDER BY `MigrationId`; [2020-06-05T12:59:56.4422387+00:00 Microsoft.EntityFrameworkCore.Database.Command INF] Executed DbCommand (2ms) [Parameters=[], CommandType=\u0026#39;Text\u0026#39;, CommandTimeout=\u0026#39;30\u0026#39;] SELECT `MigrationId`, `ProductVersion` FROM `__EFMigrationsHistory` ORDER BY `MigrationId`; [2020-06-05T12:59:56.4446400+00:00 Microsoft.EntityFrameworkCore.Database.Command DBG] A data reader was disposed. [2020-06-05T12:59:56.4447422+00:00 Microsoft.EntityFrameworkCore.Database.Connection DBG] Closing connection to database \u0026#39;user_pool\u0026#39; on server \u0026#39;aliyun-rds\u0026#39;. [2020-06-05T12:59:56.4447975+00:00 Microsoft.EntityFrameworkCore.Database.Connection DBG] Closed connection to database \u0026#39;user_pool\u0026#39; on server \u0026#39;aliyun-rds\u0026#39;. [2020-06-05T12:59:56.5170419+00:00 Microsoft.EntityFrameworkCore.Migrations INF] No migrations were applied. The database is already up to date. çœ‹åˆ°è¿™é‡Œçš„æ—¶å€™ï¼Œç”±äºå‘ç°æˆ‘ä»¬ä¹‹å‰å¯¹ DbContext å’Œ DbConnection çš„ç†è§£ä¸å¤ªå¥½ï¼Œ\næƒ³ææ¸…æ¥šç©¶ç«Ÿæ˜¯ä¸ db connection åˆ›å»ºçš„æ—¶å€™æœ‰å“ªäº›è¡Œä¸ºï¼Œ\näºæ˜¯æˆ‘ä»¬æ‰¾åˆ°äº† dotnet/efcore Github çš„æºç å¼€å§‹æ‹œè¯»ï¼Œ\nPSï¼š æºç çœŸé¦™ï¼Œèƒ½çœ‹æºç çœŸå¥½ã€‚\nå°è¯•é€šè¿‡â€œOpening connectionâ€æ‰¾åˆ°æ—¥å¿—çš„åœºæ™¯ã€‚\næƒ³äº†è§£è¿™ä¸ªæ—¥å¿—è¾“å‡ºçš„æ—¶å€™ä»£ç åœ¨åšä»€ä¹ˆæ ·çš„äº‹æƒ…ï¼Œå¯èƒ½åŒæ—¶ä¼šæœ‰å“ªäº›è¡Œä¸ºã€‚\nåœ¨è€ƒè™‘æ˜¯ä¸æ˜¯å…¶ä»–çš„ä¸€äº›è¡Œä¸ºå¯¼è‡´äº†ä¸Šé¢çš„æœåŠ¡é—®é¢˜ï¼Ÿ\næœ€ç»ˆåœ¨RelationalConnection.csç¡®è®¤ä¸Šé¢è¿™äº›æ•°æ®åº“ç›¸å…³æ—¥å¿—è‚¯å®šæ˜¯ä¼šè¾“å‡ºçš„ï¼Œä¸å­˜åœ¨å…¶ä»–çš„å¼‚å¸¸è¡Œä¸ºã€‚\nPSï¼šä¸ç”¨ç»†çœ‹ï¼Œæˆ‘ä»¬è®¤çœŸæµè§ˆäº†ä»£ç ä¹‹åç¡®è®¤ DbContext æ­£å¸¸åˆå§‹åŒ–ï¼Œ\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 /// \u0026lt;summary\u0026gt; /// Asynchronously opens the connection to the database. /// \u0026lt;/summary\u0026gt; /// \u0026lt;param name=\u0026#34;errorsExpected\u0026#34;\u0026gt; Indicate if the connection errors are expected and should be logged as debug message. \u0026lt;/param\u0026gt; /// \u0026lt;param name=\u0026#34;cancellationToken\u0026#34;\u0026gt; /// A \u0026lt;see cref=\u0026#34;CancellationToken\u0026#34; /\u0026gt; to observe while waiting for the task to complete. /// \u0026lt;/param\u0026gt; /// \u0026lt;returns\u0026gt; /// A task that represents the asynchronous operation, with a value of \u0026lt;see langword=\u0026#34;true\u0026#34;/\u0026gt; if the connection /// was actually opened. /// \u0026lt;/returns\u0026gt; public virtual async Task\u0026lt;bool\u0026gt; OpenAsync(CancellationToken cancellationToken, bool errorsExpected = false) { if (DbConnection.State == ConnectionState.Broken) { await DbConnection.CloseAsync().ConfigureAwait(false); } var wasOpened = false; if (DbConnection.State != ConnectionState.Open) { if (CurrentTransaction != null) { await CurrentTransaction.DisposeAsync().ConfigureAwait(false); } ClearTransactions(clearAmbient: false); await OpenDbConnectionAsync(errorsExpected, cancellationToken).ConfigureAwait(false); wasOpened = true; } _openedCount++; HandleAmbientTransactions(); return wasOpened; } private async Task OpenDbConnectionAsync(bool errorsExpected, CancellationToken cancellationToken) { var startTime = DateTimeOffset.UtcNow; var stopwatch = Stopwatch.StartNew(); // æ—¥å¿—è¾“å‡ºåœ¨è¿™é‡Œ var interceptionResult = await Dependencies.ConnectionLogger.ConnectionOpeningAsync(this, startTime, cancellationToken) .ConfigureAwait(false); try { if (!interceptionResult.IsSuppressed) { await DbConnection.OpenAsync(cancellationToken).ConfigureAwait(false); } // æ—¥å¿—è¾“å‡ºåœ¨è¿™é‡Œ await Dependencies.ConnectionLogger.ConnectionOpenedAsync(this, startTime, stopwatch.Elapsed, cancellationToken) .ConfigureAwait(false); } catch (Exception e) { await Dependencies.ConnectionLogger.ConnectionErrorAsync( this, e, startTime, stopwatch.Elapsed, errorsExpected, cancellationToken) .ConfigureAwait(false); throw; } if (_openedCount == 0) { _openedInternally = true; } } å½“ç„¶ï¼Œæˆ‘ä»¬åŒæ—¶ä¹Ÿå»çœ‹äº†ä¸€çœ¼ MySqlConnectorçš„æºç ï¼Œ\nç¡®è®¤å®ƒè‡ªèº«æ˜¯ç»´æŠ¤äº†æ•°æ®åº“è¿æ¥æ± çš„ã€‚åˆ°è¿™é‡ŒåŸºæœ¬ç¡®è®¤ä¸ä¼šæ˜¯æ•°æ®åº“é©±åŠ¨å¯¼è‡´çš„ä¸Šè¿°é—®é¢˜ã€‚\næŸç§çŒœæµ‹ è‚¯å®šæ˜¯æœ‰ä»€ä¹ˆå¥‡æ€ªçš„è¡Œä¸ºé˜»å¡äº†å½“å‰æœåŠ¡è¿›ç¨‹ï¼Œ å¯¼è‡´æ•°æ®åº“è¿æ¥çš„æ—¥å¿—ä¹Ÿæ²¡æœ‰è¾“å‡ºã€‚ é”ï¼Ÿ å¼‚æ­¥ç­‰åŒæ­¥ï¼Ÿèµ„æºåˆå§‹åŒ–é—®é¢˜ï¼Ÿ å‘¨äº”æ™šä¸ŠæŸ¥åˆ°äº†è¿™é‡Œå·²ç»åä¸€ç‚¹äº†ï¼Œ\näºæ˜¯å…ˆä¸‹ç­å›å®¶ä¼‘æ¯äº†ã€‚\näºæ˜¯ï¼Œ\nå‘¨å…­ç»ƒå®Œè½¦ä¹‹å Call äº†ä¸€ä¸‹å°ä¼™ä¼´ï¼Œ\nåˆåŒåŒå¼€å§‹äº†æ„‰å¿«çš„ Debugã€‚\næ’æ›² å°ä¼™ä¼´æµ·æ—å›å…¬å¸å‰å‘äº†ä¸ªæœ‹å‹åœˆã€‚\nâ€œ å’‹ä»¬ç»§ç»­æ˜¨å¤©çš„ bugï¼Œ\nç‰¹æ­¤ç«‹ flagï¼šä¿®ä¸å¥½ç›´æ’­åƒ bug\nåæ­£ä¸æ˜¯ä½ æ­»å°±æ˜¯æˆ‘äº¡â€¦â€\næˆ‘è°ƒä¾ƒè¯„è®ºè¯´:\nä½ ç­‰ä¸‹ï¼Œæˆ‘æ‰“åŒ…ä¸‹ä»£ç å»æ¥¼ä¸‹æ‰“å°å‡ºæ¥å¾…ä¼šå½“æ™šé¥­\nå¼€å§‹é”å®šé—®é¢˜ ä¸­é—´ä»¶å¯¼è‡´çš„å—ï¼Ÿ 1 2 3 [2020-06-05T13:00:35.2181055+00:00 Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware DBG] The request path /v1/user/test/account-balance does not match a supported file type æˆ‘ä»¬å¯¹ç€è¿™ä¸ªæ—¥å¿—æ€è€ƒäº†ä¸€ä¼šäººç”Ÿï¼Œ\nç„¶åæŠŠå¼•ç”¨æ­¤ä¸­é—´ä»¶çš„ä»£ç æ³¨é‡Šæ‰äº†ï¼Œ\nä¸è¿‡ï¼Œæ— æœã€‚\nè‡ªå®šä¹‰ filters å¯¼è‡´çš„å—ï¼Ÿ 1 2 3 4 [2020-06-05T13:01:05.3126001+00:00 Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker DBG] Execution plan of exception filters (in the following order): [\u0026#34;None\u0026#34;] [2020-06-05T13:01:05.3126391+00:00 Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker DBG] Execution plan of result filters (in the following order): [\u0026#34;Microsoft.AspNetCore.Mvc.ViewFeatures.Filters.SaveTempDataFilter\u0026#34;, \u0026#34;XXX.Filters.HTTPHeaderAttribute (Order: 0)\u0026#34;] [2020-06-05T13:01:05.3072206+00:00 Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker DBG] Execution plan of authorization filters (in the following order): [\u0026#34;None\u0026#34;] çœ‹åˆ°è¿™ä¸ªæ—¥å¿—æˆ‘ä»¬è€ƒè™‘äº†ä¸€ä¸‹ï¼Œ\næ˜¯ä¸æ˜¯å› ä¸º filters å¯¼è‡´äº†é—®é¢˜ã€‚\næ¯•ç«Ÿåœ¨ HTTPHeaderAttribute æˆ‘ä»¬è¿˜è¿˜åšäº† ThreadLocal\u0026lt;Dictionary\u0026lt;string, string\u0026raquo; CurrentXHeaders\nè¿™é‡Œæ€€ç–‘æ˜¯ä¸æ˜¯æˆ‘ä»¬çš„å®ç°å­˜åœ¨é”æœºåˆ¶å¯¼è‡´â€œå‡æ­»é—®é¢˜â€ã€‚\nå°è¯•å»æ‰ã€‚\nä¸è¿‡ï¼Œ\næ— æœã€‚\nå°è¯•ä½¿ç”¨ ptrace æ²¡ä»€ä¹ˆå¾ˆå¥½çš„å¤´ç»ªäº†ï¼Œè¦ä¸ä¸Šä¸€ä¸‹ ptrace ä¹‹ç±»çš„å·¥å…·è·Ÿä¸€ä¸‹ç³»ç»Ÿè°ƒç”¨ï¼Ÿ\næœ€æ—©åœ¨å»å¹´å°±å°è¯•è¿‡ä½¿ç”¨ ptrace æŠ“è¿›ç¨‹æ•°æ®çœ‹ç³»ç»Ÿè°ƒç”¨ï¼Œ\nåæ¥å‡çº§åˆ°.NET Core3.0 ä¹‹åï¼Œå®˜æ–¹åŸºäº Events + LTTng ä¹‹ç±»çš„ä¸œè¥¿åšäº† dotnet-trace å·¥å…·ï¼Œ\nå®˜ç½‘è¯´æ˜ï¼šdotnet-trace performance analysis utility\næ”¹ä¸€ä¸‹æ‰“åŒ…æ‰”ä¸Šå»åšä¸€ä¸ªæ•°æ®æ”¶é›†çœ‹çœ‹ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 FROM mcr.microsoft.com/dotnet/core/sdk:3.1 AS build-env WORKDIR /app # copy csproj and restore as distinct layers COPY src/*.csproj ./ RUN dotnet restore COPY . ./ # copy everything else and build RUN dotnet publish src -c Release -o /app/out # build runtime image FROM mcr.microsoft.com/dotnet/core/aspnet:3.1 # debug # Install .NET Core SDK RUN dotnet_sdk_version=3.1.100 \\ \u0026amp;\u0026amp; curl -SL --output dotnet.tar.gz https://dotnetcli.azureedge.net/dotnet/Sdk/$dotnet_sdk_version/dotnet-sdk-$dotnet_sdk_version-linux-x64.tar.gz \\ \u0026amp;\u0026amp; dotnet_sha512=\u0026#39;5217ae1441089a71103694be8dd5bb3437680f00e263ad28317665d819a92338a27466e7d7a2b1f6b74367dd314128db345fa8fff6e90d0c966dea7a9a43bd21\u0026#39; \\ \u0026amp;\u0026amp; echo \u0026#34;$dotnet_sha512 dotnet.tar.gz\u0026#34; | sha512sum -c - \\ \u0026amp;\u0026amp; rm -rf /usr/share/dotnet \\ \u0026amp;\u0026amp; rm -rf /usr/bin/dotnet \\ \u0026amp;\u0026amp; mkdir -p /usr/share/dotnet \\ \u0026amp;\u0026amp; tar -ozxf dotnet.tar.gz -C /usr/share/dotnet \\ \u0026amp;\u0026amp; rm dotnet.tar.gz \\ \u0026amp;\u0026amp; ln -s /usr/share/dotnet/dotnet /usr/bin/dotnet \\ # Trigger first run experience by running arbitrary cmd \u0026amp;\u0026amp; dotnet help RUN dotnet tool install --global dotnet-trace RUN dotnet tool install -g dotnet-dump RUN dotnet tool install --global dotnet-counters ENV PATH=\u0026#34;$PATH:/root/.dotnet/tools\u0026#34; # end debug WORKDIR /app COPY --from=build-env /app/out . ENTRYPOINT [\u0026#34;dotnet\u0026#34;, \u0026#34;Your-APP.dll\u0026#34;] æ›´æ–°å‘å¸ƒï¼Œç­‰å¾…æœåŠ¡æ­£å¸¸å¯åŠ¨ä¹‹åï¼Œ\nä½¿ç”¨ ab -c 300 -n 3000 \u0026lsquo;http://172.16.2.52/v1/user/test/account-balance\u0026rsquo; æ¨¡æ‹Ÿ 300 ä¸ªç”¨æˆ·åŒæ—¶è¯·æ±‚ï¼Œ\nä½¿å¾—ç¨‹åºè¿›å…¥ä¸Šè¿°çš„â€œå‡æ­»çŠ¶æ€â€ã€‚\næ¥ç€ç«‹å³è¿›å…¥å®¹å™¨ï¼Œæ‰§è¡Œ\u0026rsquo;dotnet-trace collect -p 1\u0026rsquo; å¼€å§‹æ”¶é›†æ—¥å¿—ã€‚\næœ€åæ‹¿åˆ°äº†ä¸€ä»½å¤§æ¦‚ 13M trace.nettrace æ•°æ®, è¿™ä¸ªæ–‡ä»¶æ˜¯ PerView æ”¯æŒçš„æ ¼å¼ï¼Œ\nåœ¨ MacOS æˆ–è€… Linux ä¸Šæ— æ³•ä½¿ç”¨ã€‚\nå¥½åœ¨ dotnet-trace convert å¯ä»¥å°† trace.nettrace è½¬æ¢æˆ speedscope/chromium ä¸¤ç§æ ¼å¼ã€‚\nspeedscope/chromium speedscope:A fast, interactive web-based viewer for performance profiles.\nchrome-devtools evaluate-performance å…¨æ–° Chrome Devtool Performance ä½¿ç”¨æŒ‡å—\n1 2 3 $dotnet-trace convert 20200606-1753-trace.nettrace.txt --format Speedscope $dotnet-trace convert 20200606-1753-trace.nettrace.txt --format chromium $speedscope 20200606-1753-trace.nettrace.speedscope.json ç„¶åï¼Œç‚¸é¸¡äº†ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 âœ Downloads speedscope 20200606-1625.trace.speedscope.json Error: Cannot create a string longer than 0x3fffffe7 characters at Object.slice (buffer.js:652:37) at Buffer.toString (buffer.js:800:14) at main (/home/liguobao/.nvm/versions/node/v12.16.2/lib/node_modules/speedscope/bin/cli.js:69:39) at processTicksAndRejections (internal/process/task_queues.js:97:5) Usage: speedscope [filepath] If invoked with no arguments, will open a local copy of speedscope in your default browser. Once open, you can browse for a profile to import. If - is used as the filepath, will read from stdin instead. cat /path/to/profile | speedscope - å“¦ï¼Œ Buffer.toString ç‚¸é¸¡äº†ã€‚\nçœ‹ä¸€çœ¼ 20200606-1625.trace.speedscope.json å¤šå¤§?\n900Mã€‚\nç‰›é€¼ã€‚\né‚£æ¢ Chrome performance çœ‹çœ‹ã€‚\næ‰‹åŠ¨è£…è½½ä¸€ä¸‹ 20200606-1753-trace.nettrace.chromium.json çœ‹çœ‹ã€‚\nç­‰ä¸‹ï¼Œ20200606-1753-trace.nettrace.chromium.json è¿™è´§å¤šå¤§ï¼Ÿ\nå“¦ï¼Œ4Gã€‚åº”è¯¥æ²¡äº‹ï¼ŒIntel NUC ä¸»æœºå†…å­˜ç©ºé—² 20Gï¼Œåƒæ‰ 4G å®Œå…¨æ˜¯æ²¡æœ‰é—®é¢˜çš„ã€‚\nçœ‹ç€è¿›åº¦æ¡åŠ è½½ï¼Œçœ‹ç€å†…å­˜æ¶¨èµ·æ¥ï¼Œ\nç„¶å\u0026hellip;Chrome æ§åˆ¶å°å¥”æºƒã€‚å†è§å†è§ï¼ŒåŸæ¥å¤§å®¶å½¼æ­¤å®Œå…¨æ²¡æœ‰ä¿¡ä»»äº†ã€‚\nå”‰ï¼Œå†æ¥ä¸€æ¬¡ï¼ŒæŠŠæ–‡ä»¶æ§åˆ¶åœ¨ 5M å·¦å³çœ‹çœ‹ã€‚\næœ€åï¼ŒæŠŠ 20200606-1753-trace.nettrace.chromium.json æ§åˆ¶åœ¨ 1.5G äº†ï¼Œ\nç»ˆäºå¯ä»¥æ­£å¸¸åŠ è½½èµ·æ¥äº†ã€‚\nChrome Performance é¦–å…ˆï¼Œ æˆ‘ä»¬çœ‹åˆ°ç›‘æ§é‡Œé¢æœ‰ä¸€å †çš„çº¿ç¨‹\néšä¾¿é€‰ä¸€ä¸ªçº¿ç¨‹çœ‹çœ‹å®ƒåšæ’’,é€‰æ‹© Call Tree ä¹‹å ç‚¹ç‚¹ç‚¹ç‚¹ç‚¹ã€‚\nä»è°ƒç”¨æ ˆèƒ½çœ‹åˆ° æ•´ä¸ªçº¿ç¨‹å½“å‰çŠ¶æ€æ˜¯â€œPerformWaitCallbackâ€\næ•´ä¸ªæ“ä½œåº”è¯¥çš„å¼€å¤´åº”è¯¥æ˜¯\nMicrosoft.AspNetCore.Server.Kestrel.Core.Internal.Infrastructure.KestrelConnection.System.Threading.IThreadPoolWorkItem.Execute()\nPSï¼š Kestrel (https://github.com/aspnet/KestrelHttpServer) is a lightweight cross-platform web server that supports .NET Core and runs on multiple platforms such as Linux, macOS, and Windows. Kestrel is fully written in .Net core. It is based on libuv which is a multi-platform asynchronous eventing library.\nPS äººè¯ï¼š .NET Core å†…ç½®çš„ HTTP Serverï¼Œå’Œ Spring Boot ä¸­çš„ tomcat ç»„ä»¶ç±»ä¼¼\nå¾ˆæ­£å¸¸ï¼Œè¯´æ˜è¯·æ±‚æ­£å¸¸åˆ°äº†æˆ‘ä»¬çš„æœåŠ¡é‡Œé¢äº†ã€‚\nå†çœ‹ä¸€ä¸‹å‰©ä¸‹çš„è°ƒç”¨é“¾ä¿¡æ¯ã€‚\nç®€è¦çš„è°ƒç”¨ä¿¡æ¯æ—¥å¿—åœ¨è¿™é‡Œï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start(!!0\u0026amp;) Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Infrastructure.KestrelConnection+\u0026lt;ExecuteAsync\u0026gt;d__32.MoveNext() Microsoft.AspNetCore.Server.Kestrel.Core.Internal.HttpConnectionMiddleware`1[System.__Canon].OnConnectionAsync(class Microsoft.AspNetCore.Connections.ConnectionContext) Microsoft.AspNetCore.Server.Kestrel.Core.Internal.HttpConnection.ProcessRequestsAsync(class Microsoft.AspNetCore.Hosting.Server.IHttpApplication`1\u0026lt;!!0\u0026gt;) System.Runtime.CompilerServices.AsyncTaskMethodBuilder.Start(!!0\u0026amp;) System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start(!!0\u0026amp;) Microsoft.AspNetCore.Server.Kestrel.Core.Internal.HttpConnection+\u0026lt;ProcessRequestsAsync\u0026gt;d__12`1[System.__Canon].MoveNext() Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequestsAsync(class Microsoft.AspNetCore.Hosting.Server.IHttpApplication`1\u0026lt;!!0\u0026gt;) System.Runtime.CompilerServices.AsyncTaskMethodBuilder.Start(!!0\u0026amp;) System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start(!!0\u0026amp;) Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol+\u0026lt;ProcessRequestsAsync\u0026gt;d__216`1[System.__Canon].MoveNext() Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests(class Microsoft.AspNetCore.Hosting.Server.IHttpApplication`1\u0026lt;!!0\u0026gt;) System.Runtime.CompilerServices.AsyncTaskMethodBuilder.Start(!!0\u0026amp;) System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start(!!0\u0026amp;) Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol+\u0026lt;ProcessRequests\u0026gt;d__217`1[System.__Canon].MoveNext() Microsoft.AspNetCore.Hosting.HostingApplication.ProcessRequestAsync(class Context) Microsoft.AspNetCore.HostFiltering.HostFilteringMiddleware.Invoke(class Microsoft.AspNetCore.Http.HttpContext) UserCenter.ErrorHandlingMiddleware.Invoke(class Microsoft.AspNetCore.Http.HttpContext) System.Runtime.CompilerServices.AsyncTaskMethodBuilder.Start(!!0\u0026amp;) System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start(!!0\u0026amp;) ...... ...... ...... e.StaticFiles.StaticFileMiddleware.Invoke(class Microsoft.AspNetCore.Http.HttpContext) Microsoft.AspNetCore.Builder.UseMiddlewareExtensions+\u0026lt;\u0026gt;c__DisplayClass4_1.\u0026lt;UseMiddleware\u0026gt;b__2(class Microsoft.AspNetCore.Http.HttpContext) dynamicClass.lambda_method(pMT: 00007FB6D3BBE570,class System.Object,pMT: 00007FB6D4739560,pMT: 00007FB6D0BF4F98) Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.GetService(class System.IServiceProvider,class System.Type,class System.Type) Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(class System.Type) System.Runtime.CompilerServices.AsyncTaskMethodBuilder.Start(!!0\u0026amp;) Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2[Microsoft.Extensions.DependencyInjection.ServiceLookup.RuntimeResolverContext,System.__Canon].VisitCallSite(class Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceCallSite,!0) System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start(!!0\u0026amp;) System.Runtime.CompilerServices.AsyncTaskMethodBuilder.Start(!!0\u0026amp;) çœ‹åˆ°è¿™é‡Œï¼Œå…¶å®åˆæœ‰äº†ä¸€äº›å¾ˆç»™åŠ›çš„ä¿¡æ¯è¢«æš´éœ²å‡ºæ¥äº†ã€‚\nPerformWaitCallback ç›´æ¥å­—é¢ç†è§£ï¼Œçº¿ç¨‹æ­£åœ¨æ‰§è¡Œç­‰å¾…å›è°ƒ è°ƒç”¨é“¾ä¿¡æ¯ è€å¿ƒç‚¹ï¼ŒæŠŠæ‰€æœ‰çš„ç”µè°ƒç”¨é“¾éƒ½å±•å¼€ã€‚\næˆ‘ä»¬èƒ½çœ‹åˆ°ç¨‹åºå·²ç»ä¾æ¬¡ç»è¿‡äº†ä¸‹é¢å‡ ä¸ªæµç¨‹ï¼š\n-\u0026gt;ProcessRequestsAsync(ç³»ç»Ÿ)\n-\u0026gt;ErrorHandlingMiddleware(å·²ç»åŠ è½½äº†è‡ªå®šä¹‰çš„é”™è¯¯ä¸­é—´ä»¶)\n-\u0026gt; HostFilteringMiddleware(åŠ è½½äº† Filter ä¸­é—´ä»¶)\n-\u0026gt; Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor(è°ƒç”¨é“¾ä¸­çš„æœ€åä¸€ä¸ªæ“ä½œ)\nå¯¹åº”æœ€ä¸Šé¢çš„æ—¥å¿—æ¥è¯´ï¼Œ\nè¯·æ±‚è¿›æ¥ï¼Œç»è¿‡äº†ä¸­é—´ä»¶å’Œ Filter éƒ½æ˜¯æ²¡é—®é¢˜çš„ï¼Œ\næœ€ååœ¨ DependencyInjectionï¼ˆä¾èµ–æ³¨å…¥ï¼‰ ä¸­æ²¡æœ‰äº†è¸ªè¿¹ã€‚\nåˆ°è¿™é‡Œï¼Œ\nå†æ¬¡éªŒè¯æˆ‘ä»¬æ˜¨å¤©çš„æ€è·¯ï¼š\nè¿™æ˜¯ä¸€ä¸ª â€œèµ„æºé˜»å¡é—®é¢˜â€äº§ç”Ÿçš„é—®é¢˜ è™½ç„¶åš ptrace æ˜¯æƒ³èƒ½ç›´æ¥æŠ“åˆ°â€œå‡¶æ‰‹â€çš„ï¼Œ\næœ€åå‘ç°å¹¶æ²¡æœ‰èƒ½è·Ÿè¸ªåˆ°å…·ä½“çš„å®ç°ï¼Œ\né‚£å¯å’‹åŠå‘¢ï¼Ÿ\næ§åˆ¶å˜é‡å®è·µ å·²çŸ¥ï¼š\nå¹¶å‘ 300 è®¿é—® /v1/user/test/account-balance æ¥å£ç¨‹åºä¼šå‡æ­» ç§»é™¤ Filter ä¸­é—´ä»¶ä¸èƒ½è§£å†³é—®é¢˜ å¹¶å‘ 300 è®¿é—® /v1/health å¥åº·æ£€æŸ¥æ¥å£ç¨‹åºæ­£å¸¸ ptrace ä¿¡æ¯å‘Šè¯‰æˆ‘ä»¬æœ‰â€œä¸œè¥¿â€åœ¨é˜»å¡ DI å®¹å™¨åˆ›å»ºæŸäº›å®ä¾‹ å¼€å§‹æ§åˆ¶å˜é‡ + äººè‚‰äºŒåˆ†æŸ¥æ‰¾ã€‚\næŒªæ¥å£ä»£ç  /v1/user/test/account-balance çš„é€»è¾‘æ˜¯ç”± AccountService å®ç°çš„ï¼Œ\nAccountService å¤§æ¦‚ä¾èµ–å››äº”ä¸ªå…¶ä»–çš„ Service å’Œ DBContextï¼Œ\næœ€ä¸»è¦çš„é€»è¾‘æ˜¯åŠ è½½ç”¨æˆ·å‡ ä¸ªè´¦å·ï¼Œç„¶åè®¡ç®—ä¸€ä¸‹ balanceã€‚\nå¤§æ¦‚ä»£ç å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 /// \u0026lt;summary\u0026gt; /// è·å–ç”¨æˆ·çš„AccountBalanceæ±‡æ€»ä¿¡æ¯ /// \u0026lt;/summary\u0026gt; public async Task\u0026lt;AccountBalanceStat\u0026gt; LoadAccountBalanceStatAsync(string owner) { // æ•°æ®åº“æŸ¥è¯¢ var accounts = await _dbContext.BabelAccounts.Where(ac =\u0026gt; ac.Owner == owner).ToListAsync(); // å†…å­˜è®¡ç®— return ConvertToAccountBalanceStat(accounts); } ä»€ä¹ˆéƒ½ä¸æ”¹ï¼Œç›´æ¥æŠŠä»£ç  CP åˆ° Health æ¥å£æµ‹ä¸€ä¸‹ã€‚\nç¥å¥‡ï¼Œ300 å¹¶å‘æŠ—ä½äº†ã€‚\nç»“è®ºï¼š\nä¸Šé¢è¿™ä¸€æ®µä»£ç å¹¶ä¸ä¼šå¯¼è‡´æœåŠ¡åƒµæ­» æ•°æ®åº“é©±åŠ¨æ²¡æœ‰é—®é¢˜ï¼ŒDbContext æ²¡æœ‰é—®é¢˜ï¼Œæ•°æ®åº“èµ„æºä½¿ç”¨æ²¡æœ‰é—®é¢˜ å½“å‰å¹¶ä¸ä¼šè§¦å‘ DI å®¹å™¨å¼‚å¸¸ï¼Œ é—®é¢˜å‡ºåœ¨ /v1/user/test/account-balance åˆå§‹åŒ– account-balance æœ‰ä»€ä¹ˆç¥å¥‡çš„ä¸œè¥¿å—ï¼Ÿ 1 2 3 4 5 6 7 8 9 10 11 12 /// \u0026lt;summary\u0026gt; /// æŸ¥è¯¢ç”¨æˆ·çš„Brickè´¦å·ä½™é¢ /// \u0026lt;/summary\u0026gt; [HttpGet(\u0026#34;v1/user/{owner}/account-balance\u0026#34;)] [SwaggerResponse(200, \u0026#34;è·å–æˆåŠŸ\u0026#34;, typeof(AccountBrickStat))] public async Task\u0026lt;IActionResult\u0026gt; GetAccountBricks( [FromRoute, SwaggerParameter(\u0026#34;æ‰€æœ‰è€…\u0026#34;, Required = true)] string owner) { owner = await _userService.FindOwnerAsync(owner); return Ok(new { data = await _accountService.LoadAccountAsync(owner), code = 0 }); } æˆ‘ä»¬åˆšåˆšéªŒè¯äº† LoadAccountAsync çš„ä»£ç æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œ\nè¦ä¸ UserService DI æœ‰é—®é¢˜ï¼Œè¦ä¸ AccountService DI æœ‰é—®é¢˜ã€‚\næŠŠ UserService åŠ å…¥åˆ° HealthController ä¸­ã€‚\n1 2 3 4 5 6 public HealthController(UserService userService, UserPoolDataContext dbContext) { _dbContext = dbContext; _userService= userService; } Boolã€‚\n300 å¹¶å‘æ²¡æœ‰æ’‘ä½ï¼Œç¨‹åºåƒµæ­»å•¦ã€‚\nå®Œç¾ï¼Œ\né—®é¢˜åº”è¯¥åœ¨ UserService DI åˆå§‹åŒ–äº†ã€‚\næ¥ä¸‹æ¥å°±æ˜¯ä¸€ä¸ªä¸ªéªŒè¯ UserService DI éœ€è¦çš„èµ„æºï¼Œ\nEmailSDK æ²¡æœ‰é—®é¢˜ï¼Œ\nHTTPHeaderTools æ²¡æœ‰é—®é¢˜ï¼Œ\nUserActivityLogService æ²¡æœ‰é—®é¢˜ã€‚\nRedisClient\u0026hellip; RedisClient\u0026hellip; RedisClient\u0026hellip;\nOK OK Ok\nå¤ç°ç‚¸é¸¡äº†ã€‚\nåŸæ¥æ˜¯ Redis çš„é”…ï¼Ÿ æ˜¯ï¼Œ\nä¹Ÿä¸æ˜¯ã€‚\nå…ˆçœ‹ä¸‹æˆ‘ä»¬ RedisClient æ˜¯æ€ä¹ˆä½¿ç”¨çš„ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 // startup.cs æ³¨å…¥äº†å•ä¾‹çš„ConnectionMultiplexer // ç¨‹åºå¯åŠ¨çš„æ—¶å€™ä¼šè°ƒç”¨InitRedis private void InitRedis(IServiceCollection services) { services.AddSingleton\u0026lt;ConnectionMultiplexer, ConnectionMultiplexer\u0026gt;(factory =\u0026gt; { ConfigurationOptions options = ConfigurationOptions.Parse(Configuration[\u0026#34;RedisConnectionString\u0026#34;]); options.SyncTimeout = 10 * 10000; return ConnectionMultiplexer.Connect(options); }); } //RedisClient.cs é€šè¿‡æ„é€ å‡½æ•°ä¼ å…¥ public class RedisClient { private readonly ConnectionMultiplexer _redisMultiplexer; private readonly ILogger\u0026lt;RedisClient\u0026gt; _logger; public RedisClient(ConnectionMultiplexer redisMultiplexer, ILogger\u0026lt;RedisService\u0026gt; logger) { _redisMultiplexer = redisMultiplexer; _logger = logger; } } DI åˆå§‹åŒ– RedisClient å®ä¾‹çš„æ—¶å€™ï¼Œ\néœ€è¦æ‰§è¡Œ ConnectionMultiplexer.Connect æ–¹æ³•ï¼Œ\nConnectionMultiplexer.Connect æ˜¯åŒæ­¥é˜»å¡çš„ã€‚\nConnectionMultiplexer.Connect æ˜¯åŒæ­¥é˜»å¡çš„ã€‚\nConnectionMultiplexer.Connect æ˜¯åŒæ­¥é˜»å¡çš„ã€‚\nä¸€åˆ‡éƒ½èƒ½è§£é‡Šäº†ã€‚\næ€ä¹ˆæ”¹ï¼Ÿ\n1 2 3 4 5 6 7 8 9 // InitRedis ç›´æ¥æŠŠé“¾æ¥åˆ›å»ºå¥½ï¼Œç„¶åç›´æ¥æ³¨å…¥åˆ°IServiceCollectionä¸­ private void InitRedis(IServiceCollection services) { ConfigurationOptions options = ConfigurationOptions.Parse(Configuration[\u0026#34;RedisConnectionString\u0026#34;]); options.SyncTimeout = 10 * 10000; var redisConnectionMultiplexer = ConnectionMultiplexer.Connect(options); services.AddSingleton(redisConnectionMultiplexer); Log.Information(\u0026#34;InitRedis success.\u0026#34;); } å‘å¸ƒéªŒè¯ï¼Œ\nå¼€é—¨æ”¾å¹¶å‘ 300 + 3000 è¯·æ±‚ã€‚\nå®Œç¾æŠ—ä½ï¼Œä¸ä¸€èˆ¬é¡ºæ»‘ã€‚\nè¿˜æœ‰æ›´ä¼˜çš„å†™æ³•å—ï¼Ÿ çœ‹äº†ä¸‹å¾®è½¯ Cache ä¸­é—´ä»¶æºç ï¼Œæ›´å¥½çš„åšæ³•åº”è¯¥æ˜¯é€šè¿‡ä¿¡å·é‡+å¼‚æ­¥é”æ¥åˆ›å»º Redis é“¾æ¥ï¼Œä¸‹æ¥å†ç ”ç©¶ä¸€ä¸‹ æ•°æ®åº“ä¸­å¯èƒ½ä¹Ÿå­˜åœ¨ç±»ä¼¼çš„é—®é¢˜ï¼Œä¸è¿‡å½“å‰ä¼šåœ¨ Startup ä¸­æˆ³ä¸€ä¸‹æ•°æ®åº“è¿æ¥ï¼Œåº”è¯¥é—®é¢˜ä¸å¤§ã€‚ å¤ç›˜ ç¨‹åºå¯åŠ¨çš„æ—¶å€™ä¾èµ–æ³¨å…¥å®¹å™¨åŒæ­¥åˆå§‹åŒ– Redis å¯èƒ½å¾ˆæ…¢(å‡ ç§’ç”šè‡³æ›´é•¿)çš„æ—¶å€™ï¼Œ\nå…¶ä»–çš„èµ„æºéƒ½åœ¨åŒæ­¥ç­‰å¾…å®ƒåˆå§‹åŒ–å¥½ï¼Œ\næœ€ç»ˆå¯¼è‡´è¯·æ±‚å †ç§¯ï¼Œå¼•èµ·ç¨‹åºé›ªå´©æ•ˆåº”ã€‚\nRedis åˆå§‹åŒ–è¿‡æ…¢å¹¶ä¸æ¯æ¬¡éƒ½å‘ç”Ÿï¼Œ æ‰€ä»¥ä¹‹å‰æœåŠ¡ä¹Ÿåªæ˜¯å¶å‘ã€‚\nDI åˆå§‹åŒ– Redis è¿æ¥çš„æ—¶å€™ï¼Œredis æ‰“æ¥è¿æ¥è¿˜æ˜¯ä¸ªåŒæ­¥çš„æ–¹æ³•ï¼Œ\nè¿™ç§æƒ…å†µä¸‹è¿˜å¯èƒ½å‘ç”Ÿå¼‚æ­¥è¯·æ±‚ä¸­ç­‰å¾…åŒæ­¥èµ„æºäº§ç”Ÿé˜»å¡é—®é¢˜ã€‚\nåŒæ—¶è¿˜éœ€è¦æ’æŸ¥ä½¿ç”¨å…¶ä»–å¤–éƒ¨èµ„æºçš„æ—¶å€™æ˜¯å¦ä¼šè§¦å‘åŒç±»é—®é¢˜ã€‚\nå‡ ä¸ªé€šç”¨çš„å°æŠ€å·§ ptrace å¯¹æ­¤ç±»é—®é¢˜åˆ†æå¾ˆæœ‰æ„ä¹‰ï¼Œä¸åŒè¯­è¨€æ¡†æ¶éƒ½æœ‰ç±»ä¼¼çš„å®ç°\nåŒæ­¥ã€å¼‚æ­¥æ¦‚å¿µçš„åŸç†å’Œå®ç°éƒ½è¦äº†è§£ï¼Œè¿™ä¸ªæœ‰åˆ©äºç†è§£ä¸€äº›å¥‡å¥‡æ€ªæ€ªçš„é—®é¢˜\nç«ç„°å›¾ã€Chrome dev Performance ã€speedscope éƒ½æ˜¯å¥½ä¸œè¥¿\nDebug æ—¥å¿—èƒ½ç»™æ›´å¤šçš„ä¿¡æ¯ï¼Œåœ¨éš”ç¦»ç”Ÿäº§çš„æƒ…å†µä¸‹å¤§èƒ†ä½¿ç”¨\nè¿™è¾ˆå­éƒ½ä¸å¯èƒ½çœ‹æºç çš„ï¼Œå†™å†™ CURD å¤šç¾ä¸½ï¼Ÿæºç çœŸé¦™ï¼Œæºç çœŸç‰›é€¼ã€‚\næ§åˆ¶å˜é‡éªŒè¯ï¼Œå¤§èƒ†å‡è®¾ï¼Œå°å¿ƒæ±‚è¯ï¼Œäººè‚‰äºŒåˆ†æŸ¥ï¼Œå…ˆæ€€ç–‘è‡ªå·±å†æ€€ç–‘æ¡†æ¶\næäº‹çš„æ—¶å€™ä¸è¦è‡ªå·±ä¸€ä¸ªäººï¼Œæœ‰ Bug ä¸€å®šè¦æ‹‰ä¸Šå°ä¼™ä¼´ä¸€èµ·åƒ\nç›¸å…³èµ„æ–™ IBM Developer ptrace åµŒå…¥å¼ç³»ç»Ÿä¸­è¿›ç¨‹é—´é€šä¿¡çš„ç›‘è§†æ–¹æ³•\nåˆ†æè¿›ç¨‹è°ƒç”¨ pstack å’Œ starce\npstack æ˜¾ç¤ºæ¯ä¸ªè¿›ç¨‹çš„æ ˆè·Ÿè¸ª\nå¾®è½¯ï¼šdotnet-trace performance analysis utility\nçŸ¥ä¹ï¼šå…¨æ–° Chrome Devtool Performance ä½¿ç”¨æŒ‡å—\nspeedscope A fast, interactive web-based viewer for performance profiles.\njdk å·¥å…·ä¹‹ jstack(Java Stack Trace)\né˜®ä¸€å³°:å¦‚ä½•è¯»æ‡‚ç«ç„°å›¾ï¼Ÿ\n","date":"2020-06-07T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/%E4%B8%80%E6%AC%A1%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5%E4%B8%8D%E6%85%8E%E5%BC%95%E5%8F%91%E7%9A%84%E4%B8%80%E8%BF%9E%E4%B8%B2%E4%BA%8B%E6%95%85/","title":"ä¸€æ¬¡ä¾èµ–æ³¨å…¥ä¸æ…å¼•å‘çš„ä¸€è¿ä¸²äº‹æ•…"},{"content":"è½¬è½½ï¼šCodeReview æ­£ç¡®çš„å§¿åŠ¿æ˜¯ä»€ä¹ˆï¼Ÿ ä½œè€…ï¼šå¾®åšæ˜¯é˜¿é‡Œå­¤å°½ é“¾æ¥ï¼šhttps://www.zhihu.com/question/383079175/answer/1109655276 æ¥æºï¼šçŸ¥ä¹ è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚\nCodeReview æ­£ç¡®çš„å§¿åŠ¿æ˜¯ä»€ä¹ˆï¼Ÿ â€‹\nå…¨æ–‡è½¬è½½äº â€œå¾®åšæ˜¯é˜¿é‡Œå­¤å°½â€åœ¨ä¸Šé¢çš„å›ç­”ï¼Œå·²å¾æ±‚æœ¬äººåŒæ„ã€‚\nä»¥ä¸‹æ˜¯åŸæ–‡ï¼š\næœ€è¿‘ CodeReviewï¼ˆä»¥ä¸‹ç®€ç§° CR ï¼‰å¿ƒæ€ç›¸å½“çš„å¹³å’Œï¼Œä»£ç æ˜¯ä¸€ä¸ªè®²é“ç†çš„ä¸œè¥¿ï¼Œæ˜¯å°±æ˜¯ï¼Œå¦å°±å¦ã€‚åœ¨ CR æ—¶ï¼Œæ²Ÿé€šç‰¹åˆ«è½»æ¾ï¼Œé—®é¢˜è®¨è®ºä¹Ÿç‰¹åˆ«èšç„¦ï¼Œå› ä¸ºå®ƒæ˜¯é‡åŒ–å’Œå®šå‘çš„ã€‚\nCR çš„è¿‡ç¨‹ä¸æ˜¯æƒå¼ºå‡Œå¼±ï¼Œä¹Ÿä¸æ˜¯ä¸€è¨€å ‚ï¼Œå¤§å®¶çœ‹ç€ä»£ç ï¼Œå½“ä½œæ˜¯ä¸€ç§çµé­‚çš„äº¤æµï¼Œé‚£ä¹ˆæ¯ä¸€æ¬¡çš„ CR ä¹Ÿæ˜¯åŒäº‹é—´æå‡å’Œè°åº¦çš„ä¸€ç§æ–¹å¼ã€‚ä¼˜è‰¯çš„ CR ä¼ ç»Ÿå¯ä»¥ä½“ç°å›¢é˜Ÿæ¸©åº¦ï¼Œä½“ç°é«˜å¹´çº§åŒå­¦ä¼ å¸®å¸¦çš„æŠ€æœ¯æ–‡åŒ–ã€‚å¹³æ—¶ï¼Œå¤§å®¶æŠ¬å¤´çœ‹ PRD ï¼Œä½å¤´å†™ä»£ç ï¼Œå¾ˆå°‘æœ‰æ—¶é—´é™å¿ƒæ°”é—²åœ°äº¤æµä¸€ä¸‹ä¸šåŠ¡æµç¨‹ã€ä¸šåŠ¡é€»è¾‘ã€ä¸šåŠ¡æœªæ¥æ‰©å±•ï¼Œåœ¨ CR æ—¶ï¼Œå¾€å¾€å¯ä»¥åå¤è¢«è®¨è®ºåˆ°ã€‚\nä¸€ä¸ªäººçš„èƒ½åŠ›ä¸æ˜¯ä½“ç°åœ¨è§£å†³äº†é—®é¢˜ä¸Šï¼Œä¹Ÿä¸æ˜¯å‘ç°äº†é—®é¢˜ï¼Œè€Œæ˜¯åˆ©ç”¨æŸç§æ‰‹æ®µé¢„çŸ¥é—®é¢˜å¹¶è§£å†³é—®é¢˜ã€‚æ›¾ç»æœ‰æ®µä»£ç ï¼Œæˆ‘è§‰å¾—å–åé€»è¾‘ç”Ÿæ¶©éš¾æ‡‚ï¼Œåå¤ä¿®æ”¹ä¹‹åï¼Œå‘ç°å†™ä»£ç çš„å°ä¼™ä¼´æ˜¯é”™è¯¯é¢†ä¼šäº†ä¸šåŠ¡æ„å›¾ã€‚\næå‡æŠ€æœ¯è´¨é‡ã€ä¿ƒè¿›äººæ‰æˆé•¿ã€åŸ¹å…»æŠ€æœ¯æƒ…æ€€è¿™äº›å£å·æˆ‘ä»¬ä»Šå¤©å…ˆæ”¾ä¸€è¾¹ï¼ŒèŠèŠæœ€è¿‘ CR çš„åˆ‡èº«ä½“ä¼šã€‚CR ä¸æ˜¯äº’ç›¸çœ‹å¤©ä¹¦ï¼Œè€Œæ˜¯äº§ç”Ÿå¤©å¤©çœ‹ä¹¦çš„æ„Ÿè§‰ï¼Œæ¯ä¸€æ®µå†™å¾—å¥½ï¼Œå†™å¾—ä¸å¥½çš„ä»£ç éƒ½æ˜¯ä¸€æœ¬ä¹¦ï¼Œå¥½çš„ä»£ç å¸Œæœ›è§è´¤æ€é½ï¼Œå·®çš„ä»£ç å¸Œæœ›è§ä¸è´¤è€Œå†…è‡ªçœä¹Ÿã€‚\næ€»ä¹‹ï¼Œ CR æ˜¯ä¸€ç§ä¿®è¡Œï¼Œä¹Ÿæ˜¯ä¸€ç§è‡ªæˆ‘ç§¯ç´¯ï¼Œè‹¦æ¶©çš„æ˜¯çœ‹åˆ°æƒ¨ä¸å¿å µçš„ä»£ç ï¼Œå¿ƒé‡Œè¯´ï¼šæˆ‘å»ï¼æœ‰æ„æ€çš„æ˜¯çœ‹åˆ°ä¼˜é›…çš„ä»£ç ï¼Œå¿ƒé‡Œä¹Ÿè¯´ï¼šæˆ‘å»ï¼\nä¸šåŠ¡è·‘å¾—è¿™ä¹ˆå¿«ï¼Œæ²¡æ—¶é—´ Code Review è¿™æ˜¯ä¸€ä¸ªå¾ˆå¤§çš„è°è¨€ï¼Œä¸è¦ä¸ºè‡ªå·±çš„ä¸‘ä»£ç æ‰¾åä¸½çš„å€Ÿå£ï¼Œæ²¡æœ‰æ—¶é—´å¥½å¥½ CR ï¼Œæ€»æœ‰æ—¶é—´ç„¦å¤´çƒ‚é¢åœ°å¤„ç†æ•…éšœå’ŒæŠ•è¯‰ã€‚æ—¶é—´è€äººæ˜¯å…¬å¹³çš„ï¼Œæˆ‘ä¸€ç›´è®¤ä¸ºæŸä¸ªåŒå­¦åœ¨å·¥ä½ä¸Šå™¼é‡Œå•ªå•¦æ‰“å­—ï¼Œå°±æ˜¯è¯´æ˜ä»–å¹²æ´»å¿«ï¼Œé€šè¿‡å›¢é˜Ÿæ‰“å­—æ¯”èµ›ï¼Œå‘ç°å…¶ä¸­ 20% åœ¨æŒ‰ BACKSPACE é”®ã€‚ä¸šåŠ¡è·‘å¾—å¿«ï¼Œä»£ç å†™å¾—å¿«ï¼Œå¯èƒ½å†™çš„æ˜¯ä¸€å †æ²¡æœ‰è¥å…»ç”šè‡³æ˜¯æœ‰æ¯’çš„ä»£ç ã€‚æˆ‘ä»¬éœ€è¦è¿½æ±‚çš„æ˜¯ CR çš„æ•ˆèƒ½ï¼Œè€Œä¸æ˜¯é€ƒé¿ CR ã€‚CR æ˜¯ä¸€ç§ä¿®è¡Œï¼Œå¯¹äºåŒæ–¹éƒ½æ˜¯ä¸€æ ·çš„æ”¶è·ï¼Œå› ä¸ºå¦‚æœæƒ³è±¡æˆä¸€ä¸ªæ‘Šæ´¾ä»»åŠ¡ï¼ŒæŠµè§¦æƒ…ç»ªæ€»ä¼šæ²¹ç„¶è€Œç”Ÿã€‚ä¸šåŠ¡è·‘å¾—å¿«ï¼Œä¹Ÿå¾—ä¸¤è…¿æ˜¯å¥åº·çš„ï¼Œ CR å°±æ˜¯ä¿è¯ä¸šåŠ¡æŒç»­è·‘çš„å¿«çš„ä¸€ä¸ªå°åŒ»ç”Ÿï¼Œä¸æ­£å¸¸çš„ä¸šåŠ¡èŠ‚å¥å¯¹å…¬å¸çš„ä¸­é•¿è¿œå‘å±•è‚¯å®šæ˜¯å¼Šå¤§äºåˆ©ã€‚\nä»£ç æ˜¯è®²é“ç†çš„ æˆ‘è®¤ä¸ºé çƒ§é¦™æ¥ä¿ä½‘ä»£ç ä¸å‡ºé—®é¢˜æ—¶ï¼Œä¿å¹³å®‰å¾€å¾€ä¹Ÿæ˜¯æš‚æ—¶çš„ã€‚ä¼˜ç§€çš„ä»£ç ï¼Œå°±æ˜¯åœ¨å°æµé‡ã€å•çº¿ç¨‹æ²¡æœ‰é—®é¢˜ï¼Œåœ¨é«˜æµé‡ã€é«˜å¹¶å‘æ—¶è¿˜æ˜¯æ²¡æœ‰é—®é¢˜ï¼Œä½ çš„é™æµï¼Œä½ çš„å®¹ç¾ï¼Œä½ çš„é™çº§å„ç§å¯¼å¼¹é˜²å¾¡ç³»ç»Ÿä¸€æ ·è‡ªåŠ¨æ‰“å¼€å¹¶æ­£ç¡®åœ°å‘æŒ¥ä»·å€¼ã€‚å¾ˆå¤šäººçš„æ€ç»´è§‰å¾—ï¼Œä»£ç åªè¦åœ¨å½“å‰åœºæ™¯å’Œé€»è¾‘ä¸Šæ²¡æœ‰é—®é¢˜å°±è¡Œï¼Œé‚£æ˜¯å› ä¸ºå¤œè·¯èµ°å¾—ä¸å¤Ÿå¤šï¼Œè¿˜æ²¡æœ‰ç¢°åˆ°é¬¼ã€‚ä»£ç æ˜¯è®²é“ç†çš„ï¼Œå°±åƒæœ‰ä¸€ä¸ªåŒå­¦è¯´\u0026gt;=æ¯”\u0026gt;æ›´åŠ æ…¢ï¼Œé‚£åªæ˜¯æˆ‘ä»¬çš„æ½œæ„è¯†çŒœæµ‹ï¼Œç»è¿‡æ·±è¾¾ç¼–è¯‘å±‚çš„åˆ†æï¼Œå‘ç°ä¸¤ä¸ªæŒ‡ä»¤å‡ ä¹æ˜¯å®Œå…¨ä¸€æ ·ã€‚å…¶å®å‡­æˆ‘ä»¬çš„æƒ³è±¡ï¼Œé‚£ä¹Ÿæ˜¯ä¸€ä¸ªä½è¿ç®—çº§åˆ«çš„æ“ä½œï¼Œä»å·¦å‘å³æ¯”ï¼Œå¦‚æœä¸€å¤„æœ‰ 1 ï¼Œå¦ä¸€ä¸ªæ²¡æœ‰ 1 ï¼Œé‚£ä¹ˆå‰è€…ä¸€å®šæ˜¯æ›´å¤§ã€‚æ²¡æœ‰æ— ç¼˜æ— æ•…çš„çˆ±ï¼Œæ²¡æœ‰æ— ç¼˜æ— æ•…çš„æ¨ï¼Œä¸€åˆ‡çš„æ•…éšœæ€»æ˜¯ä»£ç çš„å­—é‡Œè¡Œé—´ã€‚æˆ‘ä»¬éœ€è¦åšçš„ï¼Œå°±æ˜¯è¯»æ‡‚å¥¹ï¼Œç”¨å¥½å¥¹ï¼Œå†™å¥½å¥¹.ã€‚å¦‚æœä»£ç ä»»æ€§é—¯ç¥¸ï¼Œåªèƒ½æ˜¯æˆ‘ä»¬ä¸æ‡‚ä»£ç çš„å¿ƒæ€ã€‚\næ¯ä¸€è¡Œä»£ç çš„å­˜åœ¨æ˜¯æœ‰æ„ä¹‰çš„ æ›´åŠ ä¸¥æ ¼åœ°è¯´ï¼Œæ¯ä¸€ä¸ªå­—ç¬¦çš„å­˜åœ¨éƒ½åº”è¯¥æ˜¯æœ‰æ„ä¹‰çš„ã€‚å¦‚æœæŸè¡Œä»£ç çš„å­˜åœ¨å®Œå…¨æ˜¯å¯æœ‰å¯æ— çš„ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬è€ƒè™‘è¿‡ JVM çš„æ„Ÿå—å—ï¼Ÿå‡­ç™½æ— æ•…åœ°è¦ç¼–è¯‘è¿™äº›å­—èŠ‚ç ï¼Œç„¶åæ ˆè¿›æ ˆå‡ºçš„å¿™æ´»ä¸€é˜µå­ï¼Œç„¶åå‘Šè¯‰å®ƒï¼Œä½ çš„åŠ³åŠ¨æ˜¯æ²¡æœ‰ä»»ä½•ä»·å€¼çš„ã€‚æ¯”å¦‚ï¼ŒBoolean assetFlag = Boolean.true ; è¿™é‡Œéƒ½å·²ç»æ˜ç¡®åœ°ç»™ç»™å‡ºæ¥æ˜¾ç¤ºçš„åˆå§‹å€¼ï¼Œå¯æ˜¯åœ¨è°ƒç”¨ç«¯ï¼Œå±…ç„¶è¿˜æœ‰è¿™æ ·çš„åˆ¤æ–­ï¼šif ( assetFlag != null \u0026amp;\u0026amp; assetFlag == true) {\u0026hellip;}ï¼Œä»€ä¹ˆæƒ…å†µä¸‹ä¸º null å€¼å•Šï¼Ÿå¦å¤–å‚æ•°åœ¨æ¡†æ¶é‡Œå·²ç»åšäº†å€¼çš„åˆ¤æ–­ï¼Œé‚£ä¹ˆä¸‹è¾¹åˆæ˜¯ n è¡Œï¼Œå¯¹æ‰€æœ‰å‚æ•°é‡æ–°åˆ¤æ–­ä¸€éï¼Œæ˜¯å¯¹æˆ‘ä»¬çš„ä»£ç æœ‰å¤šå°‘ä¸è‡ªä¿¡ï¼Œè¿˜æ˜¯å¯¹æ¡†æ¶ä¸è‡ªä¿¡ï¼Ÿæ¯ä¸€è¡Œçš„ä»£ç ï¼Œç›¸å½“äºç”Ÿå‘½ï¼Œå®ƒçš„å­˜åœ¨ä¸€å®šæ˜¯æœ‰æ„ä¹‰çš„ï¼Œä¸€å®šæ˜¯èƒ½å¤Ÿè¢«æ‰§è¡Œåˆ°å¹¶ä¸”èƒ½å¤Ÿä¸ºå®é™…çš„ä¸šåŠ¡è´Ÿè´£çš„ã€‚\næˆ‘ä»¬æ¯”æ‹¼çš„ä¸æ˜¯ä»£ç è¡Œæ•° åœ¨ Code Review è¿‡ç¨‹ä¸­ï¼Œå‘ç°æœ‰äº›æ–¹æ³•ï¼Œé‡å¤ç”¨åˆ°ä¸€æ®µé€»è¾‘ï¼Œè¿™æ®µé€»è¾‘å¦‚æœä¸æŠ½å–å‡ºæ¥æˆä¸ºä¸€ä¸ªæ–¹æ³•ï¼Œæœªæ¥çš„ä¿®æ”¹å°±æˆäº†ä¸€ä¸ªå¿…é¡»å¤šç‚¹å…¨éƒ¨ä¿®æ”¹çš„å¤§å‘ï¼Œç¨æœ‰ä¸æ…ï¼Œå®¹æ˜“é—æ¼ã€‚é‡å¤ä»£ç åœ¨æäº¤è¡Œæ•°ä¸Šï¼Œä¼¼ä¹æŒºå£®è§‚çš„ã€‚å¦‚æœåœ¨åŒæ ·çš„æ•ˆæœä¸Šï¼Œ 3 è¡Œä»£ç èƒ½å¤Ÿå®ç°åŠŸèƒ½çš„ä»·å€¼ï¼Œå°±ä¸åº”è¯¥ç”¨ 4 è¡Œæ¥å®ç°ã€‚æˆ‘ä»¬ç»å¸¸è¯´æ™’å‡ºä»£ç è¡Œæ•°ï¼Œå¹¶éæ˜¯å•çº¯åœ°é¼“åŠ±ä»£ç è¡Œæ•°å¤šï¼Œè€Œæ˜¯æå€¡å¤§å®¶å»å†™ä»£ç ï¼Œå†™ä¼˜è´¨çš„ä»£ç ï¼Œä¼˜è´¨çš„ä»£ç ä¸€å®šæ˜¯å°‘å³æ˜¯å¤šçš„åŸåˆ™ã€‚ä»£ç çš„å®ç°ï¼Œä¸è¦åƒé²è¿…å…ˆç”Ÿè¯´çš„ä¸€æ ·ï¼šæ‡’å©†å¨˜çš„è£¹è„šå¸ƒåˆè‡­åˆé•¿ã€‚\nç”¨æˆ·è§†è§’çš„æˆåŠŸä¸å¤±è´¥ åœ¨äº¤ä»˜æ—¶ï¼Œè°ƒç”¨æœåŠ¡å¤±è´¥ï¼Œç„¶åè¿”å›å‰å°ä¸€ä¸ªç©ºåˆ—è¡¨ï¼Œé‚£ä¹ˆå‰ç«¯ä¸šåŠ¡çš„å±•ç¤ºæ˜¯åå°æ•°æ®æ­£å¸¸ï¼Œè¿™ä¸ªäººä¸æ‹¥æœ‰æ•°æ®åˆ—è¡¨ï¼Œè¿™æ˜æ˜æ˜¯å¯¹æ•°æ®çš„ä¸€ç§æ›²è§£ã€‚æ‰€ä»¥ï¼Œåå°è°ƒç”¨æœåŠ¡å¤±è´¥ï¼Œå°±åº”è¯¥æ˜ç¡®å‘Šè¯‰å‰å°ï¼ŒæœåŠ¡å‡ºé”™äº†ï¼Œè¿™ä¸ªç”¨æˆ·æœ‰æ²¡æœ‰æ•°æ®ã€‚ç³»ç»Ÿå‡ºé”™çš„ä¿¡æ¯ç»™ç”¨æˆ·çœ‹ï¼Œåˆé€‚å—ï¼Ÿä¸åˆé€‚ã€‚å‰åç«¯çš„ç”¨æˆ·äº¤ç•Œé¢ä¸Šï¼Œå¾€å¾€é£ç€ä¸¤ç±»ä¿¡æ¯ï¼šé”™è¯¯ç ã€é”™è¯¯ä¿¡æ¯ã€‚è¿™æ ·å¤Ÿäº†å—ï¼Ÿç”¨æˆ·æç¤ºéœ€è¦é¢å¤–åœ°å†ç»™å‡ºæ¥ï¼Œå¾€å¾€æ ¹æ®ä¸åŒçš„é”™è¯¯ç ï¼Œæœ‰ä¸åŒçš„ç”¨æˆ·æç¤ºï¼Œå¯èƒ½æ˜¯ä¸€ä¸ªå¤šå¯¹å¤šçš„å…³ç³»ã€‚å¤šä¸ªé”™è¯¯ç ï¼Œæç¤ºç»™ç”¨æˆ·çš„ä¿¡æ¯ï¼šè¯·è¾“å…¥å¿…å¡«é¡¹ã€‚å¤šä¸ªç”¨æˆ·ä¿¡æ¯ï¼Œå¯èƒ½ä¹Ÿå¯¹åº”ä¸€ä¸ªé”™è¯¯ç ã€‚ä¸€èˆ¬æ¥è¯´åå°æ‰¿åŒ…è¿™ä¸‰è€…çš„è”åŠ¨å…³ç³»ï¼Œ json ä¸²æ¨é€ç»™å‰ç«¯æ—¶ï¼Œå‰ç«¯æ‹¿æ¥ä¸»ä¹‰å³å¯ã€‚\næœ‰é‡å¤ä½¿ç”¨çš„é‡ä¸€å®šè¦æ‰¾ä¸ªåœ°æ–¹é›†ä¸­éš”ç¦» ä¸ç®¡æ˜¯å˜é‡ï¼Œè¿˜æ˜¯å¸¸é‡ï¼Œå·¥å…·ç±»ï¼Œå¦‚æœæ˜¯å¤šä¸ªåœ°æ–¹åŒæ—¶ç”¨åˆ°ï¼Œé‚£ä¹ˆå¦‚æœç¡¬ç¼–ç åœ¨ä»£ç æˆ–è€…æ²‰æ·€åœ¨åŒ…é‡Œï¼Œæœªæ¥ä¸€å®šæ˜¯ä¸€ä¸ªç¾éš¾ã€‚æ¯”å¦‚ï¼Œä¸€ä¸ªç»„è£… SQL è¯­å¥çš„ä»£ç ï¼Œåˆ°å¤„éƒ½æ˜¯ \u0026ldquo;from\u0026rdquo; \u0026ldquo;where\u0026rdquo; \u0026ldquo;limit\u0026rdquo; ï¼Œéƒ½æ˜¯è¿™ç±»è¯­å¥ç›´æ¥å†™æ­»åœ¨ä»£ç ä¸­ï¼Œæ³¨æ„é—®é¢˜æ¥äº†ï¼Œè¿™äº›å•è¯å‰åéƒ½éœ€è¦åŠ ç©ºæ ¼ã€‚æœ‰æ—¶å€™åœ¨å¤åˆ¶ç²˜ç²˜æ—¶ï¼Œå‘ç°å°‘äº†ä¸€ä¸ªç©ºæ ¼ï¼Œå‡ºç°çš„é—®é¢˜ï¼Œå¾€å¾€æ˜¯è‡´å‘½çš„ã€‚å†æ¯”å¦‚ï¼Œä¸€ä¸ªäº’ç›¸çº¦å®šçš„åˆ†éš”ç¬¦ â€œ###â€ ï¼Œå®šä¹‰åœ¨æœ¬ç±»ä¸­ private String ï¼Œè¿™æ˜æ˜¾æ˜¯ä¸¤ä¸ªå…±åŒéµå®ˆçš„å¸¸é‡ï¼Œå•ç‹¬å®šä¹‰çš„ç»“æœå°±æ˜¯å®¹æ˜“é€ æˆä¸åŒ¹é…ã€‚éš”ç¦»çš„ç›®çš„æ˜¯å¤ç”¨å®ƒï¼Œä¿æŠ¤ç¨‹åºåœ°æ­£å¸¸è¿è¡Œï¼Œæ˜“äºç»´æŠ¤ã€‚\nå•æµ‹æ²¡å¿…è¦ä»£ç  Code Review å•æµ‹æœ‰æ—¶å€™æ„Ÿè§‰åƒæ˜¯é˜‘å°¾ï¼Œæœ‰æˆ–æ²¡æœ‰æ„Ÿè§‰éƒ½æ˜¯æ— å…³ç´§æ€¥ï¼Œè¿™æ˜¯é”™è¯¯çš„è§‚ç‚¹ã€‚å•æµ‹æ„Ÿè§‰å°±æ˜¯ä¸€ä¸ªä»»åŠ¡ã€‚ä½ å†™å•æµ‹äº†å—ï¼Ÿå†™äº†ã€‚å•æµ‹æ˜¯å¦éœ€è¦ MOCK ï¼Œæ˜¯å¦è¿›è¡Œè¾¹ç•Œå€¼æµ‹è¯•ï¼Œæ˜¯å¦ç”¨ä¾‹è¦†ç›–åˆ°ä¸šåŠ¡åœºæ™¯ï¼Œè¿™éƒ½ä¹Ÿæ˜¯ CR çš„ä¸€éƒ¨åˆ†ã€‚å•æµ‹å†™å¾—å¥½ï¼Œ BUG è‚¯å®šå°‘ã€‚\néœ€è¦è°ƒè¯•æ¥æŸ¥æ‰¾é”™è¯¯æ—¶ï¼Œå¾€å¾€æ˜¯ä¸€ç§å¯¹å¼‚å¸¸å¤„ç†æœºåˆ¶çš„ä¾®è¾± è‰¯å¥½çš„æ—¥å¿—å’Œå¼‚å¸¸æœºåˆ¶ï¼Œæ˜¯ä¸åº”è¯¥å‡ºç°è°ƒè¯•çš„ã€‚æ‰“æ—¥å¿—å’ŒæŠ›å¼‚å¸¸ï¼Œä¸€å®šè¦æŠŠä¸Šä¸‹æ–‡ç»™å‡ºæ¥ï¼Œå¦åˆ™ï¼Œç­‰äºåœ¨ç ´åå‘½æ¡ˆç°åœºï¼ŒæŠŠåè¾¹å¤„ç†é—®é¢˜çš„äººï¼Œå¾€æ­ªè·¯ä¸Šå¸¦ã€‚åˆ«äººä¼ ä¸€ä¸ªå‚æ•°è¿›æ¥ï¼Œå‘ç°æ˜¯ null ï¼Œç«‹é©¬æŠ›å‡ºæ¥ä¸€ä¸ªå‚æ•°å¼‚å¸¸æç¤ºï¼Œç„¶åä¹Ÿä¸è¿”å›å“ªä¸€ä¸ªå‚æ•°æ˜¯ null ï¼Œè¿™åœ¨è°ƒç”¨å‚æ•°å¾ˆå¤šçš„æƒ…å†µä¸‹ï¼Œç®€ç›´å°±æ˜¯å­—è°œæ¸¸æˆä¸€æ ·ã€‚åˆ°åº•æ˜¯æŠ›å¼‚å¸¸ï¼Œè¿˜æ˜¯æŠ›é”™è¯¯ç ï¼Ÿæˆ‘ä¸ç®¡æŠ›ä»€ä¹ˆï¼Œåæ­£é”™äº†ä»€ä¹ˆä¸œè¥¿ï¼Œéƒ½åº”è¯¥é€æ˜å‡ºæ¥ã€‚åˆ°åº•æ˜¯æŠ›å—æ£€å¼‚å¸¸ï¼Œè¿˜æ˜¯éå—æ£€å¼‚å¸¸ï¼Œæˆ‘åªæƒ³è¯´ï¼Œæ²¡æœ‰å……è¶³çš„ç†ç”±ï¼Œä¸è¦ä¹±æŠ›å—æ£€å¼‚å¸¸ã€‚å¼‚å¸¸æŠ›å‡ºæ—¶ï¼Œä¸€å®šè¦è‡ªå·±æ¶ˆåŒ–å¹²å‡€ï¼Œå‘Šè¯‰åˆ«äººè¯´æˆ‘çš„æ–¹æ³•ç­¾åæŠ›çš„æ˜¯ AbcException ï¼Œå®é™…è¿è¡Œä¸­ï¼Œä»£ç æŸä¸ªåœ°æ–¹ç›´æ¥æŠ›å‡º EfgException ï¼Œè¿™ä¹Ÿæ˜¯ä¸è´Ÿè´£ä»»çš„ã€‚\nå¤šä¸ª return çš„è¯­å¥ï¼Œæ¦‚ç‡é«˜çš„ä¸€å®šå…ˆè¿›è¡Œåˆ¤å®š if(condition1) return; if(condition2) return; if(condition3) return ; é‚£ä¹ˆéœ€è¦è¯„ä¼°ä¸€ä¸‹ condition1/2/3 å‡ºç°æ¦‚ç‡çš„å¤§å°ï¼Œæ¦‚å¿µå¤§çš„åœ¨æœ€å‰è¾¹ï¼Œå°½å¯èƒ½å¿«åœ°è¿›è¡Œ return ï¼Œä¸éœ€è¦è¿›è¡Œåç»­æ— è°“çš„åŒ¹é…ã€‚ä¸è¦æ€»è§‰å¾—è®¡ç®—æœºè·‘å¾—å¿«ï¼Œä¸å·®è¿™ç‚¹è‡å¤´å°åˆ©çš„ï¼Œè¿™ç§æ€ç»´ï¼Œå’Œã€Šå—è¾•åŒ—è¾™ã€‹é‡Œçš„å¯“ä¹‰ä¸€æ ·çš„å—ï¼Ÿ\nåå•¬ç©ºè¡Œ æ„Ÿè§‰ç©ºè¡Œæ˜¯å»‰ä»·çš„ï¼Œåˆ°å¤„ä¹±æ‰”æ˜¯ä¸€ç§ï¼›å¦ä¸€ç§æ˜¯æ„Ÿè§‰ç©ºè¡Œæ˜¯æ˜‚è´µçš„ï¼Œèˆä¸å¾—ç”¨ï¼Œè¿™ç§æƒ…å†µæ›´å¤šè§ã€‚50 è¡Œä»£ç æ²¡æœ‰ä¸€ä¸ªç©ºè¡Œï¼Œå°±åƒè‹±è¯­ 50 å¥è¯ï¼Œæ²¡æœ‰ä»»ä½•æ ‡ç‚¹ç¬¦å·ä¸€æ ·ã€‚æ—¢ç„¶æ ‡ç‚¹ç¬¦å·èµ·åˆ°éš”æ–­å’Œè¯­ä¹‰åŒºåˆ†ä½œç”¨ï¼Œæˆ‘ä»¬çš„ç©ºè¡Œä¸æ˜¯åŒä¸€ä¸ªé“ç†å—ï¼Ÿåœ¨ä»¥ä¸‹æƒ…å½¢ï¼š 1ã€åœ¨æ–¹æ³•çš„ returnã€breakã€continueã€è¿™æ ·æ–­å¼€æ€§è¯­å¥åå¿…é¡»æ˜¯ç©ºè¡Œã€‚ 2ã€åœ¨ä¸åŒè¯­ä¹‰å—ä¹‹é—´ã€‚ 3ã€å¾ªç¯ä¹‹å‰å’Œä¹‹åä¸€èˆ¬æœ‰ç©ºè¡Œã€‚å¦å¤–ï¼Œæ–¹æ³•å’Œç±»å®šä¹‰ä¸‹æ–¹å°±ä¸éœ€è¦ç©ºè¡Œäº†å§ã€‚\nå‘½åå¤ªéšæ„ ä»£ç æœ‰ä¸¤ä»¶äº‹æƒ…æ¯”è¾ƒå¤´ç–¼ï¼šå‘½åå’Œå¾ªç¯ã€‚äººå¦‚å…¶åï¼Œå¦‚æœä¸æ˜¯å®ƒå¹²çš„æ´»ï¼Œåå­—å´æ˜¯ä¸€å‰¯é“è²Œå²¸ç„¶ï¼Œå¤ªå®¹æ˜“æŠŠäººå¸¦åäº†ï¼Œä¸€ä¸ªä¸­å›½äººå¦‚æœå–åå«èµµ Cï¼Œä¸€ä¸ªå¥³å­©å­å¦‚æœå–åå«çŸ³æ•¢å½“ï¼Œç¬¬ä¸€å°è±¡ç”Ÿç”Ÿåœ°ç»™æ‰­æ›²äº†ã€‚è‹±è¯­ä¸å¥½çš„åŒå­¦ï¼Œè¦ä¹ˆç”¨é”™è‹±æ–‡å•è¯ï¼Œè¦ä¹ˆç¿»è¯å…¸ï¼Œæ•´å‡ºä¸€ä¸ªä¸“å…«çš„è¯æ±‡ï¼Œä»»ä½•äººéƒ½ä¸è®¤å¾—è¿™ä¸ªå•è¯ï¼Œåœ¨ CR æ—¶ï¼Œè¿˜éœ€è¦æ‰“å¼€åœ¨çº¿ç¿»è¯‘æ—¶çš„å‘½åï¼Œç»å¯¹ä¸æ˜¯å¥½å‘½åã€‚å½“ç„¶å¦‚æœåœ¨çº¿ç¿»è¯‘éƒ½ç¿»ä¸å‡ºæ¥çš„æ—¶å€™ï¼Œé‚£æ›´å¤´ç–¼ã€‚å¦‚æœè¡¨æ„é”™è¯¯ï¼Œé‚£æ›´è¦å‘½ã€‚\næ³¨é‡Šæ˜¯ç”µå½±çš„æ—ç™½ ç”µå½±çš„æ—ç™½ï¼š1ï¼‰ä¿¡æ¯é‡å¤§ã€‚2ï¼‰é€‚æ—¶å‡ºç°ã€‚å°±åƒ star war é‡Œï¼Œå¼€å§‹çš„ä¸€æ®µä¸€æ ·ï¼Œå¦‚æœä¸äº¤ä»£é‚£äº›èƒŒæ™¯ï¼Œå¯èƒ½è¿›å…¥æ­£ç‰‡æ˜¯ä¸€è„¸æ‡µé€¼çš„ã€‚åœ¨ä»£ç ä¸Šä¸éœ€è¦å†™æ­£ç¡®çš„åºŸè¯ï¼Œåå­—å–å¾—å¥½ï¼Œè‡ªç„¶æ˜¯è‡ªè§£é‡Šçš„ã€‚åœ¨åµŒå¥—å¾ªç¯ä¸­ï¼Œæˆ–è€…åœ¨å¤æ‚æ¡ä»¶åˆ†æ”¯ä¸­ï¼Œå¾€å¾€æ˜¯éœ€è¦è®²æ˜ç™½çš„ã€‚å¦å¤–ï¼Œæ·»åŠ ä¸šåŠ¡èƒŒæ™¯ä¿¡æ¯ï¼Œä»¥åŠæ‰§è¡Œé¢‘ç‡ï¼Œæ‰§è¡Œæ¡ä»¶ï¼Œç”šè‡³ç»´æŠ¤è€…æ³¨æ„ç‚¹ï¼Œéƒ½æ˜¯æ³¨é‡Šçš„é‡è¦ç†ç”±ã€‚è¯†åˆ«åˆ°å“ªé‡Œè¦å†™æ³¨é‡Šï¼Œä¹Ÿæ˜¯ä¸€ä¸ªå¯¹ä¸šåŠ¡çš„é˜…è¯»èƒ½åŠ›ï¼Œè€Œä¸æ˜¯ä»£ç é˜…è¯»èƒ½åŠ›ã€‚\næ»¡å¤©é£çš„å‡½æ•°å¼ç¼–ç¨‹å¥½å—ï¼Ÿ ä¸å¥½ã€‚å¦‚æœä¸€ä¸ª stream åè¾¹çš„è°ƒç”¨è¶…è¿‡ 5 ä¸ªï¼Œæˆ‘è§‰å¾—ä½ æ˜¯ä¸ºäº†ç‚«è€€ï¼Œå› ä¸ºåˆ«äººä¸æ•¢æ”¹è¿™æ®µä»£ç ï¼Œä½“ç°å‡ºæ¥ä½ çš„ä¸å¯æ›¿ä»£æ€§ã€‚è¿™ç§ 10 è¡Œéƒ½æ˜¯å‡½æ•°å¼ç¼–ç¨‹çš„æ–¹å¼ï¼Œå°±åƒè®©äººåœ¨æ°´é‡Œæ†‹æ°”è¶…è¿‡ 10 åˆ†é’Ÿä¸èƒ½æ¢æ°”ä¸€æ ·éš¾å—ï¼Œæœ‰ç‚¹ç¼ºæ°§çš„æ„Ÿè§‰ã€‚\næˆ‘ä»¬å›¢é˜Ÿæœ‰ä¸€ä¸ªä¼˜ç§€çš„ CR ä¹ æƒ¯ï¼Œ\nå¦‚æœåŠ å…¥æˆ‘ä»¬ï¼Œè¯·æ‰«ç ï¼š â€‹ alibaba.tupu360.com\nä»¥ä¸‹æ˜¯æˆ‘è‡ªå·±çš„å›ç­”ï¼Œä¹Ÿè´´ä¸€ä¸‹ã€‚ åœ¨æˆ‘è¿™é‡Œï¼Œ\næ¯ä¸€æ¬¡ CodeReview éƒ½æ˜¯å¯¹è‡ªå·±å’Œå…¶ä»–äººçš„â€œç²¾ç¥â€å®¡é—®ã€‚\né¦–å…ˆï¼Œç¡®ç«‹åŸåˆ™â€œå¯¹äº‹ä¸å¯¹äººâ€ï¼Œ\nåŒç†ï¼Œå¯¹ä»£ç ä¸å¯¹äººã€‚\nç”¨å‰é˜µå­ç»™æŸå®ä¹ ç”Ÿ Review çš„æ—¶å€™çš„è¯„è®ºä¸¾ä¾‹å§ã€‚\næ ·ä¾‹ä¸€ï¼šæ¥å£è¿”å›å€¼ä¸ç¬¦åˆçº¦å®šçš„è§„èŒƒ\nReview è¿™ä¸ªæ—¶å€™ä¸€èˆ¬å°±è¯´æ˜ä¸€ä¸‹å…·ä½“çš„æƒ…å†µå’Œå»ºè®®ã€‚\nåŒæ—¶æˆ‘ä¹Ÿé¼“åŠ±å¯¹æ–¹èƒ½æœ‰å…¶ä»–çš„æ„è§æˆ–è€…è¯´æ³•åŠ å…¥è®¨è®ºã€‚\næ ·ä¾‹äºŒï¼šè¯­è¨€ç‰¹æ€§ä¸‹çš„æŸä¸ªåŸºç¡€ç”¨æ³•å¯èƒ½å­˜ç–‘ã€‚\nè¿™ç§æƒ…å†µä¸‹ï¼Œ\nä¸€èˆ¬æˆ‘ä¼šæå‡ºç–‘é—®ï¼Œ\næœŸå¾…å¾—åˆ°ä¸€ä¸ªå®Œå¤‡çš„ç­”æ¡ˆã€‚\næ ·ä¾‹ä¸‰ï¼šå®ç°é€»è¾‘ä¸å¤ªåˆç†ã€ä¼˜é›…\nç›´æ¥æŒ‡æ˜æœ‰æ›´å¥½çš„åšæ³•ï¼Œ\nå¯ä»¥è¯•è¯•å¦ä¸€ç§æ€è·¯ã€‚\nå¦‚æœå¯¹æ–¹æœ‰å…¶ä»–çš„æ€é‡ï¼Œ\néå¸¸æ¬¢è¿ã€‚\næ ·ä¾‹å››ï¼šæŸäº›åœºæ™¯ä¸‹ä¸­æ–­æ•´ä¸ªç¨‹åºçš„å®ç°\nç”±æŸä¸ªä¸å¥½çš„å®ç°ï¼Œ\nå¼•å‡ºä¸€äº›æ€è€ƒå’Œè®¨è®ºã€‚\nPSï¼š\nä»¥ä¸Š Review æœ‰è‡ªå·±çš„é€‚ç”¨åœºæ™¯ï¼Œ\nåˆ«è¿½é—®ï¼Œ\nå†é—®å°±æ˜¯æˆ‘èœã€‚\næ‰€ä»¥ï¼Œ\nåœ¨æˆ‘çœ‹æ¥ï¼Œ\nCodeReview çš„æ­£ç¡®å§¿åŠ¿æ˜¯ï¼š\nå¯¹äº‹ä¸å¯¹äººï¼Œ\nå¯¹æ€ç»´æ–¹å¼ä¸åªå¯¹ä»£ç ï¼Œ\nå¯¹åœºæ™¯é€‚å®œä¸å¯¹é¸¡è›‹æŒ‘éª¨å¤´ã€‚\næœ€åï¼Œ\nå°½é‡è®©å›¢é˜Ÿå’Œäººéƒ½è¾¾åˆ°:\né«˜æ•ˆè¾“å‡º + ä¼˜é›…å®è·µ + æŒ‰æ—¶ä¸‹ç­ + è½»æ¾ä»å®¹åº”å¯¹å¤æ‚çš„ä¸–ç•Œã€‚\nä»¥ä¸Šã€‚\nè°¢è°¢ã€‚\n","date":"2020-04-05T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/%E8%BD%AC%E8%BD%BDcodereview%E6%AD%A3%E7%A1%AE%E7%9A%84%E5%A7%BF%E5%8A%BF%E6%98%AF%E4%BB%80%E4%B9%88/","title":"è½¬è½½ï¼šCodeReviewæ­£ç¡®çš„å§¿åŠ¿æ˜¯ä»€ä¹ˆï¼Ÿ"},{"content":"å®¢å®˜æ¥ç©K8Sä¹‹æ­ä¸ªGitlab å‰è¨€ ä¸éœ€è¦å‰è¨€.\næœ¬æ¬¡æ•™ç¨‹ä¸­åŒ…å«çš„çŸ¥è¯†ç‚¹ éœ€è¦çš„çŸ¥è¯†ç‚¹\nk8såŸºç¡€, Pod/Service ç›¸å…³çŸ¥è¯†\nk8så­˜å‚¨, PV/PVC/StorageClass ç›¸å…³çŸ¥è¯†\nnginxåŸºç¡€\nGitlab CE ä¾èµ–çš„æœåŠ¡ postgreSQL\nredis\n2G ä»¥ä¸Šå†…å­˜, æœ€å¥½ 4G(2G å†…å­˜ä¸å¦‚ dog)\nå½“ç„¶, ä»¥ä¸ŠæœåŠ¡ä¸€æ ·ç”¨ K8S éƒ¨ç½².\npostgreSQL 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 apiVersion: extensions/v1beta1 kind: Deployment metadata: labels: run: postgresql name: postgresql spec: progressDeadlineSeconds: 600 replicas: 1 revisionHistoryLimit: 10 selector: matchLabels: run: postgresql strategy: rollingUpdate: maxSurge: 25% maxUnavailable: 25% type: RollingUpdate template: metadata: creationTimestamp: null labels: run: postgresql spec: containers: - env: - name: POSTGRES_DB value: gitlab - name: POSTGRES_USER value: gitlab - name: POSTGRESQL_PASSWORD value: éšä¾¿å†™ä½ çš„å¯†ç  - name: PGDATA value: /var/lib/postgresql/data/pgdata image: postgres:10 imagePullPolicy: IfNotPresent name: postgresql imagePullPolicy: IfNotPresent ports: - containerPort: 5432 protocol: TCP resources: limits: cpu: 500m memory: 1024Mi requests: cpu: 200m memory: 256Mi terminationMessagePath: /dev/termination-log terminationMessagePolicy: File volumeMounts: - mountPath: /var/lib/postgresql/data/ name: es-data subPath: postgresql dnsPolicy: ClusterFirst restartPolicy: Always schedulerName: default-scheduler securityContext: {} terminationGracePeriodSeconds: 30 # è¿™é‡Œæ˜¯k8sçš„pvc, æˆ‘è¿™é‡Œpvcå«es-data, å’Œelasticç”¨åŒä¸€ä¸ªç£ç›˜ volumes: - name: es-data persistentVolumeClaim: claimName: es-data --- apiVersion: v1 kind: Service metadata: # è¿™ä¸ªannotationsæ˜¯è…¾è®¯äº‘ç”³è¯·å†…ç½‘IPçš„é…ç½®, éœ€è¦æ”¹æˆè‡ªå·±k8sæ‰€åœ¨ç½‘ç»œçš„å­ç½‘id # postgresql è¿™é‡Œå…¶å®å¯ä»¥ä¸è¦å†…ç½‘service ip, å†…ç½‘ç›´æ¥ç”¨service nameè®¿é—®å³å¯ annotations: service.kubernetes.io/loadbalance-id: lb-ä½ è‡ªå·±çš„loadbalanceid service.kubernetes.io/qcloud-loadbalancer-internal-subnetid: subnet-ä½ è‡ªå·±çš„å­ç½‘id labels: run: postgresql name: postgresql spec: externalTrafficPolicy: Cluster ports: - port: 3433 protocol: TCP targetPort: 5432 selector: run: postgresql sessionAffinity: None type: LoadBalancer è¿™é‡Œé¢ç”¨çš„ PV/PVC éœ€è¦è‡ªå·±åœ¨è…¾è®¯äº‘é‡Œé¢åˆ›å»º, åŸºæœ¬å°±æ˜¯ç‚¹ç‚¹ç‚¹å°±èƒ½åˆ›å»ºå‡ºæ¥äº†.\nredis éƒ¨ç½² è·³è¿‡\u0026hellip;\néšä¾¿æŠ„ä¸€ä¸‹ k8s éƒ¨ç½² Redis æ•™ç¨‹å°±å®Œäº‹äº†.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 apiVersion: apps/v1 kind: StatefulSet metadata: generation: 2 labels: app: redis name: redis spec: podManagementPolicy: OrderedReady replicas: 1 revisionHistoryLimit: 10 selector: matchLabels: app: redis serviceName: redis template: metadata: creationTimestamp: null labels: app: redis spec: containers: - env: - name: REDIS_PASSWORD value: æ¢æˆä½ çš„å¯†ç  image: bitnami/redis:5.0 imagePullPolicy: IfNotPresent name: redis resources: limits: cpu: 500m memory: 256Mi requests: cpu: 200m memory: 128Mi terminationMessagePath: /dev/termination-log terminationMessagePolicy: File volumeMounts: - mountPath: /bitnami/redis/data name: redis-data subPath: redis dnsPolicy: ClusterFirst imagePullSecrets: - name: regsecret nodeSelector: tuiwen-tech.com/phase: test restartPolicy: Always schedulerName: default-scheduler securityContext: runAsUser: 0 terminationGracePeriodSeconds: 30 updateStrategy: rollingUpdate: partition: 0 type: RollingUpdate volumeClaimTemplates: - metadata: creationTimestamp: null name: redis-data spec: accessModes: - ReadWriteOnce dataSource: null resources: requests: storage: 10Gi storageClassName: æ¢æˆä½ çš„storageClassName --- apiVersion: v1 kind: Service metadata: labels: app: redis name: redis spec: externalTrafficPolicy: Cluster ports: - name: headless nodePort: 31966 port: 6379 protocol: TCP targetPort: 6379 selector: app: redis sessionAffinity: None type: LoadBalancer Gitlab CE 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 apiVersion: extensions/v1beta1 kind: Deployment metadata: labels: app: gitlab name: gitlab spec: replicas: 1 strategy: rollingUpdate: maxSurge: 1 maxUnavailable: 0 template: metadata: labels: app: gitlab spec: containers: - env: - name: GITLAB_OMNIBUS_CONFIG value: | # external_url è¿™é‡Œè¦æ³¨æ„, è¦ä¸æ”¹æˆä½ çš„å…¬ç½‘IP, è¦ä¸æ”¹æˆnginxæš´éœ²åˆ°å¤–é¢çš„åŸŸå+ç«¯å£ æˆ–è€…åŸŸå+äºŒçº§ç›®å½• external_url \u0026#39;æ¢æˆä½ è‡ªå·±çš„\u0026#39; # Disable the built-in Postgres postgresql[\u0026#39;enable\u0026#39;] = false # Fill in the connection details for database.yml gitlab_rails[\u0026#39;db_adapter\u0026#39;] = \u0026#39;postgresql\u0026#39; gitlab_rails[\u0026#39;db_encoding\u0026#39;] = \u0026#39;utf8\u0026#39; gitlab_rails[\u0026#39;db_host\u0026#39;] = \u0026#39;postgresql\u0026#39; gitlab_rails[\u0026#39;db_port\u0026#39;] = 3433 gitlab_rails[\u0026#39;db_database\u0026#39;] = \u0026#34;gitlab\u0026#34; gitlab_rails[\u0026#39;db_username\u0026#39;] = \u0026#39;gitlab\u0026#39; gitlab_rails[\u0026#39;db_password\u0026#39;] = \u0026#39;æ¢æˆä½ è‡ªå·±çš„\u0026#39; # mail config gitlab_rails[\u0026#39;smtp_enable\u0026#39;] = true gitlab_rails[\u0026#39;smtp_address\u0026#39;] = \u0026#34;æ¢æˆä½ è‡ªå·±çš„\u0026#34; gitlab_rails[\u0026#39;smtp_port\u0026#39;] = 465 gitlab_rails[\u0026#39;smtp_user_name\u0026#39;] = \u0026#34;æ¢æˆä½ è‡ªå·±çš„\u0026#34; gitlab_rails[\u0026#39;smtp_password\u0026#39;] = \u0026#34;æ¢æˆä½ è‡ªå·±çš„\u0026#34; gitlab_rails[\u0026#39;smtp_domain\u0026#39;] = \u0026#34;æ¢æˆä½ è‡ªå·±çš„\u0026#34; gitlab_rails[\u0026#39;smtp_authentication\u0026#39;] = \u0026#34;login\u0026#34; gitlab_rails[\u0026#39;smtp_enable_starttls_auto\u0026#39;] = true gitlab_rails[\u0026#39;smtp_tls\u0026#39;] = true # è¿™ä¸ªå¾ˆé‡è¦ï¼Œè€Œä¸”æ˜¯å®˜æ–¹æ–‡æ¡£é‡Œæ²¡æåŠçš„ # If your SMTP server does not like the default \u0026#39;From: [email protected]ocalhost\u0026#39; you # # can change the \u0026#39;From\u0026#39; with this setting. gitlab_rails[\u0026#39;gitlab_email_from\u0026#39;] = \u0026#39;å®Œæ•´é‚®ä»¶è´¦æˆ·\u0026#39; # Disable the built-in Redis redis[\u0026#39;enable\u0026#39;] = true # Add any other gitlab.rb configuration here, each on its own line # Redis via TCP gitlab_rails[\u0026#39;redis_host\u0026#39;] = \u0026#39;redis\u0026#39; gitlab_rails[\u0026#39;redis_port\u0026#39;] = 6379 gitlab_rails[\u0026#39;redis_password\u0026#39;] = \u0026#39;æ¢æˆä½ è‡ªå·±çš„\u0026#39; image: gitlab/gitlab-ce:11.11.7-ce.0 name: gitlab resources: requests: memory: \u0026#34;1Gi\u0026#34; cpu: \u0026#34;300m\u0026#34; limits: memory: \u0026#34;3Gi\u0026#34; cpu: \u0026#34;1000m\u0026#34; ports: - containerPort: 443 - containerPort: 80 - containerPort: 22 volumeMounts: - mountPath: /etc/gitlab name: es-data subPath: gitlab - mountPath: /var/opt/gitlab/git-data name: es-data subPath: gitlab restartPolicy: Always serviceAccount: gitlab serviceAccountName: gitlab volumes: - name: es-data persistentVolumeClaim: claimName: es-data --- apiVersion: v1 kind: Service metadata: annotations: service.kubernetes.io/loadbalance-id: æ¢æˆä½ è‡ªå·±çš„ service.kubernetes.io/qcloud-loadbalancer-internal-subnetid: æ¢æˆä½ è‡ªå·±çš„ labels: app: gitlab name: gitlab spec: ports: - name: git-ssl port: 443 targetPort: 443 - name: git-http port: 80 targetPort: 80 selector: app: gitlab type: LoadBalancer --- apiVersion: v1 kind: Service metadata: annotations: service.kubernetes.io/loadbalance-id: æ¢æˆä½ è‡ªå·±çš„ service.kubernetes.io/qcloud-loadbalancer-internal-subnetid: æ¢æˆä½ è‡ªå·±çš„ labels: app: gitlab name: gitlab-ssh spec: ports: - name: git-ssh port: 22 targetPort: 22 selector: app: gitlab type: LoadBalancer ç†è®ºä¸Šæ¥è¯´, åªéœ€è¦ç­‰å¾…å¯åŠ¨å°±å®Œäº‹äº†..\næœ€åæ˜¯æš´éœ²åˆ°å¤–éƒ¨çš„ NGINX é…ç½® å¦‚æœç›´æ¥ä½¿ç”¨ k8s ingress æ‹¿åˆ°å…¬ç½‘ IP çš„è¯, å°±ä¸ç”¨è‡ªå·±é…ç½® NGINX è½¬å‘äº†.\nå¦‚æœå’Œæˆ‘ä¸€æ ·éœ€è¦è‡ªå·±ç”¨ Nginx æä¾›å¤–éƒ¨è®¿é—®çš„è¯, å‚è€ƒä¸‹é¢.\n1 2 3 4 5 location /app/git { proxy_pass http://å¯è¾¾çš„å†…ç½‘IP(å°±æ˜¯k8s serviceçš„å†…ç½‘IP):80; client_max_body_size 50m; } æ•™ç¨‹å®Œæ¯•.\n","date":"2019-08-31T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/%E5%AE%A2%E5%AE%98%E6%9D%A5%E7%8E%A9k8s%E4%B9%8B%E6%90%AD%E4%B8%AAgitlab/","title":"å®¢å®˜æ¥ç©K8Sä¹‹æ­ä¸ªGitlab"},{"content":"ä½ ä¸å¯èƒ½æä¸å®šè…¾è®¯äº‘K8Sçš„Service/Ingress å‰è¨€ ä¸Šä¸€ä¸ªæ‰‹æŠŠæ‰‹æ•™ç¨‹ä¸Šç®€å•ä»‹ç»è¿‡k8sä¸­çš„Pod/Service,\né‡Œé¢æåˆ°è¿‡Serviceæ˜¯K8Sä¸­çš„è´Ÿè½½å‡è¡¡, åŒæ—¶ä¹Ÿå¯ä»¥åœ¨ä¸åŒPodä¸­ä½¿ç”¨Service nameäº’ç›¸è®¿é—®.\nå¦‚æœæˆ‘ä»¬åœ¨å¤–éƒ¨(å…¬ç½‘)è®¿é—®K8Sçš„æœåŠ¡æ€ä¹ˆåŠå‘¢?\né¦–å…ˆ, ä½ çš„æœ‰ä¸ªå…¬ç½‘IP.\nç„¶å\u0026hellip;.å…³æ‰è¿™ä¸ªæ•™ç¨‹.\nå›åˆ°æ­£æ–‡.\nåœ¨k8sä¸­, ingressæ¥è´Ÿè´£å¯¹å¤–æä¾›è®¿é—®, ä¸€èˆ¬åŸŸåé…ç½®, åŸŸåè¯ä¹¦éƒ½åœ¨è¿™è¾¹.\næ˜¯ä¸æ˜¯æœ‰ç‚¹ç†Ÿæ‚‰? è¿™ä¸å°±æ˜¯NGINX?\nå¯¹çš„, ç”šè‡³ingressçš„å®ç°å°±æœ‰ä¸€éƒ¨åˆ†æ˜¯NGINX.\nä½†æ˜¯, å¤§å®¶éƒ½çŸ¥é“, å…¬ç½‘IPè¿™ç§ä¸œè¥¿, å¯æ˜¯è¦æ”¶è´¹çš„.\nè…¾è®¯äº‘çš„æ”¶è´¹æ ‡å‡†: åº”ç”¨å‹è´Ÿè½½å‡è¡¡å™¨ï¼ˆæ”¯æŒHTTP/HTTPSï¼‰0.02å…ƒ/å°æ—¶\næœ‰é’±çš„åŒå­¦ç›´æ¥ç”¨å°±å¥½äº†,\næ•™ç¨‹è§è…¾è®¯äº‘é›†ç¾¤ç®¡ç†, ç‚¹ç‚¹ç‚¹å°±å¥½äº†.\nç©·äººä¸é…ç”¨å…¬ç½‘? ä¸, æˆ‘ä»¬æœ‰è‡ªå·±çš„å€”å¼º! æƒ³ä¸‹, æˆ‘ä»¬åœ¨åšk8sé›†ç¾¤çš„æ—¶å€™, ç”¨çš„ä¸»æœºä¸æ˜¯æœ¬æ¥å°±å¸¦å…¬ç½‘IPå—?\nè™½ç„¶ç°åœ¨ä¸»æœºå·²ç»æ˜¯k8sçš„workerèŠ‚ç‚¹äº†, ä¸è¿‡æœºå™¨è¿˜æ˜¯å¯ä»¥ç»§ç»­ç”¨çš„å‘€.\næ‰€ä»¥, æˆ‘ä»¬çš„æ–¹æ¡ˆæ˜¯,\nä¸»æœºä¸Šè£…ä¸ªNGINX, ç”±NGINXç”¨ç«¯å£è½¬å‘çš„æ–¹å¼è½¬åˆ°å†…éƒ¨K8S Serviceä¸­ ,\nè¿™æ ·å°±å®Œç¾äº†.\nè¿™æ ·çš„è¯, é‚£ä¹ˆæˆ‘ä»¬çš„ä¸»æœºæ€ä¹ˆè®¿é—®k8s Serviceå‘¢?\nåœ¨å‰é¢æˆ‘ä»¬ç®€å•æè¿‡, k8sçš„pod,serviceéƒ½æ˜¯åœ¨è‡ªå·±çš„å†…ç½‘çš„.\nè™½ç„¶ç°åœ¨ä¸»æœºå’Œk8sçš„æœåŠ¡å¯èƒ½éƒ½åœ¨ä¸€ä¸ªä¸»æœºä¸Š, ç„¶è€Œé‡Œé¢è¿˜æ˜¯æœ‰é€»è¾‘å±‚å†…ç½‘éš”ç¦»çš„.\né‚£ä¹ˆ, è¿™æ ·æ€ä¹ˆåŠå‘¢?\næ”¾å¿ƒ, k8s serviceæ—©å°±æœ‰è§£å†³æ–¹æ¡ˆå•¦.\nç­”æ¡ˆæ˜¯:\nåœ¨è…¾è®¯äº‘ä¸­çš„ä½¿ç”¨service.kubernetes.io/qcloud-loadbalancer-internal-subnetid annotationsæ¥ç”³è¯·å†…ç½‘IP.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 --- apiVersion: v1 kind: Service metadata: # è¿™ä¸ªannotationsæ˜¯è…¾è®¯äº‘ç”³è¯·å†…ç½‘IPçš„é…ç½®, éœ€è¦æ”¹æˆè‡ªå·±k8sæ‰€åœ¨ç½‘ç»œçš„å­ç½‘id # postgresql è¿™é‡Œå…¶å®å¯ä»¥ä¸è¦å†…ç½‘service ip, å†…ç½‘ç›´æ¥ç”¨service nameè®¿é—®å³å¯ annotations: service.kubernetes.io/loadbalance-id: lb-ä½ è‡ªå·±çš„loadbalanceid service.kubernetes.io/qcloud-loadbalancer-internal-subnetid: subnet-ä½ è‡ªå·±çš„å­ç½‘id name: codelover-blog namespace: default spec: externalTrafficPolicy: Cluster ports: - nodePort: 32278 port: 80 protocol: TCP targetPort: 80 selector: run: codelover-blog sessionAffinity: None type: LoadBalancer æŸ¥çœ‹ä¸€ä¸‹é…ç½®çš„æ•ˆæœ\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 âœ codelover-blog git:(master) âœ— kc get service NAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE codelover-blog LoadBalancer 172.16.255.232 172.17.0.28 80:32278/TCP 55d root@VM-0-13-ubuntu:~# curl -vvvv 172.17.0.28 * Rebuilt URL to: 172.17.0.28/ * Trying 172.17.0.28... * Connected to 172.17.0.28 (172.17.0.28) port 80 (#0) \u0026gt; GET / HTTP/1.1 \u0026gt; Host: 172.17.0.28 \u0026gt; User-Agent: curl/7.47.0 \u0026gt; Accept: */* \u0026gt; \u0026lt; HTTP/1.1 200 OK \u0026lt; Server: nginx/1.17.1 \u0026lt; Date: Sun, 01 Sep 2019 05:30:51 GMT \u0026lt; Content-Type: text/html \u0026lt; Content-Length: 45988 \u0026lt; Last-Modified: Mon, 08 Jul 2019 03:59:21 GMT \u0026lt; Connection: keep-alive \u0026lt; ETag: \u0026#34;5d22bf99-b3a4\u0026#34; \u0026lt; Accept-Ranges: bytes \u0026lt; \u0026lt;!DOCTYPE html\u0026gt; ç°åœ¨å†…ç½‘IPæœ‰äº†, ä¸‹é¢ä¹Ÿå°±æ˜¯é…ç½®ä¸€ä¸‹NGINXçš„äº‹æƒ…äº†.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 server { listen 80; server_name ä½ çš„åŸŸå; location / { proxy_pass http://172.17.0.28:80; } error_page 500 502 503 504 /50x.html; location = /50x.html { root html; } proxy_set_header Host $host; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; gzip on; gzip_min_length 5k; gzip_buffers 4 16k; gzip_http_version 1.1; gzip_comp_level 3; gzip_types text/plain application/json application/javascript text/css application/xml text/javascript image/jpeg image/gif image/png; gzip_vary on; } å¥½äº†, å®Œäº‹.\n","date":"2019-08-31T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/%E4%BD%A0%E4%B8%8D%E5%8F%AF%E8%83%BD%E6%90%9E%E4%B8%8D%E5%AE%9A%E8%85%BE%E8%AE%AF%E4%BA%91k8s%E7%9A%84service/ingress/","title":"ä½ ä¸å¯èƒ½æä¸å®šè…¾è®¯äº‘K8Sçš„Service/Ingress"},{"content":".NET Coreä¹±ç³Šä»£ç ä¹‹\u0026quot;å¼‚æ­¥è°ƒå·®æ€§èƒ½\u0026quot;æŒ‡åŒ— å‰è¨€ æ•…äº‹è¦ä»å¥½ä¹…ä¹‹å‰è¯´èµ·,çº¿ä¸ŠæŸæœåŠ¡ä»é›¶åˆ°ä¸Šçº¿éƒ½æ˜¯æˆ‘æ’¸çš„, æ¶æ„ä¸»è¦æ˜¯.NET Core API + EF, ä»æœ€æ—©çš„æ—¥æ´»ä¸€åƒåˆ°ç°åœ¨æ—¥æ´»å‡ ä¸‡.\nå¹³æ—¶åœ¨çº¿äººæ•°å‡ ç™¾, é«˜å³°ä¸Šåƒ, é ç€6-8ä¸ªDockerå®ä¾‹åŸºæœ¬æ’‘ä½äº†, è¯·æ±‚é‡æ¥è¯´QPSåœ¨100å·¦å³. å¹³æ‘Šä¸‹æ¥å…¶å®æ¯ä¸ªå®ä¾‹çš„å¹¶å‘é‡ä¸ç®—å¤ªé«˜.\nä½†æ˜¯æŸä¸ªè¿­ä»£å¼€å§‹å‘ç°,\nè¿™ä¸ªWeb APIæœ‰ä¸€å®šå‡ ç‡åœ¨å¯åŠ¨çš„æ—¶å€™æ¥æ”¶åˆ°å¤§é‡è¯·æ±‚åå †ç§¯èµ·æ¥, çœ‹æ—¥å¿—æ˜¾ç¤ºè¯·æ±‚è¿›æ¥äº†, ä½†æ˜¯ä¸€ç›´æ²¡æœ‰åˆ°é€»è¾‘ä»£ç æˆ–è€…æ•°æ®åº“æŸ¥è¯¢,\næ‰€æœ‰çš„è¯·æ±‚çœ‹èµ·æ¥éƒ½æ˜¯åœ¨ç­‰è°ƒåº¦.\nå·²çŸ¥ä¿¡æ¯ å‡ºç°åœºæ™¯å¤§å¤šæ˜¯åˆšå¯åŠ¨çš„æ—¶å€™å¤§é‡è¯·æ±‚è¿›æ¥, å¯èƒ½ä¼šæŠŠå®ä¾‹æ‰“å´©\nå¶å°”æœ‰åœºæ™¯æ˜¯çªç„¶æ¶Œè¿›å¤§é‡ç”¨æˆ·, ä¹Ÿå¯èƒ½æŠŠå®ä¾‹æ‰“å´©\nå‘ç”Ÿé—®é¢˜æ—¶å®ä¾‹CPUå ç”¨ç‡å’Œå†…å­˜éƒ½å¾ˆæ­£å¸¸, æ•´ä¸ªå®¿ä¸»æœºè¿è½¬æ­£å¸¸, ä¹Ÿæ²¡æœ‰å¤§é‡IOè¯»å†™æ“ä½œ, åŸºæœ¬æ’é™¤å¤–éƒ¨å› ç´ \nç½‘ç»œæƒ…å†µæ­£å¸¸, å†…ç½‘ä¸­æ²¡æœ‰å¥‡æ€ªçš„æ•°æ®è¯·æ±‚,ä¸å­˜åœ¨ç½‘ç»œé£æš´ä¹‹ç±»çš„ä¸œè¥¿\nå‘ç”Ÿé—®é¢˜å‰æ­¤æ—¶æ•°æ®åº“è¿æ¥æ•°æ­£å¸¸, å®ä¾‹ä¸æ–­è¢«é‡å¯åæˆ–è€…ä¸€ç›´åƒµæ­»ä¸­, æ•°æ®åº“è¿æ¥æ•°ä¼šä¸æ–­å¢åŠ , ä¹Ÿæœ‰ä¸€å®šå‡ ç‡ä¼šæŠŠæ•°æ®åº“è¿æ¥æ•°æ’‘çˆ†.\nå¼€å§‹\u0026quot;ä¾¦æŸ¥æ¨¡å¼\u0026quot; çŒœæƒ³ä¸€, æ•°æ®åº“æäº‹äº†? æœ€æ—©æ€€ç–‘æ˜¯æ•°æ®åº“è¿æ¥çš„é—®é¢˜.\næ€»æ‰€å‘¨çŸ¥EFé¦–æ¬¡å¯åŠ¨ç‰¹åˆ«æ…¢, å¦‚æœä¸€å¼€å§‹æŸ¥è¯¢æ¯”è¾ƒå¤šè¿›æ¥, ç›´æ¥è½åˆ°æ•°æ®åº“æŸ¥è¯¢.\næ¯ä¸ªEFå®ä¾‹åˆå§‹åŒ–éƒ½éœ€è¦è€—è´¹ä¸€å®šæ—¶é—´, è¿™æ ·åŠ¿å¿…æ˜¯ä¼šå½±å“æ•´ä¸ªæ€§èƒ½çš„.\nè¿™ç§æƒ…å†µä¸‹, å¦‚æœå¯ä»¥å¯¹EF DB Poolåšä¸€æ¬¡é¢„çƒ­æ˜¯ä¸æ˜¯ä¼šå¥½ä¸€äº›å‘¢?\næ‰€ä»¥æ›¾ç»åœ¨Startup.csä¸‹é¢å†™è¿‡ç±»ä¼¼çš„é¢„çƒ­ä»£ç .\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 private static void InitDataContextService(IApplicationBuilder app) { Console.WriteLine($\u0026#34;InitDataContextService start,now:{DateTime.Now.ToString()}\u0026#34;); var tasks = new List\u0026lt;Task\u0026gt;(); for (var i = 0; i \u0026lt;= 10; i++) { var serviceScope = app.ApplicationServices.CreateScope(); var context = serviceScope.ServiceProvider.GetRequiredService\u0026lt;XXXContext\u0026gt;(); var t = context.Database.CanConnectAsync(); tasks.Add(t); } Task.WaitAll(tasks.ToArray()); Console.WriteLine($\u0026#34;InitDataContextService finish,now:{DateTime.Now.ToString()}\u0026#34;); } ç”¨Taskå¼‚æ­¥çš„æ–¹å¼æ¥æ§åˆ¶æ¯æ¬¡å°½é‡äº§ç”Ÿä¸åŒçš„å®ä¾‹, å·²è¾¾åˆ°é¢„çƒ­æ•°æ®é‡è¿æ¥æ± çš„æ•ˆæœ.\næ˜¯ä¸æ˜¯å¾ˆæœºæ™ºå•Š? (P, ç„¶è€Œå¹¶æ²¡æœ‰åŠæ¯›é’±çš„æ•ˆæœ)\nçŒœæƒ³äºŒ, åŒæ­¥è¯·æ±‚ç­‰å¾…èµ„æºå¯¼è‡´æ€§èƒ½å˜å·®, å¯åŠ¨çš„æ—¶å€™è¢«æ‰“å´©? æœ€æ—©ç‰ˆæœ¬æ‰€æœ‰çš„Controller Action éƒ½æ˜¯åŒæ­¥è¯·æ±‚, æ¥ä¸€ä¸ªè¯·æ±‚åŒæ­¥æŸ¥è¯¢æ•°æ®, æ‰§è¡ŒHTTPè¯·æ±‚ç­‰ç­‰éƒ½æ˜¯æ­£å¸¸çš„é€»è¾‘ä»£ç .\nä»æ¥ä¸ç”¨async/awatiä¹‹ç±»çš„ä¸œè¥¿.(å°±æ˜¯è¿™ä¹ˆæ‡’)\næ—¢ç„¶å‡ºäº‹äº†, æ”¹ä¸€ç‰ˆçœ‹çœ‹.\nå¼€å§‹é”µé”µé”µæ”¹Controller Action, æ”¹æˆTaskçš„å½¢å¼.\nåŸºæœ¬ä»£ç \n1 2 3 4 5 6 7 8 [HttpGet(\u0026#34;v1/books/{id}\u0026#34;, Name = \u0026#34;GetBook\u0026#34;)] [SwaggerResponse(200, \u0026#34;è·å–æˆåŠŸ\u0026#34;, typeof(BookDetail))] [SwaggerResponse(404, \u0026#34;æ‰¾ä¸åˆ°ä¹¦ç±\u0026#34;)] public async Task\u0026lt;IActionResult\u0026gt; GetBook([FromRoute]string id) { return Ok(new { data = await _bookService.FindBookDetailForUser(id), code = 0 }); } serviceå±‚çš„ç”¨åˆ°çš„æ–¹æ³•åŒæ—¶ä¹Ÿæ”¹é€ æˆå¼‚æ­¥, ä»å¤´åˆ°å°¾éƒ½æ˜¯å¼‚æ­¥.\nè¿™æ ·æµ‹ä¸‹æ¥, æ€§èƒ½æ¯”åŒæ­¥å¤§æ¦‚æ¶¨äº†30%-50%å·¦å³(çæµ‹çš„, ä¹Ÿä¸å¤ªè®°å¾—äº†æ•°å€¼äº†,æ²¡æœ‰å‚è€ƒæ„ä¹‰)\nå°±è¿™æ ·åˆä¸Šäº†ä¸€ä¸ªç‰ˆæœ¬, æ¯”å†å‰é¢å‡ ä¸ªç‰ˆæœ¬éƒ½å¥½ç‚¹äº†, ç°åœ¨å‘ç”Ÿæ‰“å´©çš„æƒ…å†µé™ä½äº†å¾ˆå¤š.\nç„å­¦ç°åœº:åˆåšäº†ä¸€äº›å¥‡æ€ªçš„äº‹æƒ… åæ¥åˆå‘ç°, æ¯æ¬¡å¯åŠ¨çš„æ—¶å€™, åœ¨æ­£å¼æµé‡æ‰“å…¥ä¹‹å‰, å°½é‡é¢„çƒ­ä¸€ä¸‹apiå®ä¾‹çš„è¯, è¢«ç›´æ¥æ‰“å´©çš„å‡ ç‡ä¼šå˜ä½,\næ•´ä½“apiä¼šæ¯”è¾ƒæ­£å¸¸å¯åŠ¨.\nè‡³å°‘ç®—æ˜¯ä¸€ä¸ªèƒ½æ“ä½œçš„äº‹æƒ…, è¿™ä¸ªæ—¶å€™å°±å¾ˆå‚»äº†, æ¯æ¬¡å‘å¸ƒçš„æ—¶å€™éƒ½æ‰‹åŠ¨ab testä¸€ä¸‹è¿˜æ²¡æœ‰è½¬å…¥æµé‡çš„å®ä¾‹,\nå°½å¯èƒ½é¢„çƒ­ä¸€ä¸‹æ•°æ®åº“å’Œè¿™ä¸ªHTTPç®¡é“.\nè¿™ä¸ªæ—¶å€™çœŸçš„æ˜¯ç„å­¦ç°åœº, å¤ªè®©æˆ‘æ²®ä¸§äº†.\nå¢¨è²å®šå¾‹æ€»æ˜¯ä¼šæ¥çš„ å‰å¤©æ™šä¸Šå‘å¸ƒæ–°ç‰ˆæœ¬, é¢„å‘å¸ƒç¯å¢ƒæ”¿ç­–, æ€§èƒ½æ­£å¸¸ä¹‹åæ¨åˆ°ç”Ÿäº§, ç„¶åå…¨çº¿å‘Šè­¦.\nç¥å¥‡äº†, ç°åœ¨åˆè§é¬¼äº†.\nç”¨ä¸Šé¢çš„å‹æµ‹é¢„çƒ­æŠ˜è…¾äº†ä¸€ä¸ªå°æ—¶, æ²¡æœ‰æˆåŠŸå…¨éƒ¨å¯åŠ¨åº”ç”¨, æœ€åæ— å¥ˆå…ˆå›æ»šäº†, å›æ»šåæœåŠ¡æ­£å¸¸.\nOK, è¿™ä¸ªè¿­ä»£çš„ä»£ç åŠ å‰§äº†åº”ç”¨è¢«æ‰“å´©çš„æƒ…å†µ.\nç°æ€»ç»“ä¸€ä¸‹å½“å‰æƒ…å†µ\nè¿™æ¬¡ä¸Šçº¿å‰, æ•°æ®åº“å·²ç»å‡çº§äº†é…ç½®, æ•´ä½“ç›‘æ§ä¸Šæ•°æ®åº“æ²¡æœ‰ä»»ä½•çš„ç“¶é¢ˆ\næ²¡æœ‰å¤§çš„é€»è¾‘å˜åŠ¨, è€çš„æ ¸å¿ƒæ¥å£åŸºæœ¬éƒ½å¼‚æ­¥æ”¹é€ å®Œæˆ, æ–°æ¥å£åŸºæœ¬éƒ½æ˜¯å¼‚æ­¥çš„\nä¸å­˜åœ¨ç¼“å­˜ç©¿é€é—®é¢˜, Redisç¼“å­˜å‘½ä¸­æ­£å¸¸.\nè¿™æ¬¡å‘å¸ƒæœ€å¤§å˜æ›´æ˜¯IPå®šä½, éœ€è¦å¤„ç†headersä¸­çš„IPæ•°æ®,\nä½¿ç”¨ActionFilterAttributeåœ¨è¯·æ±‚è¿›å…¥Actionæ–¹æ³•å‰å®ŒæˆIPåˆ°åœ°åŒºçš„è½¬æ¢.\nè¿™é‡Œä¸»è¦ä¼šç”¨åˆ°Rediså’ŒMaxMind.Db, ä¼˜å…ˆä»RedisæŸ¥è¯¢IPåœ°åŒºç¼“å­˜, æ²¡æœ‰å‘½ä¸­åˆ™ç›´æ¥æŸ¥è¯¢MaxMind.Dbæ•°æ®, æŸ¥è¯¢å¥½ä¹‹åå†å†™å…¥åˆ°Redisä¸­.\nä»£ç å¤§æ¦‚æ˜¯è¿™æ ·çš„.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 public class HTTPHeaderAttribute : ActionFilterAttribute { private readonly HTTPHeaderTools _httpHeaderTools; private readonly MaxMindDBClient _maxMindDBClient; private readonly RedisService _redisService; public HTTPHeaderAttribute(HTTPHeaderTools httpHeaderTools, MaxMindDBClient maxMindDBClient, RedisService redisService) { _httpHeaderTools = httpHeaderTools; _maxMindDBClient = maxMindDBClient; _redisService = redisService; } public override void OnActionExecuting(ActionExecutingContext context) { var dicXHeaders = new Dictionary\u0026lt;string, string\u0026gt;(); string locationISOCode = GetLocationISOCode(context); dicXHeaders.Add(CommonConst.LocationHeaderKey, locationISOCode); _httpHeaderTools.CurrentXHeaders = new ThreadLocal\u0026lt;Dictionary\u0026lt;string, string\u0026gt;\u0026gt;(() =\u0026gt; dicXHeaders); } private string GetLocationISOCode(ActionExecutingContext context) { string requestIP = context.HttpContext.Request.Headers.GetHeaderValue(\u0026#34;X-Forwarded-For\u0026#34;); if(requestIP.Contains(\u0026#34;,\u0026#34;)) { requestIP = requestIP.Split(\u0026#34;,\u0026#34;)[0]; } var locationISOCode = _redisService.ReadHashValueByKey\u0026lt;string\u0026gt;(ConstRedisKey.IPLocations, requestIP); if (string.IsNullOrEmpty(locationISOCode)) { locationISOCode = _maxMindDBClient.GetIPLocationISOCode(requestIP); _redisService.WriteHash(ConstRedisKey.IPLocations, requestIP, locationISOCode); } return locationISOCode; } } ä»£ç å…ˆæ‰”ç€, çœ‹èµ·æ¥æ²¡ä»€ä¹ˆç‰¹åˆ«çš„åœ°æ–¹.\nå¥½äº†, æˆ‘è¦ç¡äº†æ˜å¤©ç»§ç»­\u0026hellip;\nç­‰æˆ‘ç¡é†’äº†å†ç»§ç»­..\nå…ˆç›´æ¥ç”©çœŸæ­£è§£å†³é—®é¢˜çš„çš„ä»£ç :\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 public class HTTPHeaderAttribute : ActionFilterAttribute { private readonly HTTPHeaderTools _httpHeaderTools; private readonly MaxMindDBClient _maxMindDBClient; private readonly RedisService _redisService; public HTTPHeaderAttribute(HTTPHeaderTools httpHeaderTools, MaxMindDBClient maxMindDBClient, RedisService redisService) { _httpHeaderTools = httpHeaderTools; _maxMindDBClient = maxMindDBClient; _redisService = redisService; } public override async Task OnActionExecutionAsync(ActionExecutingContext context, ActionExecutionDelegate next) { var dicXHeaders = new Dictionary\u0026lt;string, string\u0026gt;(); string locationISOCode = await GetLocationISOCode(context); dicXHeaders.Add(CommonConst.LocationHeaderKey, locationISOCode); _httpHeaderTools.CurrentXHeaders = new ThreadLocal\u0026lt;Dictionary\u0026lt;string, string\u0026gt;\u0026gt;(() =\u0026gt; dicXHeaders); await next(); } private async Task\u0026lt;string\u0026gt; GetLocationISOCode(ActionExecutingContext context) { string requestIP = context.HttpContext.Request.Headers.GetHeaderValue(\u0026#34;X-Forwarded-For\u0026#34;); if (requestIP.Contains(\u0026#34;,\u0026#34;)) { requestIP = requestIP.Split(\u0026#34;,\u0026#34;)[0]; } if (string.IsNullOrEmpty(requestIP)) { return CommonConst.ChinaISOCode; } var locationISOCode = await _redisService.ReadHashValueByKeyAsync(ConstRedisKey.IPLocations, requestIP); if (string.IsNullOrEmpty(locationISOCode)) { locationISOCode = _maxMindDBClient.GetIPLocationISOCode(requestIP); _redisService.WriteHash(ConstRedisKey.IPLocations, requestIP, locationISOCode); } return locationISOCode; } } å…ˆç¡è§‰äº†, æœ‰æƒ³æ³•çš„æœ‹å‹æ¬¢è¿è¯„è®ºæ‰“æ¶\u0026hellip;\n","date":"2019-08-03T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/.net-core%E4%B9%B1%E7%B3%8A%E4%BB%A3%E7%A0%81%E4%B9%8B%E5%BC%82%E6%AD%A5%E8%B0%83%E5%B7%AE%E6%80%A7%E8%83%BD%E6%8C%87%E5%8C%97/","title":".NET Coreä¹±ç³Šä»£ç ä¹‹\"å¼‚æ­¥è°ƒå·®æ€§èƒ½\"æŒ‡åŒ—"},{"content":".NET Core Web API Swagger æ–‡æ¡£ç”Ÿæˆ REST API ä¸­æ–‡æ¡£è¯´æ˜,ç”¨Swaggeréƒ½å¿«æˆäº†ä¸€ç§è§„èŒƒäº†,\nä¹‹å‰åœ¨å…¬å¸é‡Œé¢å°±æŠ˜è…¾è¿‡äº†, æ•ˆæœè¿˜æ˜¯å¾ˆä¸é”™çš„, ä¸è¿‡ä¹‹å‰éƒ½æ˜¯ç»´æŠ¤ä¸€ä¸ªswagger json/yaml,\nåæ¥å‘ç°å…¶å®å¯ä»¥ç›´æ¥åœ¨APIå®ç°çš„åœ°æ–¹æ ¹æ®å®ç°æ¥ç”Ÿæˆswaggeråœ¨çº¿æ–‡æ¡£,\næ‹–å»¶ç—‡å‘ä½œçš„æˆ‘å¹¶æ²¡æœ‰å»ç®¡, è¿™æ¬¡æœ‰ä¸ªæ–°APIåœ¨åš, äºæ˜¯æŠ˜è…¾äº†ä¸€ä¸‹.\nèµ·æ­¥ é¦–å…ˆè¦æœ‰ä¸ª.NET Coreé¡¹ç›®.\nå¾®è½¯å®˜æ–¹æ•™ç¨‹getting-started-with-swashbuckle\nGithub/Swashbuckle.AspNetCore\nå¼•å…¥ä¸€ä¸‹Swashbuckle.AspNetCoreå’ŒSwashbuckle.AspNetCore.Annotations 1 2 3 4 5 6 # ä¸»è¦çš„æ–‡æ¡£ç”Ÿæˆéƒ½åœ¨è¿™é‡Œ dotnet add package Swashbuckle.AspNetCore --version 4.0.1 # ç”¨æ¥æè¿°è¯·æ±‚çš„ç›¸å…³ä¿¡æ¯ dotnet add package Swashbuckle.AspNetCore.Annotations --version 4.0.1 ä»£ç :\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 using System; using System.Collections.Generic; using System.Linq; using System.Threading.Tasks; using Zhihu404API.Dao; using Microsoft.AspNetCore.Builder; using Microsoft.AspNetCore.Hosting; using Microsoft.AspNetCore.Mvc; using Microsoft.Extensions.Configuration; using Microsoft.Extensions.DependencyInjection; using Microsoft.EntityFrameworkCore; using Swashbuckle.AspNetCore.Swagger; namespace XX404API { public class Startup { public Startup(IConfiguration configuration) { Configuration = configuration; } public IConfiguration Configuration { get; } // This method gets called by the runtime. Use this method to add services to the container. public void ConfigureServices(IServiceCollection services) { services.AddMvc().SetCompatibilityVersion(CompatibilityVersion.Version_2_2); services.AddOptions().Configure\u0026lt;AppSettings\u0026gt;(Configuration); services.AddSwaggerGen(c =\u0026gt; { c.SwaggerDoc(\u0026#34;v1\u0026#34;, new Info { Title = \u0026#34;XX-404 API\u0026#34;, Version = \u0026#34;v1\u0026#34; }); c.EnableAnnotations(); }); } // This method gets called by the runtime. Use this method to configure the HTTP request pipeline. public void Configure(IApplicationBuilder app, IHostingEnvironment env) { // å¯ç”¨Swagger app.UseSwagger(); // å¯åŠ¨Swagger UI app.UseSwaggerUI(c =\u0026gt; { c.RoutePrefix = \u0026#34;docs\u0026#34;; c.SwaggerEndpoint(\u0026#34;/swagger/v1/swagger.json\u0026#34;, \u0026#34;Zhihu-404 API\u0026#34;); }); app.UseMvc(); } } } ç„¶åéšä¾¿æ‰”ä¸¤ä¸ªControllerä»£ç å‡ºæ¥ä½œä¸ºæ ·ä¾‹çœ‹çœ‹.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 // HealthController.cs using System; using System.Collections.Generic; using System.Linq; using System.Threading.Tasks; using Microsoft.AspNetCore.Mvc; namespace XX404API.Controllers { [Route(\u0026#34;api/v1/health\u0026#34;)] [ApiController] public class HealthController : ControllerBase { // GET api/values [HttpGet] public ActionResult\u0026lt;IEnumerable\u0026lt;string\u0026gt;\u0026gt; Get() { return new string[] { \u0026#34;value1\u0026#34;, \u0026#34;value2\u0026#34; }; } } } 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 // HealthController.cs using System; using System.Collections.Generic; using System.Linq; using System.Threading.Tasks; using Microsoft.AspNetCore.Mvc; using Microsoft.EntityFrameworkCore; using Swashbuckle.AspNetCore.Annotations; using Newtonsoft.Json.Linq; using RestSharp; namespace XX404API.Controllers { [ApiController] public class ExtendDataController : ControllerBase { public ExtendDataController() { } [HttpPost(\u0026#34;api/v1/extend-data\u0026#34;)] // è¿”å›å€¼æ ¼å¼ä¼šç›´æ¥åºåˆ—åŒ–è¿™ä¸ªtypeofçš„ç±»å‹ [SwaggerResponse(200, \u0026#34;\u0026#34;, typeof(int))] // SwaggerParameterä¼šç”Ÿæˆè¯·æ±‚ä½“çš„æ ¼å¼ public ActionResult AddExtendData([FromBody, SwaggerParameter(\u0026#34;åŸå§‹æ•°æ®\u0026#34;)]List\u0026lt;DBExtendData\u0026gt; extendData) { if(extendData ==null || extendData.Any(a =\u0026gt;a.Id == default(long))) { throw new Exception(\u0026#34;ä¼ å…¥æ•°æ®æœ‰è¯¯, è¯·æ£€æŸ¥æ¯ä¸€é¡¹æ•°æ®Id\u0026#34;); } var count = 10;// _extendDataDapper.BulkInsert(extendData); return Ok(new { code = 0, data = count }); } } class DBExtendData { [Column(\u0026#34;id\u0026#34;)] [JsonProperty(PropertyName = \u0026#34;id\u0026#34;)] public long Id { get; set; } [Column(\u0026#34;create_time\u0026#34;)] [JsonProperty(PropertyName = \u0026#34;createTime\u0026#34;)] public DateTime? CreateTime { get; set; } [Column(\u0026#34;update_time\u0026#34;)] [JsonProperty(PropertyName = \u0026#34;updateTime\u0026#34;)] public DateTime? UpdateTime { get; set; } = DateTime.Now; } } ç„¶åè®¿é—® localhost:5000/docs å°±èƒ½çœ‹åˆ°ä¸‹é¢çš„æ–‡æ¡£äº†.\nå¥½äº†, å…¨æ–‡å®Œ.\næˆ‘å»åšé¥­äº†\u0026hellip;\n","date":"2019-07-06T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/.net-core-web-api-swagger-%E6%96%87%E6%A1%A3%E7%94%9F%E6%88%90/","title":".NET Core Web API Swagger æ–‡æ¡£ç”Ÿæˆ"},{"content":"åæ‰‹æ¥ä¸ªK8Så…¥é—¨åˆ°è·‘è·¯ å‰è¨€ æ”¾å‡å‰ä¸€ä¸¤å¤©å‘ç°è…¾è®¯äº‘æ‰˜ç®¡K8Sé›†ç¾¤ä¸Šçº¿å¥½ä¸€é˜µå­äº†, è¿˜æ”¯æŒæŠŠåŸæœ‰ä¸»æœºè¿å…¥k8sé›†ç¾¤, ç´¢æ€§å¼€å§‹æäº‹äº†.\nå…ˆç®€å•ç§‘æ™®ä¸€ä¸‹, ä»€ä¹ˆæ˜¯k8s?\nk8s ç§‘æ™®æ—¶é—´ Kubernetes (K8s) is an open-source system for automating deployment, scaling, and management of containerized applications. It groups containers that make up an application into logical units for easy management and discovery. Kubernetes builds upon 15 years of experience of running production workloads at Google, combined with best-of-breed ideas and practices from the community. æ¥è‡ª:https://kubernetes.io/\n1 2 3 4 5 6 7 8 9 Kubernetesæ˜¯ä¸€ä¸ªå¼€æºçš„ï¼Œç”¨äºç®¡ç†äº‘å¹³å°ä¸­å¤šä¸ªä¸»æœºä¸Šçš„å®¹å™¨åŒ–çš„åº”ç”¨ï¼ŒKubernetesçš„ç›®æ ‡æ˜¯è®©éƒ¨ç½²å®¹å™¨åŒ–çš„åº”ç”¨ç®€å•å¹¶ä¸”é«˜æ•ˆï¼ˆpowerfulï¼‰,Kubernetesæä¾›äº†åº”ç”¨éƒ¨ç½²ï¼Œè§„åˆ’ï¼Œæ›´æ–°ï¼Œç»´æŠ¤çš„ä¸€ç§æœºåˆ¶ã€‚ Kubernetesä¸€ä¸ªæ ¸å¿ƒçš„ç‰¹ç‚¹å°±æ˜¯èƒ½å¤Ÿè‡ªä¸»çš„ç®¡ç†å®¹å™¨æ¥ä¿è¯äº‘å¹³å°ä¸­çš„å®¹å™¨æŒ‰ç…§ç”¨æˆ·çš„æœŸæœ›çŠ¶æ€è¿è¡Œç€ï¼ˆæ¯”å¦‚ç”¨æˆ·æƒ³è®©apacheä¸€ç›´è¿è¡Œï¼Œç”¨æˆ·ä¸éœ€è¦å…³å¿ƒæ€ä¹ˆå»åšï¼ŒKubernetesä¼šè‡ªåŠ¨å»ç›‘æ§ï¼Œç„¶åå»é‡å¯ï¼Œæ–°å»º. æ€»ä¹‹ï¼Œè®©apacheä¸€ç›´æä¾›æœåŠ¡ï¼‰ï¼Œç®¡ç†å‘˜å¯ä»¥åŠ è½½ä¸€ä¸ªå¾®å‹æœåŠ¡ï¼Œè®©è§„åˆ’å™¨æ¥æ‰¾åˆ°åˆé€‚çš„ä½ç½®. åŒæ—¶ï¼ŒKubernetesä¹Ÿç³»ç»Ÿæå‡å·¥å…·ä»¥åŠäººæ€§åŒ–æ–¹é¢ï¼Œè®©ç”¨æˆ·èƒ½å¤Ÿæ–¹ä¾¿çš„éƒ¨ç½²è‡ªå·±çš„åº”ç”¨ï¼ˆå°±åƒcanary deploymentsï¼‰ã€‚ -- [https://www.kubernetes.org.cn/k8s](https://www.kubernetes.org.cn/k8s) ç”¨äººè¯æ¥è¯´, é¦–å…ˆæˆ‘ä»¬ä»¥å‰å·²ç»æŠŠæ‰€æœ‰çš„æœåŠ¡(server/api)éƒ½Dockerå®¹å™¨åŒ–äº†,\nk8så°±æ˜¯ä¸€å¥—ç”¨æ¥åšå®¹å™¨æœåŠ¡ç®¡ç†/ç¼–æ’çš„ç³»ç»Ÿ.\né‚£ä¹ˆæˆ‘ä»¬ç°åœ¨å¼€å§‹å§.\nç¥è¯´, è¦æœ‰k8s. åˆå§‹åŒ–è‡ªå·±çš„è…¾è®¯äº‘/é˜¿é‡Œäº‘k8s å®¹å™¨æœåŠ¡ ç™»å½•ä¸€ä¸‹è‡ªå·±çš„æŸäº‘å¹³å°, æ‰¾ä¸€ä¸‹\u0026quot;å®¹å™¨æœåŠ¡\u0026quot;, æ–°å»ºé›†ç¾¤, é€‰\u0026quot;æ‰˜ç®¡é›†ç¾¤\u0026quot;, ç‚¹ç‚¹ç‚¹ä¹‹åå®Œæˆé…ç½®.\nç„¶åæŠŠè‡ªå·±å·²æœ‰çš„æœºå™¨åŠ å…¥åˆ°ä¸Šé¢çš„é›†ç¾¤é‡Œé¢å», åŸºæœ¬ä¹Ÿæ˜¯åœ¨ç•Œé¢ä¸Šç‚¹ç‚¹ç‚¹å°±å¥½.\nç®€å•ç§‘æ™®ä¸€ä¸‹k8sé‡Œé¢å¯¹äºæœºå™¨çš„å®šä¹‰ ä¸€ä¸ªæœºå™¨åœ¨k8sæ˜¯ä¸€ä¸ªèŠ‚ç‚¹,èŠ‚ç‚¹åˆ†æˆä¸¤ç§ç±»å‹,\nä¸€ç±»æ˜¯masterèŠ‚ç‚¹, è·‘ç€ä¸€å †k8sæ ¸å¿ƒæœåŠ¡(etcdä¹‹ç±»çš„, å…·ä½“çš„è‡ªå·±å»äº†è§£å§);\nä¸€ç±»æ˜¯workerèŠ‚ç‚¹,ç”¨äºè·‘æˆ‘ä»¬è‡ªå·±çš„ä¸šåŠ¡æœåŠ¡(å¦‚,æŸä¸ªçˆ¬è™«)\nä¸€èˆ¬æƒ…å†µä¸‹, æˆ‘ä»¬æŠŠæœåŠ¡æ‰”ç»™k8sè¿è¡Œèµ·æ¥çš„æ—¶å€™, å®é™…ä¸Šéƒ½æ˜¯åœ¨workerèŠ‚ç‚¹ä¸Šèµ·ä¸€ä¸ªDockerå®¹å™¨å®ä¾‹ + ç›¸å…³çš„é…ç½®.\nè¿™è¾¹äº‘å¹³å°çš„æ‰˜ç®¡é›†ç¾¤å°±æ˜¯masterèŠ‚ç‚¹æˆ‘ä»¬ä¸ç®¡äº†, äº‘å¹³å°è´Ÿè´£å¥½, éœ€è¦çš„æœºå™¨å’Œé…ç½®éƒ½ç»™ä»–ä»¬æ;\næˆ‘ä»¬æŠŠè‡ªå·±çš„å·²ç»ä¹°è¿‡çš„æœºå™¨æˆ–è€…æ–°ä¹°çš„æœºå™¨åŠ å…¥åˆ°é›†ç¾¤é‡Œé¢, è‡ªå·±ç”¨å°±å®Œäº‹äº†.\næ‰€ä»¥\u0026hellip;.\næˆ‘åˆæ¥æäº‹äº†.\nç¥è¯´, è®©æˆ‘ä»¬è¦å¼€å§‹äº† ç­‰ä¸‹, ä¸Šé¢ç‚¹å®Œäº†, å…ˆæŠŠæœ¬åœ°çš„kubectlææ‚.\nå“ˆ? ä»€ä¹ˆæ˜¯kubectl.\nå“¦, ç®¡ç†k8sçš„å‘½ä»¤è¡Œå·¥å…·.\næ²¡æœ‰å›¾å½¢ç•Œé¢å—?\næœ‰, ä¸è¿‡æŸäº‘åšçš„å¾ˆéš¾ç”¨, åŸç”Ÿçš„å‡‘åˆèƒ½çœ‹, ä¾¿äºç†è§£æ¦‚å¿µçš„æƒ…å†µä¸‹, è¿˜æ˜¯å…ˆç”¨ctlæèµ·å§.\nå®‰è£…æ•™ç¨‹: é€šè¿‡ Kubectl è¿æ¥é›†ç¾¤\nå‡è£…åˆ°è¿™é‡Œåº”è¯¥éƒ½å¼„å¥½äº†.\n1 2 3 4 ## è¾“å…¥kubectl version æŸ¥çœ‹å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ç‰ˆæœ¬ä¿¡æ¯, èƒ½æ­£å¸¸è¾“å‡ºä¿¡æ¯è¯æ˜éƒ½workäº† âœ codelover-blog git:(master) âœ— kubectl version Client Version: version.Info{Major:\u0026#34;1\u0026#34;, Minor:\u0026#34;11\u0026#34;, GitVersion:\u0026#34;v1.11.1\u0026#34;, GitCommit:\u0026#34;b1b29978270dc22fecc592ac55d903350454310a\u0026#34;, GitTreeState:\u0026#34;clean\u0026#34;, BuildDate:\u0026#34;2018-07-18T11:37:06Z\u0026#34;, GoVersion:\u0026#34;go1.10.3\u0026#34;, Compiler:\u0026#34;gc\u0026#34;, Platform:\u0026#34;darwin/amd64\u0026#34;} Server Version: version.Info{Major:\u0026#34;1\u0026#34;, Minor:\u0026#34;12+\u0026#34;, GitVersion:\u0026#34;v1.12.4-tke.1.1\u0026#34;, GitCommit:\u0026#34;900490ac7b7ae6a13aa6599d43258f1164e9c458\u0026#34;, GitTreeState:\u0026#34;clean\u0026#34;, BuildDate:\u0026#34;2019-01-30T10:22:33Z\u0026#34;, GoVersion:\u0026#34;go1.10.4\u0026#34;, Compiler:\u0026#34;gc\u0026#34;, Platform:\u0026#34;linux/amd64\u0026#34;} åˆåˆ°æ¦‚å¿µæ—¶é—´ Pod/Service Kubernetes Podæ¦‚è¿°\nKubernetes Servicesæ¦‚è¿°\nç”¨äººè¯æ¥è¯´,\nPodå°±æ˜¯ä¸€å †app(ä¸€ä¸ª/å¤šä¸ªDockerå®¹å™¨å®ä¾‹)çš„é›†åˆ;\nServiceå°±æ˜¯åœ¨k8så†…ç½‘åå¢ƒ\u0026quot;å¯¹å¤–\u0026quot;æä¾›æœåŠ¡çš„ä¸€ä¸ªå®ä½“;\næˆ‘ä»¬ç›´æ¥åœ¨ä¸¾ä¸ªæ —å­æ¥è¯´æ˜ä¸€ä¸‹.\nä¸€ä¸ªæ”¯æŒæ°´å¹³æ‰©å±•çš„Web APIæœåŠ¡, æˆ‘ä»¬ä¸ºäº†é«˜å¯ç”¨éœ€è¦ç»™å®ƒéƒ¨ç½²äº†ä¸‰ä¸ªå®ä¾‹, è¿™é‡Œå°±æ˜¯ä¸€ä¸ªPod, ç”±ä¸‰ä¸ªå®ä¾‹ç»„æˆ\n\u0026ldquo;å¯¹å¤–\u0026rdquo;(å…¶ä»–æœåŠ¡æˆ–è€…appéœ€è¦è®¿é—®å®ƒ)æ¥è¯´, æˆ‘ä»¬éœ€è¦ç›´æ¥è®¿é—®å®ƒä½†æ˜¯æœ‰æ²¡å¿…è¦çŸ¥é“å®ƒæœ‰å‡ ä¸ªå®ä¾‹, è¿™ä¸ªæ—¶å€™å°±æœ‰ä¸€ä¸ªServiceæ¥æ‰¿è½½å®ƒ, Serviceè´Ÿè´£æŠŠè¯·æ±‚ç›´æ¥è½¬å‘åˆ°Podä¸­, Podé‡Œé¢æœ‰å¤šå°‘å®ä¾‹å¯¹Serviceå’Œå¯¹è°ƒç”¨è€…æ¥è¯´éƒ½æ˜¯é€æ˜çš„.\næ‰€ä»¥æˆ‘ä»¬æ¥éƒ¨ç½²æˆ‘ä»¬çš„ç¬¬ä¸€å¥—æœåŠ¡å§.\nç¥è¯´, è¦å¼€å§‹å…¥é—¨äº†! å°†ä¸‹é¢çš„æ–‡ä»¶ä¿å­˜æˆsample.yaml, ç„¶åæ‰§è¡Œ \u0026ldquo;kubectl apply -f sample.yaml\u0026rdquo;\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 --- apiVersion: extensions/v1beta1 kind: Deployment metadata: # ç»™podæ‰“ä¸Šæ ‡ç­¾, å®šä¹‰service éœ€è¦ç”¨ labels: run: first-web-size name: first-web-size spec: # å®ä¾‹ä¸ªæ•° replicas: 2 selector: matchLabels: run: first-web-size strategy: rollingUpdate: maxSurge: 1 maxUnavailable: 1 type: RollingUpdate template: metadata: creationTimestamp: null labels: run: first-web-size spec: containers: # å¾®è½¯ dotnet core æ ·ä¾‹é•œåƒ - image: mcr.microsoft.com/dotnet/core/samples:aspnetapp imagePullPolicy: IfNotPresent name: first-web-size terminationMessagePath: /dev/termination-log livenessProbe: httpGet: path: /v1/health port: 80 initialDelaySeconds: 120 periodSeconds: 30 # CPU + å†…å­˜é™åˆ¶ resources: # æœ€é«˜ä½¿ç”¨500mçš„CPU, è¶…è¿‡å°±é™åˆ¶CPU;æœ€é«˜ç”¨512Må†…å­˜, è¶…è¿‡å°±ç‚¸åº”ç”¨ limits: cpu: 500m memory: 512Mi # è¦æ±‚ç»™50mçš„CPUè°ƒåº¦å’Œ128Må†…å­˜æ‰å¯ä»¥å¯åŠ¨ requests: cpu: 50m memory: 128Mi # è¿™é‡Œæ˜¯ç§æœ‰é•œåƒä»“åº“éœ€è¦è‡ªå·±é…ç½®çš„ä¸€ä¸‹ç§˜é’¥ä»€ä¹ˆä¹‹ç±»çš„, é…ç½®è¿‡ç¨‹è§k8så®˜æ–¹æ–‡æ¡£ # imagePullSecrets: # - name: regcred dnsPolicy: ClusterFirst restartPolicy: Always terminationGracePeriodSeconds: 30 --- apiVersion: v1 kind: Service metadata: name: first-web-size annotations: # è¿™é‡Œ:åé¢çš„å€¼å¡«è…¾è®¯äº‘çš„å­ç½‘id, è¿™æ ·serviceå°±åœ¨è…¾è®¯äº‘ç§æœ‰ç½‘ç»œå­ç½‘é‡Œé¢æœ‰è‡ªå·±çš„ ipäº† service.kubernetes.io/qcloud-loadbalancer-internal-subnetid: subnet-xxx spec: selector: # è¿‡æ»¤æ ‡ç­¾, åœ¨ä¸Šé¢å®šä¹‰podçš„æ—¶å€™ä¹Ÿå†™äº†å¯¹åº”çš„label run: first-web-size ports: - protocol: TCP # serviceå¯¹å¤–æä¾›è®¿é—®çš„ç«¯å£ port: 80 # podçš„ç«¯å£ targetPort: 80 type: LoadBalancer externalTrafficPolicy: Cluster å°†ä¸Šé¢çš„æ–‡ä»¶ä¿å­˜æˆsample.yaml, ç„¶åæ‰§è¡Œ \u0026ldquo;kubectl apply -f sample.yaml\u0026rdquo;, å¯ä»¥çœ‹åˆ°ä¸‹é¢çš„Log\n1 2 3 4 5 6 7 8 9 âœ _posts git:(master) âœ— kubectl apply -f sample.yaml deployment.extensions/first-web-size created service/first-web-size created âœ _posts git:(master) âœ— kubectl get pod first-web-size-797fb6f8cc-q79df 1/1 Running 0 68s first-web-size-797fb6f8cc-thwm7 1/1 Running 0 68s âœ _posts git:(master) âœ— kubectl get service NAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE first-web-size LoadBalancer 10.3.255.248 \u0026lt;pending\u0026gt; 80:31054/TCP 101s æˆ‘ä»¬åœ¨ä¸Šé¢å¯ä»¥çœ‹åˆ°, æœ‰first-web-sizeè¿™ä¸ªPodæœ‰ä¸¤ä¸ªå®ä¾‹, æœ‰ä¸€ä¸ªService\nè¿™ä¸ªæ—¶å€™ç™»å½•å’Œé›†ç¾¤åœ¨åŒä¸€ä¸ªå†…ç½‘çš„æœåŠ¡å™¨ä¸Šé¢\næ‰§è¡Œ curl http://10.3.255.248 èƒ½çœ‹åˆ°å¯¹åº”çš„è®¿é—®HTML\n1 2 3 4 5 6 7 root@VM-0-6-ubuntu:~# curl http://10.3.255.248 \u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;utf-8\u0026#34; /\u0026gt; \u0026lt;meta name=\u0026#34;viewport\u0026#34; content=\u0026#34;width=device-width, initial-scale=1.0\u0026#34; /\u0026gt; \u0026lt;title\u0026gt;Home Page - aspnetapp\u0026lt;/title\u0026gt; æ€ä¹ˆå¯¹å¤–æä¾›è®¿é—®ç­‰æˆ‘ä¸‹æ¬¡åˆ†äº«äº†.\nç”¨å®Œäº†è¦åˆ æ‰è¿™äº›ä¸œè¥¿è¯·æ‰§è¡Œ \u0026ldquo;kubectl delete -f sample.yaml\u0026rdquo;\næ‹œ\u0026hellip;\næˆ‘å»åšé¥­äº†.\n","date":"2019-06-09T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/%E5%8F%8D%E6%89%8B%E6%9D%A5%E4%B8%AAk8s%E5%85%A5%E9%97%A8%E5%88%B0%E8%B7%91%E8%B7%AF/","title":"åæ‰‹æ¥ä¸ªK8Så…¥é—¨åˆ°è·‘è·¯"},{"content":"MySQL Online DDLå¯¼è‡´å…¨å±€é”è¡¨æ¡ˆä¾‹åˆ†æ æˆ‘è¿™è¾¹é‡åˆ°äº†ä»€ä¹ˆé—®é¢˜? çº¿ä¸Šç»™æŸä¸ªè¡¨æ‰§è¡Œæ–°å¢ç´¢å¼•SQL, ç„¶åæ•´ä¸ªæ•°æ®CPUæ‰“åˆ°100%, è¿æ¥æ•°æš´å¢åˆ°æé™, æœ€åå¯¼è‡´æ‰€æœ‰è®¿é—®æ•°æ®åº“çš„åº”ç”¨éƒ½å¥”æºƒ.\nSQLå¦‚ä¸‹:\n1 2 ALTER TABLE `book` ADD INDEX `idx_sub_title` (`sub_title` ASC); èƒ½çœ‹åˆ°ä»€ä¹ˆ?\n1 2 3 4 5 \u0026#39;10063293\u0026#39;, \u0026#39;root\u0026#39;, \u0026#39;10.0.0.1:35252\u0026#39;, \u0026#39;novel\u0026#39;, \u0026#39;Query\u0026#39;, \u0026#39;50\u0026#39;, \u0026#39;Waiting for table metadata lock\u0026#39;, \u0026#39;ALTER TABLE `lemon_novel`.`book` \\nADD INDEX `idx_sub_title` (`sub_title` ASC)\u0026#39; \u0026#39;10094494\u0026#39;, \u0026#39;root\u0026#39;, \u0026#39;172.16.2.112:42808\u0026#39;, \u0026#39;novel\u0026#39;, \u0026#39;Query\u0026#39;, \u0026#39;31\u0026#39;, \u0026#39;Waiting for table metadata lock\u0026#39;, \u0026#39;SELECT \\n book_trend.book_id AS book_id, å¾ˆå¥‡æ€ª, è¿™ä¸¤è¾¹éƒ½åœ¨ç­‰\u0026quot;Waiting for table metadata lock\u0026quot;\nåæ‰‹æŸ¥ä¸€ä¸‹\u0026quot;Waiting for table metadata lock\u0026quot;æ˜¯ä»€ä¹ˆ MySQLå‡ºç°Waiting for table metadata lockçš„åŸå› ä»¥åŠè§£å†³æ–¹æ³•\nmysql: Waiting for table metadata lock\nHow do I find which transaction is causing a â€œWaiting for table metadata lockâ€ state?\nMySQL:8.11.4 Metadata Locking\nMySQL:14.13.1 Online DDL Operations\nåˆæ­¥çš„ä¸€äº›ç»“è®º çœ‹ä¸‹æ¥ä¸‹é¢çš„ä¸€äº›ç»“è®º:\nMySQL 5.6ä»¥åçš„ç‰ˆæœ¬ï¼Œæ”¯æŒåœ¨çº¿DDLï¼Œæ–°å¢index/åˆ é™¤indexä¹‹ç±»çš„å¯ä»¥ç›´æ¥InPlaceæ“ä½œï¼Œä¸éœ€è¦rebuildæ•´å¼ è¡¨ï¼Œç†è®ºä¸Šæ•ˆæœæ˜¯å¾ˆå¿«çš„ï¼Œè¯¦ç»†èµ„æ–™è§Online DDL Operations\nDDL add index æ“ä½œä¼šlock table metadataï¼Œæ­¤æ“ä½œæ˜¯å¯¼è‡´æˆ‘ä»¬æœåŠ¡ä¸å¯ç”¨çš„åŸå› \næœ‰æ€€ç–‘è¿‡lock tabel matadataå’ŒMySQL autocommitæœ‰å…³ï¼Œä½†æ˜¯å®è·µä¸‹æ¥ä¸¤è€…çœ‹èµ·æ¥æ²¡æœ‰å…³è”ã€‚\nåæ¥åœ¨é˜¿é‡Œäº‘ä¸Šé¢è¿˜çœ‹åˆ°è¿‡ä»–ä»¬ç‰¹å®šå†™è¿‡ç±»ä¼¼çš„ç­”ç–‘.\nè§£å†³MDLé”å¯¼è‡´æ— æ³•æ“ä½œæ•°æ®åº“çš„é—®é¢˜\nRDS for MySQL Online DDL ä½¿ç”¨\né˜¿é‡Œäº‘å»ºè®®ä¸»è¦æ˜¯è¿™æ ·æ“ä½œ.\nè¿™é‡Œéœ€è¦æ‰¾åˆ°çš„æ˜¯ä¸€ç›´åœ¨å ç”¨è¯¥è¡¨çš„ä¼šè¯ï¼Œè€Œä¸æ˜¯æ­£åœ¨ç­‰å¾…MDLé”è§£é™¤çš„ä¼šè¯ï¼Œæ³¨æ„åŒºåˆ†ã€‚å¯ä»¥æ ¹æ®Stateåˆ—çš„çŠ¶æ€å’ŒInfoåˆ—çš„å‘½ä»¤å†…å®¹æ¥è¿›è¡Œåˆ†æåˆ¤æ–­ã€‚\næ‚¨ä¹Ÿå¯ä»¥ç”¨å¦‚ä¸‹å‘½ä»¤æŸ¥è¯¢é•¿æ—¶é—´æœªå®Œæˆçš„äº‹åŠ¡ï¼Œå¦‚æœå¯¼è‡´é˜»å¡çš„è¯­å¥çš„ç”¨æˆ·ä¸å½“å‰ç”¨æˆ·ä¸åŒï¼Œè¯·ä½¿ç”¨å¯¼è‡´é˜»å¡çš„è¯­å¥çš„ç”¨æˆ·ç™»å½•æ¥ç»ˆæ­¢ä¼šè¯ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 select concat(\u0026#39;kill \u0026#39;,i.trx_mysql_thread_id,\u0026#39;;\u0026#39;) from information_schema.innodb_trx i, (select id, time from information_schema.processlist where time = (select max(time) from information_schema.processlist where state = \u0026#39;Waiting for table metadata lock\u0026#39; and substring(info, 1, 5) in (\u0026#39;alter\u0026#39; , \u0026#39;optim\u0026#39;, \u0026#39;repai\u0026#39;, \u0026#39;lock \u0026#39;, \u0026#39;drop \u0026#39;, \u0026#39;creat\u0026#39;))) p where timestampdiff(second, i.trx_started, now()) \u0026gt; p.time and i.trx_mysql_thread_id not in (connection_id(),p.id); ç„¶è€Œåœ¨æˆ‘çš„åœºæ™¯, ä¸Šé¢çš„SQLå¹¶æ²¡æœ‰ä»»ä½•çš„è¿›ç¨‹è¾“å‡º.\né™·å…¥åƒµå±€çš„\u0026hellip; ä¸è¿‡ä¸Šé¢ç»™äº†ä¸€äº›æ€è·¯, ç°åœ¨æˆ‘ä»¬ä¸»è¦æ˜¯å› ä¸ºæœ‰ä¸œè¥¿å ç”¨ç€ table metadata lock, å¯¼è‡´å½“å‰æ‰€æœ‰çš„ä¸œè¥¿éƒ½æ²¡æœ‰æ‰§è¡Œ.\nshow full processlist;\nçœ‹ä¸€çœ¼æ²¡ä»€ä¹ˆåµç”¨, å¤„ç†é‚£ä¸¤ä¸ªå¥‡æ€ªçš„wait lock, å…¶ä»–çš„éƒ½æŒºæ­£å¸¸çš„.\né‚£ä¹ˆ, çœ‹ä¸‹ç°åœ¨è°å ç”¨ç€é”?\næ€ä¹ˆçœ‹å‘¢?\n1 select * from information_schema.innodb_trx; ç¥å¥‡äº†, çœŸæœ‰ä¸¤ä¸ªä¸œè¥¿åœ¨å ç”¨é”.\né‚£kill äº†ä»–ä»¬çœ‹çœ‹.\né¢, è§£å†³äº†.\næœ€ç»ˆç»“è®º æŸä¸ªå¥‡æ€ªçš„ç¨‹åºå¼€äº†æŸ¥è¯¢æˆ–è€…å¥‡æ€ªçš„æ“ä½œ, lockäº† table metadata, ä¹‹åè¿æ¥ä¸€ç›´éƒ½æ²¡æœ‰è¢«é‡Šæ”¾, å¯¼è‡´ä»¥ä¸Šå„ç§é—®é¢˜.\nç°åœ¨çš„é—®é¢˜æ¥äº†, ç©¶ç«Ÿæ˜¯å“ªä¸ªç¨‹åºæˆ–è€…å“ªä¸ªä»£ç å¯¼è‡´çš„å‘¢?\næŠ±æ­‰, æˆ‘ç°åœ¨ä¹Ÿè¿˜ä¸çŸ¥é“\u0026hellip;\nç†è®ºä¸Šå¯ä»¥æŸ¥, ä½†æ˜¯ä¸Šæ¬¡å»æŸ¥çš„æ—¶å€™å‘ç°æ•°æ®åº“æ˜¾ç¤ºçš„hostå¯¹åº”æœºå™¨çš„ç«¯å£æ—©å°±æ²¡ä¸œè¥¿äº†, æ­»æ— å¯¹è¯ing.\næœ€åå»ºè®® online DDLå‰,æœ€å¥½ç¡®è®¤ä¸€ä¸‹å½“å‰æ•°æ®åº“æœ‰æ²¡æœ‰ç±»ä¼¼lockå­˜åœ¨\næœ€å¥½çš„æ–¹æ¡ˆè¿˜æ˜¯ä¸»ä»åˆ‡æ¢æ¥æ\nå…¨æ–‡å®Œ.\n","date":"2019-05-11T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/mysql-online-ddl%E5%AF%BC%E8%87%B4%E5%85%A8%E5%B1%80%E9%94%81%E8%A1%A8%E6%A1%88%E4%BE%8B%E5%88%86%E6%9E%90/","title":"MySQL Online DDLå¯¼è‡´å…¨å±€é”è¡¨æ¡ˆä¾‹åˆ†æ"},{"content":"Mac OS X å®‰è£… pycryptoæŠ¥ Clang not found \u0026lsquo;stdio.h\u0026rsquo; error è£…ä¸€ä¸ªPythonåŒ…çš„æ—¶å€™ç”¨åˆ°äº†Clangç¼–è¯‘Cåº“, ç„¶åä¸€ç›´æŠ¥\n1 2 3 4 5 6 7 clang-4.0: warning: argument unused during compilation: \u0026#39;-L/usr/local/lib\u0026#39; [-Wunused-command-line-argument] src/_fastmath.c:29:10: fatal error: \u0026#39;stdio.h\u0026#39; file not found #include \u0026lt;stdio.h\u0026gt; ^~~~~~~~~ 1 error generated. error: command \u0026#39;clang\u0026#39; failed with exit status 1 è§é¬¼, è¿™ä¸æ˜¯Cæœ€é€šç”¨çš„åº“ä¹ˆ? å’‹è¿˜èƒ½æ‰¾ä¸åˆ°.\næ£€æŸ¥ä¸€ä¸‹clangç‰ˆæœ¬.\n1 2 3 4 5 âœ src git:(develop) clang --version clang version 4.0.1 (tags/RELEASE_401/final)Target: x86_64-apple-darwin18.5.0 Thread model: posix InstalledDir: /usr/local/opt/llvm@4/bin æŒºæ­£å¸¸çš„\u0026hellip;\næœ‰äººè¯´åå¢ƒå˜é‡é—®é¢˜, å¯¼å…¥ä¸€ä¸‹è¯•è¯•.\n1 export \u0026#34;CFLAGS=-I/usr/local/include -L/usr/local/lib\u0026#34; æ— æœ.\nåˆç¿»äº†ä¸€éstackoverflow..\næ‰¾åˆ°äº†è¿™ä¸ª.\n1 2 3 cd /Library/Developer/CommandLineTools/Packages open macOS_SDK_headers_for_macOS_xx.pgk # macOS_SDK_headers_for_macOS_xx.pgk å¯¹åº”è‡ªå·±çš„ç³»ç»Ÿç‰ˆæœ¬ è·³å‡ºå®‰è£…ç•Œé¢, ç‚¹ç‚¹ç‚¹\u0026hellip;\nIt work!\næ„‰å¿«å®‰è£… pip install pycrypto.\n","date":"2019-05-09T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/mac-os-x-%E5%AE%89%E8%A3%85-pycrypto%E6%8A%A5-clang-not-found-stdio.h-error/","title":"Mac OS X å®‰è£… pycryptoæŠ¥ Clang not found 'stdio.h' error"},{"content":".NET Coreæ•™ç¨‹\u0026ndash;ç»™APIåŠ ä¸€ä¸ªæœåŠ¡ç«¯ç¼“å­˜å•¦ ä»¥å‰ç»™APIæ¥å£å†™ç¼“å­˜åŸºæœ¬éƒ½æ˜¯è¿™æ ·å†™ä»£ç :\n1 2 3 4 5 6 7 8 9 10 11 12 // redis key var bookRedisKey = ConstRedisKey.RecommendationBooks.CopyOne(bookId); // è·å–ç¼“å­˜æ•°æ® var cacheBookIds = _redisService.ReadCache\u0026lt;List\u0026lt;string\u0026gt;\u0026gt;(bookRedisKey); if (cacheBookIds != null) { // return } else { // æ‰§è¡Œå¦å¤–çš„é€»è¾‘è·å–æ•°æ®, ç„¶åå†™å…¥ç¼“å­˜ } ç„¶åæŠŠè¿™ä¸€å¨å¨ä»£ç éƒ½æ•£è½åœ¨æ¯ä¸ªåœ°æ–¹ã€‚\næŸä¸€å¤©ï¼Œçªç„¶æƒ³èµ·æˆ‘è¿™è¾¹çš„ç¼“å­˜åŸºæœ¬æ—¶é—´éƒ½å·®ä¸å¤šï¼Œè€Œä¸”éƒ½æ˜¯ç»™Web APIç”¨çš„ï¼Œ\nç›´æ¥åœ¨APIå±‚æ”¯æŒç¼“å­˜ä¸å°±å®Œäº‹äº†ã€‚\næ‰€ä»¥ï¼Œ è¿™é‡Œç”¨ä»€ä¹ˆæ¥åšå‘¢ã€‚\nåœ¨.NET Core Web APIè¿™é‡Œçš„è¯, ä¸¤ç§æ€è·¯:Middleware æˆ–è€…ActionFilter.\nä¸äº†è§£çš„åŒå­¦å¯ä»¥çœ‹ä¸‹é¢çš„æ–‡æ¡£:\nASP.NET Core ä¸­æ–‡æ–‡æ¡£ ç¬¬å››ç«  MVCï¼ˆ4.3ï¼‰è¿‡æ»¤å™¨\nASP.NET Core ä¸­æ–‡æ–‡æ¡£ ç¬¬ä¸‰ç«  åŸç†ï¼ˆ2ï¼‰ä¸­é—´ä»¶\nåŸºäºæˆ‘è¿™è¾¹åªæ˜¯éƒ¨åˆ†æ¥å£æ”¯æŒç¼“å­˜çš„è¯, ç›´æ¥è¿˜æ˜¯ç”¨ActionFilterå®ç°å°±å¯ä»¥.\næ²¡æ’’è¯´çš„, ç›´æ¥ä¸Šä»£ç .\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 using System; using Microsoft.AspNetCore.Http; using Microsoft.AspNetCore.Mvc; using Microsoft.AspNetCore.Mvc.Filters; using Newtonsoft.Json.Linq; namespace XXXAPI.Filters { public class DefaultCacheFilterAttribute : ActionFilterAttribute { // è¿™ä¸ªæ—¶é—´ç”¨äºç»™å­ç±»é‡å†™,å®ç°ä¸åŒæ—¶é—´çº§åˆ«çš„ç¼“å­˜ protected TimeSpan _expireTime; // redisè¯»å†™çš„ç±»,æ²¡æ’’çœ‹çš„ private readonly RedisService _redisService; public DefaultCacheFilterAttribute(RedisService redisService) { _redisService = redisService; } public override void OnActionExecuting(ActionExecutingContext context) { if (context.HttpContext.Request.Query.ContainsKey(\u0026#34;refresh\u0026#34;)) { return; } KeyConfig redisKey = GetRequestRedisKey(context.HttpContext); var redisCache = _redisService.ReadCache\u0026lt;JToken\u0026gt;(redisKey); if (redisCache != null) { context.Result = new ObjectResult(redisCache); } return; } public override void OnActionExecuted(ActionExecutedContext context) { KeyConfig redisKey = GetRequestRedisKey(context.HttpContext); var objResult = (ObjectResult)context.Result; if (objResult == null) { return; } var jToken = JToken.FromObject(objResult.Value); _redisService.WriteCache(redisKey, jToken); } private KeyConfig GetRequestRedisKey(HttpContext httpContext) { var requestPath = httpContext.Request.Path.Value; if (!string.IsNullOrEmpty(httpContext.Request.QueryString.Value)) { requestPath = requestPath + httpContext.Request.QueryString.Value; } if (httpContext.Request.Query.ContainsKey(\u0026#34;refresh\u0026#34;)) { if (httpContext.Request.Query.Count == 1) { requestPath = requestPath.Replace(\u0026#34;?refresh=true\u0026#34;, \u0026#34;\u0026#34;); } else { requestPath = requestPath.Replace(\u0026#34;refresh=true\u0026#34;, \u0026#34;\u0026#34;); } } // è¿™é‡Œä¹Ÿå°±ä¸€ä¸ªredis keyçš„ç±» var redisKey = ConstRedisKey.HTTPRequest.CopyOne(requestPath); if (_expireTime != default(TimeSpan)) { redisKey.ExpireTime = _expireTime; } return redisKey; } } public static class ConstRedisKey { public readonly static KeyConfig HTTPRequest = new KeyConfig() { Key = \u0026#34;lemon_req_\u0026#34;, ExpireTime = new TimeSpan(TimeSpan.TicksPerMinute * 30), DBName = 5 }; } public class KeyConfig { public string Key { get; set; } public TimeSpan ExpireTime { get; set; } public int DBName { get; set; } public KeyConfig CopyOne(string state) { var one = new KeyConfig(); one.DBName = this.DBName; one.Key = !string.IsNullOrEmpty(this.Key) ? this.Key + state : state; one.ExpireTime = this.ExpireTime; return one; } } } ç„¶åä½¿ç”¨çš„åœ°æ–¹, ç›´æ¥ç»™Controllerçš„Actionæ–¹æ³•åŠ ä¸Šæ³¨è§£å³å¯.\nå¦‚:\n1 2 3 4 5 6 7 8 9 10 [HttpGet(\u0026#34;v1/xxx/latest\u0026#34;)] [ServiceFilter(typeof(DefaultCacheFilterAttribute))] public IActionResult GetLatestList([FromQuery] int page = 0, [FromQuery]int pageSize = 30) { return Ok(new { data = _service.LoadLatest(page, pageSize), code = 0 }); } å®Œäº‹\u0026hellip;\nå“¦, è®°å¾—åœ¨Startup.csæ³¨å…¥ DefaultCacheFilterAttribute.\nè¿™ä¸ªæ³¨å…¥å°±ä¸ç”¨æˆ‘æ¥å†™çš„å§.\nç¾ä¸­ä¸è¶³çš„åœ°æ–¹åœ¨äºæš‚æ—¶è¿˜ä¸çŸ¥é“æ€ä¹ˆç›´æ¥åœ¨æ³¨è§£ä¸Šé¢æ”¯æŒè‡ªå®šä¹‰ç¼“å­˜æ—¶é—´,\nå‡‘åˆå…ˆç”¨äº†.\nå®Œç»“, æ‹œ\u0026hellip;..\n","date":"2019-05-05T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/.net-core%E6%95%99%E7%A8%8B--%E7%BB%99api%E5%8A%A0%E4%B8%80%E4%B8%AA%E6%9C%8D%E5%8A%A1%E7%AB%AF%E7%BC%93%E5%AD%98%E5%95%A6/","title":".NET Coreæ•™ç¨‹--ç»™APIåŠ ä¸€ä¸ªæœåŠ¡ç«¯ç¼“å­˜å•¦"},{"content":".NET Coreå•å…ƒæµ‹è¯•ä¹‹ææ­»å¼€å‘çš„è¦†ç›–ç‡ç»Ÿè®¡ è¿™ä¸¤å¤©åœ¨ç»™é¡¹ç›®è¡¥å•å…ƒæµ‹è¯•ï¼Œdalaoä»¬è¦æ±‚\bè¦çœ‹ä¸€ä¸‹æµ‹è¯•è¦†ç›–ç‡\nç¿»äº†ä¸€æ³¢å®˜æ–¹testå‘½ä»¤è¦†ç›–ç‡å€’æ˜¯æœ‰æ”¯æŒäº†ï¼Œç„¶è€ŒæŸä¸ªæ›´æ–°æ—¥å¿—é‡Œé¢å†™ç€\nã€â€œSupport for Linux and Mac will be considered separately in a subsequent effort.â€ã€‘\nåè¡€ingã€‚ã€‚ã€‚\n8102å¹´éƒ½è¦è¿‡å»äº†ï¼Œå¾®è½¯åŒå­¦ä½ æ˜¯ä¸æœ‰ç‚¹è¿‡åˆ†å•Šã€‚\nç„¶ååˆç¿»äº†ä¸€å †èµ„æ–™ä¹‹åå‘ç°ï¼ŒGitHubæœ‰dalaoè‡ªå·±æäº†ä¸ªcoverletæ¥æ”¯æŒæµ‹è¯•è¦†ç›–ç‡ã€‚\nå¼€æºå¤§æ³•æ‹¯æ•‘ä¸–ç•Œå•Šï¼ï¼ï¼\nstarä¸€ä¸ªå†è¯´ã€‚\ncoverleté…ç½®å’Œä½¿ç”¨ é¦–å…ˆå®‰è£…ä¸€ä¸‹coverlet.\n1 2 dotnet tool install --global coverlet.console æˆ–è€…å’Œæˆ‘ä¸€æ ·æ‡’çš„è¯,ç›´æ¥åœ¨é¡¹ç›®é‡Œé¢å¼•ç”¨ \u0026ldquo;coverlet.msbuild\u0026rdquo; è¿™ä¸ªåŒ…ä¹Ÿè¡Œ.\n1 \u0026lt;PackageReference Include=\u0026#34;coverlet.msbuild\u0026#34; Version=\u0026#34;2.5.0\u0026#34; /\u0026gt; å¼•ç”¨ä¹‹å,æ‰§è¡Œdotnet test çš„æ—¶å€™åŠ å¤šä¸‰ä¸ªå‚æ•°\n1 dotnet test /p:CollectCoverage=true /p:CoverletOutput=\u0026#39;./results/\u0026#39; /p:CoverletOutputFormat=opencover CollectCoverage æ”¶é›†è¦†ç›–ç‡\nCoverletOutput æµ‹è¯•æŠ¥å‘Šæ•°æ®è¾“å‡ºè·¯å¾„\nCoverletOutputFormat æµ‹è¯•æŠ¥å‘Šæ ¼å¼,æ”¯æŒè¿™äº›æ ¼å¼json (default)/lcov/opencover/cobertura/teamcity\nå…¶ä»–å‚æ•°è‡ªå·±çœ‹ä¸€ä¸‹æ–‡æ¡£è¯´æ˜å°±å¥½.\næ‰§è¡Œä¹‹åå¤§æ¦‚ä¼šçœ‹åˆ°è¿™äº›ä¿¡æ¯.\nPS:å¯æ€œçš„ä¸ªä½æ•°è¦†ç›–ç‡\u0026hellip;.\nè¿™ä¸ªæ—¶å€™Testé¡¹ç›®é‡Œé¢çš„results æ–‡ä»¶å¤¹é‡Œé¢å°±æœ‰ä¸€ä¸ªcoverage.opencover.xml æ–‡ä»¶äº†.\næ‰“å¼€è¿™ä¸ªæ–‡ä»¶å¤§æ¦‚é•¿è¿™ä¸ªæ ·.\nå¤§æ¦‚ç‡è¿™ä¸æ˜¯äººçœ‹çš„ä¸œè¥¿.\nç„¶åå¦ä¸€ä¸ªå·¥å…·åˆå‡ºæ¥äº†.\nReportGenerator https://github.com/danielpalme/ReportGenerator\nReportGenerator converts XML reports generated by OpenCover, PartCover, dotCover, Visual Studio, NCover, Cobertura or JaCoCo into human readable reports in various formats. è¿™ä¸ªå·¥å…·å¯ä»¥è®²ä¸Šé¢è¿™äº›ä¸æ˜¯äººçœ‹çš„XMLè½¬æ¢æˆHTMLè¾“å‡º.\nç¾æ»‹æ»‹å•Šç¾æ»‹æ»‹å•Š.\nä»–ä»¬å±…ç„¶è¿˜æœ‰ä¸€ä¸ªé…ç½®æŒ‡å¯¼çš„é¡µé¢ReportGenerator/usage\nçœŸè‰¯å¿ƒ!!!\næˆ‘è¿™è¾¹ç®€å•èµ·è§,ç›´æ¥å®‰è£… dotnet tool å…¨å±€å·¥å…·ç®—äº†.\n1 dotnet tool install --global dotnet-reportgenerator-globaltool å®‰è£…å¥½äº†ä¹‹å,ç›´æ¥åœ¨å‘½ä»¤è¡Œé‡Œé¢ä½¿ç”¨ reportgenerator ç”Ÿæˆå¯¹åº”çš„æµ‹è¯•æŠ¥å‘Šå³å¯.æˆ‘è¿™è¾¹çš„å‘½ä»¤å¤§æ¦‚æ˜¯:\n1 reportgenerator \u0026#39;-reports:UnitTests/results/*.xml\u0026#39; \u0026#39;-targetdir:UnitTests/results\u0026#39; æ‰“å¼€UnitTests/results ä¸‹é¢çš„index.htmå°±èƒ½çœ‹åˆ°å¯¹åº”çš„æµ‹è¯•æŠ¥å‘Šäº†.\nå…¨æ–‡å®Œ.\n\bæ˜å¹´è§ï¼\n","date":"2019-04-08T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/.net-core%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95%E4%B9%8B%E6%90%9E%E6%AD%BB%E5%BC%80%E5%8F%91%E7%9A%84%E8%A6%86%E7%9B%96%E7%8E%87%E7%BB%9F%E8%AE%A1coverlet--reportgenerator/","title":".NET Coreå•å…ƒæµ‹è¯•ä¹‹ææ­»å¼€å‘çš„è¦†ç›–ç‡ç»Ÿè®¡ï¼ˆcoverlet + ReportGenerator ï¼‰"},{"content":"ä»»åŠ¡é˜Ÿåˆ—å’Œå¼‚æ­¥æ¥å£çš„æ­£ç¡®æ‰“å¼€æ–¹å¼ ä»€ä¹ˆæ˜¯å¼‚æ­¥æ¥å£? Asynchronous Operations Certain types of operations might require processing of the request in an asynchronous manner (e.g. validating a bank account, processing an image, etc.) in order to avoid long delays on the client side and prevent long-standing open client connections waiting for the operations to complete. For such use cases, APIs MUST employ the following pattern:\nFor POST requests:\nReturn the 202 Accepted HTTP response code.\nIn the response body, include one or more URIs as hypermedia links, which could include:\nThe final URI of the resource where it will be available in future if the ID and path are already known. Clients can then make an HTTP GET request to that URI in order to obtain the completed resource. Until the resource is ready, the final URI SHOULD return the HTTP status code 404 Not Found. { \u0026quot;rel\u0026quot;: \u0026quot;self\u0026quot;, \u0026quot;href\u0026quot;: \u0026quot;/v1/namespace/resources/{resource_id}\u0026quot;, \u0026quot;method\u0026quot;: \u0026quot;GET\u0026quot; }\nA temporary request queue URI where the status of the operation may be obtained via some temporary identifier. Clients SHOULD make an HTTP GET request to obtain the status of the operation which MAY include such information as completion state, ETA, and final URI once it is completed. { \u0026quot;rel\u0026quot;: \u0026quot;self\u0026quot;, \u0026quot;href\u0026quot;: \u0026quot;/v1/queue/requests/{request_id}, \u0026quot;method\u0026quot;: \u0026quot;GET\u0026quot; }\u0026quot;\nFor PUT/PATCH/DELETE/GET requests:\nLike POST, you can support PUT/PATCH/DELETE/GET to be asynchronous. The behaviour would be as follows:\nReturn the 202 Accepted HTTP response code.\nIn the response body, include one or more URIs as hypermedia links, which could include:\nA temporary request queue URI where the status of the operation may be obtained via some temporary identifier. Clients SHOULD make an HTTP GET request to obtain the status of the operation which MAY include such information as completion state, ETA, and final URI once it is completed. { \u0026quot;rel\u0026quot;: \u0026quot;self\u0026quot;, \u0026quot;href\u0026quot;: \u0026quot;/v1/queue/requests/{request_id}, \u0026quot;method\u0026quot;: \u0026quot;GET\u0026quot; }\u0026quot;\nAPIs that support both synchronous and asynchronous processing for an URI:\nAPIs that support both synchronous and asynchronous operations for a particular URI and an HTTP method combination, MUST recognize the Prefer header and exhibit following behavior:\nIf the request contains a Prefer=respond-async header, the service MUST switch the processing to asynchronous mode. If the request doesn\u0026rsquo;t contain a Prefer=respond-async header, the service MUST process the request synchronously. It is desirable that all APIs that implement asynchronous processing, also support webhooks as a mechanism of pushing the processing status to the client.\nèµ„æ–™å¼•è‡ª:paypal/API Design Patterns And Use Cases:asynchronous-operations\nç”¨äººè¯æ¥è¯´ ç®€å•æ¥è¯´å°±æ˜¯è¯·æ±‚è¿‡æ¥,ç›´æ¥è¿”å›å¯¹åº”çš„resourceId/request_id,ç„¶åå¯ä»¥é€šè¿‡resourceId/request_idæŸ¥è¯¢å¤„ç†ç»“æœ\nå¤„ç†\bè¿‡ç¨‹å¯èƒ½æ˜¯é˜Ÿåˆ—,ä¹Ÿå¯èƒ½ç›´æ¥æ˜¯å¼‚æ­¥æ“ä½œ\nå¦‚æœè¿˜æ²¡å®Œæˆå¤„ç†,è¿”å›404,å¦‚æœå¤„ç†å®Œæˆ,æ­£å¸¸è¿”å›å¯¹åº”æ•°æ®\nå¥½åƒä¹Ÿæ²¡ä»€ä¹ˆè®²äº†\u0026hellip;.\nå…¨æ–‡ç»“æŸå§.\næ ·ä¾‹ä»£ç éƒ¨åˆ†å•¦ å®ç°é€»è¾‘ åˆ›å»ºä»»åŠ¡,ç”Ÿæˆ\u0026quot;request-id\u0026quot;å­˜å‚¨åˆ°å¯¹åº”redis zseté˜Ÿåˆ—ä¸­\nåŒæ—¶å¾€redis channelå‘å‡ºä»»åŠ¡æ¶ˆæ¯, åå°ä»»åŠ¡å¤„ç†æœåŠ¡è‡ªè¡Œå¤„ç†æ­¤æ¶ˆæ¯(ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å¼)\nä»»åŠ¡å¤„ç†æœåŠ¡å¤„ç†å®Œæ¶ˆæ¯ä¹‹å,å°†å¤„ç†ç»“æœå†™å…¥redis,request-idä¸ºkey,ç»“æœä¸ºvalue,ç„¶åä»ä»redis zsetä»ç§»é™¤å¯¹åº”çš„\u0026quot;request-id\u0026quot;\nè·å–request-idå¤„ç†ç»“æœæ—¶:å¦‚æœrequest-idèƒ½æŸ¥è¯¢åˆ°å¯¹åº”çš„ä»»åŠ¡å¤„ç†ç»“æœ,ç›´æ¥è¿”å›å¤„ç†å®Œçš„æ•°æ®; å¦‚æœrequest-idè¿˜åœ¨sortseté˜Ÿåˆ—åˆ™ç›´æ¥è¿”å›404 + å¯¹åº”çš„ä½ç½®n,è¡¨ç¤ºè¿˜åœ¨å¤„ç†ä¸­,å‰é¢è¿˜æœ‰nä¸ªè¯·æ±‚;\næ—¶åºå›¾å¤§æ¦‚é•¿è¿™æ ·:\nå–œé—»ä¹è§ä»£ç æ—¶é—´ RequestService.cs\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 // RequestService.cs using System; using System.Collections.Generic; using System.Linq; using System.Threading.Tasks; using CorrelationId; using Microsoft.AspNetCore.Mvc; using Microsoft.Extensions.DependencyInjection; using Microsoft.Extensions.Logging; using Newtonsoft.Json.Linq; using StackExchange.Redis; using static StackExchange.Redis.RedisChannel; namespace MTQueue.Service { public class RequestService { private readonly ICorrelationContextAccessor _correlationContext; private readonly ConnectionMultiplexer _redisMultiplexer; private readonly IServiceProvider _services; private readonly ILogger\u0026lt;RequestService\u0026gt; _logger; public RequestService(ICorrelationContextAccessor correlationContext, ConnectionMultiplexer redisMultiplexer, IServiceProvider services, ILogger\u0026lt;RequestService\u0026gt; logger) { _correlationContext = correlationContext; _redisMultiplexer = redisMultiplexer; _services = services; _logger = logger; } public long? AddRequest(JToken data) { var requestId = _correlationContext.CorrelationContext.CorrelationId; var redisDB = _redisMultiplexer.GetDatabase(CommonConst.DEFAULT_DB); var index = redisDB.SortedSetRank(CommonConst.REQUESTS_SORT_SETKEY, requestId); if (index == null) { data[\u0026#34;requestId\u0026#34;] = requestId; redisDB.SortedSetAdd(CommonConst.REQUESTS_SORT_SETKEY, requestId, GetTotalSeconds()); PushRedisMessage(data.ToString()); } return redisDB.SortedSetRank(CommonConst.REQUESTS_SORT_SETKEY, requestId); } public static long GetTotalSeconds() { return (long)(DateTime.Now.ToLocalTime() - new DateTime(1970, 1, 1).ToLocalTime()).TotalSeconds; } private void PushRedisMessage(string message) { Task.Run(() =\u0026gt; { try { using (var scope = _services.CreateScope()) { var multiplexer = scope.ServiceProvider.GetRequiredService\u0026lt;ConnectionMultiplexer\u0026gt;(); multiplexer.GetSubscriber().PublishAsync(CommonConst.REQUEST_CHANNEL, message); } } catch (Exception ex) { _logger.LogError(-1, ex, message); } }); } public Tuple\u0026lt;JToken, long?\u0026gt; GetRequest(string requestId) { var redisDB = _redisMultiplexer.GetDatabase(CommonConst.DEFAULT_DB); var keyIndex = redisDB.SortedSetRank(CommonConst.REQUESTS_SORT_SETKEY, requestId); var response = redisDB.StringGet(requestId); if (response.IsNull) { return Tuple.Create\u0026lt;JToken, long?\u0026gt;(default(JToken), keyIndex); } return Tuple.Create\u0026lt;JToken, long?\u0026gt;(JToken.Parse(response), keyIndex); } } } 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 // RedisMQListener.cs using System; using System.Text; using System.Threading; using System.Threading.Tasks; using Microsoft.Extensions.DependencyInjection; using Microsoft.Extensions.Hosting; using Microsoft.Extensions.Logging; using Microsoft.Extensions.Options; using MTQueue.Model; using MTQueue.Service; using Newtonsoft.Json.Linq; using StackExchange.Redis; using static StackExchange.Redis.RedisChannel; namespace MTQueue.Listener { public class RedisMQListener : IHostedService { private readonly ConnectionMultiplexer _redisMultiplexer; private readonly IServiceProvider _services; private readonly ILogger\u0026lt;RedisMQListener\u0026gt; _logger; public RedisMQListener(IServiceProvider services, ConnectionMultiplexer redisMultiplexer, ILogger\u0026lt;RedisMQListener\u0026gt; logger) { _services = services; _redisMultiplexer = redisMultiplexer; _logger = logger; } public Task StartAsync(CancellationToken cancellationToken) { Register(); return Task.CompletedTask; } public virtual bool Process(RedisChannel ch, RedisValue message) { _logger.LogInformation(\u0026#34;Process start,message: \u0026#34; + message); var redisDB = _services.GetRequiredService\u0026lt;ConnectionMultiplexer\u0026gt;() .GetDatabase(CommonConst.DEFAULT_DB); var messageJson = JToken.Parse(message); var requestId = messageJson[\u0026#34;requestId\u0026#34;]?.ToString(); if (string.IsNullOrEmpty(requestId)) { _logger.LogWarning(\u0026#34;requestId not in message.\u0026#34;); return false; } var mtAgent = _services.GetRequiredService\u0026lt;ZhihuClient\u0026gt;(); var text = mtAgent.GetZhuanlan(messageJson); redisDB.StringSet(requestId, text.ToString(), CommonConst.RESPONSE_TS); _logger.LogInformation(\u0026#34;Process finish,requestId:\u0026#34; + requestId); redisDB.SortedSetRemove(CommonConst.REQUESTS_SORT_SETKEY, requestId); return true; } public void Register() { var sub = _redisMultiplexer.GetSubscriber(); var channel = CommonConst.REQUEST_CHANNEL; sub.SubscribeAsync(channel, (ch, value) =\u0026gt; { Process(ch, value); }); } public void DeRegister() { // this.connection.Close(); } public Task StopAsync(CancellationToken cancellationToken) { // this.connection.Close(); return Task.CompletedTask; } } } 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 // RequestsController.cs using System; using System.Collections.Generic; using System.Linq; using System.Threading.Tasks; using CorrelationId; using Microsoft.AspNetCore.Mvc; using MTQueue.Service; using Newtonsoft.Json.Linq; namespace MTQueue.Controllers { [Route(\u0026#34;v1/[controller]\u0026#34;)] [ApiController] public class RequestsController : ControllerBase { private readonly ICorrelationContextAccessor _correlationContext; private readonly RequestService _requestService; private readonly ZhihuClient _mtAgentClient; public RequestsController(ICorrelationContextAccessor correlationContext, RequestService requestService, ZhihuClient mtAgentClient) { _correlationContext = correlationContext; _requestService = requestService; _mtAgentClient = mtAgentClient; } [HttpGet(\u0026#34;{requestId}\u0026#34;)] public IActionResult Get(string requestId) { var result = _requestService.GetRequest(requestId); var resource = $\u0026#34;/v1/requests/{requestId}\u0026#34;; if (result.Item1 == default(JToken)) { return NotFound(new { rel = \u0026#34;self\u0026#34;, href = resource, method = \u0026#34;GET\u0026#34;, index = result.Item2 }); } return Ok(result.Item1); } [HttpPost] public IActionResult Post([FromBody] JToken data, [FromHeader(Name = \u0026#34;Prefer\u0026#34;)]string prefer) { if (!string.IsNullOrEmpty(prefer) \u0026amp;\u0026amp; prefer == \u0026#34;respond-async\u0026#34;) { var index = _requestService.AddRequest(data); var requestId = _correlationContext.CorrelationContext.CorrelationId; var resource = $\u0026#34;/v1/requests/{requestId}\u0026#34;; return Accepted(resource, new { rel = \u0026#34;self\u0026#34;, href = resource, method = \u0026#34;GET\u0026#34;, index = index }); } return Ok(_mtAgentClient.GetZhuanlan(data)); } } } å®Œæ•´ä»£ç è§:https://github.com/liguobao/TaskQueueSample\n","date":"2019-04-05T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/%E4%BB%BB%E5%8A%A1%E9%98%9F%E5%88%97%E5%92%8C%E5%BC%82%E6%AD%A5%E6%8E%A5%E5%8F%A3%E7%9A%84%E6%AD%A3%E7%A1%AE%E6%89%93%E5%BC%80%E6%96%B9%E5%BC%8F.net-core%E7%89%88%E6%9C%AC/","title":"ä»»åŠ¡é˜Ÿåˆ—å’Œå¼‚æ­¥æ¥å£çš„æ­£ç¡®æ‰“å¼€æ–¹å¼(.NET Coreç‰ˆæœ¬)"},{"content":"æ²¡æœ‰æ‰§è¡Œè¿‡rm -rf /*çš„å¼€å‘ä¸æ˜¯å¥½è¿ç»´ èµ·å›  çªç„¶æ”¶åˆ°ç”¨æˆ·åé¦ˆè¯´ç½‘ç«™åœ¨æ‰‹æœºç«¯æ‰“å¼€æ˜¯ç™½å±, å¾ˆå¥‡æ€ªçš„é—®é¢˜.\nåœ¨ç”µè„‘ç«¯è¯•äº†ä¸‹,ç¡®å®ä¹Ÿæ˜¯ç™½å±,HTMLåŠ è½½è¿›æ¥äº†,å¥½åƒæœ‰ä¸ªæ ¸å¿ƒJSåŠ è½½å¤±è´¥.\nçœ‹åˆ°ä¸€ä¸ªé”™è¯¯æ˜¯: We\u0026rsquo;re sorry but house doesn\u0026rsquo;t work properly without JavaScript enabled. Please enable it to continue.\nè¿˜æœ‰ä¸€ä¸ªhttpè¯·æ±‚çš„é”™è¯¯æ˜¯: ERR_INCOMPLETE_CHUNKED_ENCODING\näºæ˜¯å°è¯•äº†ä¸€ä¸‹çš„è§£å†³æ–¹æ¡ˆ:\næ— è„‘é‡å¯çœ‹çœ‹èƒ½ä¸èƒ½è§£å†³é—®é¢˜?é‡å¯äº†ä¸€ä¸‹å¯¹åº”Dockerå®¹å™¨,æ— æœ\nå¯èƒ½æ˜¯ç°åœ¨ç‰ˆæœ¬å¼•å…¥çš„Bug?å›æ»šä»£ç é‡æ–°build,æ— æœ.\nnginxçš„é—®é¢˜? é‡å¯nginx,æ— æœ.\næŸ¥çœ‹nginxæ—¥å¿—,æ²¡ä»€ä¹ˆæœ‰ç”¨çš„ä¸œè¥¿,æ— æœ.\nçµæœºä¸€é—ª,ä¸ä¼šæ˜¯ç£ç›˜ç©ºé—´æ»¡äº†å§.\ndf -h çœ‹äº†ä¸€çœ¼,99.99%çš„ç£ç›˜ä½¿ç”¨ç‡.\næŸä¸ªDockerå®¹å™¨çš„ç£ç›˜ç©ºé—´ç”¨æ‰äº†34G.\nçœ‹ä¸€çœ¼Dockerå®¹å™¨,ç›´è§‰å‘Šè¯‰æˆ‘åº”è¯¥æ˜¯ElasticsearchæœåŠ¡\u0026hellip;\nä¸ç®—å¤ªé‡è¦çš„æœåŠ¡,å…ˆåœäº†æ¸…ç†ç©ºé—´å†è¯´.\nåˆ æ‰äº†å®¹å™¨åˆ äº†dataæ–‡ä»¶,é‡å¯nginx,ä¸€åˆ‡éƒ½æ­£å¸¸Workäº†.\né—®é¢˜è§£å†³!!!\nä¸è¿‡Elasticsearchæ€»è¦é‡æ–°å›å¤å›æ¥å˜›,çœ‹äº†ä¸‹è…¾è®¯äº‘äº‘ç¡¬ç›˜ç›˜ä»·æ ¼,ä¹Ÿä¸æ˜¯å¾ˆè´µå˜›.\nå•ç‹¬ç»™Elasticsearch èµ·ä¸ªæ•°æ®ç›˜å§.\nä½œæ­»å¼€å§‹ é¦–å…ˆæ ¹æ®è…¾è®¯äº‘çš„æŒ‡ç¤º,æŒ‚åœ¨äº†æ•°æ®ç›˜åˆ°æœåŠ¡å™¨ä¸Šé¢.\nç„¶åç»™æ•°æ®ç›˜åˆ†åŒº,æ¥ç€mountåˆ°å¯¹åº”çš„è·¯å¾„.\nå—¯,å¥½åƒæœ‰ä¸ªè­¦å‘Š.\néš¾é“ä¸æ˜¯è¿™ä¸ªç£ç›˜ä¹ˆ?æ¢å¦å¤–ä¸€ä¸ªçœ‹çœ‹.\næ‰§è¡Œå¦å¤–ä¸€ä¸ªmount.\nå…¨ç¨‹\bå‘½ä»¤å¦‚ä¸‹:\nè¿›å…¥å¯¹åº”ç›®å½•æ¸…ç©ºä¸€ä¸‹äº‘ç›˜æ•°æ®å§.(PS:è„‘å­æœ‰ç—…æ‰åšè¿™ä¸ª,åˆšåˆšåˆå§‹åŒ–çš„äº‘ç›˜å“ªæœ‰ä¸œè¥¿.)\nls çœ‹ä¸€ä¸‹,å’‹è¿™ä¹ˆå¤šå¥‡å¥‡æ€ªæ€ªçš„æ–‡ä»¶,éš¾é“æ˜¯\båŸæ¥Elasticsearch\b docker å®¹å™¨ç•™ä¸‹æ¥çš„.\nå…ˆåˆ äº†å†è¯´.\næ‰§è¡Œ rm -rf ./*\nå’¦,æ€ä¹ˆæœ‰æ–‡ä»¶busyæ— æ³•åˆ é™¤.\n\bé¢,å’‹lséƒ½æ²¡æœ‰äº†.\nå“ˆ?cat ä¹Ÿæ²¡æœ‰äº†.\nå™—,copyä¹Ÿç‚¸äº†.\ncd\b è¿˜åœ¨.\nå“‡å¡,\b\bè¿™å¯å’‹åŠäº†.\nå…ˆå¤ç›˜ä¸€ä¸‹åšäº†ä»€ä¹ˆäº‹æƒ… åˆå§‹åŒ–ç£ç›˜çš„æ—¶å€™æ²¡æœ‰æ ¼å¼åŒ–,ä½†æ˜¯mountå¤±è´¥\nmountå¤±è´¥åæ²¡æœ‰æ£€æŸ¥åŸå› ,ç›´æ¥å°è¯•æŠŠå¦ä¸€ä¸ªç£ç›˜mountè¿›å»\nmountç³»ç»Ÿç›˜åˆ°æŒ‡å®šæ–‡ä»¶å¤¹åå¹¶æ²¡æœ‰æ£€æŸ¥å†…å®¹,ç›´æ¥rm -rf ./*\nrm -rf ./* æ­¤æ—¶å·²ç»åŸºæœ¬æ²¡æ•‘äº†\næ‹¯æ•‘å°è¯• è¿˜åœ¨è·‘çš„æœåŠ¡åŸºæœ¬æ˜¯æ´»ç€çš„ï¼Œæ‰€ä»¥æš‚æ—¶æ¥è¯´APIå’ŒWebç½‘ç«™éƒ½æ˜¯å¥½çš„ã€‚\næœåŠ¡å™¨ä¸Šé¢è·‘çš„åŸºæœ¬éƒ½æ˜¯Dockerå®¹å™¨, Dockeré•œåƒéƒ½åœ¨é˜¿é‡Œäº‘ä¸Šé¢å­˜ç€ï¼ŒåŸºæœ¬ä¸æ€•ä¸¢å¤±çš„é—®é¢˜ã€‚\nä¸è¿‡åº”ç”¨é…ç½®æ–‡ä»¶/æœåŠ¡å™¨è¯ä¹¦ä¹‹ç±»çš„ä¸œè¥¿éƒ½åœ¨ä¸Šé¢ï¼Œè¿™ä¸ªä¼°è®¡è¦æŠ˜è…¾ä¸€ä¸‹äº†ã€‚\ncd è¿˜èƒ½ç”¨ï¼Œlsæ²¡äº†ï¼Œcatä¹Ÿæ²¡äº†ã€‚\nå°è¯•cat xxx.confä¹Ÿæ²¡ç”¨äº†,éš¾é“åªèƒ½ä¸€ç‚¹ç‚¹ç¿»é…ç½®æ–‡ä»¶ä¹ˆ.\nç¾¤é‡Œçš„æœ‹å‹æäº†ä¸€å¥ï¼Œçœ‹çœ‹ä½ çš„äº‘ç›˜æœ‰æ²¡æœ‰å¤‡ä»½ä¹‹ç±»çš„.\nå’¦,å¥½åƒä¸¤ä¸ªæ˜ŸæœŸå‰æ‰¾è…¾è®¯äº‘æŠ€æœ¯æ”¯æŒçš„æ—¶å€™åšè¿‡ä¸€æ¬¡ç³»ç»Ÿé•œåƒ.\næ˜¯ä¸æ˜¯å¯ä»¥ç›´æ¥æ‹¿å›æ¥ç›´æ¥ç”¨?\nçœ‹äº†ä¸‹å…·ä½“çš„é•œåƒç‰ˆæœ¬å’Œå¤‡æ³¨ä¿¡æ¯,çœ‹èµ·æ¥é‚£æ—¶å€™ä¸Šé¢çš„å†…å®¹å’Œç°åœ¨çš„ä¼°è®¡æ²¡å¤ªå¤šå˜åŒ–.\nç›´æ¥é‡è£…ä¹‹åæ›´æ–°ä¸€ä¸‹å„ä¸ªæœåŠ¡çš„é•œåƒåˆ°æœ€æ–°ç‰ˆæœ¬åº”è¯¥å°±å¥½äº†.\næ”¾å¼ƒæ‹¯æ•‘,ç›´æ¥ä½¿ç”¨å¤‡ä»½çš„ç³»ç»Ÿé•œåƒé‡è£… Work\u0026hellip;\nç³»ç»Ÿå¤‡ä»½é•œåƒæ‹¯æ•‘ä¸–ç•Œ!!!\nåç»­æ“ä½œ + æ€»ç»“ æ•°æ®ç›˜å’Œç³»ç»Ÿç›˜åˆ†å¼€,ä¸è¦è®©ç¨‹åºçš„æ•°æ®å¯¼è‡´ç³»ç»Ÿä¸å¯ç”¨\nåœ¨è´¹ç”¨å…è®¸çš„æƒ…å†µä¸‹è®¾ç½®ç£ç›˜å¿«ç…§ç­–ç•¥,æˆ‘è¿™è¾¹æœ€æç«¯çš„æƒ…å†µä¸‹ä¹Ÿåº”è¯¥èƒ½å›æ»šåˆ°ä¸€ä¸ªæ˜ŸæœŸå‰çš„ç‰ˆæœ¬\nä¸‹æ¬¡å¤§å½±å“æ“ä½œå‰å…ˆæ‰‹åŠ¨å¤‡ä»½ç³»ç»Ÿé•œåƒ,æ•‘å‘½ç¨»è‰ä¸€èˆ¬çš„å­˜åœ¨.\n","date":"2018-11-20T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/%E6%B2%A1%E6%9C%89%E6%89%A7%E8%A1%8C%E8%BF%87rm-rf-/%E7%9A%84%E5%BC%80%E5%8F%91%E4%B8%8D%E6%98%AF%E5%A5%BD%E8%BF%90%E7%BB%B4/","title":"æ²¡æœ‰æ‰§è¡Œè¿‡rm -rf /*çš„å¼€å‘ä¸æ˜¯å¥½è¿ç»´"},{"content":"C#:åœ¨Taskä¸­ä½¿ç”¨ä¾èµ–æ³¨å…¥çš„Service/EFContext dotnet coreæ—¶ä»£,ä¾èµ–æ³¨å…¥åŸºæœ¬å·²ç»æˆä¸ºæ ‡é…äº†,è¿™å°±ä¸å¤šè¯´äº†.\nå‰å‡ å¤©åœ¨åšæŸä¸ªåŠŸèƒ½çš„æ—¶å€™é‡åˆ°åœ¨Taskä¸­ä½¿ç”¨EF DbContextçš„é—®é¢˜,å­¦è‰ºä¸ç²¾çš„æˆ‘è¢«å›°æ‰°äº†ä¸çŸ­çš„ä¸€æ®µæ—¶é—´,\näºæ˜¯æœ‰äº†è¿™ä¸ªæ–‡ç« .\nå…ˆè¯´ä¸€ä¸‹ä»£ç ç»“æ„å’Œåœºæ™¯.\né¦–å…ˆæœ‰ä¸€ä¸ªHouseDbContext,ä»£ç å¤§æ¦‚æ˜¯ä¸‹é¢è¿™æ ·:\n1 2 3 4 5 6 7 8 public class HouseDbContext : DbContext { public HouseDbContext(DbContextOptions\u0026lt;HouseDbContext\u0026gt; options) : base(options) { } public DbSet\u0026lt;Notice\u0026gt; Notices { get; set; } } æ¥ç€å·²ç»åœ¨StarUp.csä¸­åˆå§‹åŒ–å¹¶æ³¨å…¥äº†,æ³¨å…¥ä»£ç æ˜¯è¿™æ ·çš„:\n1 2 3 4 5 6 services.AddDbContextPool\u0026lt;HouseDbContext\u0026gt;(options =\u0026gt; { options.UseLoggerFactory(loggerFactory); options.UseMySql(Configuration[\u0026#34;MySQLString\u0026#34;].ToString()); }); æœ‰ä¸€ä¸ªNoticeService.cs ä¼šç”¨åˆ°HouseDbContext è¿›è¡Œå¢åˆ æŸ¥æ”¹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 public class NoticeService { private readonly HouseDbContext _dataContext; public NoticeService(HouseDbContext dataContext) { _dataContext = dataContext; } public Notice FindNotice(long id) { var notice = _dataContext.Notices.FirstOrDefault(n =\u0026gt;n.Id == id); return notice; } } å½“ç„¶æˆ‘ä»¬ä¹Ÿéœ€è¦æŠŠNoticeServiceæ³¨å…¥åˆ°å®¹å™¨ä¸­,ç±»ä¼¼è¿™æ ·\n1 2 services.AddScoped\u0026lt;NoticeService,NoticeService\u0026gt;(); ç°åœ¨ä¸€åˆ‡éƒ½æ˜¯å¾ˆç¾å¥½çš„,ä¹Ÿèƒ½æ­£å¸¸æŸ¥è¯¢å‡ºNotice\nç„¶åæŸä¸€å¤©æ¥äº†,æœ‰ä¸ªéœ€æ±‚æ˜¯Update Noticeä¹‹åéœ€è¦æŠŠNoticeåŒæ­¥åˆ°å¦å¤–ä¸€ä¸ªåœ°æ–¹,ä¾‹å¦‚Elasticsearch?\nä»£ç å¦‚ä¸‹:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 public class NoticeService { private readonly HouseDbContext _dataContext; public NoticeService(HouseDbContext dataContext) { _dataContext = dataContext; } public Notice FindNotice(long id) { var notice = _dataContext.Notices.FirstOrDefault(n =\u0026gt;n.Id == id); return notice; } public void Save(Notice notice) { _dataContext.Notices.Add(notice); _dataContext.SaveChanges(); Task.Run(() =\u0026gt; { try { var one = _dataContext.Notices.FirstOrDefault(n =\u0026gt;n.Id == notice.Id); // write to other } catch (Exception ex) { Console.WriteLine(ex.ToString()); } }); } } ç„¶åä¸€è·‘\u0026hellip;\nä»£ç ç‚¸äº†\u0026hellip;\næ­å–œä½ è·å¾—è·¨çº¿ç¨‹ä½¿ç”¨EF DbContextå¯¼è‡´ä¸Šä¸‹æ–‡ä¸åŒæ­¥çš„å¼‚å¸¸.\né”™è¯¯å¤§æ¦‚é•¿è¿™æ ·.\n1 2 3 System.ObjectDisposedException: Cannot access a disposed object. A common cause of this error is disposing a context that was resolved from dependency injection and then later trying to use the same context instance elsewhere in your application. This may occur if you are calling Dispose() on the context, or wrapping the context in a using statement. If you are using dependency injection, you should let the dependency injection container take care of disposing context instances. Object name: \u0026#39;HouseDbContext\u0026#39;. ä¼°è®¡ç°åœ¨æ•´ä¸ªäººéƒ½ä¸å¥½äº†.\nè¿™ä¸ªæ’’æ„æ€å‘¢?\n1 2 3 4 5 6 æ— æ³•è®¿é—®è¢«é‡Šæ”¾çš„å¯¹è±¡ã€‚ è¿™ç§é”™è¯¯çš„ä¸€ä¸ªå¸¸è§åŸå› æ˜¯ä½¿ç”¨ä»ä¾èµ–æ³¨å…¥ä¸­è§£å†³çš„ä¸Šä¸‹æ–‡ï¼Œç„¶ååœ¨åº”ç”¨ç¨‹åºçš„å…¶ä»–åœ°æ–¹å°è¯•ä½¿ç”¨ç›¸åŒçš„ä¸Šä¸‹æ–‡å®ä¾‹ã€‚ å¦‚æœæ‚¨åœ¨ä¸Šä¸‹æ–‡ä¸Šè°ƒç”¨Dispose()ï¼Œæˆ–è€…åœ¨usingè¯­å¥ä¸­åŒ…è£…ä¸Šä¸‹æ–‡ï¼Œå¯èƒ½ä¼šå‘ç”Ÿè¿™ç§æƒ…å†µã€‚å¦‚æœä½¿ç”¨ä¾èµ–é¡¹æ³¨å…¥ï¼Œåˆ™åº”è¯¥è®©ä¾èµ–é¡¹æ³¨å…¥å®¹å™¨å¤„ç†ä¸Šä¸‹æ–‡å®ä¾‹ã€‚ ç”¨äººè¯æ¥è¯´æ˜¯ä»€ä¹ˆæ„æ€å‘¢?\nè¿™é‡Œçš„HouseDbContextæ˜¯ä¾èµ–æ³¨å…¥è¿›æ¥çš„,ç”Ÿå‘½å‘¨æœŸç”±å®¹å™¨æœ¬èº«ç®¡ç†;\nåœ¨Task.Runä¸­å†æ¬¡ä½¿ç”¨HouseDbContextå®ä¾‹ä¸­ç”±äºå·²ç»åˆ‡æ¢äº†çº¿ç¨‹äº†,\nHouseDbContextå®ä¾‹å·²ç»è¢«é‡Šæ”¾æ‰äº†,æ— æ³•å†ç»§ç»­ä½¿ç”¨åŒä¸€ä¸ªå®ä¾‹,æˆ‘ä»¬åº”è¯¥è‡ªå·±åˆå§‹åŒ–HouseDbContextæ¥ç”¨.\nåˆ°è¿™é‡Œçš„è¯,ä¸Šæ¬¡æˆ‘åšçš„æ—¶å€™å¿ƒç”Ÿä¸€è®¡:\næ—¢ç„¶æˆ‘ä»¬ä¸èƒ½ç›´æ¥ä»æ„é€ å‡½æ•°æ³¨å…¥çš„HouseDbContextå®ä¾‹çš„è¯,æˆ‘ä»¬æ˜¯ä¸æ˜¯å¯ä»¥ç›´æ¥ä»ä¾èµ–æ³¨å…¥å®¹å™¨ä¸­æ‹¿ä¸€ä¸ªå®ä¾‹å›æ¥å‘¢?\né‚£åœ¨dotnet coreé‡Œé¢å¯ä»¥ç”¨ä¸ªä»€ä¹ˆä»å®¹å™¨ä¸­å–å‡ºå®ä¾‹å‘¢?\nç­”æ¡ˆæ˜¯:IServiceProvider\nä»£ç å¦‚ä¸‹:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 public class NoticeService { private readonly HouseDbContext _dataContext; private readonly IServiceProvider _serviceProvider; public NoticeService(HouseDbContext dataContext,IServiceProvider serviceProvider) { _dataContext = dataContext; _serviceProvider = serviceProvider; } public Notice FindNotice(long id) { var notice = _dataContext.Notices.FirstOrDefault(n =\u0026gt; n.Id == id); Task.Run(() =\u0026gt; { try { var context = _serviceProvider.GetService\u0026lt;HouseDbContext\u0026gt;(); var one = context.Notices.FirstOrDefault(n =\u0026gt; n.Id == notice.Id); Console.WriteLine(notice.Id); // write to other } catch (Exception ex) { Console.WriteLine(ex.ToString()); } }); return notice; } public void Save(Notice notice) { _dataContext.Notices.Add(notice); _dataContext.SaveChanges(); Task.Run(() =\u0026gt; { try { var one = _dataContext.Notices.FirstOrDefault(n =\u0026gt; n.Id == notice.Id); // write to other } catch (Exception ex) { Console.WriteLine(ex.ToString()); } }); } } è·‘ä¸€ä¸‹çœ‹çœ‹\u0026hellip;\nç„¶è€Œäº‹å®å‘Šè¯‰æˆ‘,å®ä¾‹æ˜¯èƒ½æ‹¿å¾—åˆ°,ç„¶è€Œè¿˜æ˜¯ä¼šç‚¸,é”™è¯¯æ˜¯ä¸€æ ·çš„.\nåŸå› å…¶å®è¿˜æ˜¯ä¸€æ ·çš„,è¿™é‡Œå·²ç»ä¸å—ä¾èµ–æ³¨å…¥æ‰˜ç®¡äº†,äººå®¶çš„ä¸Šä¸‹æ–‡ä½ åˆ«æƒ³ç”¨äº†.\né‚£å’‹åŠå‘¢\u0026hellip;\nåœ¨EF6,è¿˜å¯ä»¥ç›´æ¥new HouseDbContext ä¸€ä¸ªå­—ç¬¦ä¸²è¿›å»åˆå§‹åŒ–,åœ¨EF Coreè¿™é‡Œ,å·²ç»ä¸èƒ½è¿™æ ·ç©äº†.\né‚£å¯å’‹åŠå‘¢?\nç¿»äº†å¥½å¤šèµ„æ–™éƒ½æ²¡çœ‹åˆ°æœ‰äººä»‹ç»è¿‡å’‹åŠ,æœ€åå±…ç„¶è¿˜æ˜¯åœ¨å®˜ç½‘æ•™ç¨‹é‡Œé¢æ‰¾åˆ°äº†æ ·ä¾‹.\nå…ˆçœ‹ä»£ç \u0026hellip;\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 Task.Run(() =\u0026gt; { try { var optionsBuilder = new DbContextOptionsBuilder\u0026lt;HouseDbContext\u0026gt;(); // appConfiguration.MySQLString appConfigurationæ˜¯é…ç½®ç±»,MySQLStringä¸ºè¿æ¥å­—ç¬¦ä¸² optionsBuilder.UseMySql(appConfiguration.MySQLString); using (var context = new HouseDbContext(optionsBuilder.Options)) { var one = context.Notices.FirstOrDefault(n =\u0026gt; n.Id == notice.Id); // å½“ç„¶ä½ ä¹Ÿå¯ä»¥ç›´æ¥åˆå§‹åŒ–å…¶ä»–çš„Service var nService = new NoticeService(context,null); var one =nService.FindOne(notice.Id); } }catch (Exception ex) { Console.WriteLine(ex.ToString()); } }); æ•™ç¨‹ä»£ç åœ¨:Configuring a DbContext\nå¤§åŠŸå‘Šæˆ\u0026hellip;\n","date":"2018-11-20T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/%E5%9C%A8task%E4%B8%AD%E4%BD%BF%E7%94%A8%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5%E7%9A%84service/efcontext/","title":"åœ¨Taskä¸­ä½¿ç”¨ä¾èµ–æ³¨å…¥çš„Service/EFContext"},{"content":"å¹´è½»äººçš„ç¬¬ä¸€ä¸ªAPMä¹‹Skywalking å‰è¨€ ä»€ä¹ˆæ˜¯APM?å…¨ç§°:Application Performance Management\nå¯ä»¥å‚è€ƒè¿™é‡Œ:\n1 2 3 4 5 6 ç°ä»£APMä½“ç³»ï¼ŒåŸºæœ¬éƒ½æ˜¯å‚è€ƒGoogleçš„Dapperï¼ˆå¤§è§„æ¨¡åˆ†å¸ƒå¼ç³»ç»Ÿçš„è·Ÿè¸ªç³»ç»Ÿï¼‰çš„ä½“ç³»æ¥åšçš„ã€‚é€šè¿‡è·Ÿè¸ªè¯·æ±‚çš„å¤„ç†è¿‡ç¨‹ï¼Œæ¥å¯¹åº”ç”¨ç³»ç»Ÿåœ¨å‰åç«¯å¤„ç†ã€æœåŠ¡ç«¯è°ƒç”¨çš„æ€§èƒ½æ¶ˆè€—è¿›è¡Œè·Ÿè¸ªï¼Œå…³äºDapperçš„ä»‹ç»å¯ä»¥çœ‹è¿™ä¸ªé“¾æ¥ï¼šDapperï¼Œå¤§è§„æ¨¡åˆ†å¸ƒå¼ç³»ç»Ÿçš„è·Ÿè¸ªç³»ç»Ÿ by bigbully ä½œè€…ï¼šåˆ€æŠŠäº” é“¾æ¥ï¼šhttps://www.zhihu.com/question/27994350/answer/118821214 æ¥æºï¼šçŸ¥ä¹ è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚ æœ€æ—©ä½¿ç”¨APMè¿˜æ˜¯åœ¨æºç¨‹é‡Œé¢æ¬ç –çš„æ—¶å€™,å½“æ—¶ä½¿ç”¨çš„æ˜¯å¤§å®—ç‚¹è¯„ç½‘å¼€æºçš„dianping/catæ¡†æ¶.\nåæ¥åˆ°äº†æ–°å…¬å¸,å› ä¸ºå†å²åŒ…è¢±æœ‰ç‚¹å¤š,è¿½è¸ªæ€§èƒ½é—®é¢˜å¤ªéº»çƒ¦,ç”¨è¿‡æ”¶è´¹çš„New Relic | Real-time insights for modern software ,newrelicæŒ‰ç…§CPUæ ¸æ•°å’Œå†…å­˜æ¥æ”¶è´¹,å®åœ¨å¤ªè´µäº†æˆ‘ä»¬å°±æ”¾å¼ƒäº†.\nå†åæ¥æˆ‘ä»¬è°ƒç ”ä¸€ä¸‹å¸‚é¢çš„å…¶ä»–æ–¹æ¡ˆ,çœ‹åˆ°äº†è¿™ä¸ªçŸ¥ä¹è®¨è®ºç»™äº†ä¸å°‘çš„ä¸œè¥¿.\næœ‰ä»€ä¹ˆçŸ¥åçš„å¼€æºapm(Application Performance Management)å·¥å…·å—ï¼Ÿ\nå½“æ—¶çœ‹åˆ°naver/pinpoint å’Œapache/incubator-skywalking éƒ½å¾ˆä¸é”™.\nä¸€ä¸ªæ˜¯éŸ©å›½æœç´¢å›¢é˜Ÿå¼€æºçš„,ä¸€ä¸ªæ˜¯å›½å†…ä¸ªäººç”¨æˆ·å¼€æº,å·²ç»åˆ°äº†apacheå­µåŒ–å™¨äº†.\näºæ˜¯ä¸¤ä¸ªéƒ½è¯•ç”¨äº†ä¸€ä¸‹, æœ€åç”±äºé‚£æ—¶å€™é©¬ä¸Šè€ƒè™‘ä¸Šåˆ†è¡¨åˆ†åº“ç»„ä»¶ sharding-jdbc-dangdang, skywalkingä¹Ÿè¦å¯¹åº”çš„æ”¯æŒ,æ‰€ä»¥å†³å®šç”¨skywalkingè¯•è¯•.\nå†åæ¥åˆè·‘è·¯äº†,ä¸å¥½æ„æ€ç»™é‚£è¾¹ç•™ä¸‹å‘å°±æ²¡ç»§ç»­æ­å»ºçœ‹. åˆ°äº†æ–°å…¬å¸PHP/Python/Javaä»€ä¹ˆéƒ½å†™,å¼€å§‹ä¸¤ä¸‰ä¸ªæœˆä¹Ÿæ²¡ç®¡è¿™ä¸ª.\næœ€è¿‘ä¸æ˜¯å¤ªå¿™äº†,æ–°å…¬å¸è¿™è¾¹æœåŠ¡ç«¯APIæš‚æ—¶è¢«æˆ‘å¸¦æˆäº†dotnet coreæŠ€æœ¯æ ˆ,233\u0026hellip;\nåŒæ—¶å‘ç°å½“å‰ç”¨çš„EFæ¡†æ¶å¶å°”ä¼šå› ä¸ºä¸å°å¿ƒå°±å†™å‡ºäº†æ€§èƒ½å¾ˆå·®çš„SQL,æµ‹è¯•ç¯å¢ƒåŸºæœ¬çœ‹ä¸å‡ºæ¥,åˆ°äº†ç”Ÿäº§å¯èƒ½å°±ç‚¸.\nå‰é˜µå­çœ‹åˆ°dalao å€¾ç«¹ æŠŠdotnet core agentå†™å‡ºæ¥äº†, äºæ˜¯çˆ½æ­ªæ­ªå°±å¼€å§‹gangäº†.\nå¼€å§‹æ­å»ºskywalking github:incubator-skywalking\nå½“å‰releaseç‰ˆæœ¬ä¸º5.0RC2,æœ€æ–°ç‰ˆæœ¬6.Xæ­£åœ¨å¼€å‘ä¸­.\næ‰€ä»¥å½“å‰æˆ‘è¿™é‡Œæ˜¯åŸºäº5.0 RC2æ¥æ­å»ºçš„.\nå®˜æ–¹å‘å¯¼æ–¹æ¡ˆåœ¨è¿™é‡Œ:incubator-skywalking/blob/5.x/docs/README.md\nä¸­æ–‡æ–‡æ¡£åœ¨è¿™é‡Œ:incubator-skywalking/blob/5.x/docs/README_ZH.md\næˆ‘è¿™é‡Œä»Šå¤©è¿˜æ˜¯å…¨ç¨‹dockeréƒ¨ç½².\nä»¥ä¸‹æ“ä½œæ¥è‡ªJaredTan95/skywalking-docker dalaoå‡†å¤‡çš„dockeréƒ¨ç½².\né¢„å¤‡æ¡ä»¶:\ndocker\nelasticsearch\nå¯åŠ¨Elasticsearch 1 2 3 4 # Elasticsearchç‰ˆæœ¬è¦æ±‚5.x docker run -p 9200:9200 -p 9300:9300 -e cluster.name=elasticsearch -e xpack.security.enabled=false --name=elasticsearch --restart=always -d wutang/elasticsearch-shanghai-zone å¯åŠ¨å¥½äº†è®¿é—®ä¸€ä¸‹ http://localhost:9200 çœ‹çœ‹,çœ‹åˆ°ä¸€ä¸‹çš„å†…å®¹è¯´æ˜ESå·²ç»æ­£å¸¸å¯åŠ¨äº†.\n1 2 3 4 5 6 7 8 9 10 11 12 13 { \u0026#34;name\u0026#34;: \u0026#34;_PNUyiW\u0026#34;, \u0026#34;cluster_name\u0026#34;: \u0026#34;elasticsearch\u0026#34;, \u0026#34;cluster_uuid\u0026#34;: \u0026#34;\u0026#34;, \u0026#34;version\u0026#34;: { \u0026#34;number\u0026#34;: \u0026#34;5.6.10\u0026#34;, \u0026#34;build_hash\u0026#34;: \u0026#34;b727a60\u0026#34;, \u0026#34;build_date\u0026#34;: \u0026#34;2018-06-06T15:48:34.860Z\u0026#34;, \u0026#34;build_snapshot\u0026#34;: false, \u0026#34;lucene_version\u0026#34;: \u0026#34;6.6.1\u0026#34; }, \u0026#34;tagline\u0026#34;: \u0026#34;You Know, for Search\u0026#34; } æ¥ç€ä½¿ç”¨ docker inspect elasticsearch |grep IPAddress æŸ¥çœ‹ä¸€ä¸‹ elasticsearch å½“å‰IP.\n1 2 3 4 âœ âœ— docker inspect elasticsearch |grep IPAddress \u0026#34;SecondaryIPAddresses\u0026#34;: null, \u0026#34;IPAddress\u0026#34;: \u0026#34;\u0026#34;, \u0026#34;IPAddress\u0026#34;: \u0026#34;172.27.0.2\u0026#34;, å¯åŠ¨ Skywalking UI + Skywalking collector dalao wutangçš„wutang/skywalking-dockerå·²ç»æŠŠUIå’Œcollectoræ‰“åŒ…åˆ°ä¸€ä¸ªé•œåƒé‡Œé¢äº†,å®Œå…¨å¯ä»¥ç‹¬ç«‹å®‰è£….\næ‰€ä»¥æˆ‘è¿™é‡Œé‡‡ç”¨çš„ä¹Ÿæ˜¯è¿™ä¸ªæ–¹æ¡ˆ.\n1 docker run -p 8080:8080 -p 10800:10800 -p 11800:11800 -p 12800:12800 -e ES_CLUSTER_NAME=elasticsearch -e ES_ADDRESSES=ä¸Šä¸€æ­¥æ‹¿åˆ°çš„elasticsearchIP:9300 -d wutang/skywalking-docker:5.x å¯åŠ¨å¥½äº†ä¹‹åæ‰“å¼€ localhost:8080,å¦‚æœUIé¡µé¢æ²¡æœ‰500/404é”™è¯¯,è¯´æ˜æ•´ä¸ªç³»ç»Ÿå·²ç»æ­£å¸¸å¯åŠ¨äº†.\nPS:é»˜è®¤è´¦å·å¯†ç æ˜¯:admin admin,å¯ä»¥åœ¨docker runæŒ‡å®š UI_ADMIN_PASSWORDç¯å¢ƒå˜é‡è‡ªå®šä¹‰å¯†ç .\nå¦‚æœæœ‰é”™è¯¯çš„è¯,å¤§æ¦‚ç‡æ˜¯ESæ²¡æœ‰è¿ä¸Š,æ£€æŸ¥ä¸€ä¸‹ESæ˜¯ä¸æ˜¯è¿˜æ´»ç€,å†ä¸è¡Œå°±è¿›åˆ°å®¹å™¨é‡Œé¢çœ‹æ—¥å¿—.æ—¥å¿—é»˜è®¤è·¯å¾„:/apache-skywalking-apm-incubating/logs\nAgentæ¥å…¥ å½“å‰å·²ç»æœ‰Java/C#(dotnet core)/Node.jsçš„Agentäº†.\nå¯¹åº”çš„è¯Javaæ”¯æŒæ˜¯æœ€å¤šçš„,å…¶ä»–ä¸¤ä¸ªæˆ‘çœ‹ä¸‹æ¥åŸºæœ¬å°±æ˜¯ä¸»æµæ¯”è¾ƒå¤šçš„ä¸€äº›æ¡†æ¶éƒ½åŸºæœ¬æœ‰äº†.\nå¯¹åº”agentæ¡†æ¶é“¾æ¥:\ndotnet core: OpenSkywalking/skywalking-netcore\nnode.js:OpenSkywalking/skywalking-nodejs\nç†è®ºä¸Šåº”è¯¥éµå¾ªhttp://opentracing.io/ APIæ ‡å‡†çš„.\nJava agent ä¸»ä»“åº“å°±æœ‰,ç›´æ¥å»çœ‹releaseå³å¯.\nä»Šå¤©æˆ‘ä»¬è‚¯å®šæ˜¯ç”¨dotnet core å•¦.\ndotnet coreå½“å‰æ”¯æŒçš„åº“å’Œä¸­é—´ä»¶æœ‰ä¸‹é¢è¿™äº›:\nASP.NET Core .NET Core BCL types (HttpClient and SqlClient) EntityFrameworkCore Npgsql.EntityFrameworkCore.PostgreSQL Pomelo.EntityFrameworkCore.MySql CAP å—¯,è¯¥æœ‰çš„éƒ½æœ‰äº†.\nå…ˆå¼•å…¥ä¸€ä¸‹SkyWalking.AspNetCoreçš„Package.\n1 dotnet add package SkyWalking.AspNetCore --version 0.3.0 é…Œæƒ…æ–°å¢ SkyWalking.Diagnostics.EntityFrameworkCore, SkyWalking.Diagnostics.HttpClient, SkyWalking.Diagnostics.EntityFrameworkCore.Npgsql,SkyWalking.Diagnostics.EntityFrameworkCore.Pomelo.MySql ç­‰ç­‰\u0026hellip;\næˆ–è€…ç›´æ¥åœ¨xxx.csproj æ–°å¢ä¸‹é¢è¿™äº›åŒ….\n1 2 3 4 5 \u0026lt;PackageReference Include=\u0026#34;SkyWalking.AspNetCore\u0026#34; Version=\u0026#34;0.3.0\u0026#34;/\u0026gt; \u0026lt;PackageReference Include=\u0026#34;SkyWalking.Diagnostics.EntityFrameworkCore\u0026#34; Version=\u0026#34;0.3.0\u0026#34;/\u0026gt; \u0026lt;PackageReference Include=\u0026#34;SkyWalking.Diagnostics.HttpClient\u0026#34; Version=\u0026#34;0.3.0\u0026#34;/\u0026gt; \u0026lt;PackageReference Include=\u0026#34;SkyWalking.Diagnostics.EntityFrameworkCore.Npgsql\u0026#34; Version=\u0026#34;0.3.0\u0026#34;/\u0026gt; \u0026lt;PackageReference Include=\u0026#34;SkyWalking.Diagnostics.EntityFrameworkCore.Pomelo.MySql\u0026#34; Version=\u0026#34;0.3.0\u0026#34;/\u0026gt; ç„¶ååœ¨ Startup.csçš„ConfigureServices æ–¹æ³•ä¸­æ·»åŠ å¼•ç”¨\n1 2 3 4 5 6 7 8 9 10 11 12 13 // using SkyWalking.AspNetCore; // using SkyWalking.Diagnostics.EntityFrameworkCore; // using SkyWalking.Diagnostics.HttpClient; // using SkyWalking.Diagnostics.SqlClient; services.AddSkyWalking(option =\u0026gt; { option.ApplicationCode = \u0026#34;my-first-api\u0026#34;; option.DirectServers = \u0026#34;127.0.0.1:11800\u0026#34;; // æ¯ä¸‰ç§’é‡‡æ ·çš„Traceæ•°é‡,-1 ä¸ºå…¨éƒ¨é‡‡é›† option.SamplePer3Secs = -1; }).AddEntityFrameworkCore(c =\u0026gt; { c.AddPomeloMysql(); }) .AddHttpClient(); æ¥ç€å¯åŠ¨åº”ç”¨.\nçœ‹åˆ°æœ‰ç±»ä¼¼çš„æ—¥å¿—è¾“å…¥,è¯´æ˜å·²ç»åº”ç”¨å·²ç»æ­£å¸¸è¿æ¥åˆ°SkyWalkingäº†.\n1 2 3 4 5 6 info: SkyWalking.Remote.GrpcApplicationService[0] Register application instance success. [applicationInstanceId] = 31 SkyWalking.Remote.GrpcApplicationService:Information: Register application instance success. [applicationInstanceId] = 31 info: SkyWalking.Remote.GrpcApplicationService[0] Register application instance success. [applicationInstanceId] = 31 è¿™æ—¶å€™æˆ‘ä»¬æ‰“å¼€http://localhost:8080/#/monitor/dashboard\nå¯ä»¥çœ‹åˆ°APPå·²ç»æœ‰æ•°é‡äº†.\næ¥ç€æˆ‘ä»¬è®¿é—®ä¸€ä¸‹å·²æœ‰çš„API/Webé¡µé¢,å°±èƒ½çœ‹åˆ°å¯¹åº”çš„ä¿¡æ¯äº†.\nç‚¹ä¸€ä¸‹å¯¹åº”çš„URL.\nhttp clientè¯·æ±‚(å…¶å®æ˜¯æŸ¥è¯¢ES):\nTopology Map\nå…¶ä»–çš„ä¸€äº›åŠŸèƒ½å°±çœ‹è‡ªå·±ç©äº†.\næœ¬æœŸç»“æŸ\u0026hellip;\n","date":"2018-09-21T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/%E6%AF%8F%E5%91%A8%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE%E5%88%86%E4%BA%AB-%E5%B9%B4%E8%BD%BB%E4%BA%BA%E7%9A%84%E7%AC%AC%E4%B8%80%E4%B8%AAapm%E4%B9%8Bskywalking/","title":"æ¯å‘¨å¼€æºé¡¹ç›®åˆ†äº«-å¹´è½»äººçš„ç¬¬ä¸€ä¸ªAPMä¹‹Skywalking"},{"content":" æ–°ç‰ˆåŸŸå https://house2048.cn/app/house-map/#/ æ–°ç‰ˆæœ¬åœ°å€ ç‚¹å‡»æˆ‘ https://house2048.cn/app/house-map å°ç¨‹åºå·²ç»ä¸Šçº¿ï¼Œæ¬¢è¿å…³æ³¨â€œäººç”Ÿåˆ é™¤æŒ‡å—â€å…¬ä¼—å·è·å–ã€‚ é¡¹ç›®åœ°å€ï¼š https://github.com/liguobao/58HouseSearch æœ€æ–°ç‰ˆä½¿ç”¨æ•™ç¨‹ æœ€æ–°åœ°å€è¯·åœ¨æ•™ç¨‹ä¸­æŸ¥çœ‹ ","date":"2018-09-04T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/%E5%9C%B0%E5%9B%BE%E6%90%9C%E7%A7%9F%E6%88%BF%E9%A1%B9%E7%9B%AE%E8%BF%81%E7%A7%BBhouse2048.cn/","title":"åœ°å›¾æœç§Ÿæˆ¿é¡¹ç›®è¿ç§»ï¼ˆhouse2048.cnï¼‰"},{"content":"dotnet core ç®€æ˜“å®šæ—¶ä»»åŠ¡æ¡†æ¶TimeJob å¾ˆå¤šæ—¶å€™æˆ‘ä»¬å¯èƒ½éœ€è¦å‘¨æœŸé‡å¤åšä¸€äº›äº‹æƒ…, å®šæ—¶ä»»åŠ¡æ¡†æ¶åº”è¿è€Œç”Ÿ.\nåœ¨Linuxä¸‹é¢crontabé›†åˆshellè„šæœ¬åšä¸€äº›å®šæ—¶é‡å¤æ“ä½œæ˜¯å¸¸è§é€šç”¨çš„.\nä½†æ˜¯æœ‰æ—¶å€™æˆ‘ä»¬å¯èƒ½éœ€è¦åœ¨ç¨‹åºä¸­åšç±»ä¼¼çš„äº‹æƒ…,å¦‚:\nå®šæ—¶é‚®ä»¶æ¨é€\nå®šæ—¶\bç›‘æ§æ—¥æŠ¥ç”Ÿæˆ\n\bXXX\u0026hellip;\nJavaè¿™è¾¹,ä¸€èˆ¬éƒ½ä½¿ç”¨Quartzæ¡†æ¶\bç®€å•å®ç°å®šæ—¶ä»»åŠ¡.\n.NETè¿™è¾¹,ä¹Ÿæœ‰Quartz.net,\bä¸è¿‡ASP.NETæ—¶ä»£å—åˆ¶äºIIS\b,ç»å¸¸ä¼šæœ‰åŒè¡Œå°ä¼™ä¼´è¯´æŠ±æ€¨å®šæ—¶ä»»åŠ¡å¶å°”çªç„¶å°±ä¸è·‘.\nå‚è€ƒæ–‡ç« :\nç½‘ç«™å‘å¸ƒååœ¨IISä¸Šå®šæ—¶æ‰§è¡Œä»»åŠ¡\nQuartzå®šæ—¶ä»»åŠ¡å’ŒIISç¨‹åºæ± é—²ç½®è¶…æ—¶æ—¶é—´å†²çªè§£å†³æ–¹æ¡ˆ\nåˆ°äº†dotnet coreæ—¶ä»£,\bè‡ªå®¿ä¸»ä¸ä¾èµ–IISäº†,ä¹Ÿæœ‰è‡ªå·±ç‹¬ç«‹çš„ä¸»çº¿ç¨‹ä¹‹å,æˆ‘ä»¬åšå®šæ—¶ä»»åŠ¡å°±å¾ˆæ–¹ä¾¿äº†.\nå¼€æºdalaoAmamiya Yuuko å°±è‡ªå·±æ’¸äº†ä¸€ä¸ªç®€æ˜“å®šæ—¶ä»»åŠ¡æ¡†æ¶å‡ºæ¥å•¦.\n\bGitHubå¼€æºåœ°å€:https://github.com/PomeloFoundation/dotNETCore-Extensions\nNugetåœ°å€:Pomelo.AspNetCore.TimedJob\nTimeJob ä½¿ç”¨æ•™ç¨‹ Start.csçš„ConfigureServicesæ³¨å…¥AddTimedJobæœåŠ¡ ä»£ç å¦‚ä¸‹:\n1 2 3 4 public void ConfigureServices(IServiceCollection services) { services.AddTimedJob(); } Start.csçš„Configureå¼•å…¥UseTimedJobä¸­é—´ä»¶ 1 2 3 4 public void Configure(IApplicationBuilder app, IHostingEnvironment env) { app.UseTimedJob(); } æ–°å»º\bä¸€ä¸ªXXXJob.csç±»,ç»§æ‰¿äºJob\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 using Microsoft.Extensions.Options; using System; using System.Collections.Generic; using System.Data; using System.Data.SqlClient; using System.Linq; using Pomelo.AspNetCore.TimedJob; namespace Sample.Jobs { public class TestJob : Job { public TestJob() { } [Invoke(Begin = \u0026#34;2018-07-27 00:00\u0026#34;, Interval = 1000 * 600, SkipWhileExecuting = true)] public void Run() { Console.WriteLine(DateTime.Now.ToString()+\u0026#34;,TestJob run...\u0026#34;); } } } å¤§åŠŸå‘Šæˆ!\nå¦‚æœéœ€è¦æŠŠå®šæ—¶ä»»åŠ¡ç›¸å…³çš„å†…å®¹å›ºåŒ–åˆ°æ•°æ®åº“,å¯ä»¥å‚è€ƒ:Timed Job - Pomeloæ‰©å±•åŒ…ç³»åˆ—\nå—¯?å®Œäº†?\u0026hellip;\nå¯¹å•Š,ç»“æŸäº†.\nçœŸç»“æŸäº†\u0026hellip;.\n","date":"2018-07-28T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/%E6%AF%8F%E5%91%A8%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE%E5%88%86%E4%BA%AB-dotnet-core-%E7%AE%80%E6%98%93%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%E6%A1%86%E6%9E%B6timejob/","title":"æ¯å‘¨å¼€æºé¡¹ç›®åˆ†äº«-dotnet core ç®€æ˜“å®šæ—¶ä»»åŠ¡æ¡†æ¶TimeJob"},{"content":"å¹´è½»äººçš„ç¬¬ä¸€ä¸ªOAuth2.0 Server:hydra hydra æ˜¯ä»€ä¹ˆå‘¢?\nOpenID Connect certified OAuth2 Server - cloud native, security-first, open source API security for your infrastructure. Written in Go. SDKs for any language. è®²äººè¯çš„è¯å°±æ˜¯ä¸€ä¸ªOAuth2.0çš„æœåŠ¡ç«¯æ¡†æ¶å’¯,å¼€ç®±å³ç”¨.\nOAuthæ˜¯æ’’? QQäº’è”çŸ¥é“ä¹ˆ?å¾®ä¿¡æˆæƒç™»å½•çŸ¥é“ä¹ˆ?\næ‰©å±•é˜…è¯»:ç†è§£OAuth 2.0:é˜®ä¸€å³°\nå¼€æºåœ°å€:https://github.com/ory/hydra\næ–‡æ¡£åœ°å€:https://www.ory.sh/docs/guides/master/hydra/\næœ¬æ–‡ç»“æŸ\u0026hellip;\nå¼€å§‹æ‰‹æŠŠæ‰‹æ•™ä½ è·‘hydra server å…¨ç¨‹Dockeréƒ¨ç½²,è¯·è‡ªè¡Œå‡†å¤‡ç›¸å…³ç¯å¢ƒ. å‡†å¤‡PostgreSQL æ•°æ®åº“/MySQLæ•°æ®åº“ hydraæ”¯æŒPostgreSQL/MySQL,ä»»å›é€‰æ‹©.\nå®˜ç½‘æŒ‡å¯¼æ•™ç¨‹ä½¿ç”¨çš„æ˜¯PostgreSQL,ä¸‹é¢æˆ‘ä¹ŸæŠ„è¿‡æ¥äº†,åŒæ—¶æä¾›MySQLçš„ç›¸å…³æ“ä½œ.\nå¯åŠ¨æ•°æ®åº“å•¦!!!\nå“¦,å¯åŠ¨ä¹‹å‰å…ˆåˆ›å»ºä¸€ä¸ªdocker ç½‘ç»œ.\n1 docker network create hydraguide å¯åŠ¨ PostgreSQL,å¦‚ä¸‹\n1 2 3 4 5 6 7 docker run \\ --network hydraguide \\ --name ory-hydra-example--postgres \\ -e POSTGRES_USER=hydra \\ -e POSTGRES_PASSWORD=secret \\ -e POSTGRES_DB=hydra \\ -d postgres:9.6 æˆ–è€…å¯åŠ¨MySQL\n1 2 3 4 5 docker run -p 3306:3306 \\ --network hydraguide \\ --name hydra-mysql --restart=always \\ -v ~/docker-data/hydra-mysql/data/:/var/lib/mysql \\ -e MYSQL_ROOT_PASSWORD=123 -d mysql:5.7 å¯åŠ¨å¥½äº†è‡ªè¡ŒéªŒè¯ä¸€ä¸‹æ•°æ®åº“æ˜¯ä¸æ˜¯æ­£ç¡®å¯åŠ¨å’Œèƒ½è¿æ¥ä¸Šå»äº†.\nå‡†å¤‡hydraç›¸å…³ç¯å¢ƒå˜é‡ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 # The system secret can only be set against a fresh database. Key rotation is currently not supported. This # secret is used to encrypt the database and needs to be set to the same value every time the process (re-)starts. # You can use /dev/urandom to generate a secret. But make sure that the secret must be the same anytime you define it. # You could, for example, store the value somewhere. $ export SYSTEM_SECRET=$(export LC_CTYPE=C; cat /dev/urandom | tr -dc \u0026#39;a-zA-Z0-9\u0026#39; | fold -w 32 | head -n 1) # # Alternatively you can obviously just set a secret: # $ export SYSTEM_SECRET=this_needs_to_be_the_same_always_and_also_very_$3cuR3-._ # The database url points us at the postgres instance. This could also be an ephermal in-memory database (`export DATABASE_URL=memory`) # or a MySQL URI. $ export DATABASE_URL=postgres://hydra:secret@ory-hydra-example--postgres:5432/hydra?sslmode=disable # MySQLçš„é…ç½®,host.docker.internalä¸ºå®¿ä¸»æœºIP,mysqlå®¹å™¨çš„å†…éƒ¨IPæˆ–è€…hydra-mysqlä¹Ÿå¯ä»¥ç”¨ $ export DATABASE_URL=mysql://root:123@tcp(host.docker.internal/mysqlå®¹å™¨çš„å†…éƒ¨IP/hydra-mysql:3306)/hydra?parseTime=true SYSTEM_SECRET æ˜¯hydraå¯åŠ¨æ—¶åŠ å¯†æ•°æ®åº“ä½¿ç”¨çš„,Mac/Linuxç›´æ¥ä½¿ç”¨ä¸Šé¢çš„æ–¹æ³•è®¾ç½®å³å¯,windowsç¯å¢ƒä¸‹è®¾ç½®ä¸€ä¸‹ç¯å¢ƒå˜é‡?å¤§æ¦‚æ˜¯è¿™æ ·.\nDATABASE_URL æ˜¯æ•°æ®åº“è¿æ¥é…ç½®,postgreså’Œmysql äºŒé€‰ä¸€å³å¯.\næ‰§è¡Œè¿ç§»æ•°æ®åº“è„šæœ¬ hydraè‡ªå¸¦çš„,ç›´æ¥æ‰§è¡Œå³å¯.\n1 2 3 4 docker run -it --rm \\ --network hydraguide \\ oryd/hydra:v1.0.0-beta.5 \\ migrate sql $DATABASE_URL æ­£å¸¸æ‰§è¡Œçš„è¯,åº”è¯¥å¦‚ä¸‹:\n1 2 3 4 5 6 7 8 9 10 Applying `client` SQL migrations... Applied 0 `client` SQL migrations. Applying `oauth2` SQL migrations... Applied 0 `oauth2` SQL migrations. Applying `jwk` SQL migrations... Applied 0 `jwk` SQL migrations. Applying `consent` SQL migrations... Applied 0 `consent` SQL migrations. Migration successful! Applied a total of 0 SQL migrations. Migration successful! æ•°æ®åº“å¥½äº†,æˆ‘ä»¬ç°åœ¨å¯ä»¥å¼€å§‹ææœåŠ¡ç«¯äº†.\nå¯åŠ¨hydra æœåŠ¡ç«¯ 1 2 3 4 5 6 7 8 9 10 docker run -d \\ --name ory-hydra-example--hydra \\ --network hydraguide \\ -p 9000:4444 \\ -e SYSTEM_SECRET=$SYSTEM_SECRET \\ -e DATABASE_URL=$DATABASE_URL \\ -e OAUTH2_ISSUER_URL=https://localhost:9000/ \\ -e OAUTH2_CONSENT_URL=http://localhost:9020/consent \\ -e OAUTH2_LOGIN_URL=http://localhost:9020/login \\ oryd/hydra:v1.0.0-beta.5 serve è¿™é‡Œæˆ‘ä»¬ç•™æ„å‡ ä¸ªä¼ å…¥ç»™å®¹å™¨çš„ç¯å¢ƒå˜é‡.\nOAUTH2_ISSUER_URL hydraæ‰€åœ¨çš„åœ°å€\nOAUTH2_CONSENT_URL æˆæƒé¡µé¢åœ°å€\nOAUTH2_LOGIN_URL ç™»å½•é¡µé¢åœ°å€\nå‡è£…å¤§å®¶éƒ½äº†è§£OAuth2.0çš„æµç¨‹çš„æƒ…å†µä¸‹,å…¶å®è¿™é‡Œå°±æµç¨‹åŸºæœ¬å°±æ˜¯:\nXXåº”ç”¨è¯·æ±‚æˆæƒ\n-\u0026gt; è·³è½¬åˆ°OAUTH2_LOGIN_URLåœ°å€\n-\u0026gt; ç™»å½•æˆåŠŸ\n-\u0026gt;è·³è½¬åˆ°OAUTH2_CONSENT_URLæˆæƒé¡µé¢\n-\u0026gt; æˆæƒæˆåŠŸ\n-\u0026gt;å›è°ƒXXåº”ç”¨åœ°å€å¹¶ä¸”è¿”å›ç›¸å…³æˆæƒcode/token\n-\u0026gt; XXåº”ç”¨ä½¿ç”¨code/tokenè·å–ç”¨æˆ·ä¿¡æ¯æˆ–è€…å…¶ä»–æ“ä½œ\nå¯åŠ¨ä¹‹åçœ‹ä¸€ä¸‹logsæ˜¯ä¸æ˜¯hydraæ˜¯ä¸æ˜¯æ­£å¸¸å¯åŠ¨.\nå¸¸è§é—®é¢˜:\u0026ldquo;Could not fetch private signing key for OpenID Connect - did you forget to run \u0026quot;hydra migrate sql\u0026quot; or forget to set the SYSTEM_SECRET?\u0026rdquo; error=\u0026ldquo;unexpected end of JSON input\u0026rdquo;\nç¡®è®¤ä¸€ä¸‹SYSTEM_SECRETæœ‰æ²¡æœ‰æ­£å¸¸è®¾ç½®å‘€,å®åœ¨ä¸è¡Œç›´æ¥åœ¨docker runçš„æ—¶å€™å¸¦å…¥.\næ­£å¸¸å¯åŠ¨çš„è¯,æ—¥å¿—å¦‚ä¸‹:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 Thank you for using ORY Hydra! Take security seriously and subscribe to the ORY newsletter. Stay on top of new patches and security insights. \u0026gt;\u0026gt; Subscribe now: http://eepurl.com/di390P \u0026lt;\u0026lt; time=\u0026#34;2018-08-09T10:23:50Z\u0026#34; level=info msg=\u0026#34;Connected to SQL!\u0026#34; time=\u0026#34;2018-08-09T10:23:50Z\u0026#34; level=info msg=\u0026#34;JSON Web Key Set hydra.openid.id-token does not exist yet, generating new key pair...\u0026#34; time=\u0026#34;2018-08-09T10:23:51Z\u0026#34; level=info msg=\u0026#34;Setting up Prometheus middleware\u0026#34; time=\u0026#34;2018-08-09T10:23:51Z\u0026#34; level=info msg=\u0026#34;Transmission of telemetry data is enabled, to learn more go to: https://www.ory.sh/docs/guides/latest/telemetry/\u0026#34; time=\u0026#34;2018-08-09T10:23:51Z\u0026#34; level=info msg=\u0026#34;Detected local environment, skipping telemetry commit\u0026#34; time=\u0026#34;2018-08-09T10:23:51Z\u0026#34; level=info msg=\u0026#34;Detected local environment, skipping telemetry commit\u0026#34; time=\u0026#34;2018-08-09T10:23:51Z\u0026#34; level=info msg=\u0026#34;JSON Web Key Set hydra.https-tls does not exist yet, generating new key pair...\u0026#34; time=\u0026#34;2018-08-09T10:23:55Z\u0026#34; level=info msg=\u0026#34;Setting up http server on :4444\u0026#34; è¿™æ—¶å€™å»è®¿é—®:https://localhost:9000/.well-known/jwks.json\nç†è®ºä¸Šæ˜¯èƒ½æ­£å¸¸è¾“å‡ºç»“æœçš„.\nè¿™ä¸ªæ—¶å€™è¯´æ˜æˆ‘ä»¬çš„hydraå·²ç»æ­£å¸¸è·‘èµ·æ¥äº†.\nç™»å½•/æˆæƒæ ·ä¾‹ç½‘ç«™å¯åŠ¨ 1 2 3 4 5 6 7 docker run -d \\ --name ory-hydra-example--consent \\ -p 9020:3000 \\ --network hydraguide \\ -e HYDRA_URL=https://ory-hydra-example--hydra:4444 \\ -e NODE_TLS_REJECT_UNAUTHORIZED=0 \\ oryd/hydra-login-consent-node:v1.0.0-beta.5 åœ¨ä¸Šé¢æˆ‘ä»¬æè¿‡,XXåº”ç”¨è¯·æ±‚æˆæƒçš„æ—¶å€™,é¦–å…ˆæ˜¯è·³è½¬åˆ°ç»Ÿä¸€ç™»å½•é¡µé¢,\nè¿™ä¸ªæœ¬è´¨æ˜¯æ˜¯ä¸€ä¸ªç»Ÿä¸€ç”¨æˆ·ä¸­å¿ƒçš„åº”ç”¨,éœ€è¦æˆ‘ä»¬è‡ªè¡Œå¼€å‘çš„.\nhydraå®˜æ–¹æä¾›ä¸€ä¸ªæ ·ä¾‹ç»™æˆ‘ä»¬æ¥æµ‹è¯•ç”¨,node.jså†™çš„.\né¡¹ç›®åœ°å€:https://github.com/ory/hydra-login-consent-node\nè¿™é‡Œå°±æ˜¯åœ¨å¯åŠ¨è¿™ä¸ªç™»å½•/æˆæƒæ ·ä¾‹ç½‘ç«™äº†.\nPS:æˆ‘ç”¨dotnet coreä¹Ÿå®ç°äº†ä¸€å¥—å®Œæ•´çš„ç”¨æˆ·ä¸­å¿ƒæˆæƒç½‘ç«™,è¿‡å‡ å¤©ç©ºäº†æ•´ç†ä¸€ä¸‹å¼€æºå‘å‡ºæ¥.\nåˆ›å»ºoauth client å®¢æˆ·ç«¯ 1 2 3 4 5 6 7 8 9 10 11 docker run --rm -it \\ -e HYDRA_URL=https://ory-hydra-example--hydra:4444 \\ --network hydraguide \\ oryd/hydra:v1.0.0-beta.5 \\ clients create --skip-tls-verify \\ --id facebook-photo-backup \\ --secret some-secret \\ --grant-types authorization_code,refresh_token,client_credentials,implicit \\ --response-types token,code,id_token \\ --scope openid,offline,photos.read \\ --callbacks http://127.0.0.1:9010/callback æ²¡ä»€ä¹ˆè¯´çš„,ç•™æ„ä¸€ä¸‹callbacksåœ°å€å³å¯.\nå…¶å®å°±æ˜¯XXäº’è”é‡Œé¢çš„XXåº”ç”¨çš„ä¸€äº›ä¿¡æ¯.\næµ‹è¯•hydra oauthæ•´ä½“æˆæƒæµç¨‹ å¯åŠ¨ä¸€ä¸ªè¯·æ±‚æˆæƒçš„APP,å¦‚ä¸‹:\n1 2 3 4 5 6 7 8 9 10 11 docker run --rm -it \\ --network hydraguide \\ -p 9010:9010 \\ oryd/hydra:v1.0.0-beta.5 \\ token user --skip-tls-verify \\ --port 9010 \\ --auth-url https://localhost:9000/oauth2/auth \\ --token-url https://ory-hydra-example--hydra:4444/oauth2/token \\ --client-id facebook-photo-backup \\ --client-secret some-secret \\ --scope openid,offline,photos.read å¯åŠ¨ä¹‹åè®¿é—®http://127.0.0.1:9010/\nå¤§æ¦‚ä¼šçœ‹åˆ°:\n1 2 3 4 Welcome to the example OAuth 2.0 Consumer This example requests an OAuth 2.0 Access, Refresh, and OpenID Connect ID Token from the OAuth 2.0 Server (ORY Hydra). To initiate the flow, click the \u0026#34;Authorize Application\u0026#34; button. Authorize application ç‚¹å‡» Authorize application ç«‹å³è°ƒæ•´åˆ°ç™»å½•é¡µé¢.\nç™»å½•é¡µå…¶å®å°±æ˜¯æˆ‘ä»¬ä¸Šé¢å¯åŠ¨çš„node.jsçš„çš„ç™»å½•é¡µé¢,å³:http://localhost:9020/login?login_challenge=XXX\nè¾“å…¥è´¦å·å¯†ç ä¹‹åä¼šè·³åˆ°æˆæƒé¡µé¢,å³:http://localhost:9020/consent?consent_challenge=XXXX\næˆæƒé€‰å¥½äº†ä¹‹åç‚¹å‡»\u0026quot;\u0026quot; å…è®¸æˆæƒ,ç«‹å³è·³è½¬å›åˆ°å›è°ƒåœ°å€,åŒæ—¶æ˜¾ç¤ºaccess tokenç›¸å…³ä¿¡æ¯.\n1 2 3 4 Access Token: SwMfFOSHEFpiChmBvRtFLTeaPzCh-TNEXtxTfibgmdw.AgqJrWyn1VlH4FouUucBJSDsmcwOGDI3cHpuy2sDrpI Refresh Token: 48pXaTrBoXl9JxkweFgQV6frEYPwrkE6BaY8U5mymbo.ZuZe68sqX6wtRTk9k1cKBNPJxQzEBEb0G86tT_WVzCg Expires in: 2018-08-09 11:46:14.9905228 +0000 UTC m=+3843.912315001 ID Token: eyJhbGciOiJSUzI1NiIsImtpZCI6InB1YmxpYzo3MzBhZDc4ZC04ODJmLTQzNzItYTRhMi05NTE2NDdlNTk0ZTciLCJ0eXAiOiJKV1QifQ.eyJhdWQiOlsiZmFjZWJvb2stcGhvdG8tYmFja3VwIl0sImF1dGhfdGltZSI6MTUzMzgxMTUyMSwiZXhwIjoxNTMzODE1MTc1LCJpYXQiOjE1MzM4MTE1NzUsImlzcyI6Imh0dHBzOi8vbG9jYWxob3N0OjkwMDAvIiwianRpIjoiOGFkMWE2ZTYtZWY3NC00MTM2LThmODUtMGU0N2FhYWYxZjY1Iiwibm9uY2UiOiJkcXBrcXlkaG1iZXZhdXNtYXJzdWxjcW0iLCJyYXQiOjE1MzM4MTE0MTMsInN1YiI6ImZvb0BiYXIuY29tIn0.euqVspiSeYvMonrwHSPxhfXaCOoYtfP5S5_dJLg6zeQ-Kw6rRJfQRh2ddMiaZBOHdRrQLGHouNSd5SCWP4DgKjr6eA4YKmiTNvDKt0ktIBfTROs5HKOIp9NHLSCL636m10lEVAGJEnL2jwVn5JeNjYmn4nRqOqPBfAxmqFYu-RuHk3HP4w9cKAK2tUBvwUkjH7PBkZ4MZI3AgvK985iPxZWkiyJAn4QPSAidenlQqQJXc7kpYpvP6wauk-nWxid6p0GRL1MozEV1Kok6Nqiw5BtEhuuC3Saijezr-G7Va6SwgTe731huzM6xRH_ovh2x4gayQu-qFX6bT8gjvLh6otQbqEa11nNc0gXIauKds2FF8mD65k9-tnFvbs3T7fJS6wu3LOm9VAtCB78CiTH92E7sbGXaQRC9nsB6LCCteoBPYa8e-dYZxXZHPdWP9tDNc3t2Zr1Lg5bljpWXmFcLllO6gSTqhKiT0otQaQgLDm9GvSeobEaCYRmgk50FdGz4z4Sngek6JJBWHNDo16zuJMScLxIdUfhK9LtLpIsL7w7F01GRMkcriowloRM85qO3V-Dq6REY6VzAe3OkT3_0bxsbU_fzFEIbpDcXdq8hchkEq3aAp48dqXb0WE4R7Iwl4JhjDKiQFxP4-Wk5rPqRyRs7rWiDUxS9v29c88pXd6E è¿™ä¸ªæ—¶å€™æˆ‘ä»¬ä½¿ç”¨Access Tokenå»è°ƒç”¨userinfo API,å³å¯æ­£å¸¸è·å–åˆ°ç”¨æˆ·ä¿¡æ¯.\n1 2 3 4 5 6 curl -X GET \\ https://localhost:9000/userinfo \\ -H \u0026#39;authorization: Bearer SwMfFOSHEFpiChmBvRtFLTeaPzCh-TNEXtxTfibgmdw.AgqJrWyn1VlH4FouUucBJSDsmcwOGDI3cHpuy2sDrpI\u0026#39; \\ -H \u0026#39;cache-control: no-cache\u0026#39; \\ -H \u0026#39;content-type: application/json\u0026#39; \\ -H \u0026#39;postman-token: fecb7032-db0a-bb1b-a61b-de22add7e5bc\u0026#39; ç”¨æˆ·ä¿¡æ¯å¦‚ä¸‹:\n1 2 3 { \u0026#34;sub\u0026#34;: \u0026#34;foo@bar.com\u0026#34; } ä¸ºä»€ä¹ˆè¿™é‡Œç”¨æˆ·ä¿¡æ¯åªæœ‰ä¸€ä¸ªsubå‘¢?\nå› ä¸ºä»–ä»¬å®ç°ory-hydra-example\u0026ndash;consentçš„æ—¶å€™ä»€ä¹ˆéƒ½æ²¡åŠ è¿›å»,\nå…·ä½“åº”è¯¥æ€ä¹ˆåšç­‰æˆ‘ä¸‹æ¬¡åˆ†äº«dotnet coreå®ç° login-consentå†è¯´äº†..\nå—¯,æœ¬æ–‡ç»“æŸ.\n","date":"2018-07-28T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/%E6%AF%8F%E5%91%A8%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE%E5%88%86%E4%BA%AB-%E5%B9%B4%E8%BD%BB%E4%BA%BA%E7%9A%84%E7%AC%AC%E4%B8%80%E4%B8%AAoauth2.0-serverhydra/","title":"æ¯å‘¨å¼€æºé¡¹ç›®åˆ†äº«-å¹´è½»äººçš„ç¬¬ä¸€ä¸ªOAuth2.0 Server:hydra"},{"content":"dotnet core(è¯»å–é…ç½®æ–‡ä»¶) ç¬¬ä¸€ç¯‡:æ‰‹æŠŠæ‰‹æ•™ä½ å†™dotnet core(å…¥é—¨ç¯‡)\nç¬¬äºŒç¯‡:æ‰‹æŠŠæ‰‹æ•™ä½ ASP.NET Core\nä»Šå¤©æˆ‘ä»¬æ¥å­¦ä¹ æ€ä¹ˆè¯»å–dotnet coreç¨‹åºçš„é…ç½®æ–‡ä»¶.\nä¸€èˆ¬dotnet coreé…ç½®æ–‡ä»¶éƒ½ä½äºé¡¹ç›®ç›®å½•ä¸‹,åä¸ºappsettings.json\nç›´æ¥è¯»æ–‡ä»¶ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 { \u0026#34;MySQLConnectionString\u0026#34;: \u0026#34;server=mysqlåœ°å€;port=ç«¯å£å·;database=æ•°æ®åº“åå­—;uid=è´¦å·;pwd=å¯†ç ;charset=\u0026#39;utf-8\u0026#39;;Allow User Variables=True;Connection Timeout=30;SslMode=None;\u0026#34;, \u0026#34;RedisConnectionString\u0026#34;: \u0026#34;redisæ•°æ®åº“åœ°å€:ç«¯å£,name=åå­—,keepAlive=1800,syncTimeout=10000,connectTimeout=360000,password=è®¿é—®å¯†ç ,ssl=False,abortConnect=False,responseTimeout=360000,defaultDatabase=1\u0026#34;, \u0026#34;EmailAccount\u0026#34;: \u0026#34;QQé‚®ç®±è´¦å·\u0026#34;, \u0026#34;EmailPassword\u0026#34;: \u0026#34;QQé‚®ç®±å¯†ç \u0026#34;, \u0026#34;EmailSMTPDomain\u0026#34;: \u0026#34;smtp.qq.com\u0026#34;, \u0026#34;EmailSMTPPort\u0026#34;: 587, \u0026#34;SenderAddress\u0026#34;: \u0026#34;QQé‚®ç®±è´¦å·\u0026#34;, \u0026#34;ReceiverAddress\u0026#34;: \u0026#34;QQé‚®ç®±è´¦å·\u0026#34;, \u0026#34;ReceiverName\u0026#34;: \u0026#34;liguobao-test\u0026#34;, \u0026#34;EncryptionConfigCIV\u0026#34;: \u0026#34;åŠ å¯†å‘é‡,16ä¸ª16è¿›åˆ¶æ•°å­—\u0026#34;, \u0026#34;EncryptionConfigCKEY\u0026#34;: \u0026#34;åŠ å¯†ç§˜é’¥,16ä¸ª16è¿›åˆ¶æ•°å­—\u0026#34;, \u0026#34;ESURL\u0026#34;:\u0026#34;http://127.0.0.1:9201/\u0026#34;, \u0026#34;ESUserName\u0026#34;:\u0026#34;\u0026#34;, \u0026#34;ESPassword\u0026#34;:\u0026#34;\u0026#34;, \u0026#34;QQAPPID\u0026#34;:\u0026#34;\u0026#34;, \u0026#34;QQAPPKey\u0026#34;:\u0026#34;\u0026#34;, \u0026#34;QQAuthReturnURL\u0026#34;:\u0026#34;\u0026#34; } é‚£ä¹ˆæˆ‘ä»¬ç›´æ¥å»è¯»jsonç„¶ååºåˆ—åŒ–æˆå¯¹è±¡æ˜¯ä¸æ˜¯å°±å¯ä»¥äº†.\næ²¡æ¯›ç—…,ç¡®å®æ˜¯å¯ä»¥è¿™æ ·ç©çš„. ä»£ç å¤§æ¦‚æ˜¯è¿™æ ·çš„\u0026hellip;\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 public class AppSettings { public string MySQLConnectionString {get;set;} public string RedisConnectionString {get;set;} // .... } public AppSettings JsonHelper(string jsonFilePath) { _movieJsonFilePath = jsonFilePath; if (!File.Exists(jsonFilePath)) { var pvFile = File.Create(jsonFilePath); pvFile.Flush(); pvFile.Dispose(); return; } using (var stream = new FileStream(jsonFilePath, FileMode.OpenOrCreate)) { try { StreamReader sr = new StreamReader(stream); JsonSerializer serializer = new JsonSerializer { NullValueHandling = NullValueHandling.Ignore, Converters = { new JavaScriptDateTimeConverter() } }; //æ„å»ºJson.netçš„è¯»å–æµ using (var reader = new JsonTextReader(sr)) { return serializer.Deserialize\u0026lt;AppSettings\u0026gt;(reader); } } catch (Exception ex) { return null; } } } ç›´æ¥è¯»æ–‡ä»¶ç„¶åååºåˆ—åŒ–å®åœ¨æœ‰ç‚¹éº»çƒ¦,æœ‰æ²¡æœ‰ç®€å•ç‚¹çš„åŠæ³•å•Š.\nå®¢å®˜,åªè¦ç»™é’±ä»€ä¹ˆéƒ½æœ‰.\nä½¿ç”¨ConfigurationBuilder è¯»å– ç›´æ¥ä¸Šä»£ç :\n1 2 3 4 5 6 7 8 9 10 11 public void Configure(IApplicationBuilder app, IHostingEnvironment env, ILoggerFactory loggerFactory) { var mySQLConnectionString = new ConfigurationBuilder() .SetBasePath(Directory.GetCurrentDirectory()) .AddJsonFile(\u0026#34;appsettings.json\u0026#34;).Build()[\u0026#34;MySQLConnectionString\u0026#34;]; // ConnectionStringsèŠ‚ç‚¹ä¸‹çš„MySQLConnectionString // var mySQLConnectionString = new ConfigurationBuilder() // .SetBasePath(Directory.GetCurrentDirectory()) // .AddJsonFile(\u0026#34;appsettings.json\u0026#34;).Build()[\u0026#34;ConnectionStrings:MySQLConnectionString\u0026#34;]; } å—¯,å°±æ˜¯è¿™ä¹ˆç®€å•ç²—æš´,ä»€ä¹ˆéƒ½ä¸ç®¡\u0026hellip;\nè¾£é¸¡,è¿˜æœ‰æ²¡æœ‰æ›´ä¼˜é›…ç‚¹çš„æ–¹æ³•å•Š.\nå“¦,è¿™æ ·çš„è¦æ±‚ä¹ˆ?é‚£ä¹ˆæˆ‘ä»¬ä¸ŠDI(è‡ªåŠ¨æ³¨å…¥)å§.\nDIè¯»å–é…ç½®æ–‡ä»¶ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 //Startup.cs public IConfiguration Configuration { get; } public Startup(IHostingEnvironment env) { //å¤Ÿèµ var builder = new ConfigurationBuilder() .SetBasePath(env.ContentRootPath) .AddJsonFile(\u0026#34;appsettings.json\u0026#34;, optional: true, reloadOnChange: true); Configuration = builder.Build(); } public void ConfigureServices(IServiceCollection services) { services.AddMvc(); //å°†Configurationæ³¨å…¥åˆ°APPConfigurationå®ä¾‹ä¸­ services.AddOptions().Configure\u0026lt;AppSettings\u0026gt;(Configuration); } ç„¶åæˆ‘ä»¬åœ¨Controllerä¸­ä½¿ç”¨æ„é€ å‡½æ•°æ³¨å…¥çš„æ–¹å¼è·å–APPConfigurationå®ä¾‹\n1 2 3 4 5 6 private AppSettings configuration; public AccountController(IOptions\u0026lt;AppSettings\u0026gt; configurationOption) { this.configuration = configurationOption.Value; } ç„¶åå°±å¯ä»¥æ„‰å¿«çš„ä½¿ç”¨äº†.\næœ¬æ–‡ç»“æŸ\u0026hellip;\næ‹œ\u0026hellip;\n","date":"2018-07-01T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E5%86%99dotnet-core%E8%AF%BB%E5%8F%96%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6/","title":"æ‰‹æŠŠæ‰‹æ•™ä½ å†™dotnet core(è¯»å–é…ç½®æ–‡ä»¶)"},{"content":"åç«¯APIå…¥é—¨å­¦ä¹ æŒ‡åŒ— äº†è§£ä¸€ä¸‹ä¸€ä¸‹æ¦‚å¿µ.\nRESTful APIæ ‡å‡†] æ‰€æœ‰çš„APIéƒ½éµå¾ª[RESTful APIæ ‡å‡†].\nå»ºè®®å¤§å®¶éƒ½ç®€å•äº†è§£ä¸€ä¸‹HTTPåè®®å’ŒRESTful APIç›¸å…³èµ„æ–™.\né˜®ä¸€å³°:ç†è§£RESTfulæ¶æ„\né˜®ä¸€å³°:RESTful API è®¾è®¡æŒ‡å—\nRESTful APIæŒ‡å—\nä¾èµ–æ³¨å…¥ DI æµ…è°ˆä¾èµ–æ³¨å…¥\né˜®ä¸€å³°:è½¯ä»¶æ¶æ„å…¥é—¨\nJavaç‰ˆ JDKç‰ˆæœ¬:1.8 +\né›†æˆå¼€å‘ç¯å¢ƒ: IDEA https://www.jetbrains.com/idea/\næ•°æ®åº“:MySQL 5.7+\nå†…å­˜æ•°æ®åº“:Redis\næ•°æ®åº“è®¿é—®æ¡†æ¶: \bmybatis + \bgroovyè„šæœ¬(PS:å¦‚æœè‡ªå·±ç†Ÿæ‚‰JPAä¹Ÿå¯ä»¥ç”¨)\næ„å»ºå·¥å…·: maven(è‡ªå·±ç†Ÿæ‚‰\bgradleçš„è¯ä¹Ÿå¯ä»¥ç”¨)\n\bJavaæ¡†æ¶ç›´æ¥ä¸ŠSpring Boot + Spring MVC.\nèµ„æ–™é“¾æ¥ IBM:Spring æ¡†æ¶ç®€ä»‹\nIBM:Maven è®©äº‹æƒ…å˜å¾—ç®€å•\nSpring MVCå¿«é€Ÿå…¥é—¨æ•™ç¨‹\nIBM:Spring Boot åŸºç¡€\nSpring Bootâ€”â€”å¼€å‘æ–°ä¸€ä»£Spring Javaåº”ç”¨\nBuilding an Application with Spring Boot\nMyBatiså…¥é—¨å®ä¾‹ï¼šæ•´åˆSpring MVCä¸MyBatiså¼€å‘é—®ç­”ç½‘ç«™\nmybatis å®˜ç½‘\nJavaå…¥é—¨ç›®æ ‡ ä½¿ç”¨Spring boot æ­å»ºWeb API,é€šè¿‡Web APIå¯¹æ•°æ®å¢åˆ æŸ¥æ”¹.\nC#ç‰ˆ .NETç‰ˆæœ¬: dotnet core 2.0\né›†æˆå¼€å‘ç¯å¢ƒ: Visual Studio Code + dotnet core SDK æˆ–è€… Visual Studio 2017(æ¨èä½¿ç”¨ Visual Studio Code)\næ•°æ®åº“:MySQL 5.7+\nå†…å­˜æ•°æ®åº“:Redis\næ•°æ®åº“è®¿é—®æ¡†æ¶: Dapper\ndotnet core ç›´æ¥ä½¿ç”¨dotnet core mvcæ¡†æ¶å³å¯,ä¾èµ–æ³¨å…¥ç›´æ¥ä½¿ç”¨åŸç”Ÿæ¡†æ¶.\nå…¥é—¨èµ„æ–™é“¾æ¥ æ‰‹æŠŠæ‰‹æ•™ä½ å†™dotnet core(å…¥é—¨ç¯‡)\næ‰‹æŠŠæ‰‹æ•™ä½ ASP.NET Core\nå¾®è½¯:NET Core æ•™ç¨‹\nASP.NET Core ä¸­æ–‡æ–‡æ¡£ ç¬¬ä¸€ç«  å…¥é—¨\nDapper ä½¿ç”¨æ•™ç¨‹\nDapper Github\nC#å…¥é—¨ç›®æ ‡ ä½¿ç”¨ASP.NET Coreæ­å»ºWeb API,é€šè¿‡Web APIå¯¹æ•°æ®å¢åˆ æŸ¥æ”¹.\nPythonç‰ˆ Pythonç‰ˆæœ¬:3.6.5\né›†æˆå¼€å‘ç¯å¢ƒ: Visual Studio Code + Python debugæ’ä»¶ æˆ–è€… pycharm\næ•°æ®åº“:MySQL 5.7+\nå†…å­˜æ•°æ®åº“:Redis\næ•°æ®åº“è®¿é—®æ¡†æ¶: sqlalchemy\nPythonä½¿ç”¨flaskæ¡†æ¶æ­å»ºWeb API\nå…¥é—¨åˆ°æ”¾å¼ƒèµ„æ–™ çŸ¥ä¹-æè¾‰:Hello, Flask!\nå»–é›ªå³°:Pythonæ•™ç¨‹\nèœé¸Ÿæ•™ç¨‹:Python3åŸºç¡€\nSQLAlchemy ORMæ•™ç¨‹\nå®éªŒæ¥¼:SQLAlchemy åŸºç¡€æ•™ç¨‹\nçŸ¥ä¹-çŒªäº†ä¸ªå»:SQLAlchemyå…¥é—¨å’Œè¿›é˜¶\nPythonå…¥é—¨ç›®æ ‡ ä½¿ç”¨Python flaskæ­å»ºWeb API,é€šè¿‡Web APIå¯¹æ•°æ®å¢åˆ æŸ¥æ”¹.\nPHPç‰ˆæœ¬ çœŸæœ‰äººé€‰æ‹©è¿™ä¸ª?æ‹–å‡ºå»æ‰“æ­»ç®—äº†å§\u0026hellip;\nPHPç‰ˆæœ¬: 7.1 +\né›†æˆå¼€å‘ç¯å¢ƒ: Visual Studio Code + PHP debugæ’ä»¶ + nginx + php-fpm\næ•°æ®åº“:MySQL 5.7+\nå†…å­˜æ•°æ®åº“:Redis\næ•°æ®åº“è®¿é—®æ¡†æ¶: å¿˜äº†,å›å¤´è¡¥\næ„å»ºå·¥å…·:composer\nå…¥é—¨åˆ°æ‹é»„ç‰‡ Laravel-ç®€æ´ã€ä¼˜é›…çš„PHPå¼€å‘æ¡†æ¶(PHP Web Framework)\nlaravel ä¸­æ–‡æ•™ç¨‹\næ‹é»„ç‰‡å…¥é—¨ç›®æ ‡ ä½¿ç”¨laravel æ­å»ºWeb API,é€šè¿‡Web APIå¯¹æ•°æ®å¢åˆ æŸ¥æ”¹.\nnode.js ç‰ˆ node.jsç‰ˆæœ¬:9.0+\né›†æˆå¼€å‘ç¯å¢ƒ: Visual Studio Code\næ•°æ®åº“:MySQL 5.7+\nå†…å­˜æ•°æ®åº“:Redis\næ•°æ®åº“è®¿é—®æ¡†æ¶: sequelize æˆ–è€…orm2\næ„å»ºå·¥å…·:npm\nnode.jså…¥é—¨èµ„æ–™é“¾æ¥ Express:åŸºäº Node.js å¹³å°ï¼Œå¿«é€Ÿã€å¼€æ”¾ã€æç®€çš„ web å¼€å‘æ¡†æ¶ã€‚\nèœé¸Ÿæ•™ç¨‹:Node.js Express æ¡†æ¶\nsequelizejs\nSequelize ä¸­æ–‡æ‰‹å†Œ\nnode.jså…¥é—¨ç›®æ ‡ ä½¿ç”¨Express æ­å»ºWeb API,é€šè¿‡Web APIå¯¹æ•°æ®å¢åˆ æŸ¥æ”¹.\næ²¡äº†,çº¯ç²¹å è¡Œç”¨çš„\u0026hellip;\næ‹œ.\n","date":"2018-06-18T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/%E5%90%8E%E7%AB%AFapi%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8C%97/","title":"åç«¯APIå…¥é—¨å­¦ä¹ æŒ‡åŒ—"},{"content":"å¯èƒ½æ˜¯å…¨ç½‘é¦–ä¸ªæ”¯æŒé˜¿é‡Œäº‘Elasticsearch Xapcké‰´æƒçš„Skywalking å¯¹Skywalkingæœ‰å…´è¶£çš„åŒå­¦å‚è§:å¹´è½»äººçš„ç¬¬ä¸€ä¸ªAPM-Skywalking\nä¹‹å‰åœ¨æ­å»ºSkywalkingçš„æ—¶å€™å‘ç°,å®˜æ–¹Skywalking 5.Xå¹¶æ”¯æŒæœ‰é‰´æƒçš„Elasticsearch.\nè€Œæˆ‘å¸æœ‰å…¶ä»–éœ€æ±‚å·²ç»è´­ä¹°äº†é˜¿é‡Œäº‘çš„Elasticsearch,å’¨è¯¢è¿‡é˜¿é‡Œäº‘æŠ€æœ¯æ”¯æŒåä»–ä»¬è¡¨ç¤ºå¹¶ä¸èƒ½å»æ‰é‰´æƒ,æ‰€ä»¥åªå¥½è‡ªå·±æƒ³åŠæ³•äº†.\nåˆåœ¨SkywalkingæŠ€æœ¯ç¾¤é—®äº†ä¸€åœˆ,æœ‰å…¶ä»–äººä¹Ÿé‡åˆ°è¿‡ç±»ä¼¼çš„é—®é¢˜,ä½†æ˜¯æœ€åè¿˜æ˜¯é€‰æ‹©è‡ªå»ºESäº†.\nå®åœ¨ä¸æƒ³è‡ªå·±å†æµªè´¹ç²¾åŠ›å»æ­å»ºESäº†,è¿˜æ˜¯è§‰å¾—å¯ä»¥å°è¯•ä¸€ä¸‹åˆ«çš„æ–¹æ¡ˆ.\nç„¶åå’¨è¯¢äº†ä¸€ä¸‹wushengå¤§å¤§ä¹‹å,ä»–è¯´å¯ä»¥è‡ªå·±å°è¯•æ¢ä¸€ä¸ªæ”¯æŒXPacké‰´æƒçš„Client,åº”è¯¥æ²¡ä»€ä¹ˆå¤ªå¤§çš„é—®é¢˜.\näºæ˜¯å°±å¼€å§‹äº†\u0026quot;å¡«å‘\u0026quot;ä¹‹æ—….\né¦–å…ˆæ˜¯å¼•å…¥x-pack-transportæ”¯æŒ apm-collector/apm-collector-component/client-component/pom.xml\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.elasticsearch.client\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;x-pack-transport\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;${elasticsearch.client.version}\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;repositories\u0026gt; \u0026lt;repository\u0026gt; \u0026lt;id\u0026gt;elasticsearch-releases\u0026lt;/id\u0026gt; \u0026lt;url\u0026gt;https://artifacts.elastic.co/maven\u0026lt;/url\u0026gt; \u0026lt;releases\u0026gt; \u0026lt;enabled\u0026gt;true\u0026lt;/enabled\u0026gt; \u0026lt;/releases\u0026gt; \u0026lt;snapshots\u0026gt; \u0026lt;enabled\u0026gt;false\u0026lt;/enabled\u0026gt; \u0026lt;/snapshots\u0026gt; \u0026lt;/repository\u0026gt; \u0026lt;/repositories\u0026gt; æ¥ç€åœ¨ \u0026hellip;in/java/org/apache/skywalking/apm/collector/client/elasticsearch/ElasticSearchClient.java\nåŠ å…¥PreBuiltXPackTransportClientçš„åˆå§‹åŒ–\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 private final String securityUser; private PreBuiltXPackTransportClient initXPackClient() { Settings settings = Settings.builder() .put(\u0026#34;cluster.name\u0026#34;, clusterName) .put(\u0026#34;xpack.security.transport.ssl.enabled\u0026#34;, false) .put(\u0026#34;xpack.security.user\u0026#34;, securityUser) .put(\u0026#34;client.transport.sniff\u0026#34;, false).build(); return new PreBuiltXPackTransportClient(settings); } private PreBuiltTransportClient initClient() { Settings settings = Settings.builder()\tSettings settings = Settings.builder() .put(\u0026#34;cluster.name\u0026#34;, clusterName)\t.put(\u0026#34;cluster.name\u0026#34;, clusterName) .put(\u0026#34;client.transport.sniff\u0026#34;, clusterTransportSniffer)\t.put(\u0026#34;client.transport.sniff\u0026#34;, clusterTransportSniffer) .build();\t.build(); return new PreBuiltTransportClient(settings); } // æ–°å¢ private final String securityUser; // åˆ¤æ–­è¿™ä¸ªå˜é‡æ˜¯ä¸æ˜¯nullæˆ–è€…ç©ºå­—ç¬¦ä¸²,å¦‚æœæ˜¯å°±é»˜è®¤åˆå§‹åŒ–,ä¸æ˜¯åˆ™ä½¿ç”¨initXPackClientåˆå§‹åŒ– // æ”¹ä¸€ä¸‹initialize æ–¹æ³• private final String securityUser; @Override public void initialize() throws ClientException { if (securityUser == null || \u0026#34;\u0026#34;.equals(securityUser)) { client = initClient(); } else { client = initXPackClient(); } ç„¶åè¿˜è¦æŠŠapm-collector/pom.xmlçš„elasticsearch.client.version ç‰ˆæœ¬æ”¹æˆ5.3.3.\næ”¹å®Œä¹‹åå› ä¸º5.3.3å’ŒåŸæ¥5.5.0æœ‰ç‚¹ä¸ä¸€æ ·,éœ€è¦ä¿®æ”¹ä¸€ä¸‹å¾ˆå‡ ä¸ªåœ°æ–¹çš„ä»£ç .\nè¿™æ—¶å€™å»ºè®®ç›´æ¥ä½¿ç”¨IDEA build ä¸€ä¸‹,å“ªé‡ŒæŠ¥é”™æ”¹å“ªé‡Œå°±å¥½.\nä¸»è¦éƒ½æ˜¯ searchResponse.getHits().totalHits æ”¹æˆsearchResponse.getHits().totalHits()\nç¥å¥‡å‘ç°5.5.0ç‰ˆæœ¬çš„ES ClientæŠŠ5.3.3çš„searchResponse.getHits().totalHits() æ–¹æ³•æ”¹æˆäº†å±æ€§.\nä¸ç»æ„Ÿæ…¨éƒ½æ˜¯äººæ‰å•Š\u0026hellip;\nåˆ«çš„ä¸€äº›åŸºæœ¬éƒ½æ˜¯å¼•å…¥ import org.elasticsearch.action.bulk.byscroll.BulkByScrollResponse;\nå…¨éƒ¨ä»£ç åœ¨è¿™é‡Œ:liguobao/incubator-skywalking\nå®Œæ•´æ”¹å¥½çš„ä»£ç åœ¨liguobao/incubator-skywalking\nåŒæ—¶é…ç½®çš„æ—¶å€™æ·»åŠ ä¸€ä¸‹ securityUserå‚æ•°,å¦‚æœESæœ‰é‰´æƒå°±ä¼ å…¥,æ²¡æœ‰çš„è¯å°±ä¸ä¼ ,è¿™æ ·å°±è¾¾åˆ°é‰´æƒå’Œä¸é‰´æƒä¸¤ç§éœ€æ±‚çš„å…¼å®¹äº†.\næ”¯æŒxpackçš„dockeréƒ¨ç½²æ–¹æ¡ˆ å®Œæ•´åŸæ–‡é“¾æ¥:Skywalking-Dcoker for ES xpack é•œåƒ\nDockerfileè¯´æ˜ apache-skywalking-apm-incubating.tar.gzä¸ºæ”¯æŒES X-Packä¿®æ”¹åæ‰“åŒ…å‡ºæ¥çš„å‹ç¼©åŒ…,æ­¤ä»“åº“æ²¡æœ‰è¿™ä¸ªæ–‡ä»¶çš„.\nå¯ä»¥å»QQç¾¤:Apache SkyWalkingäº¤æµç¾¤(392443393)ç¾¤æ–‡ä»¶ä¸­ä¸‹è½½apache-skywalking-apm-incubating-xpack.tar.gz\næˆ–è€…è‡ªè¡Œç¼–è¯‘liguobao/incubator-skywalking/tree/5.x æ­¤ç‰ˆæœ¬çš„æºç .\nç¼–è¯‘æ­¥éª¤:\n1 2 3 4 5 6 7 8 9 # Prepare git, JDK8 and maven3 git clone https://github.com/liguobao/incubator-skywalking.git cd incubator-skywalking/ git checkout 5.x #Switch to the tag by using git checkout [tagname] (Optional, switch if want to build a release from source codes) git submodule init git submodule update Run ./mvnw clean package -DskipTests #All packages are in /dist.(.tar.gz for Linux and .zip for Windows). Docker é•œåƒåç§°:liguobao/skywalking-docker\næ‹‰å–é•œåƒï¼ˆPull Imageï¼‰: docker pull liguobao/skywalking-docker:5.0.RC2.xpack\nè¿è¡Œé•œåƒï¼ˆRunï¼‰for ES xpack: docker run -p 8080:8080 -p 10800:10800 -p 11800:11800 -p 12800:12800 -e ES_CLUSTER_NAME=elasticsearch -e ES_ADDRESSES=192.168.2.96:9300 -e SECURITY_USER='elastic:password' -d liguobao/skywalking-docker:5.0.RC2.xpack ä½¿ç”¨æµè§ˆå™¨è®¿é—®http://localhost:8080å³å¯. æ—¥å¿—æŒ‚è½½ -v /your/log/path:/apache-skywalking-apm-incubating/logs ç¯å¢ƒå˜é‡ï¼ˆEnvironment Variablesï¼‰ ES_CLUSTER_NAME,ES_ADDRESSES:elasticsearch åœ°å€å’Œé›†ç¾¤åç§°ã€‚æ³¨æ„ï¼šæ­¤å¤„Elasticsearchåœ°å€ä¸­çš„ç«¯å£åŠ¡å¿…æ˜¯Elasticsearch TCPç«¯å£ã€‚ SECURITY_USER,SECURITY_USER:elasticsearch çš„è´¦å·å¯†ç ,ä½¿ç”¨X-Packå®ç°çš„,å¸¸è§é˜¿é‡Œäº‘ES,æ ¼å¼ä¸º:\u0026lsquo;user:password\u0026rsquo;.æ­¤å‚æ•°ä¸ä¼ å…¥æˆ–è€…ä¼ å…¥\u0026rsquo;\u0026rsquo; ,é»˜è®¤ä½¿ç”¨æ²¡æœ‰æˆæƒçš„client. NAMING_BIND_HOST,NAMING_BIND_PORT:OS real network IP(binding required),for agent to find collector cluster. BIND_HOST,REMOTE_BIND_PORT:OS real network IP(binding required),for collector nodes communicate with each other in cluster. collectorN \u0026ndash;(gRPC) \u0026ndash;\u0026gt; collectorM AGENT_GRPC_BIND_PORT:OS real network IP(binding required),for agent to uplink data(trace/metrics) to collector. agent\u0026ndash;(gRPC)\u0026ndash;\u0026gt; collector AGENT_JETTY_BIND_HOST,AGENT_JETTY_BIND_PORT:OS real network IP(binding required), for agent to uplink data(trace/metrics) to collector through HTTP. agent\u0026ndash;(HTTP)\u0026ndash;\u0026gt; collector -UI_JETTY_BIND_HOST,UI_JETTY_BIND_PORT:Stay in 0.0.0.0 if UI starts up in default mode.Change it to OS real network IP(binding required), if deploy collector in different machine. ä¸elasticsearch-shanghai-zoneé•œåƒé…åˆä½¿ç”¨è¯·å‚è€ƒ wutang/elasticsearch-shanghai-zone quick start åè®° æœ¬æ¥è¿˜æ‰“ç®—æŠŠä»£ç æç»™ä¸»ä»“åº“çš„,ä½†æ˜¯wusheng å¤§å¤§è¯´xpackå®¢æˆ·ç«¯å’ŒApacheè¦æ±‚çš„æˆæƒæœ‰å†²çª,é‚\u0026hellip;\né‚£å°±ç•™ç€è‡ªå·±ç©äº†.\næ‹œ\u0026hellip;\n","date":"2018-06-18T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/%E5%8F%AF%E8%83%BD%E6%98%AF%E5%85%A8%E7%BD%91%E9%A6%96%E4%B8%AA%E6%94%AF%E6%8C%81%E9%98%BF%E9%87%8C%E4%BA%91elasticsearch-xapck%E9%89%B4%E6%9D%83%E7%9A%84skywalking/","title":"å¯èƒ½æ˜¯å…¨ç½‘é¦–ä¸ªæ”¯æŒé˜¿é‡Œäº‘Elasticsearch Xapcké‰´æƒçš„Skywalking"},{"content":"asp.net coreç¯‡ ä¸Šä¸€ç¯‡æ‰‹æŠŠæ‰‹æ•™ä½ å†™dotnet core(å…¥é—¨ç¯‡)æˆ‘ä»¬å·²ç»ç®€å•åœ¨dotnet coreé‡Œé¢è·‘äº†ä¸ª\u0026quot;hello world!\u0026ldquo;å’Œç´¯åŠ ç¨‹åº.\nä»Šå¤©æˆ‘ä»¬çš„æ­¥å­è¿ˆå¤§ä¸€ç‚¹,ç›´æ¥ä¸Š ASP.NET Coreäº†.\nASP.NET Core æ˜¯ä¸€ä¸ªæ–°çš„å¼€æºå’Œè·¨å¹³å°çš„æ¡†æ¶ï¼Œç”¨äºæ„å»ºå¦‚ Web åº”ç”¨ã€ç‰©è”ç½‘ï¼ˆIoTï¼‰åº”ç”¨å’Œç§»åŠ¨åç«¯åº”ç”¨ç­‰è¿æ¥åˆ°äº’è”ç½‘çš„åŸºäºäº‘çš„ç°ä»£åº”ç”¨ç¨‹åºã€‚ASP.NET Core åº”ç”¨å¯è¿è¡Œäº .NET Core å’Œå®Œæ•´çš„ .NET Framework ä¹‹ä¸Šã€‚ æ„å»ºå®ƒçš„ç›®çš„æ˜¯ä¸ºé‚£äº›éƒ¨ç½²åœ¨äº‘ç«¯æˆ–è€…å†…éƒ¨è¿è¡Œï¼ˆon-premisesï¼‰çš„åº”ç”¨æä¾›ä¸€ä¸ªä¼˜åŒ–çš„å¼€å‘æ¡†æ¶ã€‚å®ƒç”±æœ€å°å¼€é”€çš„æ¨¡å—åŒ–çš„ç»„ä»¶æ„æˆï¼Œå› æ­¤åœ¨æ„å»ºä½ çš„è§£å†³æ–¹æ¡ˆçš„åŒæ—¶å¯ä»¥ä¿æŒçµæ´»æ€§ã€‚ä½ å¯ä»¥åœ¨ Windowsã€Mac å’Œ Linux ä¸Šè·¨å¹³å°çš„å¼€å‘å’Œè¿è¡Œä½ çš„ ASP.NET Core åº”ç”¨ã€‚ ASP.NET Core å¼€æºåœ¨ GitHub ä¸Šã€‚ åˆ›å»ºASP.NET Coreç¨‹åº å¼€å‘ç¯å¢ƒ: dotnet SDK + VS Code è¿™é‡Œè¿˜æ˜¯ç›´æ¥ä½¿ç”¨dotnet newå‘½ä»¤æ¥åˆ›å»ºASP.NET Coreé¡¹ç›®, ç»ˆç«¯ä¸­è¾“å…¥\u0026quot;dotnet new web -n FirsrMVC\u0026rdquo;.\nè‡ªåŠ¨åˆ›å»ºFirsrMVCæ–‡ä»¶å¤¹å¹¶ç”Ÿæˆå¯¹åº”çš„csprojå’ŒCSæ–‡ä»¶,å…·ä½“æ“ä½œå’Œè¾“å‡ºä¿¡æ¯å¦‚ä¸‹:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 âœ codelover-blog git:(master) âœ— dotnet new web -n FirsrMVC The template \u0026#34;ASP.NET Core Empty\u0026#34; was created successfully. This template contains technologies from parties other than Microsoft, see https://aka.ms/template-3pn for details. Processing post-creation actions... Running \u0026#39;dotnet restore\u0026#39; on FirsrMVC/FirsrMVC.csproj... Restoring packages for /Users/liguobao/code/codelover-blog/FirsrMVC/FirsrMVC.csproj... Generating MSBuild file /Users/liguobao/code/codelover-blog/FirsrMVC/obj/FirsrMVC.csproj.nuget.g.props. Generating MSBuild file /Users/liguobao/code/codelover-blog/FirsrMVC/obj/FirsrMVC.csproj.nuget.g.targets. Restore completed in 1.97 sec for /Users/liguobao/code/codelover-blog/FirsrMVC/FirsrMVC.csproj. Restore succeeded. âœ codelover-blog git:(master) âœ— cd FirsrMVC âœ FirsrMVC git:(master) âœ— ls FirsrMVC.csproj Program.cs Startup.cs obj/ wwwroot/ Program.cs åœ¨VS Codeä¸­æ‰“å¼€FirsrMVCæ–‡ä»¶å¤¹,ç®€å•çœ‹ä¸€ä¸‹æ–‡ä»¶å’ŒProgram.csçš„ä»£ç \nProgram.csä¾æ—§æ˜¯Mainä¸»æ–¹æ³•,ç„¶åè°ƒç”¨äº†ä¸€ä¸‹BuildWebHostæ–¹æ³•,BuildWebHostè¿”å›ä¸€ä¸ªIWebHostçš„å®ä¾‹,æ¥ç€Run.\nå…ˆä¸ç®¡è¿™é‡Œå…·ä½“åšäº†ä»€ä¹ˆäº‹æƒ…,æˆ‘ä»¬ä»è¯­ä¹‰ä¸Šç†è§£ä¸€ä¸‹.\nBuildWebHostæ„å»ºä¸€ä¸ªWebçš„Hostå®ä¾‹,ç„¶åæŠŠWebHostå®ä¾‹è¿è¡Œèµ·æ¥äº†\nåˆ›å»ºWebHostä½¿ç”¨äº†ä¸€ä¸ªStartupçš„ç±»\nå…³äºè¯¦ç»†WebHostçš„è¯¦ç»†è§£æè§:ASP.NET Core è¿è¡ŒåŸç†è§£å‰–[1]:Hosting\nStartup.cs å…ˆç›´æ¥ä¸Šä¸€æ³¢ä»£ç \n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 using System; using System.Collections.Generic; using System.Linq; using System.Threading.Tasks; using Microsoft.AspNetCore.Builder; using Microsoft.AspNetCore.Hosting; using Microsoft.AspNetCore.Http; using Microsoft.Extensions.DependencyInjection; namespace FirsrMVC { public class Startup { // This method gets called by the runtime. Use this method to add services to the container. // For more information on how to configure your application, visit https://go.microsoft.com/fwlink/?LinkID=398940 public void ConfigureServices(IServiceCollection services) { } // This method gets called by the runtime. Use this method to configure the HTTP request pipeline. public void Configure(IApplicationBuilder app, IHostingEnvironment env) { if (env.IsDevelopment()) { app.UseDeveloperExceptionPage(); } //ç›´æ¥å¾€HTTP Responseä¸­å†™å…¥\u0026#34;Hello World!\u0026#34;,å³åœ¨é¡µé¢ç›´æ¥æ˜¾ç¤ºæ­¤å­—ç¬¦ app.Run(async (context) =\u0026gt; { await context.Response.WriteAsync(\u0026#34;Hello World!\u0026#34;); }); } } } ConfigureServices:è¿è¡Œæ—¶è¢«è°ƒç”¨,å°†æœåŠ¡(services)æ·»åŠ åˆ°å®¹å™¨(container)ä¸­\nConfigure:è¿è¡Œæ—¶è¢«è°ƒç”¨, é…ç½®HTTP request çš„pipeline\nå—¯,çœ‹ä¸æ‡‚?æ²¡å…³ç³»,å¾…ä¼šä¸€ä¸ªä¸ªæ¼”ç¤º.\næˆ‘ä»¬è¿™é‡Œè¿˜æ˜¯ç›´æ¥å…ˆè·‘ä¸€ä¸‹ç¨‹åº,FirsrMVCæ–‡ä»¶å¤¹è·¯å¾„ä¸‹æ‰§è¡Œ:dotnet run è¾“å‡ºå¦‚ä¸‹:\n1 2 3 4 5 âœ FirsrMVC git:(master) âœ— dotnet run Hosting environment: Production Content root path: /Users/liguobao/code/codelover-blog/FirsrMVC Now listening on: http://localhost:5000 Application started. Press Ctrl+C to shut down. ç„¶åè®¿é—®http://localhost:5000çœ‹çœ‹.\nå¥½äº†,ç¬¬ä¸€ä¸ªMVCç¨‹åºå·²ç»è·‘èµ·æ¥äº†,æœ¬æ–‡ç»“æŸ.é€ƒ\u0026hellip;\nè¿™é‡Œåº”è¯¥è¿˜æœ‰äººå§?é‚£æˆ‘ä»¬ç»§ç»­äº†.\nwwwrootä¸­çš„é™æ€æ–‡ä»¶ åœ¨wwwrootæ–‡ä»¶å¤¹æ–°å¢first.html,éšä¾¿å†™ä¸ªèƒ½çœ‹è§çš„HTMLæ ‡ç­¾(æˆ‘å†™çš„æ˜¯pæ ‡ç­¾)\nåœ¨ Configure æ–¹æ³•ä¸­æ·»åŠ ä¸€å¥ app.UseStaticFiles(); ç„¶åå†é‡æ–°è¿è¡Œä¸€ä¸‹\nè®¿é—®http://localhost:5000/first.html\næœ¬æ­¥éª¤å®Œæˆ.\nUseStaticFiles()æ–¹æ³•:è°ƒç”¨ä¸€ä¸ªè¯»å–wwwrootæ–‡ä»¶å¤¹ä¸‹é¢çš„é™æ€æ–‡ä»¶è¾“å‡ºçš„ä¸­é—´ä»¶æ³¨å†Œåˆ°ç¨‹åºä¸­,ä»è€Œå®Œæˆé™æ€æ–‡ä»¶çš„è¾“å‡º.\nè¿™é‡Œä¹Ÿå‘Šè¯‰æˆ‘ä»¬,ASP.NET Coreçš„é™æ€æ–‡ä»¶(JS+CSS+å›¾ç‰‡\u0026hellip;)ä¹‹ç±»çš„éƒ½å¯ä»¥æ”¾è¿™è¾¹æ¥.\nç”šè‡³äºå¦‚æœç®€å•åšå‰åç«¯åˆ†ç¦»çš„è¯,å‰ç«¯çš„vue/reacté¡¹ç›®éƒ½å¯ä»¥æ‰”è¿™é‡Œå».\né‡å¤´æˆMVC ç»ˆäºè¦è®²åˆ°MVCäº†.\nMVCæ¨¡å¼æœ€æ—©ç”±Trygve Reenskaugåœ¨1978å¹´æå‡º[1]ï¼Œæ˜¯æ–½ä¹å¸•ç½—å¥¥å¤šç ”ç©¶ä¸­å¿ƒï¼ˆXerox PARCï¼‰åœ¨20ä¸–çºª80å¹´ä»£ä¸ºç¨‹åºè¯­è¨€Smalltalkå‘æ˜çš„ä¸€ç§è½¯ä»¶æ¶æ„ã€‚MVCæ¨¡å¼çš„ç›®çš„æ˜¯å®ç°ä¸€ç§åŠ¨æ€çš„ç¨‹å¼è®¾è®¡ï¼Œä½¿åç»­å¯¹ç¨‹åºçš„ä¿®æ”¹å’Œæ‰©å±•ç®€åŒ–ï¼Œå¹¶ä¸”ä½¿ç¨‹åºæŸä¸€éƒ¨åˆ†çš„é‡å¤åˆ©ç”¨æˆä¸ºå¯èƒ½ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæ­¤æ¨¡å¼é€šè¿‡å¯¹å¤æ‚åº¦çš„ç®€åŒ–ï¼Œä½¿ç¨‹åºç»“æ„æ›´åŠ ç›´è§‚ã€‚è½¯ä»¶ç³»ç»Ÿé€šè¿‡å¯¹è‡ªèº«åŸºæœ¬éƒ¨åˆ†åˆ†ç¦»çš„åŒæ—¶ä¹Ÿèµ‹äºˆäº†å„ä¸ªåŸºæœ¬éƒ¨åˆ†åº”æœ‰çš„åŠŸèƒ½ã€‚ä¸“ä¸šäººå‘˜å¯ä»¥é€šè¿‡è‡ªèº«çš„ä¸“é•¿åˆ†ç»„ï¼š\næ§åˆ¶å™¨ï¼ˆControllerï¼‰- è´Ÿè´£è½¬å‘è¯·æ±‚ï¼Œå¯¹è¯·æ±‚è¿›è¡Œå¤„ç†ã€‚ è§†å›¾ï¼ˆViewï¼‰ - ç•Œé¢è®¾è®¡äººå‘˜è¿›è¡Œå›¾å½¢ç•Œé¢è®¾è®¡ã€‚ æ¨¡å‹ï¼ˆModelï¼‰ - ç¨‹åºå‘˜ç¼–å†™ç¨‹åºåº”æœ‰çš„åŠŸèƒ½ï¼ˆå®ç°ç®—æ³•ç­‰ç­‰ï¼‰ã€æ•°æ®åº“ä¸“å®¶è¿›è¡Œæ•°æ®ç®¡ç†å’Œæ•°æ®åº“è®¾è®¡(å¯ä»¥å®ç°å…·ä½“çš„åŠŸèƒ½)ã€‚ ä»¥ä¸Šæ¦‚å¿µæ¥è‡ªç»´åŸºç™¾ç§‘:MVC\nåœ¨ASP.NET Core,MVCæ¨¡å‹ä¸€èˆ¬å°±å¯¹åº”ç€ä¸‰ä¸ªæ–‡ä»¶å¤¹,Models/Views/Controllers.\nModels:å­˜æ”¾ä¸€äº›ä¸šåŠ¡å®ä½“ç±»,å¦‚Student,Courseç­‰,è¡¨ç°ä¸Šå°±æ˜¯C#çš„.csæ–‡ä»¶\nViews:å­˜æ”¾CSHTMLæ–‡ä»¶,ASP.NET Coreçš„æ¨¡æ¿æ–‡ä»¶,ç±»HTML,ä¹Ÿå¯ä»¥å†™C#ä»£ç \nControllers: csæ–‡ä»¶,ç»§æ‰¿Controllerç±»çš„XXXController,å®ç°ä¸šåŠ¡é€»è¾‘ä»£ç \nä¸‹é¢ä¸€èµ·æ¥å†™ä¸€ä¸ªç®€å•çš„MVCç©ç©.\nStartup ä¿®æ”¹ Startup.csçš„ä»£ç ,æ–°å¢MVCä¸­é—´ä»¶çš„å¼•ç”¨,æ“ä½œå¦‚ä¸‹:\nStartup.csä¸­çš„ConfigureServicesæ–¹æ³•ä¸‹æ–°å¢:services.AddMvc();\nConfigureæ–¹æ³•ä¸‹å»æ‰ä¹‹å‰çš„UseMvc,æ”¹æˆ\n1 2 3 4 5 6 app.UseMvc(routes =\u0026gt; { routes.MapRoute( name: \u0026#34;default\u0026#34;, template: \u0026#34;{controller=Home}/{action=Index}/{id?}\u0026#34;); }); å…¨éƒ¨ä»£ç å¦‚ä¸‹:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 using System; using System.Collections.Generic; using System.Linq; using System.Threading.Tasks; using Microsoft.AspNetCore.Builder; using Microsoft.AspNetCore.Hosting; using Microsoft.Extensions.Configuration; using Microsoft.Extensions.DependencyInjection; namespace FirsrMVC { public class Startup { public Startup(IConfiguration configuration) { Configuration = configuration; } public IConfiguration Configuration { get; } // This method gets called by the runtime. Use this method to add services to the container. public void ConfigureServices(IServiceCollection services) { services.AddMvc(); } // This method gets called by the runtime. Use this method to configure the HTTP request pipeline. public void Configure(IApplicationBuilder app, IHostingEnvironment env) { if (env.IsDevelopment()) { app.UseDeveloperExceptionPage(); } else { app.UseExceptionHandler(\u0026#34;/Home/Error\u0026#34;); } app.UseStaticFiles(); app.UseMvc(routes =\u0026gt; { routes.MapRoute( name: \u0026#34;default\u0026#34;, template: \u0026#34;{controller=Home}/{action=Index}/{id?}\u0026#34;); }); } } } Controllers æ–°å¢Controllersæ–‡ä»¶å¤¹,åœ¨æ­¤æ–‡ä»¶ä¸‹æ–°å»ºHomeController.csæ–‡ä»¶,ç„¶åå¡«å…¥ä¸€ä¸‹ä»£ç :\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 using System; using System.Collections.Generic; using System.Diagnostics; using System.Linq; using System.Threading.Tasks; using Microsoft.AspNetCore.Mvc; namespace FirsrMVC.Controllers { public class HomeController : Controller { public IActionResult Index() { return View(); } public IActionResult About() { return Json(new { name = \u0026#34;æˆ‘çš„åå­—\u0026#34;, success = true }); } } } åˆ°è¿™é‡Œ,æˆ‘ä»¬å…ˆè¿è¡Œä¸€ä¸‹ä»£ç .\nå¦‚æ— æ„å¤–çš„è¯,\nè®¿é—®http://localhost:5000/ ç©ºç™½ä¸€ç‰‡,\nè®¿é—®http://localhost:5000/Home/About ä¼šè¾“å‡º\n1 2 3 4 { \u0026#34;name\u0026#34;: \u0026#34;æˆ‘çš„åå­—\u0026#34;, \u0026#34;success\u0026#34;: true } http://localhost:5000/ å…¶å®è¿™é‡Œè®¿é—®çš„æ˜¯http://localhost:5000/Home/Index,å¯¹åº”æ–¹æ³•æ˜¯HomeController/Index\næˆ‘ä»¬çœ‹ä¸€ä¸‹Logè¾“å‡ºä¼šå‘ç°è¿™æ ·çš„ä¸€å¥é”™è¯¯\u0026quot;fail: The view \u0026lsquo;Index\u0026rsquo; was not found. Searched locations: /Views/Home/Index.cshtml, /Views/Shared/Index.cshtml\u0026quot;\nåŸå› æ˜¯HomeControllerä¸­çš„Indexè¿”å›çš„æ˜¯View,\nç¨‹åºé»˜è®¤å°±ä¼šå»/Views/ç›®å½•ä¸‹å¯»æ‰¾/Home/Index.cshtmlæ–‡ä»¶æ¥æ¸²æŸ“ç„¶åè¿”å›ç»™æµè§ˆå™¨,ä½†æ˜¯è¿™é‡Œæˆ‘ä»¬å¹¶æ²¡æœ‰è¿™ä¸ªæ–‡ä»¶,æ‰€ä»¥ç›´æ¥GG.\nhttp://localhost:5000/Home/About å¯¹åº”æ–¹æ³•æ˜¯HomeController/About,è¿”å›ä¸ºJsonæ•°æ®,ä¸éœ€è¦View.\næ‰€ä»¥ç›´æ¥å°±å¾€æµè§ˆå™¨è¾“å‡ºäº†{ name = \u0026ldquo;æˆ‘çš„åå­—\u0026rdquo;, success = true }çš„Jsonæ ¼å¼æ•°æ®\nViews ä¸Šä¸€æ­¥æˆ‘ä»¬çš„çš„Controllerå·²ç»å»ºå¥½äº†,ä½†æ˜¯ç¼ºViewæ–‡ä»¶,æˆ‘ä»¬è¿™é‡Œæ¥åˆ›å»ºä¸€ä¸‹Viewæ–‡ä»¶\næ–°å»ºViews/Homeæ–‡ä»¶å¤¹,ç„¶åå†åœ¨æ­¤æ–‡ä»¶å¤¹ä¸‹æ–°å¢Index.cshtmlæ–‡ä»¶\nç„¶ååœ¨Index.cshtmlä¸­è¾“å…¥:\n1 \u0026lt;p\u0026gt;First View Page\u0026lt;/p\u0026gt;\u0026gt; åˆ·æ–°ä¸€ä¸‹http://localhost:5000/é¡µé¢.\nViewæ–‡ä»¶ä¹Ÿå»ºç«‹å¥½äº†.\nModels æœ€åç®€å•è®²ä¸€ä¸‹Model.\nåŒç†,æ–°å»ºModelsæ–‡ä»¶å¤¹,åœ¨æ­¤æ–‡ä»¶å¤¹ä¸‹æ–°å¢Student.csæ–‡ä»¶.\n1 2 3 4 5 6 7 8 9 10 namespace FirsrMVC { public class Student { public string Name { get; set; } public int Age { get; set; } } } æˆ‘ä»¬æƒ³åšçš„è¦åšçš„æ˜¯æŠŠStudentä¿¡æ¯é€šè¿‡Controllerè¿”å›ç»™View,ç„¶åç”¨Viewæ¸²æŸ“å‡ºæ¥.\nä¿®æ”¹ä¸€ä¸‹HomeController/Indexæ–¹æ³•:\n1 2 3 4 5 public IActionResult Index() { Models.Student student = new Models.Student() { Name = \u0026#34;å°æ˜\u0026#34;, Age = 16 }; return View(student); } ä¿®æ”¹ä¸€ä¸‹Views/Home/Index.cshtml\n1 2 3 4 5 6 7 8 @model FirsrMVC.Models.Student @if(Model !=null) { \u0026lt;p\u0026gt;@Model.Name\u0026lt;span\u0026gt;ä»Šå¹´\u0026lt;/span\u0026gt;@Model.Age\u0026lt;span\u0026gt;å²\u0026lt;/span\u0026gt;\u0026lt;/p\u0026gt; }else { \u0026lt;p\u0026gt;è¿™é‡Œä»€ä¹ˆéƒ½æ²¡æœ‰.\u0026lt;/p\u0026gt; } é‡æ–°è¿è¡Œä¸€ä¸‹ç¨‹åº,è®¿é—®http://localhost:5000/\nMVCç»“æŸ.\næœ¬æ–‡å®Œ.\nä¸‹ä¸€èŠ‚é…ç½®æ–‡ä»¶+DIä¾èµ–æ³¨å…¥.\n","date":"2018-05-30T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E5%86%99dotnet-coremvc/","title":"æ‰‹æŠŠæ‰‹æ•™ä½ å†™dotnet core(MVC)"},{"content":"dotnet core(å…¥é—¨ç¯‡) å¼€å‘ç¯å¢ƒå‡†å¤‡ dotnet coreæœ€ä½å¼€å‘ç¯å¢ƒè¦æ±‚å°±æ˜¯ä¸€ä¸ª.NET SDK,åœ¨è¿™é‡Œå¯ä»¥ä¸‹è½½çš„åˆ°æœ€æ–°ç‰ˆæœ¬çš„SDK,å„ä¸ªå¹³å°éƒ½æœ‰.\nç†è®ºä¸Šæœ‰äº†SDKä»€ä¹ˆäº‹éƒ½èƒ½åšäº†.\nå®‰è£…SDKçš„æ­¥éª¤å‚è€ƒä¸Šé¢çš„è¿æ¥å°±OK,è¿™éƒ¨åˆ†æˆ‘ä»¬è·³è¿‡.\nç®€å•è®²ä¸€ä¸‹ä¸åŒæ“ä½œç³»ç»Ÿçš„å¼€å‘å·¥å…·é€‰æ‹©.\nWindowså¹³å°ä¸‹é¦–é€‰Visual Studio 2017,å®‰è£…çš„æ—¶å€™é€‰æ‹© .NET Coreéƒ¨åˆ†å³å¯,å®‰è£…ä¸‹æ¥ä¼°è®¡å ç”¨ç£ç›˜ç©ºé—´5G,åŒæ—¶ä¼šå¸®ä½ è£…å¥½SDKçš„,å¥½ç”¨,å¾ˆå¥½ç”¨.\nMacOS/Linuxå¹³å°é€‰æ‹© SDK + Visual Studio Code + Debugæ’ä»¶ + Nugetæ’ä»¶,å¾ˆä¸é”™,å®Œå…¨ç”Ÿäº§çº§åˆ«\nå¤‡é€‰æ–¹æ¡ˆ Jetbrainså®¶çš„rider,æš‚æ—¶æ²¡ç”¨è¿‡,resharperä¸€ç›´å¥½è¯„å¦‚æ½®\nä»Šå¤©æˆ‘è¿™è¾¹ä¸»è¦æ˜¯æ˜¯ä»¥VS Code + Debugæ’ä»¶ + å‘½ä»¤è¡Œæ¥è¿›æ¥è®²è§£.\nè£…å¥½dotnet core SDKä¹‹å,æ‰“å¼€å‘½ä»¤è¡Œç•Œé¢,è¾“å…¥dotnetçœ‹çœ‹.\nWindowsä¸­ä¸ºCMDæˆ–è€…Powershell,MacOS/Linuxä¸ºç»ˆç«¯ 1 2 3 4 5 6 7 8 9 Usage: dotnet [options] Usage: dotnet [path-to-application] Options: -h|--help Display help. --version Display version. path-to-application: å†è¾“å…¥dotnet \u0026ndash;versionæŸ¥çœ‹ä¸€ä¸‹å½“å‰ç‰ˆæœ¬,æˆ‘è¿™è¾¹æ˜¾ç¤º2.1.4.\nè¾“å…¥dotnet help\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 .NET Command Line Tools (2.1.4) Usage: dotnet [runtime-options] [path-to-application] Usage: dotnet [sdk-options] [command] [arguments] [command-options] path-to-application: The path to an application .dll file to execute. SDK commands: new Initialize .NET projects. restore Restore dependencies specified in the .NET project. run Compiles and immediately executes a .NET project. build Builds a .NET project. publish Publishes a .NET project for deployment (including the runtime). test Runs unit tests using the test runner specified in the project. pack Creates a NuGet package. migrate Migrates a project.json based project to a msbuild based project. clean Clean build output(s). sln Modify solution (SLN) files. add Add reference to the project. remove Remove reference from the project. list List reference in the project. nuget Provides additional NuGet commands. msbuild Runs Microsoft Build Engine (MSBuild). vstest Runs Microsoft Test Execution Command Line Tool. Common options: -v|--verbosity Set the verbosity level of the command. Allowed values are q[uiet], m[inimal], n[ormal], d[etailed], and diag[nostic]. -h|--help Show help. æœ‰ç±»ä¼¼çš„è¿™äº›ä¿¡æ¯,è¯´æ˜æˆ‘ä»¬çš„SDKå®‰è£…ä»¥åŠå®Œæˆäº†.\nVisual Studio å’ŒVisual Studio Codeçš„å®‰è£…å°±ä¸å¤šè¯´äº†.\nåˆ›å»º dotnet coreç¨‹åº æˆ‘è¿™è¾¹åªæœ‰SDK + VS Codeç¯å¢ƒ,åˆ›å»ºç¨‹åºç›´æ¥ä½¿ç”¨å‘½ä»¤è¡Œäº†.\ndotnet core SDKä¸­å·²ç»æœ‰å¾ˆå¤šç°æˆçš„APPæ¨¡æ¿,æˆ‘ä»¬ç›´æ¥ä½¿ç”¨dotnet newå‘½ä»¤å°±å¯ä»¥åˆ›å»ºå¯¹åº”çš„ç¨‹åº.\nå‘½ä»¤è¡Œè¾“å…¥ \u0026quot; dotnet new \u0026ldquo;, æ˜¾ç¤ºå¦‚ä¸‹:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 Usage: new [options] Options: -h, --help Displays help for this command. -l, --list Lists templates containing the specified name. If no name is specified, lists all templates. -n, --name The name for the output being created. If no name is specified, the name of the current directory is used. -o, --output Location to place the generated output. -i, --install Installs a source or a template pack. -u, --uninstall Uninstalls a source or a template pack. --type Filters templates based on available types. Predefined values are \u0026#34;project\u0026#34;, \u0026#34;item\u0026#34; or \u0026#34;other\u0026#34;. --force Forces content to be generated even if it would change existing files. -lang, --language Specifies the language of the template to create. Templates Short Name Language Tags -------------------------------------------------------------------------------------------------------- Console Application console [C#], F#, VB Common/Console Class library classlib [C#], F#, VB Common/Library Unit Test Project mstest [C#], F#, VB Test/MSTest xUnit Test Project xunit [C#], F#, VB Test/xUnit ASP.NET Core Empty web [C#], F# Web/Empty ASP.NET Core Web App (Model-View-Controller) mvc [C#], F# Web/MVC ASP.NET Core Web App razor [C#] Web/MVC/Razor Pages ASP.NET Core with Angular angular [C#] Web/MVC/SPA ASP.NET Core with React.js react [C#] Web/MVC/SPA ASP.NET Core with React.js and Redux reactredux [C#] Web/MVC/SPA ASP.NET Core Web API webapi [C#], F# Web/WebAPI global.json file globaljson Config NuGet Config nugetconfig Config Web Config webconfig Config Solution File sln Solution Razor Page page Web/ASP.NET MVC ViewImports viewimports Web/ASP.NET MVC ViewStart viewstart Web/ASP.NET Examples: dotnet new mvc --auth Individual dotnet new viewimports --namespace dotnet new --help æ—¢ç„¶æ˜¯æ‰‹æŠŠæ‰‹æ•™ç¨‹,è‚¯å®šä»æœ€åŸå§‹çš„Console Application å¼€å§‹å’¯,åœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥å‘½ä»¤\u0026quot;dotnet new console -n FirstApplication\u0026rdquo;,åˆ›å»ºä¸€ä¸ªåä¸ºFirstApplicationçš„å‘½ä»¤è¡Œç¨‹åº\n1 2 3 4 5 6 dotnet new console -n FirstApplication; \bcd FirstApplication; ls FirstApplication; #âœ— cd FirstApplication # FirstApplication git:(master) âœ— ls # FirstApplication.csproj Program.cs obj/ æˆ‘ä»¬åˆ‡æ¢åˆ°FirstApplicationæ–‡ä»¶ä¸­,å¯ä»¥çœ‹åˆ°ç°åœ¨å·²ç»æœ‰ä¸‰ä¸ªæ–‡ä»¶.ç®€å•è®²è§£ä¸€ä¸‹:\nFirstApplication.csproj .csprojä¸ºé¡¹ç›®æ„å»ºæ–‡ä»¶(C Sharp Projectâ€),å¯¹åº”mavenä¸­çš„pom.xmlæˆ–è€…æ˜¯gradleä¸­çš„build.gradle\nProgram.cs ä¸ºç¨‹åºçš„ä¸»å…¥å£, æœ‰ä¸€ä¸ªé™æ€çš„Mainæ–¹æ³•\nobjç”¨äºå­˜æ”¾ç¼–è¯‘è¿‡ç¨‹ä¸­ç”Ÿæˆçš„ä¸­é—´ä¸´æ—¶æ–‡ä»¶,ä¸€èˆ¬ä¸ç”¨ç®¡\næˆ‘ä»¬ä½¿ç”¨VS Codeæ‰“å¼€è¿™ä¸ªæ–‡ä»¶å¤¹çœ‹çœ‹.\né¦–æ¬¡åœ¨VS Codeä¸­æ‰“å¼€å¸¦æœ‰.csprojæ–‡ä»¶çš„æ–‡ä»¶å¤¹,VS Codeä¼šæç¤ºæ˜¯å¦éœ€è¦å®‰è£…ç›¸å…³æ’ä»¶,ç›´æ¥é€‰æ‹©æ˜¯å³å¯.\næˆ‘ä»¬è¿™é‡Œè¦ç”¨åˆ°çš„æ’ä»¶ä¸»è¦æ˜¯\u0026quot;C# for Visual Studio Code (powered by OmniSharp)\u0026quot;,ç›´æ¥åœ¨æ’ä»¶ä»“åº“æœC#åŸºæœ¬å°±èƒ½çœ‹åˆ°.\nç›´æ¥çœ‹ä¸‹Program.csçš„ä»£ç :\nä¸€å¥è¯è¾“å‡º\u0026quot;Hello World!\u0026quot;\u0026hellip;\næˆ‘ä»¬è¯•ç€è¿è¡Œä¸€ä¸‹çœ‹çœ‹.\næœ‰ä¸¤ç§æ–¹å¼:\nç›´æ¥åœ¨å¯¹åº”é¡¹ç›®æ–‡ä»¶å¤¹ä½ç½®çš„å‘½ä»¤è¡Œä¸­æ‰§è¡Œdotner run;\nVS Code debugå¯åŠ¨\ndotnet run \u0026ldquo;VS Code-æŸ¥çœ‹-é›†æˆç»ˆç«¯\u0026quot;å¯ä»¥ç›´æ¥è°ƒå‡ºç»ˆç«¯,å¹¶ä¸”åˆ‡åˆ°å½“å‰é¡¹ç›®æ–‡ä»¶è·¯å¾„,æ‰§è¡Œ dotnet runè¾“å‡ºå¦‚ä¸‹:\n1 2 âœ FirstApplication git:(master) âœ— dotnet run Hello World! VS Code debug VS Codeå·¦ä¾§åˆ‡åˆ°debug(ä¸€åªè™«å­çš„å›¾æ ‡),ç‚¹å‡»è°ƒè¯•æ—è¾¹çš„ç»¿è‰²æŒ‰é’®å¼€å§‹å¯åŠ¨.\nç»ˆç«¯è¾“å‡º:\nè°ƒè¯•æ§åˆ¶å°è¾“å‡º:\néƒ½è¯´äº†Debugäº†,æˆ‘ä»¬ç®€å•ä¹Ÿåšä¸ªdebugæ–­ç‚¹è°ƒè¯•.\nç‚¹å‡»ä»£ç æ–‡ä»¶å·¦ä¾§é»‘è‰²è¾¹æ ,é¼ æ ‡å·¦é”®å•å‡»åœ¨ç¬¬8,9è¡Œ,å¯¹åº”ä½ç½®å‡ºç°æ–­ç‚¹(å°çº¢ç‚¹),\b å¦‚ä¸‹å›¾: å†æ¬¡Debugè¿è¡Œç¨‹åº.\nç¬¬8è¡Œä½ç½®å‡ºç°é»„è‰²æ¡çº¹,ç¨‹åºå¤„äºdebugé»˜è®¤ç­‰å¾…ä¸‹ä¸€æ­¥æ“ä½œ.\nå·¦ä¾§å¯æŸ¥çœ‹ç›¸å…³å˜é‡å½“å‰å€¼,æ­£ä¸Šæ–¹æœ‰debugç›¸å…³æ“ä½œ(F5ç»§ç»­,F10å•æ­¥è·³è¿‡,F11å•æ­¥è°ƒè¯•\u0026hellip;)\nF5æŒ‰ä¸€ä¸‹,é»„è‰²æ¡çº¹å¾€ä¸‹èµ°ä¸€æ­¥åˆ°ç¬¬9è¡Œ(ä¸Šä¸€æ­¥ä¹Ÿä¸‹äº†æ–­ç‚¹).æ­¤æ—¶å°šæœªè¾“å‡ºä»»ä½•çš„ä¿¡æ¯.\nF5ä¸‹ä¸€æ­¥æ‰§è¡ŒConsole.WriteLine(\u0026ldquo;Hello World!\u0026rdquo;);è¾“å‡º\u0026quot;Hello World!\u0026rdquo;\nå†™ä¸ªç´¯åŠ ç¨‹åºè¯•è¯•æ°´ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 using System; namespace FirstApplication { class Program { static void Main(string[] args) { var sum = 0; for (var i = 0; i \u0026lt; 10; i++) { sum = sum + i; Console.WriteLine($\u0026#34;å½“å‰iå€¼ä¸º:{i},sum:{sum}\u0026#34;); } } } } /* Loaded \u0026#39;/usr/local/share/dotnet/shared/Microsoft.NETCore.App/2.0.5/System.Runtime.Extensions.dll\u0026#39;. Skipped loading symbols. Module is optimized and the debugger option \u0026#39;Just My Code\u0026#39; is enabled. å½“å‰iå€¼ä¸º:0,sum:0 å½“å‰iå€¼ä¸º:1,sum:1 å½“å‰iå€¼ä¸º:2,sum:3 å½“å‰iå€¼ä¸º:3,sum:6 å½“å‰iå€¼ä¸º:4,sum:10 å½“å‰iå€¼ä¸º:5,sum:15 å½“å‰iå€¼ä¸º:6,sum:21 å½“å‰iå€¼ä¸º:7,sum:28 å½“å‰iå€¼ä¸º:8,sum:36 å½“å‰iå€¼ä¸º:9,sum:45 The program \u0026#39;[32086] FirstApplication.dll\u0026#39; has exited with code 0 (0x0). */ åœ¨å¾ªç¯é‡Œé¢æ‰“ä¸ªæ–­ç‚¹çœ‹çœ‹içš„å€¼å’Œsumçš„å€¼.\né¼ æ ‡ç§»åŠ¨åˆ°å¯¹åº”å˜é‡ä¸Š. åˆ°è¿™é‡Œ,ç¬¬ä¸€ä¸ªdotnet coreç¨‹åºåŸºæœ¬å·²ç»å®Œæˆäº†,æœ¬æ•™ç¨‹ç»“æŸ\u0026hellip;.\néª—ä½ çš„,è¿™é‡Œè¿˜æœ‰ è¿˜è®°å¾—æˆ‘ä»¬ä¸Šé¢çœ‹åˆ°çš„FirstApplication.csprojå—?\næˆ‘ä»¬ç›´æ¥åœ¨VS Codeä¸­æ‰“å¼€çœ‹çœ‹.(VSç”¨æˆ·éšä¾¿æ‰¾ä¸ªæ–‡ä»¶ç¼–è¾‘å™¨æ‰“å¼€)\n1 2 3 4 5 6 7 8 \u0026lt;Project Sdk=\u0026#34;Microsoft.NET.Sdk\u0026#34;\u0026gt; \u0026lt;PropertyGroup\u0026gt; \u0026lt;OutputType\u0026gt;Exe\u0026lt;/OutputType\u0026gt; \u0026lt;TargetFramework\u0026gt;netcoreapp2.0\u0026lt;/TargetFramework\u0026gt; \u0026lt;/PropertyGroup\u0026gt; \u0026lt;/Project\u0026gt; è¿™é‡Œå°±æŒ‡å®šäº†SDKç‰ˆæœ¬å’Œç¨‹åºç‰ˆæœ¬,æ²¡æœ‰å…¶ä»–å¤šä½™çš„ä¸œè¥¿äº†.\næš‚æ—¶æ²¡ä»€ä¹ˆçœ‹çš„,æˆ‘ä»¬æ‰¾ä¸ªwebé¡¹ç›®çš„æ¥çœ‹çœ‹.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 \u0026lt;Project Sdk=\u0026#34;Microsoft.NET.Sdk.Web\u0026#34;\u0026gt; \u0026lt;PropertyGroup\u0026gt; \u0026lt;TargetFramework\u0026gt;netcoreapp2.0\u0026lt;/TargetFramework\u0026gt; \u0026lt;/PropertyGroup\u0026gt; \u0026lt;ItemGroup\u0026gt; \u0026lt;Folder Include=\u0026#34;wwwroot\\\u0026#34;/\u0026gt; \u0026lt;/ItemGroup\u0026gt; \u0026lt;ItemGroup\u0026gt; \u0026lt;PackageReference Include=\u0026#34;Dapper\u0026#34; Version=\u0026#34;1.50.4\u0026#34;/\u0026gt; \u0026lt;PackageReference Include=\u0026#34;Microsoft.ApplicationInsights.AspNetCore\u0026#34; Version=\u0026#34;2.2.1\u0026#34;/\u0026gt; \u0026lt;PackageReference Include=\u0026#34;Microsoft.AspNetCore\u0026#34; Version=\u0026#34;2.0.2\u0026#34;/\u0026gt; \u0026lt;PackageReference Include=\u0026#34;Microsoft.AspNetCore.Mvc\u0026#34; Version=\u0026#34;2.0.3\u0026#34;/\u0026gt; \u0026lt;PackageReference Include=\u0026#34;Microsoft.AspNetCore.StaticFiles\u0026#34; Version=\u0026#34;2.0.2\u0026#34;/\u0026gt; \u0026lt;PackageReference Include=\u0026#34;Microsoft.EntityFrameworkCore.Design\u0026#34; Version=\u0026#34;2.0.2\u0026#34;/\u0026gt; \u0026lt;PackageReference Include=\u0026#34;Microsoft.Extensions.Logging.Debug\u0026#34; Version=\u0026#34;2.0.1\u0026#34;/\u0026gt; \u0026lt;PackageReference Include=\u0026#34;Microsoft.VisualStudio.Web.BrowserLink\u0026#34; Version=\u0026#34;2.0.2\u0026#34;/\u0026gt; \u0026lt;PackageReference Include=\u0026#34;Microsoft.VisualStudio.Web.CodeGeneration.Design\u0026#34; Version=\u0026#34;2.0.3\u0026#34;/\u0026gt; \u0026lt;PackageReference Include=\u0026#34;Newtonsoft.Json\u0026#34; Version=\u0026#34;11.0.2\u0026#34;/\u0026gt; \u0026lt;PackageReference Include=\u0026#34;StackExchange.Redis.StrongName\u0026#34; Version=\u0026#34;1.2.6\u0026#34;/\u0026gt; \u0026lt;PackageReference Include=\u0026#34;System.Diagnostics.Tools\u0026#34; Version=\u0026#34;4.3.0\u0026#34;/\u0026gt; \u0026lt;PackageReference Include=\u0026#34;System.Text.Encoding.CodePages\u0026#34; Version=\u0026#34;4.4.0\u0026#34;/\u0026gt; \u0026lt;PackageReference Include=\u0026#34;System.ValueTuple\u0026#34; Version=\u0026#34;*\u0026#34;/\u0026gt; \u0026lt;PackageReference Include=\u0026#34;Microsoft.Extensions.Configuration.Json\u0026#34; Version=\u0026#34;2.1.0-rc1-final\u0026#34;/\u0026gt; \u0026lt;PackageReference Include=\u0026#34;Pomelo.AspNetCore.TimedJob\u0026#34; Version=\u0026#34;2.0.0-rtm-10046\u0026#34;/\u0026gt; \u0026lt;PackageReference Include=\u0026#34;MySqlConnector\u0026#34; Version=\u0026#34;0.40.3\u0026#34;/\u0026gt; \u0026lt;PackageReference Include=\u0026#34;MongoDB.Driver.Core\u0026#34; Version=\u0026#34;2.7.0-beta0001\u0026#34;/\u0026gt; \u0026lt;PackageReference Include=\u0026#34;MongoDB.Driver\u0026#34; Version=\u0026#34;2.7.0-beta0001\u0026#34;/\u0026gt; \u0026lt;/ItemGroup\u0026gt; \u0026lt;/Project\u0026gt; è¿™è¾¹èƒ½çœ‹çš„ä¸œè¥¿å°±å¾ˆå¤šäº†.\nProject Sdk=\u0026ldquo;Microsoft.NET.Sdk.Web\u0026rdquo; SDkä¸ºWeb\n\bFolder Include=\u0026ldquo;wwwroot\u0026quot; åŒ…å« wwwrooté™æ€æ–‡ä»¶\nPackageReference Include=\u0026ldquo;Dapper\u0026rdquo; Version=\u0026ldquo;1.50.4\u0026rdquo; å¼•ç”¨äº†Dapperç¨‹åºåŒ…(ä¸€ä¸ªORMæ¡†æ¶)\nPackageReference Include=\u0026ldquo;Microsoft.AspNetCore.Mvc\u0026rdquo; Version=\u0026ldquo;2.0.3\u0026rdquo; å¼•ç”¨äº†MVCæ¡†æ¶\nPackageReference Include=\u0026ldquo;Newtonsoft.Json\u0026rdquo; Version=\u0026ldquo;11.0.2\u0026rdquo; å¼•ç”¨äº†Newtonsoft.Json Jsonåº“\nè¿™é‡Œæˆ‘ä»¬å…ˆçœ‹çœ‹,å…·ä½“å†…å®¹åœ¨ä¸‹ä¸€è®²asp.net core å…¥é—¨æˆ‘ä»¬ä¼šè¯¦ç»†è®²è§£.\nå…¨æ–‡å®Œ\u0026hellip;.\n","date":"2018-05-29T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E5%86%99dotnet-core%E5%85%A5%E9%97%A8%E7%AF%87/","title":"æ‰‹æŠŠæ‰‹æ•™ä½ å†™dotnet core(å…¥é—¨ç¯‡)"},{"content":"åŠä¸ªå°æ—¶æ•™ä½ å†™ä¸€ä¸ªæ¯•è®¾ä¹‹åœ°å›¾æœç§Ÿæˆ¿ é¦–å…ˆéœ€è¦ä¸€ä¸ªPython3ç¯å¢ƒ,æ€ä¹ˆå‡†å¤‡æˆ‘å°±ä¸å¤šè¯´äº†,å®åœ¨ä¸ä¼šçš„å‡ºé—¨å³è½¬çœ‹ä¸€ä¸‹å»–é›ªå³°è€å¸ˆçš„åšå®¢.\nHTMLéƒ¨åˆ† ä»£ç æ¥è‡ª:é«˜å¾·API+Pythonè§£å†³ç§Ÿæˆ¿é—®é¢˜,ç®€å•æ”¹äº†ä¸‹åŠ è½½æ•°æ®éƒ¨åˆ† ä»£ç è·¯å¾„:/static/index.html\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 \u0026lt;html\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;utf-8\u0026#34;\u0026gt; \u0026lt;meta http-equiv=\u0026#34;X-UA-Compatible\u0026#34; content=\u0026#34;IE=edge\u0026#34;\u0026gt; \u0026lt;meta name=\u0026#34;viewport\u0026#34; content=\u0026#34;initial-scale=1.0, user-scalable=no, width=device-width\u0026#34;\u0026gt; \u0026lt;title\u0026gt;æ¯•ä¸šç”Ÿç§Ÿæˆ¿\u0026lt;/title\u0026gt; \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;http://cache.amap.com/lbs/static/main1119.css\u0026#34; /\u0026gt; \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;http://cache.amap.com/lbs/static/jquery.range.css\u0026#34; /\u0026gt; \u0026lt;script src=\u0026#34;http://cache.amap.com/lbs/static/jquery-1.9.1.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script src=\u0026#34;http://cache.amap.com/lbs/static/es5.min.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script src=\u0026#34;http://webapi.amap.com/maps?v=1.3\u0026amp;key=22d3816e107f199992666d6412fa0691\u0026amp;plugin=AMap.ArrivalRange,AMap.Scale,AMap.Geocoder,AMap.Transfer,AMap.Autocomplete\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script src=\u0026#34;http://cache.amap.com/lbs/static/jquery.range.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;style\u0026gt; .control-panel { position: absolute; top: 30px; right: 20px; } .control-entry { width: 280px; background-color: rgba(119, 136, 153, 0.8); font-family: fantasy, sans-serif; text-align: left; color: white; overflow: auto; padding: 10px; margin-bottom: 10px; } .control-input { margin-left: 120px; } .control-input input[type=\u0026#34;text\u0026#34;] { width: 160px; } .control-panel label { float: left; width: 120px; } #transfer-panel { position: absolute; background-color: white; max-height: 80%; overflow-y: auto; top: 30px; left: 20px; width: 250px; } \u0026lt;/style\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;div id=\u0026#34;container\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;control-panel\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;control-entry\u0026#34;\u0026gt; \u0026lt;label\u0026gt;é€‰æ‹©å·¥ä½œåœ°ç‚¹ï¼š\u0026lt;/label\u0026gt; \u0026lt;div class=\u0026#34;control-input\u0026#34;\u0026gt; \u0026lt;input id=\u0026#34;work-location\u0026#34; type=\u0026#34;text\u0026#34;\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;control-entry\u0026#34;\u0026gt; \u0026lt;label\u0026gt;é€‰æ‹©é€šå‹¤æ–¹å¼ï¼š\u0026lt;/label\u0026gt; \u0026lt;div class=\u0026#34;control-input\u0026#34;\u0026gt; \u0026lt;input type=\u0026#34;radio\u0026#34; name=\u0026#34;vehicle\u0026#34; value=\u0026#34;SUBWAY,BUS\u0026#34; onClick=\u0026#34;takeBus(this)\u0026#34; checked/\u0026gt; å…¬äº¤+åœ°é“ \u0026lt;input type=\u0026#34;radio\u0026#34; name=\u0026#34;vehicle\u0026#34; value=\u0026#34;SUBWAY\u0026#34; onClick=\u0026#34;takeSubway(this)\u0026#34; /\u0026gt; åœ°é“ \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div id=\u0026#34;transfer-panel\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;script\u0026gt; var map = new AMap.Map(\u0026#34;container\u0026#34;, { resizeEnable: true, zoomEnable: true, center: [116.397428, 39.90923], zoom: 11 }); var scale = new AMap.Scale(); map.addControl(scale); var arrivalRange = new AMap.ArrivalRange(); var x, y, t, vehicle = \u0026#34;SUBWAY,BUS\u0026#34;; var workAddress, workMarker; var rentMarkerArray = []; var polygonArray = []; var amapTransfer; var infoWindow = new AMap.InfoWindow({ offset: new AMap.Pixel(0, -30) }); var auto = new AMap.Autocomplete({ input: \u0026#34;work-location\u0026#34; }); AMap.event.addListener(auto, \u0026#34;select\u0026#34;, workLocationSelected); function takeBus(radio) { vehicle = radio.value; loadWorkLocation() } function takeSubway(radio) { vehicle = radio.value; loadWorkLocation() } function workLocationSelected(e) { workAddress = e.poi.name; loadWorkLocation(); } function loadWorkMarker(x, y, locationName) { workMarker = new AMap.Marker({ map: map, title: locationName, icon: \u0026#39;http://webapi.amap.com/theme/v1.3/markers/n/mark_r.png\u0026#39;, position: [x, y] }); } function loadWorkRange(x, y, t, color, v) { arrivalRange.search([x, y], t, function(status, result) { if (result.bounds) { for (var i = 0; i \u0026lt; result.bounds.length; i++) { var polygon = new AMap.Polygon({ map: map, fillColor: color, fillOpacity: \u0026#34;0.4\u0026#34;, strokeColor: color, strokeOpacity: \u0026#34;0.8\u0026#34;, strokeWeight: 1 }); polygon.setPath(result.bounds[i]); polygonArray.push(polygon); } } }, { policy: v }); } function addMarkerByAddress(address, url) { var geocoder = new AMap.Geocoder({ city: \u0026#34;åŒ—äº¬\u0026#34;, radius: 1000 }); geocoder.getLocation(address, function(status, result) { if (status === \u0026#34;complete\u0026#34; \u0026amp;\u0026amp; result.info === \u0026#39;OK\u0026#39;) { var geocode = result.geocodes[0]; rentMarker = new AMap.Marker({ map: map, title: address, icon: \u0026#39;http://webapi.amap.com/theme/v1.3/markers/n/mark_b.png\u0026#39;, position: [geocode.location.getLng(), geocode.location.getLat()] }); rentMarkerArray.push(rentMarker); rentMarker.content = \u0026#34;\u0026lt;div\u0026gt;æˆ¿æºï¼š\u0026lt;a target = \u0026#39;_blank\u0026#39; href=\u0026#39;\u0026#34; + url + \u0026#34;\u0026#39;\u0026gt;\u0026#34; + address + \u0026#34;\u0026lt;/a\u0026gt;\u0026lt;div\u0026gt;\u0026#34; rentMarker.on(\u0026#39;click\u0026#39;, function(e) { infoWindow.setContent(e.target.content); infoWindow.open(map, e.target.getPosition()); if (amapTransfer) amapTransfer.clear(); amapTransfer = new AMap.Transfer({ map: map, policy: AMap.TransferPolicy.LEAST_TIME, city: \u0026#34;åŒ—äº¬å¸‚\u0026#34;, panel: \u0026#39;transfer-panel\u0026#39; }); amapTransfer.search([{ keyword: workAddress }, { keyword: address }], function(status, result) {}) }); } }) } function delWorkLocation() { if (polygonArray) map.remove(polygonArray); if (workMarker) map.remove(workMarker); polygonArray = []; } function delRentLocation() { if (rentMarkerArray) map.remove(rentMarkerArray); rentMarkerArray = []; } function loadWorkLocation() { delWorkLocation(); var geocoder = new AMap.Geocoder({ city: \u0026#34;åŒ—äº¬\u0026#34;, radius: 1000 }); geocoder.getLocation(workAddress, function(status, result) { if (status === \u0026#34;complete\u0026#34; \u0026amp;\u0026amp; result.info === \u0026#39;OK\u0026#39;) { var geocode = result.geocodes[0]; x = geocode.location.getLng(); y = geocode.location.getLat(); loadWorkMarker(x, y); loadWorkRange(x, y, 60, \u0026#34;#3f67a5\u0026#34;, vehicle); map.setZoomAndCenter(12, [x, y]); } }) } $(function() { $.get(\u0026#34;/get_houses\u0026#34;, function(data) { data.forEach(function(element, index) { addMarkerByAddress(element.address, element.url); }); }); }) \u0026lt;/script\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; Python flaskéƒ¨åˆ† Python3ç¯å¢ƒ,ä½¿ç”¨å®‰è£…Flask,pymysql,BeautifulSoup\n1 2 3 4 pip install Flask; pip install pymysql; pip install beautifulsoup4; pip install requests; ç„¶åç›´æ¥ä¸Šä»£ç å’¯.\nè·¯å¾„:/app.py\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 from flask import Flask, request from flask import jsonify from flask import render_template from flask import Response import requests from bs4 import BeautifulSoup import pymysql app = Flask(__name__) @app.route(\u0026#34;/get_houses_db/\u0026#34;) def get_houses_db(): # ä»æ•°æ®åº“è¯»å‡ºæ¥çš„æ•°æ®,urlä¸ºæˆ¿æºurl,addressä¸ºæˆ¿æºå®šä½åœ°å€ houses = [] # Connect to the database connection = pymysql.connect(host=\u0026#39;127.0.0.1\u0026#39;, user=\u0026#39;root\u0026#39;, password=\u0026#39;123\u0026#39;, db=\u0026#39;ä½ çš„æ•°æ®åº“åå­—\u0026#39;, charset=\u0026#39;utf8mb4\u0026#39;, cursorclass=pymysql.cursors.DictCursor) try: with connection.cursor() as cursor: # Read a single record sql = \u0026#34;SELECT ä½ çš„URLå­—æ®µ,ä½ çš„åœ°å€å­—æ®µ FROM ä½ çš„æˆ¿æºæ•°æ®è¡¨ where 1=1;\u0026#34; keyword = request.args.get(\u0026#39;keyword\u0026#39;) if keyword is not None: sql = sql + \u0026#34;æŸ¥è¯¢å­—æ®µ like %%s%\u0026#34; % keyword cursor.execute(sql) houses = cursor.fetchall() finally: connection.close() return jsonify(houses) @app.route(\u0026#34;/get_houses\u0026#34;, methods=[\u0026#39;POST\u0026#39;, \u0026#39;GET\u0026#39;]) def get_houses(): # ç›´æ¥ä»ç½‘é¡µè·å–æ•°æ®,urlä¸ºæˆ¿æºurl,addressä¸ºæˆ¿æºå®šä½åœ°å€ houses = [] city = request.args.get(\u0026#39;city\u0026#39;) if city is None: city = \u0026#39;bj\u0026#39; city_url = \u0026#39;http://%s.58.com\u0026#39; % city for page_num in range(1, 10): url = \u0026#34;%s/pinpaigongyu/pn/%d/\u0026#34; % (city_url, page_num) headers = { \u0026#39;connection\u0026#39;: \u0026#34;keep-alive\u0026#34;, \u0026#39;upgrade-insecure-requests\u0026#39;: \u0026#34;1\u0026#34;, \u0026#39;user-agent\u0026#39;: \u0026#34;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/66.0.3359.181 Safari/537.36\u0026#34;, \u0026#39;accept\u0026#39;: \u0026#34;text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8\u0026#34;, \u0026#39;accept-encoding\u0026#39;: \u0026#34;gzip, deflate\u0026#34;, \u0026#39;accept-language\u0026#39;: \u0026#34;zh-CN,zh;q=0.9,en;q=0.8,da;q=0.7\u0026#34;, \u0026#39;cookie\u0026#39;: \u0026#34;f=n; f=n; id58=c5/njVsEqPqC7y9vB/RHAg==; 58tj_uuid=ac94c044-cbb8-451c-b6be-974f90197010; new_uv=1; utm_source=; spm=; init_refer=https%253A%252F%252Fcn.bing.com%252F; als=0; f=n; new_session=0; qz_gdt=; Hm_lvt_dcee4f66df28844222ef0479976aabf1=1527032264,1527032267,1527032270,1527032380; Hm_lpvt_dcee4f66df28844222ef0479976aabf1=1527032421; ppStore_fingerprint=3283C76981CCD1090B42ACBBF624A4C9613FE967CDC69C58%EF%BC%BF1527032420843\u0026#34;, \u0026#39;cache-control\u0026#39;: \u0026#34;no-cache\u0026#34;, } response = requests.request(\u0026#34;GET\u0026#34;, url, headers=headers) htmlSoup = BeautifulSoup(response.text, \u0026#34;html.parser\u0026#34;) ul = htmlSoup.find(attrs={\u0026#34;class\u0026#34;: \u0026#34;list\u0026#34;}) if ul is None: continue li_list = ul.find_all(\u0026#34;li\u0026#34;) if li_list is None: continue for li in li_list: house = {} house[\u0026#39;url\u0026#39;] = \u0026#39;%s/%s\u0026#39; % (city_url, li.find(\u0026#34;a\u0026#34;)[\u0026#39;href\u0026#39;]) house[\u0026#39;address\u0026#39;] = li.find(\u0026#34;h2\u0026#34;).text houses.append(house) return jsonify(houses) @app.route(\u0026#39;/\u0026#39;) def index(): return app.send_static_file(\u0026#39;index.html\u0026#39;) if __name__ == \u0026#39;__main__\u0026#39;: app.run(port=8888) # python3 å®‰è£…flaskä¹‹å,å®‰è£…å‘½ä»¤pip install Flask # è¿è¡Œ python app.py æ•ˆæœå›¾:\nç„¶å\u0026hellip;\nå†™å®Œäº†\u0026hellip;\nä¸‹æ¬¡è§\u0026hellip;\n","date":"2018-05-23T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/%E5%8D%8A%E4%B8%AA%E5%B0%8F%E6%97%B6%E6%95%99%E4%BD%A0%E5%86%99%E4%B8%80%E4%B8%AA%E6%AF%95%E8%AE%BE%E4%B9%8B%E5%9C%B0%E5%9B%BE%E6%90%9C%E7%A7%9F%E6%88%BF/","title":"åŠä¸ªå°æ—¶æ•™ä½ å†™ä¸€ä¸ªæ¯•è®¾ä¹‹åœ°å›¾æœç§Ÿæˆ¿"},{"content":"åŒæ­¥åšå®¢åˆ°è…¾è®¯äº‘ç¤¾åŒºå£°æ˜ æˆ‘çš„åšå®¢å³å°†æ¬è¿åŒæ­¥è‡³è…¾è®¯äº‘+ç¤¾åŒºï¼Œé‚€è¯·å¤§å®¶ä¸€åŒå…¥é©»ï¼šhttps://cloud.tencent.com/developer/support-plan?invite_code=2wlwxlkrybgg8\n","date":"2018-05-22T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/%E5%90%8C%E6%AD%A5%E5%8D%9A%E5%AE%A2%E5%88%B0%E8%85%BE%E8%AE%AF%E4%BA%91%E7%A4%BE%E5%8C%BA%E5%A3%B0%E6%98%8E/","title":"åŒæ­¥åšå®¢åˆ°è…¾è®¯äº‘ç¤¾åŒºå£°æ˜"},{"content":"ç”¨Visual Studio Code Debugä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€(Macç¯‡) é¦–å…ˆ,ä½ è¦æœ‰å°Macbook Pro,æ¥ç€æ‰ç»§ç»­çœ‹è¿™ä¸ªæ•™ç¨‹.\nPS:Windowsç”¨æˆ·çœ‹è¿™é‡Œç”¨Visual Studio Code Debugä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€\nbrew ç¯å¢ƒå‡†å¤‡ è§brew.sh,æˆ–è€…\n1 /usr/bin/ruby -e \u0026#34;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)\u0026#34; PHP7 + nginx + php-fpm + xdebug \bPHP7 1 2 brew install php@7.1 å®‰è£…å®Œäº†ä¹‹åçœ‹ä¸‹å®‰è£…è·¯å¾„:\n1 2 3 4 5 6 where php; ##âœ ~ where php ## /usr/local/opt/php@7.1/bin/php ## /usr/bin/php ä¸€èˆ¬php.iniåœ¨/usr/local/etc/php/7.1\n1 2 ls /usr/local/etc/php/7.1 #conf.d pear.conf php-fpm.conf php-fpm.d php.ini å¾…ä¼šæˆ‘ä»¬é…ç½®xdebugå’Œphp-fpmçš„æ—¶å€™ä¼šç”¨åˆ°è¿™ä¸ªè¿™äº›é…ç½®æ–‡ä»¶çš„,å…ˆè·³è¿‡\nxdebugå®‰è£… æœ¬æ¥å…¶å®ä¸€å¥brew install php71-xdebug \u0026ndash;without-homebrew-phpå°±å®Œäº‹çš„,è°çŸ¥é“homebrew-phpæœ€è¿‘è¢«ç§»é™¤äº†,æ‰€ä»¥å°±å°´å°¬äº†\u0026hellip;\næ‰‹åŠ¨å»ä¸‹è½½xdebugç„¶åé…ç½®å§.ä¸‹è½½é¡µé¢:https://xdebug.org/files/\né€‰æ‹©è‡ªå·±è¦å®‰è£…çš„ç‰ˆæœ¬,æˆ‘è¿™é‡Œé€‰äº†2.6.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 # åˆ›å»ºä¸€ä¸ªä½ å–œæ¬¢çš„è·¯å¾„å­˜æ”¾,æˆ‘æ”¾åœ¨äº†~/tool/ç›®å½•ä¸‹; mkdir tool; wget https://xdebug.org/files/xdebug-2.6.0.tgz; # è§£å‹ tar xvzf xdebug-2.6.0.tgz; cd xdebug-2.6.0; # åˆå§‹åŒ–phpæ¨¡å— phpize; # ç”Ÿæˆå¯¹åº”çš„soæ–‡ä»¶ # ./configure --enable-xdebug --with-php-config=PHPå®‰è£…è·¯å¾„/bin/php-config; ./configure --enable-xdebug --with-php-config=/usr/local/Cellar/php@7.1/7.1.17/bin/php-config; make; make test; # ä¸Šä¸€æ­¥æ­£å¸¸makeæ‰§è¡Œå®Œæ¯•ä¹‹åä¼šåœ¨xdebug-2.6.0/modules/æ–‡ä»¶å¤¹ä¸‹ç”Ÿæˆxdebug.laå’Œxdebug.so,å¾…ä¼šæˆ‘ä»¬åœ¨php.iniä¸­é…ç½®xdebugä¼šç”¨åˆ°è¿™ä¸ªæ–‡ä»¶ https://www.techflirt.com/install-configure-xdebug-on-xampp-windows-and-mac/\nå®‰è£…nginx 1 2 brew install nginx é…ç½®nginx.conf å®‰è£…å®Œæˆä¹‹åå¼€å§‹é…ç½®nginx,é¦–å…ˆåˆ›å»ºä¸€å †éœ€è¦ç”¨åˆ°çš„æ–‡ä»¶ä»¶.\n1 2 3 4 5 6 7 8 9 10 11 12 13 mkdir -p /usr/local/var/logs/nginx mkdir -p /usr/local/etc/nginx/sites-available mkdir -p /usr/local/etc/nginx/sites-enabled mkdir -p /usr/local/etc/nginx/conf.d mkdir -p /usr/local/etc/nginx/ssl sudo mkdir -p /var/www sudo chown :staff /var/www sudo chmod 777 /var/www #ä½œè€…ï¼šGQ1994 #é“¾æ¥ï¼šhttps://www.jianshu.com/p/a642ee8eca9a #ä¾†æºï¼šç®€ä¹¦ #è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚ ç„¶åvim /usr/local/etc/nginx/nginx.conf è¾“å…¥ä»¥ä¸‹å†…å®¹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 user root wheel; #é»˜è®¤çš„æ˜¯nobodyä¼šå¯¼è‡´403 worker_processes 1; error_log /usr/local/var/logs/nginx/error.log debug; pid /usr/local/var/run/nginx.pid; events { worker_connections 256; } http { include mime.types; default_type application/octet-stream; log_format main \u0026#39;$remote_addr - $remote_user [$time_local] \u0026#34;$request\u0026#34; \u0026#39; \u0026#39;$status $body_bytes_sent \u0026#34;$http_referer\u0026#34; \u0026#39; \u0026#39;\u0026#34;$http_user_agent\u0026#34; \u0026#34;$http_x_forwarded_for\u0026#34;\u0026#39;; access_log /usr/local/var/logs/access.log main; sendfile on; keepalive_timeout 65; port_in_redirect off; include /usr/local/etc/nginx/sites-enabled/*; } è®¾ç½®nginx php-fpmé…ç½®æ–‡ä»¶ vim /usr/local/etc/nginx/conf.d/php-fpm ä¿®æ”¹ä¸º(æ²¡æœ‰åˆ™åˆ›å»º)\n1 2 3 4 5 6 7 8 #proxy the php scripts to php-fpm location ~ \\.php$ { try_files $uri = 404; fastcgi_pass 127.0.0.1:9000; fastcgi_index index.php; fastcgi_intercept_errors on; include /usr/local/etc/nginx/fastcgi.conf; } åˆ›å»ºé»˜è®¤è™šæ‹Ÿä¸»æœºdefault vim /usr/local/etc/nginx/sites-available/defaultè¾“å…¥ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 server { listen 80;#å¦‚æœ80è¢«ç”¨äº†å¯ä»¥æ¢æˆåˆ«çš„,éšä½ å¼€å¿ƒ server_name www.qilipet.com admin.qilipet.com; root /var/www/pet/public; access_log /usr/local/var/logs/nginx/default.access.log main; index index.php index.html index.htm; location / { # First attempt to serve request as file, then # as directory, then fall back to displaying a 404. try_files $uri $uri/ /index.php?$query_string; # Uncomment to enable naxsi on this location # include /etc/nginx/naxsi.rules } location ~ \\.php$ { fastcgi_pass 127.0.0.1:9000; fastcgi_index index.php; fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name; include fastcgi_params; } } æ­¤éƒ¨åˆ†å†…å®¹åŸºæœ¬æ¥è‡ªGQ1994:macä¸‹é…ç½®phpã€nginxã€mysqlã€redis\né…ç½®php.ini å›åˆ°æˆ‘ä»¬çš„/usr/local/etc/php/7.1æ–‡ä»¶å¤¹\nåœ¨php.iniä¸­åŠ å…¥xdebug\bé…ç½®\n1 2 3 4 5 6 7 8 9 10 11 [xdebug] ;zend_extension=\u0026#34;åˆšåˆšçš„xdebugè·¯å¾„/modules/xdebug.so\u0026#34; zend_extension=\u0026#34;~/tool/xdebug-2.6.0/modules/xdebug.so\u0026#34; xdebug.remote_enable = 1 xdebug.remote_autostart = 1 xdebug.remote_connect_back = 1 ;é»˜è®¤çš„9000å·²ç»è¢«php-fpmå ç”¨äº†,åˆ‡è®°æ¢ä¸€ä¸ªç«¯å£ xdebug.remote_port = 9001 xdebug.scream = 0 xdebug.show_local_vars = 1 é‡å¯ä¸€ä¸‹php-fpmå’Œnginx,çœ‹ä¸€ä¸‹phpæ˜¯ä¸æ˜¯éƒ½æ­£å¸¸è·‘èµ·æ¥äº†.\nVS Codeé…ç½® User Settingsé…ç½®PHPç›®å½• 1 \u0026#34;php.executablePath\u0026#34;: \u0026#34;/usr/local/opt/php@7.1/bin/php\u0026#34; å®‰è£…php debugæ’ä»¶ å®‰è£…å®Œæˆä¹‹åé…ç½®ä¸€ä¸‹launch.json\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 { // ä½¿ç”¨ IntelliSense äº†è§£ç›¸å…³å±æ€§ã€‚ // æ‚¬åœä»¥æŸ¥çœ‹ç°æœ‰å±æ€§çš„æè¿°ã€‚ // æ¬²äº†è§£æ›´å¤šä¿¡æ¯ï¼Œè¯·è®¿é—®: https://go.microsoft.com/fwlink/?linkid=830387 \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for XDebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9001 //é»˜è®¤æ˜¯9000å·²ç»è¢«php-fpmå ç”¨,ä¸Šä¸€æ­¥æˆ‘ä»¬é…ç½®è¿œç¨‹ç«¯å£æ˜¯9001 }, { \u0026#34;name\u0026#34;: \u0026#34;Launch currently open script\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;program\u0026#34;: \u0026#34;${file}\u0026#34;, \u0026#34;cwd\u0026#34;: \u0026#34;${fileDirname}\u0026#34;, \u0026#34;port\u0026#34;: 9001 //é»˜è®¤æ˜¯9000å·²ç»è¢«php-fpmå ç”¨,ä¸Šä¸€æ­¥æˆ‘ä»¬é…ç½®è¿œç¨‹ç«¯å£æ˜¯9001 } ] } ç„¶åå°±æ„‰å¿«debugæœ€å¥½çš„è¯­è¨€å§!\nå…¶ä»–éƒ¨åˆ† macOSç³»ç»ŸPHP7å¢åŠ Xdebug\nInstall PEAR and PECL on Mac OS X\nXdebug on macOS 10.13 with PHP 7\ninstall-configure-xdebug-on-xampp-windows-and-mac\ninstalling-pecl-and-pear-on-os-x-10-11-el-capitan-macos-10-12-sierra-macos-10\n","date":"2018-05-21T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/%E7%94%A8visual-studio-code-debug%E4%B8%96%E7%95%8C%E4%B8%8A%E6%9C%80%E5%A5%BD%E7%9A%84%E8%AF%AD%E8%A8%80mac%E7%AF%87/","title":"ç”¨Visual Studio Code Debugä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€(Macç¯‡)"},{"content":"logstash groké…ç½®è§„åˆ™ logstash.conf è¿™é‡Œä¸»è¦éœ€è¦é…ç½®grok match,æŠŠæ—¥å¿—ä¿¡æ¯åˆ‡åˆ†æˆç´¢å¼•æ•°æ®(matchæœ¬è´¨æ˜¯ä¸€ä¸ªæ­£åˆ™åŒ¹é…)\næ—¥å¿—åŸæ–‡:\n1 2018-04-13 16:03:49.822 INFO o.n.p.j.c.XXXXX - Star Calculator grok match:\n1 match =\u0026gt; { \u0026#34;message\u0026#34; =\u0026gt; \u0026#34;%{DATA:log_date} %{TIME:log_localtime} %{WORD:log_type} %{JAVAFILE:log_file} - %{GREEDYDATA:log_content}\u0026#34;} åˆ‡å‡ºæ¥çš„æ•°æ®\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 { \u0026#34;log_date\u0026#34;: [ [ \u0026#34;2018-04-13\u0026#34; ] ], \u0026#34;log_localtime\u0026#34;: [ [ \u0026#34;16:03:49.822\u0026#34; ] ], \u0026#34;HOUR\u0026#34;: [ [ \u0026#34;16\u0026#34; ] ], \u0026#34;MINUTE\u0026#34;: [ [ \u0026#34;03\u0026#34; ] ], \u0026#34;SECOND\u0026#34;: [ [ \u0026#34;49.822\u0026#34; ] ], \u0026#34;log_type\u0026#34;: [ [ \u0026#34;INFO\u0026#34; ] ], \u0026#34;log_file\u0026#34;: [ [ \u0026#34;o.n.p.j.c.XXXX\u0026#34; ] ], \u0026#34;log_content\u0026#34;: [ [ \u0026#34;Star Calculator\u0026#34; ] ] } ä¸Šé¢æ‰€æœ‰åˆ‡å‡ºæ¥çš„fieldéƒ½æ˜¯\besä¸­mapping index,éƒ½å¯ä»¥åœ¨ç”¨æ¥åšæ¡ä»¶æŸ¥è¯¢.\ngrokdebug.herokuapp.comé‡Œé¢å¯ä»¥åšæµ‹è¯•.\ngrokdebug.herokuapp.com/patterns æ‰€æœ‰å¯ç”¨çš„patternséƒ½å¯ä»¥åœ¨è¿™é‡ŒæŸ¥åˆ°.\nç°åœ¨æˆ‘ä»¬åœ¨ç”¨çš„é…ç½®è§/logstash/logstash-k8s.conf\nQ: éœ€è¦æŒ‡å®šmapping indexçš„æ•°æ®ç±»å‹æ€ä¹ˆåŠ? A: grok matchæœ¬è´¨æ˜¯ä¸€ä¸ªæ­£åˆ™åŒ¹é…,é»˜è®¤å‡ºæ¥çš„æ•°æ®éƒ½æ˜¯String.\bæœ‰äº›æ—¶å€™æˆ‘ä»¬çŸ¥é“æŸä¸ªå€¼å…¶å®æ˜¯ä¸ªæ•°æ®ç±»å‹,è¿™æ—¶å€™å¯ä»¥ç›´æ¥æŒ‡å®šæ•°æ®ç±»å‹. ä¸è¿‡matchä¸­ä»…æ”¯æŒç›´æ¥è½¬æ¢æˆint ,float,è¯­æ³•æ˜¯ %{NUMBER:response_time:int} å®Œæ•´é…ç½®:\n1 2 match =\u0026gt; { \u0026#34;message\u0026#34; =\u0026gt; \u0026#34;%{DATA:log_date} %{TIME:log_localtime} %{WORD:log_type} %{JAVAFILE:log_file} - %{WORD:method} %{URIPATHPARAM:uri} %{NUMBER:status:int} %{NUMBER:size:int} %{NUMBER:response_time:int}\u0026#34;} Q: ç´¢å¼•æ–‡ä»¶æƒ³éœ€è¦æŒ‰æ—¥æœŸåˆ†åˆ«å­˜æ”¾,æ€ä¹ˆåŠ? A: outä¸­æŒ‡å®šindex\bæ ¼å¼,å¦‚ index=\u0026gt; \u0026ldquo;k8s-%{+YYYY.MM.dd}\u0026rdquo;\nå®Œæ•´outå¦‚ä¸‹:\n1 2 3 4 5 6 7 output { elasticsearch { hosts =\u0026gt; \u0026#34;${ES_URL}\u0026#34; manage_template =\u0026gt; false index =\u0026gt; \u0026#34;k8s-%{+YYYY.MM.dd}\u0026#34; } } å®Œæ•´logstash.conf\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 input { beats { host =\u0026gt; \u0026#34;0.0.0.0\u0026#34; port =\u0026gt; 5043 } } filter { if [type] == \u0026#34;kube-logs\u0026#34; { mutate { rename =\u0026gt; [\u0026#34;log\u0026#34;, \u0026#34;message\u0026#34;] } date { match =\u0026gt; [\u0026#34;time\u0026#34;, \u0026#34;ISO8601\u0026#34;] remove_field =\u0026gt; [\u0026#34;time\u0026#34;] } grok { match =\u0026gt; { \u0026#34;source\u0026#34; =\u0026gt; \u0026#34;/var/log/containers/%{DATA:pod_name}_%{DATA:namespace}_%{GREEDYDATA:container_name}-%{DATA:container_id}.log\u0026#34;} match =\u0026gt; { \u0026#34;message\u0026#34; =\u0026gt; \u0026#34;%{DATA:log_date} %{TIME:log_localtime} %{WORD:log_type} %{JAVAFILE:log_file} - %{WORD:method} %{URIPATHPARAM:uri} %{NUMBER:status:int} %{NUMBER:size:int} %{NUMBER:response_time:int}\u0026#34;} remove_field =\u0026gt; [\u0026#34;source\u0026#34;] break_on_match =\u0026gt; false } } } output { elasticsearch { hosts =\u0026gt; \u0026#34;${ES_URL}\u0026#34; manage_template =\u0026gt; false index =\u0026gt; \u0026#34;k8s-%{+YYYY.MM.dd}\u0026#34; } } ","date":"2018-05-20T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/logstash-grok%E9%85%8D%E7%BD%AE%E8%A7%84%E5%88%99/","title":"logstash groké…ç½®è§„åˆ™"},{"content":"æ‰‹æŠŠæ‰‹æ•™ä½ ç”¨Dockeræ­å»ºHexoåšå®¢ hexo å¿«é€Ÿã€ç®€æ´ä¸”é«˜æ•ˆçš„åšå®¢æ¡†æ¶,Node.js æ‰€å¸¦æ¥çš„è¶…å¿«ç”Ÿæˆé€Ÿåº¦ï¼Œè®©ä¸Šç™¾ä¸ªé¡µé¢åœ¨å‡ ç§’å†…ç¬é—´å®Œæˆæ¸²æŸ“ã€‚\nåªéœ€ä¸€æ¡æŒ‡ä»¤å³å¯éƒ¨ç½²åˆ° GitHub Pages, Heroku æˆ–å…¶ä»–ç½‘ç«™ã€‚\nHexo æ‹¥æœ‰å¼ºå¤§çš„æ’ä»¶ç³»ç»Ÿï¼Œå®‰è£…æ’ä»¶å¯ä»¥è®© Hexo æ”¯æŒ Jade, CoffeeScriptã€‚\n1 2 3 4 5 npm install hexo-cli -g hexo init blog cd blog npm install hexo server ä»¥ä¸Šæ¥è‡ªHexoå®˜ç½‘\nåˆ°è¿™é‡Œ,ä½ çš„hexoåšå®¢å·²ç»åˆå§‹åŒ–å¥½äº†, blog/publicæ–‡ä»¶å¤¹ä¸‹é¢å·²ç»ç”Ÿæˆäº†å¯¹åº”çš„HTMLæ–‡ä»¶.\næ‰©å±•é˜…è¯»:\nhexo nextä¸»é¢˜\nhexo nextä¸»é¢˜é…ç½®\ndocker éƒ¨ç½² ä¸BBè¿™ä¹ˆå¤š,å…ˆä¸ŠDockerfile\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 # nodeç¯å¢ƒé•œåƒ FROM node:latest AS build-env # åˆ›å»ºhexo-blogæ–‡ä»¶å¤¹ä¸”è®¾ç½®æˆå·¥ä½œæ–‡ä»¶å¤¹ RUN mkdir -p /usr/src/hexo-blog WORKDIR /usr/src/hexo-blog # å¤åˆ¶å½“å‰æ–‡ä»¶å¤¹ä¸‹é¢çš„æ‰€æœ‰æ–‡ä»¶åˆ°hexo-blogä¸­ COPY . . # å®‰è£… hexo-cli RUN npm --registry=https://registry.npm.taobao.org install hexo-cli -g \u0026amp;\u0026amp; npm install # ç”Ÿæˆé™æ€æ–‡ä»¶ RUN hexo clean \u0026amp;\u0026amp; hexo g # é…ç½®nginx FROM nginx:latest ENV TZ=Asia/Shanghai RUN ln -snf /usr/share/zoneinfo/$TZ /etc/localtime \u0026amp;\u0026amp; echo $TZ \u0026gt; /etc/timezone WORKDIR /usr/share/nginx/html # æŠŠä¸Šä¸€éƒ¨ç”Ÿæˆçš„HTMLæ–‡ä»¶å¤åˆ¶åˆ°Nginxä¸­ COPY --from=build-env /usr/src/hexo-blog/public /usr/share/nginx/html EXPOSE 80 æ¥ç€è·‘ä¸€ä¸‹çœ‹çœ‹.\n1 2 docker build -t é•œåƒå:latest .; docker run -p 80:80 -d é•œåƒå:latest; å¥½äº†,å®Œäº‹\u0026hellip;.\nNginx httpsè¯ä¹¦é…ç½® æœ€åNginxé…ç½®httpsè¯ä¹¦çš„æ­¥éª¤.\né¦–å…ˆ,ä½ è¦æœ‰ä¸ªè¯ä¹¦,å“ªæ¥çš„æˆ‘ä¸ç®¡äº†.\nPS:è‰¯å¿ƒæ¨èhttps://freessl.org/ç›´æ¥ç”Ÿæˆå…è´¹è¯ä¹¦\nç„¶ånginx.confå¦‚ä¸‹:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 events { worker_connections 1024; } http { server { listen 443; server_name codelover.link; root /usr/share/nginx/html; index index.html index.htm; ssl on; ssl_certificate /etc/nginx/full_chain.pem; ssl_certificate_key /etc/nginx/private.key; include /etc/nginx/mime.types; default_type application/octet-stream; gzip on; gzip_min_length 5k; gzip_buffers 4 16k; gzip_http_version 1.1; gzip_comp_level 3; gzip_types text/plain application/json application/javascript text/css application/xml text/javascript image/jpeg image/gif image/png; gzip_vary on; } server { listen 80; server_name codelover.link; root /usr/share/nginx/html; index index.html index.htm; include /etc/nginx/mime.types; default_type application/octet-stream; } } è¿™æ—¶å€™ç”¨dockerè·‘ä½ çš„hexo-blogé•œåƒçš„æ—¶å€™æŠŠå¯¹åº”çš„pemå’Œkeyæ–‡ä»¶æ˜ å°„åˆ°å¯¹åº”è·¯å¾„è®°å½•.\nå¦‚ä¸‹:\n1 2 3 4 5 6 7 # codelover-blog ä¸ºé…ç½®æ–‡ä»¶è·¯å¾„,codelover-blog/sslä¸ºè¯ä¹¦è·¯å¾„ docker run -p 80:80 -p 443:443 \\ --name codelover-blog \\ -v ~/docker-data/codelover-blog/nginx.conf:/etc/nginx/nginx.conf \\ -v ~/docker-data/codelover-blog/ssl/full_chain.pem:/etc/nginx/full_chain.pem \\ -v ~/docker-data/codelover-blog/ssl/private.key:/etc/nginx/private.key \\ --restart=always -d ä½ çš„hexo-blogåšå®¢é•œåƒ; é¡ºæ‰‹ä¹ŸæŠŠéé™æ€æ–‡ä»¶çš„nginxé…ç½®æ”¾ä¸€ä»½,å¦‚ä¸‹:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 events { worker_connections 1024; } http { upstream webservers { #weigthå‚æ•°è¡¨ç¤ºæƒå€¼ï¼Œæƒå€¼è¶Šé«˜è¢«åˆ†é…åˆ°çš„å‡ ç‡è¶Šå¤§ #æœ¬æœºä¸Šçš„Squidå¼€å¯3128ç«¯å£ server 10.31.160.197:8080 weight=5; server 192.168.0.1:9090 weight=3; } server { listen 443; server_name woyaozufang.live; location / { proxy_pass http://webservers; } ssl on; ssl_certificate /etc/nginx/full_chain.pem; ssl_certificate_key /etc/nginx/private.key; error_page 500 502 503 504 /50x.html; location = /50x.html { root html; } gzip on; gzip_min_length 5k; gzip_buffers 4 16k; gzip_http_version 1.1; gzip_comp_level 3; gzip_types text/plain application/json application/javascript text/css application/xml text/javascript image/jpeg image/gif image/png; gzip_vary on; } server { listen 8080; server_name woyaozufang.live; location / { proxy_pass http://webservers; } error_page 500 502 503 504 /50x.html; location = /50x.html { root html; } } server { listen 80; server_name woyaozufang.live; location / { proxy_pass http://webservers; } error_page 500 502 503 504 /50x.html; location = /50x.html { root html; } } } ","date":"2018-05-18T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E7%94%A8docker%E6%90%AD%E5%BB%BAhexo%E5%8D%9A%E5%AE%A2/","title":"æ‰‹æŠŠæ‰‹æ•™ä½ ç”¨Dockeræ­å»ºHexoåšå®¢"},{"content":"Jenkinséƒ¨åˆ† é¦–å…ˆ,æˆ‘ä»¬è¦æœ‰ä¸ªJenkinså’¯,ä¸‹è½½é“¾æ¥:https://jenkins.io/download/\næˆ‘ä»¬å®‰è£…å®˜ç½‘æ•™ç¨‹å®‰è£…å¥½jenkins,å®‰è£…æ•™ç¨‹ç•¥\u0026hellip;.\nå—¯?ä¸æ˜¯è¯´å¥½æ‰‹æŠŠæ‰‹ä¹ˆ?ä½ å¦¹çš„.\nå¥½å¥½å¥½,æˆ‘ä»¬è¿˜æ˜¯æ¥æ‰‹æŠŠæ‰‹æ•™ç¨‹å¥½äº†.\né¦–å…ˆå®‰è£…JDK8 æ·»åŠ å®‰è£…æºä¹‹åç›´æ¥apt-get installå°±å¥½,ä¸‹é¢æ˜¯ubuntuçš„å®‰è£…å‘½ä»¤,å…¶ä»–ç³»ç»Ÿè‡ªå·±ç©ä¸€ä¸‹å°±å¥½.\n1 2 3 4 5 6 sudo add-apt-repository ppa:webupd8team/java sudo apt-get update sudo apt-get install oracle-java8-installer ä¸‹è½½jenkins.war + å¯åŠ¨Jenkins ä¸‹è½½é“¾æ¥:http://mirrors.jenkins.io/war-stable/\nåœ¨è¿™é‡Œé¢æ‰¾æœ€æ–°çš„ä¸‹è½½,æˆ‘å½“å‰æœ€æ–°çš„åº”è¯¥æ˜¯2.107.2\nä¸‹è½½å¥½äº†jenkins.warä¹‹å,åœ¨å½“å‰ç›®å½•åˆ›å»ºä¸€ä¸ªjenkins-homeæ–‡ä»¶å¤¹,è®¾ç½®JENKINS_HOMEç¯å¢ƒå˜é‡ä¸ºjenkins-home(ä¸è®¾ç½®ä¹Ÿå¯ä»¥,é»˜è®¤åœ¨~/.jenkins)\n1 2 3 4 5 6 wget http://mirrors.jenkins.io/war-stable/2.107.2/jenkins.war; mkdir ~/jenkins-home; export JENKINS_HOME=~/jenkins-home; tmux; java -jar jenkins.war ä¸€èˆ¬å»ºè®®å¼€ä¸ªåå°è¿›ç¨‹æ¥è·‘jenkins,å…å¾—ç»ˆç«¯é€€å‡ºä¹‹åjenkinså°±æ­»æ‰äº†.\næ‰€ä»¥ä¸Šé¢æˆ‘å…ˆæ‰“å¼€äº†tmuxä¹‹åå†è·‘java -jar jenkins.war.\nå¦‚ä¸‹å›¾: æ¥ç€\bç•™æ„ä¸€ä¸‹initialAdminPasswordçš„è¾“å‡º\n1 2 3 4 5 6 7 Jenkins initial setup is required. An admin user has been created and a password generated. Please use the following password to proceed to installation: XXXXXXXXXXXXXX This may also be found at: /root/jenkins-home/secrets/initialAdminPassword è¿™ä¸ªæ—¶å€™è®¿é—®å½“å‰ä¸»æœºçš„8080ç«¯å£å·²ç»å¯ä»¥çœ‹åˆ°jenkinsæ­£åœ¨å¯åŠ¨äº†,ç¨ç­‰ç‰‡åˆ»å°±å¯ä»¥çœ‹åˆ°jenkinsç™»å½•é¡µ.\nè¿™ä¸ªæ—¶å€™æŠŠä¸Šé¢çš„XXXXXXXXXXXXXXå¤åˆ¶å‡ºæ¥,è¾“è¿›å»ç‚¹å‡»\bç»§ç»­é…ç½®jenkinsè´¦å·å¯†ç ä¿¡æ¯ä¹‹ç±»çš„.\n\b\næ¥ç€å®‰è£…é»˜è®¤æ’ä»¶.\nè¿™é‡Œä¼°è®¡ä¹Ÿè¦ç­‰å‡ åˆ†é’Ÿä¸ç­‰,çœ‹ä½ çš„æœºå™¨æ€§èƒ½å’Œç½‘ç»œé€Ÿåº¦.\nå®‰è£…å¥½äº†ä¹‹åä¼šè¿›å…¥é…ç½®ç™»å½•è´¦å·å¯†ç ,å®‰è£…æç¤ºé…ç½®å°±å®Œäº‹.\næœ€å\bè¿›å…¥jenkinsé¡µé¢æ˜¯è¿™æ ·çš„. \båˆ°ç°åœ¨æˆ‘ä»¬å·²ç»æŠŠjenkinsè·‘èµ·æ¥äº†,ä¹Ÿæœ‰äº†ä¸€äº›å¸¸ç”¨çš„æ’ä»¶.\næˆ‘ä»¬å…ˆå»æŠŠdotnet core docker ç¼–è¯‘å‘å¸ƒç›¸å…³çš„ä¸œè¥¿å¼„å¥½ä¹‹åå†å›æ¥ç»§ç»­åšjenkinsä»»åŠ¡.\ndotnet core docker æ‰“åŒ… åœ¨é¡¹ç›®ç›®å½•ä¸‹æ–°å»ºDockerfileæ–‡ä»¶,å†…å®¹å¦‚ä¸‹:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 FROM microsoft/aspnetcore-build:2.0 AS build-env WORKDIR /app # copy csproj and restore as distinct layers COPY *.csproj ./ RUN dotnet restore # copy everything else and build COPY . ./ RUN dotnet publish -c Release -o out # build runtime image FROM microsoft/aspnetcore:2.0 WORKDIR /app COPY --from=build-env /app/out . ENTRYPOINT [\u0026#34;dotnet\u0026#34;, \u0026#34;ä½ çš„dotnet coreç¨‹åº.dll\u0026#34;] è¿™ä¸ªDockerfileåŸºæœ¬å°±æ˜¯æŠŠå½“å‰ç›®å½•çš„\bæ–‡ä»¶\bæ‹·è´åˆ°aspnetcore-buildé•œåƒä¸­,å†é‡Œé¢ç¼–è¯‘å¥½ä¹‹åå†å‘å¸ƒåˆ°aspnetcore:2.0\bé•œåƒ\bä¸­,\næœ€åæŒ‡å®šè¿è¡Œä½ çš„dotnet coreç¨‹åº\næ¥æº:https://github.com/DaoCloud/dotnet-docker-samples\ndocker build + run è„šæœ¬(éå¿…é¡»,å¯ä»¥ä½¿ç”¨jenkinsä¸­è„šæœ¬ç¼–è¯‘æ›¿ä»£) ä»¥HouseCrawler.Webä¸ºä¾‹,\n1 2 3 4 5 6 7 8 9 10 11 12 #!/bin/sh image_version=`date +%Y%m%d%H%M`; echo $image_version; cd ~/code/58HouseSearch/HouseCrawler.Core/HouseCrawler.Web; git pull --rebase origin master; docker stop house-web; docker rm house-web; docker build -t house-web:$image_version .; docker images; docker run -p 8080:80 -v ~/docker-data/house-web/appsettings.json:/app/appsettings.json -v ~/docker-data/house-web/NLogFile/:/app/NLogFile --restart=always --name house-web -d house-web:$image_version; docker logs house-web; é€šè¿‡ä¸Šé¢è¿™ä¸ªbuild+runè„šæœ¬,æˆ‘ä»¬å·²ç»æŠŠdotnet coreç¨‹åºç¼–è¯‘å¥½äº†,å¹¶ä¸”æ‰“åŒ…æˆäº†docker images,è¿˜ç›´æ¥è·‘èµ·æ¥äº†.\nä½†æ˜¯æˆ‘ä»¬æƒ³è¦çš„åº”è¯¥æ˜¯è‡ªåŠ¨åŒ–ç¼–è¯‘éƒ¨ç½²,è€Œä¸”ä¸Šé¢æˆ‘ä»¬éƒ½æŠŠjenkinsè·‘èµ·æ¥äº†,æ‰€ä»¥\u0026hellip;.\njenkins jobé…ç½® æ–°å»ºJob æ‰“å¼€jenkinsé¦–é¡µ,å·¦ä¾§é€‰æ‹©\u0026quot;æ–°å»ºä»»åŠ¡\u0026quot;(newJob),å¦‚ä¸‹å›¾:\nç»™æ–°çš„jobå–ä¸ªåå­—,ç„¶åé€‰æ‹©\u0026quot;æ„å»ºè‡ªç”±é£æ ¼çš„è½¯ä»¶é¡¹ç›®\u0026quot;,å¦‚å›¾:\næ·»åŠ æºç ä»“åº“ ç¡®è®¤ä¹‹åè¿›å…¥Jobé…ç½®é¡µé¢,æºç ç®¡ç†é‡Œé¢é€‰æ‹©git,å¦‚å›¾: å¦‚æœgitä»“åº“æ˜¯éœ€è¦æƒé™çš„è¯éœ€è¦é…ç½®ä¸€ä¸‹æƒé™,æˆ‘ä¸€èˆ¬ç®€å•ç²—æš´ç›´æ¥æŠŠjenkinsä¸»æœºçš„å…¬é’¥æ·»åŠ åˆ°gitä»“åº“é‡Œé¢,æ‰€ä»¥è¿™é‡Œç›´æ¥é…ç½®æˆ\u0026rsquo;From the Jenkins master ~/.ssh\u0026rsquo;,ä¹Ÿå¯ä»¥ç”¨è´¦å·å¯†ç è®¿é—®ç­‰ç­‰çš„.\n\u0026ldquo;Branch Specifier (blank for \u0026lsquo;any\u0026rsquo;)\t\u0026ldquo;é»˜è®¤masteråˆ†æ”¯,æ ¹æ®è‡ªå·±çš„éœ€æ±‚å¡«å…¥ä¸åŒçš„åˆ†æ”¯.\næ„å»ºè§¦å‘å™¨å’Œæ„å»ºç¯å¢ƒå…ˆè·³è¿‡,æˆ‘ä»¬ä¸ç®¡,å¾…ä¼šå¼„.\næ„å»º ç‚¹å‡»\u0026quot;æ·»åŠ æ„å»ºæ­¥éª¤\u0026rdquo;,é€‰æ‹©\u0026quot;Execute shell\u0026rdquo;,ç„¶åèƒ½çœ‹åˆ°å¦‚ä¸‹å›¾: è¿˜è®°å¾—æˆ‘ä»¬ä¸Šä¸€æ­¥çš„è„šæœ¬ä¹ˆ?ä¿®æ”¹ä¸€ä¸‹æºç è·¯å¾„å†æ”¾è¿›å».\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 # åˆ‡æ¢åˆ°æºç ç›®å½•,å¯¹åº”åœ¨jenkins-homeçš„workspaceä¸‹é¢ cd ~jenkins-home/workspace/é¡¹ç›®åç§°/Dockerfileæ‰€åœ¨ç›®å½•; image_version=`date +%Y%m%d%H%M`; echo $image_version; # åœæ­¢ä¹‹å‰çš„docker container docker stop house-web; # åˆ é™¤è¿™ä¸ªcontainer docker rm house-web; # buildé•œåƒå¹¶ä¸”æ‰“ä¸Štag docker build -t house-web:$image_version .; docker images; # æŠŠåˆšåˆšbuildå‡ºæ¥çš„é•œåƒè·‘èµ·æ¥ docker run -p 8080:80 -v ~/docker-data/house-web/appsettings.json:/app/appsettings.json -v ~/docker-data/house-web/NLogFile/:/app/NLogFile --restart=always --name house-web -d house-web:$image_version; docker logs house-web; å¦‚æœjenkinsä¸»æœºå’Œç¨‹åºè¿è¡Œä¸»æœºä¸åœ¨ä¸€å°æœºå™¨ä¸Š,å»ºè®®ç›´æ¥åœ¨æŠŠä¸Šé¢çš„è„šæœ¬æ”¾åœ¨è¿è¡Œä¸»æœºä¸Š,å‘½åæˆ start_XXX.sh.\nä¸Šé¢çš„å‘½ä»¤ç›´æ¥å°±æ˜¯æˆäº†\n1 ssh username@å‘å¸ƒä¸»æœºçš„IP \u0026#39;~/start_XXX.sh\u0026#39; ps:è®°å¾—åœ¨jenkinsä¸»æœºé…ç½®sshå…ç™»é™†\næ„å»ºè§¦å‘å™¨ æ„å»ºè§¦å‘å™¨å°±æ˜¯æˆ‘ä»¬é€‰æ‹©ä»€ä¹ˆæ—¶å€™æ¥è§¦å‘æ„å»ºä»»åŠ¡,æœ‰å‡ ç§æ–¹æ¡ˆå¯ä»¥åš.\nä½¿ç”¨ Build periodically,å®šæ—¶ or éš”Nä¹…å»æ‹‰ä¸€æ¬¡ä»£ç æ„å»º Poll SCMï¼šå®šæ—¶æ£€æŸ¥æºç å˜æ›´ï¼ˆæ ¹æ®SCMè½¯ä»¶çš„ç‰ˆæœ¬å·ï¼‰,å¦‚æœæœ‰å˜åŒ–å°±å»æ‰§è¡Œæ„å»º GitHub hook trigger for GITScm polling æˆ–è€…å…¶ä»–Gitå¹³å°æä¾›çš„webhook å®‰è£…Generic Webhook Triggeræ’ä»¶ä¹‹å,ä½¿ç”¨å…¶ä»–å¹³å°çš„webhookæ¥è§¦å‘æ„å»ºä»»åŠ¡. æˆ‘è¿™é‡Œé€‰æ‹©ç¬¬4ç§æ–¹æ¡ˆ,å®‰è£…Generic Webhook Triggeræ’ä»¶,ä¸‹é¢é©¬ä¸Šå›å‘Šè¯‰ä½ ä¸ºä»€ä¹ˆè¿™æ ·åšçš„.\nGeneric Webhook Triggeræ’ä»¶åœ¨\u0026quot;ç³»ç»Ÿç®¡ç†-ç®¡ç†æ’ä»¶-å¯é€‰æ’ä»¶\u0026quot;é‡Œé¢ç›´æ¥æœ\u0026quot;Generic Webhook Trigger\u0026quot;å®‰è£…å°±å¯ä»¥.\nä»ä¸Šä¸€æ­¥çš„æ„å»ºæ­¥éª¤é‡Œé¢çš„è„šæœ¬ä¸­æˆ‘ä»¬å°±çŸ¥é“,å…¶å®æˆ‘ä»¬ç°åœ¨è¦ä¸å°±åœ¨jenkinsä¸»æœºä¸Šdocker build,è¦ä¸å°±åœ¨å‘å¸ƒç›®æ ‡ä¸»æœºä¸Šbuild,\nbuildè¿‡ç¨‹æ¯”è¾ƒæ…¢è€Œä¸”è¿˜ä¼šäº§ç”Ÿé•œåƒåœ¨æœ¬æœºorç›®æ ‡ä¸»æœºä¸Š,docker imagesä¹Ÿæ²¡æœ‰è¢«ç®¡ç†èµ·æ¥.\næœ‰ä»€ä¹ˆå¥½çš„åŠæ³•ä¹ˆ?å—¯,è¿˜çœŸæœ‰.ç›´æ¥ç”¨é˜¿é‡Œäº‘\u0026quot;å®¹å™¨é•œåƒæœåŠ¡\u0026quot;æ¥æ„å»ºé•œåƒ\nä½¿ç”¨é˜¿é‡Œäº‘-å®¹å™¨é•œåƒæœåŠ¡ é¦–å…ˆç™»å½•é˜¿é‡Œäº‘,ç„¶åè¿›å…¥å®¹å™¨é•œåƒæœåŠ¡,åœ°å€æ˜¯https://cr.console.aliyun.com/\né¦–æ¬¡è¿›å…¥ä¼°è®¡éœ€è¦åˆ›å»ºä¸€ä¸ªå‘½åç©ºé—´,ä¸€èˆ¬ç”¨å…¬å¸åæˆ–è€…ä½ çš„åå­—å°±å®Œäº‹.\næ¥ç€é€‰æ‹©\u0026quot;åˆ›å»ºé•œåƒä»“åº“\u0026quot;.\né€‰åœ°åŒº-é€‰å‘½åç©ºé—´-å¡«ä»“åº“åç§°(å°±æ˜¯é•œåƒåç§°)-å¡«æ‘˜è¦-è®¾ç½®ä»£ç æº(æ”¯æŒGitHub/é˜¿é‡Œäº‘code/Bitbucket/ç§æœ‰Gitlab/æœ¬åœ°Gitç­‰ç­‰,ç»™ä¸ªæˆæƒå°±å®Œäº‹)\næ„å»ºè®¾ç½®é€‰æ‹©\u0026quot;ä»£ç å˜æ›´æ—¶è‡ªåŠ¨æ„å»ºé•œåƒ\u0026quot;,ç„¶åé€‰ä¸€ä¸‹æ„å»ºåˆ†æ”¯ä¸ºä½ æƒ³è¦çš„åˆ†æ”¯,å¡«å…¥Dockerfileåœ¨æºç ä¸­çš„è·¯å¾„,ç„¶åä¿å­˜ æ¥ç€æˆ‘ä»¬è¿›å…¥ç®¡ç†å¹³å°çœ‹ä¸€ä¸‹.\nç‚¹å‡»ä¸€ä¸‹\u0026quot;ç«‹å³æ„å»º\u0026quot;,ç„¶åæŸ¥çœ‹ä¸€ä¸‹æ—¥å¿—. è¿™ä¸ªæ—¶å€™,æˆ‘ä»¬ç”¨docker pull registry-internal.cn-hangzhou.aliyuncs.com/ä½ çš„å‘½åç©ºé—´/ä½ çš„é•œåƒåç§° å°±å¯ä»¥æ‹‰åˆ°è¿™ä¸ªé˜¿é‡Œäº‘buildæˆåŠŸçš„é•œåƒäº†.\né•œåƒbuildçš„é—®é¢˜è§£å†³äº†,é‚£ä¹ˆæˆ‘ä»¬æ€ä¹ˆè‡ªåŠ¨æŠŠé•œåƒå‘å¸ƒåˆ°æˆ‘ä»¬çš„è¿è¡Œä¸»æœºå‘¢?\nè¿™æ—¶å€™webhookåˆå‡ºæ¥äº†.\njenkins webhookè§¦å‘é…ç½® æˆ‘ä»¬çœ‹é˜¿é‡Œäº‘é•œåƒæ„å»ºæœåŠ¡é‡Œé¢,æœ‰ä¸€é¡¹æ˜¯webhookçš„,å®˜æ–¹ä»‹ç»åœ¨è¿™é‡Œ:é˜¿é‡Œäº‘-webhookç®¡ç†\nè¿™é‡Œå°±éœ€è¦å¡«å…¥æˆ‘ä»¬çš„webhookåœ°å€,è¿˜è®°å¾—å‰é¢æˆ‘æ— ç«¯ç«¯é€‰æ‹©çš„ç¬¬å››ç§æ–¹æ¡ˆ,ç„¶åè®©å¤§å®¶è·Ÿç€å®‰è£…çš„Generic Webhook Triggeræ’ä»¶ä¹ˆ?\næˆ‘ä»¬å°±æ˜¯ç”¨è¿™è´§æ¥ä¸ºæˆ‘ä»¬æä¾›webhook API.\nç†ä¸€ä¸‹æµç¨‹:\ngitä»“åº“ä»£ç å˜åŒ– -\u0026gt;é˜¿é‡Œäº‘å®¹å™¨æ„å»ºæœåŠ¡å¯åŠ¨ -\u0026gt; æ„å»ºå¥½é•œåƒä¹‹åè§¦å‘webhook -\u0026gt; jenkinsæ”¶åˆ°é˜¿é‡Œäº‘çš„webhookä¹‹åè§¦å‘jobæ‰§è¡Œéƒ¨ç½²è„šæœ¬ -\u0026gt;éƒ¨ç½²è„šæœ¬ä½¿ç”¨é˜¿é‡Œäº‘é•œåƒrunèµ·æ¥ -\u0026gt;å®Œäº‹.\næˆ‘ä»¬ç»§ç»­é…ç½®Generic Webhook Trigger.\nGeneric Webhook Triggeræ”¯æŒçš„å‘½åè§¦å‘URLæ ¼å¼æ˜¯è¿™æ ·çš„:\n1 http://jenkinsç™»å½•ç”¨æˆ·å:tokenæˆæƒç @jenkins IP:8080/generic-webhook-trigger/invoke?token=è§¦å‘å™¨åç§° jenkinsç™»å½•åå’Œtokenåœ¨\u0026quot;è´¦å·-è®¾ç½®-API Token-Show API Token\u0026hellip;\u0026ldquo;é‡Œé¢èƒ½çœ‹åˆ°,æ‰¾å‡ºæ¥ä¹‹åå¡«åˆ°ä¸Šé¢å»å°±å¯ä»¥.\næœ€åä¸€ä¸ªtokenå‚æ•°å…¶å®å°±æ˜¯\u0026quot;æ„å»ºè§¦å‘å™¨\u0026quot;ä¸­\u0026quot;è§¦å‘è¿œç¨‹æ„å»º\u0026quot;çš„å‚æ•°,å»ºè®®ä½¿ç”¨jobåå­—.è¿™é‡Œçš„é…ç½®å¤§æ¦‚æ˜¯è¿™æ ·çš„:\næœ€åæˆ‘ä»¬è¿˜éœ€è¦åœ¨jenkinså…¨å±€å®‰å…¨è®¾ç½®ä¸­å–æ¶ˆå‹¾é€‰â€œé˜²æ­¢è·¨ç«™ç‚¹è¯·æ±‚ä¼ªé€ ï¼ˆPrevent Cross Site Request Forgery exploits)\u0026ldquo;é€‰é¡¹,è¿™æ ·é˜¿é‡Œäº‘webhookæ‰èƒ½è¿‡å¾—æ¥.\næ‰‹åŠ¨åœ¨æµè§ˆå™¨ä¸­è®¿é—®ä¸€ä¸‹http://jenkinsç™»å½•ç”¨æˆ·å:tokenæˆæƒç @jenkins IP:8080/generic-webhook-trigger/invoke?token=è§¦å‘å™¨åç§° å¦‚æœå¯¹åº”çš„jenkins Jobèƒ½æ­£å¸¸å¼€å§‹æ‰§è¡Œ,è¯´æ˜æ•´ä¸ªæµç¨‹å·²ç»okäº†.\næœ€åæˆ‘ä»¬å›åˆ°ä¸Šé¢\u0026quot;é˜¿é‡Œäº‘-å®¹å™¨é•œåƒæœåŠ¡-å¯¹åº”é•œåƒä»“åº“-webhook-æ·»åŠ è®°å½•\u0026rdquo; PS:webhookåç§°ä¸è¦å¸¦ç‰¹æ®Šå­—ç¬¦or \u0026ldquo;-\u0026ldquo;ä¹‹ç±»çš„,ä¸ç„¶ä¸€ç›´ä¿å­˜å¤±è´¥è€Œä¸”è¿˜ä¸ä¼šæç¤ºä½ æ˜¯å› ä¸ºåå­—ä¸åˆæ³•,ä¸‹åˆè¢«è¿™ä¸ªå‘äº†åŠä¸ªå°æ—¶.\nåˆ°è¿™é‡Œ,æˆ‘ä»¬åŸºæœ¬å¤§åŠŸå‘Šæˆäº†.\næœ€åæˆ‘ä»¬å†æ”¹ä¸€ä¸‹jenkinsçš„è„šæœ¬,ä¸åœ¨æœ¬åœ°build dockeräº†,ç›´æ¥æ‹¿\bé˜¿é‡Œäº‘é•œåƒæœåŠ¡æ„å»ºå‡ºæ¥çš„é•œåƒè·‘å°±å¯ä»¥.\n1 2 3 4 5 6 7 # åœæ­¢ä¹‹å‰çš„docker container docker stop house-web; # åˆ é™¤è¿™ä¸ªcontainer docker rm house-web; docker pull ä½ çš„é˜¿é‡Œäº‘é•œåƒåœ°å€; # æŠŠåˆšåˆšbuildå‡ºæ¥çš„é•œåƒè·‘èµ·æ¥ docker run --restart=always --name ä½ çš„contianeråç§° ä½ çš„é˜¿é‡Œäº‘é•œåƒåœ°å€; æ€»ç»“ä¸€ä¸‹æˆ‘ä»¬åšäº†ä»€ä¹ˆ æ­å»ºjenkins ç¼–å†™Dockerfileæ–‡ä»¶,ç›´æ¥ç¼–è¯‘å‘å¸ƒ+æ‰“åŒ…æˆdockeré•œåƒ+éƒ¨ç½²è„šæœ¬ \b\b\bä½¿ç”¨é˜¿é‡Œäº‘-å®¹å™¨æ„å»ºæœåŠ¡æ„å»ºdockeré•œåƒ,\bæ„å»ºæˆåŠŸåä½¿ç”¨webhooké€šçŸ¥jenkins \bé…ç½®jenkins webhookè§¦å‘å™¨,è§¦å‘éƒ¨ç½²è„šæœ¬ å…¶ä»–é¡¹ç›®/è¯­è¨€å…¶å®ä¹ŸåŸºæœ¬ä¸€æ ·çš„æ“ä½œ,åŒºåˆ«åªåœ¨äº\bDockerfileçš„ç¼–å†™ å®Œäº‹\u0026hellip; ","date":"2018-05-08T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E7%94%A8jenkins%E8%87%AA%E5%8A%A8%E5%8F%91%E5%B8%83dotnet-core%E7%BD%91%E7%AB%99/","title":"æ‰‹æŠŠæ‰‹æ•™ä½ ç”¨Jenkinsè‡ªåŠ¨å‘å¸ƒdotnet coreç½‘ç«™"},{"content":"è€æ—©ä¹‹å‰å°±åœ¨ v2ex å‘è¿‡å¸–å­ä»‹ç»è‡ªå·±çš„å·¥å…·å•¦ã€‚\nè€æ—©ä¹‹å‰åšçš„\u0026quot;åœ°å›¾æœç§Ÿæˆ¿(https://house-map.cn)\u0026ldquo;ä¸Šçº¿äº†æ–°äº¤äº’ï¼Œæ¬¢è¿å¤§å®¶è½»æ‹ç –\nå‘ç°å¥½å¤šäººéƒ½åœ¨\u0026quot;åŸå¸‚\u0026quot;è¿™ä¸ªä¸»é¢˜ä¸‹å‘è½¬ç§Ÿ/ç§Ÿæˆ¿å¸–å­,ç´¢æ€§æŠ“äº†ä¸€æ³¢åˆ°\u0026quot;åœ°å›¾æœç§Ÿæˆ¿\u0026quot;é‡Œé¢\nåˆæ˜¯ä¸€ä¸ªå¹¿å‘Šå¸–å­+\u0026ldquo;åœ°å›¾æœç§Ÿæˆ¿\u0026quot;å‰ç«¯å¤§æ”¹ç‰ˆ + å°ç¨‹åºä¸Šçº¿äº†\nåœ°å›¾æœç§Ÿæˆ¿-å¤šå¹³å°æˆ¿æºçˆ¬è™« + é«˜å¾·åœ°å›¾å¼ºåŠ›é©±åŠ¨,å¸®åŠ©ä½ è¿…é€Ÿæ‰¾åˆ°åˆé€‚æˆ¿æºã€‚\nå‡æ–°é—»å¼€å§‹ PSï¼šä¸Šé¢æ˜¯ä¸ªå‡æ–°é—»ï¼Œè¿™æ¬¡æ¥çœŸçš„ã€‚\nå†ä¹‹å‰çš„å°ç¨‹åºå› ä¸ºèµ„è´¨çš„é—®é¢˜é€šè¿‡ä¸äº†ã€‚\nå¤§æ¦‚æ˜¯å¹´å‰æ‹‰ç€å­¦å¼Ÿä¸€èµ·æ¥åšè¿™ä¸ªâ€œåœ°å›¾æœç§Ÿæˆ¿â€å°ç¨‹åºäº†ã€‚\nå¤§ä½“åšäº†ä¸‹é¢çš„ä¸€äº›åŠŸèƒ½ã€‚\nåŠŸèƒ½ä»‹ç» åŸå¸‚æˆ¿æº ä¸åŒå¹³å°å•ç‹¬å±•ç¤º æ¡ä»¶è¿‡æ»¤æŸ¥è¯¢ æˆ¿æºè¯¦æƒ… + åœ°å›¾ æ”¶è— + åé¦ˆ ç¥ä¸€æ ·ç°åœ¨æ‰å†™æ›´æ–°å†…å®¹ æ˜æ˜¾ï¼Œç°åœ¨ Beta9 å˜›ï¼Œå‡‘å’Œèƒ½ç”¨çš„ç¨‹åº¦ã€‚\næ›´æ–°åˆ—è¡¨ï¼š\næ”¯æŒäº†åŸå¸‚çš„è¡Œæ”¿åŒºç­›é€‰ï¼Œæ²¡æœ‰è¡Œæ”¿åŒºçš„ç›´æ¥å½’ä¸ºå½“å‰åŸå¸‚ æ”¯æŒäº† XX å¤©å†…çš„æ•°æ®ç­›é€‰ æ”¯æŒäº†æˆ¿æºç±»å‹çš„ç­›é€‰ ä¸Šé¢ç»„åˆ + ä»·æ ¼ç­›é€‰ä¹Ÿåšå•¦ åˆ—è¡¨é¡µæ”¯æŒäº†æˆ¿æºå‘å¸ƒæ—¶é—´ï¼Œæ›´åŠ ç›´è§‚å±•ç¤º ä¸€äº› Bug çš„ä¿®å¤å’Œå¼•å…¥äº†æ–°çš„ Bug ä¼˜åŒ–åŠ è½½é€Ÿåº¦ï¼Œæ–°å¢æ•°æ®ç¼“å­˜ åŠ äº†â€œå¹¿å‘Šâ€ä½\u0026hellip; å¹¿å‘Šä½çš„è¯´æ˜ åæ­£ä¹Ÿæ”¶ä¸åˆ°å¤šå°‘é’±ï¼Œ\nè¿™ä¸¤ä¸‰å¹´çš„é¡¹ç›®æ”¶å…¥æ˜¯-10000 å·¦å³ã€‚\n2333\u0026hellip;\næœ€åï¼ŒçŒ®ä¸Šåœ°å€ã€‚\nå¾®ä¿¡å…¬ä¼—å·æœç´¢â€œäººç”Ÿåˆ é™¤æŒ‡å—â€\næˆ–è€…æ‰«æä¸‹é¢çš„äºŒç»´ç éƒ½å¯ä»¥å…³æ³¨åè·å–å¾®ä¿¡å°ç¨‹åºã€‚\nPSï¼šå½“ç„¶æ˜¯è·ªæ±‚å…³æ³¨å•¦ã€‚\nå°ç¨‹åºç  æ’’æ—¶å€™è¿˜å¥—è·¯ v2ex è€å“¥å˜›ã€‚æœ‰å¿…è¦å—ï¼Ÿ\næ‹¿å»æ‹¿å»ï¼\næœ€åè¯´å‡ å¥ å°ç¨‹åºåˆšä¸Šçº¿æ²¡å¤šä¹…ï¼ŒBug å¤šå¤šï¼Œå¤šä½“è°…ä½“è°…ï¼Œæå§ä¸‡å²ï¼ æœ‰ä»€ä¹ˆå»ºè®®å’Œæƒ³æ³•æ¬¢è¿å…¬ä¼—å·äº¤æµï¼Œé‚®ä»¶æˆ‘ä¹Ÿè¡Œï¼ æ±‚è½»å–·ï¼Œåˆ«æ‰“è„¸ ","date":"2018-03-22T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/%E5%9C%B0%E5%9B%BE%E6%90%9C%E7%A7%9F%E6%88%BF-%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%89%88%E6%9C%AC%E4%B8%8A%E7%BA%BF/","title":"åœ°å›¾æœç§Ÿæˆ¿-å°ç¨‹åºç‰ˆæœ¬ä¸Šçº¿"},{"content":".NET Coreä¸­ä½¿ç”¨RabbitMQæ­£ç¡®æ–¹å¼ é¦–å…ˆç”©å®˜ç½‘:http://www.rabbitmq.com/\nç„¶åæ˜¯.NET Clienté“¾æ¥:http://www.rabbitmq.com/dotnet.html\nGitHubä»“åº“:https://github.com/rabbitmq/rabbitmq-dotnet-client\nä¸‹é¢ç›´æ¥è¿›å…¥æ­£æ–‡,ä¸€å…±æ˜¯ä¸¤ä¸ªä¸»é¢˜:æ¶ˆè´¹è€…æ€ä¹ˆå†™?ç”Ÿäº§è€…æ€ä¹ˆå†™?\næ¶ˆè´¹è€… åœ¨dotnet core mvcä¸­,æ¶ˆè´¹è€…è‚¯å®šä¸èƒ½é€šè¿‡APIæˆ–è€…å…¶ä»–çš„ä¸œè¥¿å¯åŠ¨,ç†åº”æ˜¯è·Ÿç€ç¨‹åºä¸€èµ·å¯åŠ¨çš„.\næ‰€ä»¥\u0026hellip;\nåœ¨dotnet core 2.0ä»¥ä¸Šç‰ˆæœ¬,æˆ‘ä»¬ç›´æ¥ç”¨ IHostedService æ¥å£å®ç°.\n.NET Core ä¸­åŸºäº IHostedService å®ç°åå°å®šæ—¶ä»»åŠ¡\nImplementing background tasks in .NET Core 2.x webapps or microservices with IHostedService and the BackgroundService class\nç›´æ¥ä¸Šä»£ç .\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 // RabbitListener.cs è¿™ä¸ªæ˜¯åŸºç±»,åªå®ç°æ³¨å†ŒRabbitMQååˆ°ç›‘å¬æ¶ˆæ¯,ç„¶åæ¯ä¸ªæ¶ˆè´¹è€…è‡ªå·±å»é‡å†™RouteKey/QueueName/æ¶ˆæ¯å¤„ç†å‡½æ•°Process using System; using System.Text; using System.Threading; using System.Threading.Tasks; using Microsoft.Extensions.DependencyInjection; using Microsoft.Extensions.Hosting; using Microsoft.Extensions.Logging; using Microsoft.Extensions.Options; using RabbitMQ.Client; using RabbitMQ.Client.Events; namespace Test.Listener { public class RabbitListener : IHostedService { private readonly IConnection connection; private readonly IModel channel; public RabbitListener(IOptions\u0026lt;AppConfiguration\u0026gt; options) { try { var factory = new ConnectionFactory() { // è¿™æ˜¯æˆ‘è¿™è¾¹çš„é…ç½®,è‡ªå·±æ”¹æˆè‡ªå·±ç”¨å°±å¥½ HostName = options.Value.RabbitHost, UserName = options.Value.RabbitUserName, Password = options.Value.RabbitPassword, Port = options.Value.RabbitPort, }; this.connection = factory.CreateConnection(); this.channel = connection.CreateModel(); } catch (Exception ex) { Console.WriteLine($\u0026#34;RabbitListener init error,ex:{ex.Message}\u0026#34;); } } public Task StartAsync(CancellationToken cancellationToken) { Register(); return Task.CompletedTask; } protected string RouteKey; protected string QueueName; // å¤„ç†æ¶ˆæ¯çš„æ–¹æ³• public virtual bool Process(string message) { throw new NotImplementedException(); } // æ³¨å†Œæ¶ˆè´¹è€…ç›‘å¬åœ¨è¿™é‡Œ public void Register() { Console.WriteLine($\u0026#34;RabbitListener register,routeKey:{RouteKey}\u0026#34;); channel.ExchangeDeclare(exchange: \u0026#34;message\u0026#34;, type: \u0026#34;topic\u0026#34;); channel.QueueDeclare(queue:QueueName, exclusive: false); channel.QueueBind(queue: QueueName, exchange: \u0026#34;message\u0026#34;, routingKey: RouteKey); var consumer = new EventingBasicConsumer(channel); consumer.Received += (model, ea) =\u0026gt; { var body = ea.Body; var message = Encoding.UTF8.GetString(body); var result = Process(message); if (result) { channel.BasicAck(ea.DeliveryTag, false); } }; channel.BasicConsume(queue: QueueName, consumer: consumer); } public void DeRegister() { this.connection.Close(); } public Task StopAsync(CancellationToken cancellationToken) { this.connection.Close(); return Task.CompletedTask; } } } // éšä¾¿è´´ä¸€ä¸ªå­ç±» using System; using System.Text; using Microsoft.Extensions.Options; using Newtonsoft.Json.Linq; using RabbitMQ.Client; using RabbitMQ.Client.Events; using Microsoft.Extensions.DependencyInjection; using Microsoft.EntityFrameworkCore; using Microsoft.Extensions.Logging; namespace Test.Listener { public class ChapterLister : RabbitListener { private readonly ILogger\u0026lt;RabbitListener\u0026gt; _logger; // å› ä¸ºProcesså‡½æ•°æ˜¯å§”æ‰˜å›è°ƒ,ç›´æ¥å°†å…¶ä»–Serviceæ³¨å…¥çš„è¯ä¸¤è€…ä¸åœ¨ä¸€ä¸ªscope, // è¿™é‡Œè¦è°ƒç”¨å…¶ä»–çš„Serviceå®ä¾‹åªèƒ½ç”¨IServiceProvider CreateScopeåè·å–å®ä¾‹å¯¹è±¡ private readonly IServiceProvider _services; public ChapterLister(IServiceProvider services, IOptions\u0026lt;AppConfiguration\u0026gt; options, ILogger\u0026lt;RabbitListener\u0026gt; logger) : base(options) { base.RouteKey = \u0026#34;done.task\u0026#34;; base.QueueName = \u0026#34;lemonnovelapi.chapter\u0026#34;; _logger = logger; _services = services; } public override bool Process(string message) { var taskMessage = JToken.Parse(message); if (taskMessage == null) { // è¿”å›false çš„æ—¶å€™å›ç›´æ¥é©³å›æ­¤æ¶ˆæ¯,è¡¨ç¤ºå¤„ç†ä¸äº† return false; } try { using (var scope = _services.CreateScope()) { var xxxService = scope.ServiceProvider.GetRequiredService\u0026lt;XXXXService\u0026gt;(); return true; } } catch (Exception ex) { _logger.LogInformation($\u0026#34;Process fail,error:{ex.Message},stackTrace:{ex.StackTrace},message:{message}\u0026#34;); _logger.LogError(-1, ex, \u0026#34;Process fail\u0026#34;); return false; } } } } ç„¶å,è®°ä½\u0026hellip;.\næ³¨å…¥åˆ°Startup.csçš„æ—¶å€™,ä½¿ç”¨AddHostedService\n1 services.AddHostedService\u0026lt;ChapterLister\u0026gt;(); æ¶ˆè´¹è€…å°±è¿™æ ·ç©äº†.\nç”Ÿäº§è€…å’‹ç©å‘¢? è¿™ä¸ªå…¶å®æ›´ç®€å•.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 using System; using System.Net; using Newtonsoft.Json.Linq; using RestSharp; using Microsoft.Extensions.Logging; using Microsoft.Extensions.Options; using RabbitMQ.Client; using Newtonsoft.Json; using System.Text; namespace Test.SDK { public class RabbitMQClient { private readonly IModel _channel; private readonly ILogger _logger; public RabbitMQClient(IOptions\u0026lt;AppConfiguration\u0026gt; options, ILogger\u0026lt;RabbitMQClient\u0026gt; logger) { try { var factory = new ConnectionFactory() { HostName = options.Value.RabbitHost, UserName = options.Value.RabbitUserName, Password = options.Value.RabbitPassword, Port = options.Value.RabbitPort, }; var connection = factory.CreateConnection(); _channel = connection.CreateModel(); } catch (Exception ex) { logger.LogError(-1, ex, \u0026#34;RabbitMQClient init fail\u0026#34;); } _logger = logger; } public virtual void PushMessage(string routingKey, object message) { _logger.LogInformation($\u0026#34;PushMessage,routingKey:{routingKey}\u0026#34;); _channel.QueueDeclare(queue: \u0026#34;message\u0026#34;, durable: false, exclusive: false, autoDelete: false, arguments: null); string msgJson = JsonConvert.SerializeObject(message); var body = Encoding.UTF8.GetBytes(msgJson); _channel.BasicPublish(exchange: \u0026#34;message\u0026#34;, routingKey: routingKey, basicProperties: null, body: body); } } } åˆ‡è®°æ³¨å…¥å®ä¾‹çš„æ—¶å€™ç”¨å•ä¾‹æ¨¡å¼.\nservices.AddSingleton\u0026lt;RabbitMQClient, RabbitMQClient\u0026gt;();\nå…¨æ–‡å®Œ\u0026hellip;\n","date":"2018-01-15T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/.net-core%E4%B8%AD%E4%BD%BF%E7%94%A8rabbitmq%E6%AD%A3%E7%A1%AE%E6%96%B9%E5%BC%8F/","title":".NET Coreä¸­ä½¿ç”¨RabbitMQæ­£ç¡®æ–¹å¼"},{"content":"Linuxè¿ç»´ç›¸å…³è½¯ä»¶å®‰è£…é…ç½®å¤‡å¿˜ ç«¯å£å ç”¨ç›¸å…³ 1 2 3 4 5 6 //æŸ¥æ‰¾ç«¯å£å ç”¨æƒ…å†µ $ netstat -anp | grep \u0026#34;5000\u0026#34; //å¹²æ‰æŸä¸ªè¿›ç¨‹ $ kill -9 2553 //åå°è¿è¡Œ $ nohup command \u0026amp; å®‰è£…SS 1 2 3 4 5 6 $ apt-get update //å®‰è£…ss $ apt-get install python-pip $ pip install shadowsocks //è¿è¡ŒssæœåŠ¡ç«¯ $ nohup ssserver -s ipåœ°å€ -k å¯†ç  \u0026amp; å®‰è£…MySQL5.7 1 2 3 4 5 6 7 8 9 10 11 12 13 14 http://tecadmin.net/install-mysql-5-on-ubuntu/ $ sudo apt-get install software-properties-common $ sudo add-apt-repository -y ppa:ondrej/mysql-5.7 $ sudo apt-get update $ sudo apt-get install mysql-server //ç¼–è¾‘æ­¤å¤„ï¼Œå…è®¸è¿œç¨‹ç™»å½• /etc/mysql/my.cnf bind-address\t= 0.0.0.0 //é‡å¯MySQL $ /etc/init.d/mysql restart MySQLæ·»åŠ ç”¨æˆ· 1 2 3 4 5 6 7 8 9 10 //æ–°å¢ç”¨æˆ· grant all privileges on *.* to root@\u0026#39;%\u0026#39; identified by \u0026#34;root\u0026#34;; //ç«‹å³ç”Ÿæ•ˆ flush privileges; grant select,insert,update,delete,create,drop on to joe@10.163.225.87 identified by â€˜123â€²; grant all on xxxDB.* to xxx@\u0026#39;%\u0026#39;; MySQLæç¤ºâ€œChecking for tables which need an upgrade, are corrupt or were not closed cleanlyâ€ æ“ä½œæ­¥éª¤ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 $ sudo service mysql stop $ sudo /etc/init.d/apparmor reload $ sudo service mysql start æˆ–è€…ï¼š down vote This error occurs due to multiple installations of mysql. Run the command: $ ps -A|grep mysql Kill the process by using: $ sudo pkill mysql and then run command: $ ps -A|grep mysqld Also Kill this process by running: $ sudo pkill mysqld Now you are fully set just run the following commands: $ service mysql restart mysql -u root -p 7zç›¸å…³æ“ä½œ 1 2 3 4 //å‹ç¼© $ 7z a -t7z -r manager.7z /home/manager/* //è§£å‹ $ 7z X xx.zip è…¾è®¯äº‘ä¿®æ”¹å¯†ç ,å…è®¸rootç™»å½• 1 2 3 4 5 $ sudo passwd root $ sudo vi /etc/ssh/sshd_config $ sudo service ssh restart å¼€æœºå¯åŠ¨ç›¸å…³ 1 2 3 4 5 //æŸ¥çœ‹å¼€æœºå¯åŠ¨ç›¸å…³ç¨‹åº $ ls /etc/rc* //å®‰è£…sysv-rc-conf $ sudo apt-get install sysv-rc-conf $ sudo sysv-rc-conf ","date":"2017-03-25T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/linux%E8%BF%90%E7%BB%B4%E7%9B%B8%E5%85%B3%E8%BD%AF%E4%BB%B6%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE%E5%A4%87%E5%BF%98/","title":"Linuxè¿ç»´ç›¸å…³è½¯ä»¶å®‰è£…é…ç½®å¤‡å¿˜"},{"content":"ç”¨Visual Studio Code Debugä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€ Macç”¨æˆ·çœ‹è¿™é‡Œ:ç”¨Visual Studio Code Debugä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€(Macç¯‡)\nå‰è¨€ è¿™é˜µå­å› ç¼˜å·§åˆæ¥æ‰‹äº†ä¸€ä¸ªè¾£é¸¡é¡¹ç›®ï¼Œæ˜¯ç”¨ä¸–ç•Œä¸Šæœ€å¥½çš„æ‹é»„ç‰‡å†™çš„ï¼Œé¡¹ç›®åŸºæœ¬æ˜¯å¦ä¸€ä¸ªå°ä¼™ä¼´åœ¨æ’¸ç ï¼Œæˆ‘å°±å…¼èŒæ‰“æ‚å’Œå‘å¸ƒåšç‚¹è¿ç»´çš„å·¥ä½œã€‚\nç„¶åæ˜¨å¤©é¡¹ç›®ä¸Šäº†æµ‹è¯•ç‰ˆä¹‹åï¼Œä¸€ç”¨èµ·æ¥Erroræ»¡å¤©é£äº†ã€‚è®©å°ä¼™ä¼´æŸ¥äº†å¾ˆä¹…éƒ½æ²¡æœ‰å¤´ç»ªï¼Œå®åœ¨å°´å°¬ï¼Œåªå¥½è‡ªå·±åŠ¨æ‰‹äº†\u0026hellip;\nä½œä¸ºä¸€ä¸ªåç«¯ç‹—ï¼Œè™½ç„¶çŸ¥é“PHPå¤§ä½“åŸç†å’Œæ¡†æ¶ï¼Œçœ‹ç€é¡¹ç›®çš„ä¸šåŠ¡é€»è¾‘ä¹Ÿå¤§ä½“çŸ¥é“ä¸ªæ‰€ä»¥ç„¶ï¼Œåœ¨æ­¤ä¹‹å‰è¿˜æ˜¯æ²¡æ’¸è¿‡ä»£ç çš„ã€‚\nçœ‹ä»£ç åŸºæœ¬æ˜¯Visual Studio Codeæˆ–è€…HBuilderå·¥å…·ï¼Œæœ¬åœ°è·‘ä»£ç å¾ˆç™½ç—´çš„åœ¨ç”¨phpStudyã€‚\nErrorå‡ºæ¥äº†ï¼Œç¬¬ä¸€ååº”å°±æ˜¯debugå’¯\u0026hellip;ç„¶åé—®äº†ä¸‹å°ä¼™ä¼´ä»–ä»¥å‰æ€ä¹ˆç©çš„ï¼Œç­”æ›°ï¼šechoã€‚\nä¸€å£è€è¡€éƒ½\u0026hellip;\næŸ¥äº†ä¸‹è°·æ­Œå‘ç°ï¼ŒVisual Studio Code + æ’ä»¶æ˜¯å®Œå…¨å¯ä»¥ç”¨æ¥è°ƒè¯•PHPçš„ï¼Œæ‰€ä»¥å°±æ’¸èµ·äº†ã€‚\nVisual Studio Code + php-debugæ’ä»¶ + phpStudy + xdebug å®‰è£…Visual Studio Code é¦–å…ˆè‚¯å®šæ˜¯å…ˆä¸‹è½½Visual Studio Code å’¯ã€‚\nå®‰è£…å¥½ä¹‹åï¼Œéšä¾¿åœ¨ä¸€ä¸ªæ–‡ä»¶å¤¹å†…é¼ æ ‡â€œå³é”®â€ï¼Œéƒ½èƒ½çœ‹åˆ°Open with codeï¼Œæ‰“å¼€ä¹‹åå¦‚ä¸‹å›¾ï¼š\nå®‰è£…Visual Studio Code php-debugæ’ä»¶ è£…å¥½VS Codeä¹‹åï¼Œæ¥ä¸‹æ¥æ˜¯å®‰è£…ä¸€ä¸‹PHP-Debugæ’ä»¶äº†ã€‚æˆ‘ä»¬åœ¨æ’ä»¶å•†åŸæœç´¢ä¸€ä¸‹phpï¼Œæ’åç¬¬äºŒçš„PHP Debugå°±æ˜¯æˆ‘ä»¬è¦çš„æ’ä»¶äº†ã€‚ å¦‚ä¸‹å›¾ï¼š è£…å¥½äº†ä¹‹åé‡å¯ä¸€ä¸‹vs codeå³å¯ã€‚\nphpStudy å¯¹äºæˆ‘è¿™ç§æ‡’äººæ¥è¯´ï¼Œå»é…ç½®ä»€ä¹ˆPHPè¿è¡Œç¯å¢ƒè‚¯å®šæ˜¯ä¸æ„¿æ„çš„ï¼Œé‚£ä¹ˆç±»ä¼¼çš„é›†æˆç¯å¢ƒæœ‰ä¹ˆï¼Ÿ\nå°ä¼™ä¼´å’Œæˆ‘è¯´ï¼Œä½ ä¸‹ä¸ªphpStudyæ’¸å°±ç®—äº†ï¼Œåˆ«å»å€’è…¾ä»€ä¹ˆç‰ˆæœ¬äº†ã€‚\nç„¶å\u0026hellip;\nä¸‹è½½å¥½äº†å®‰è£…å®Œäº†ï¼Œæ‰“å¼€ç¨‹åºå¦‚ä¸‹å›¾ï¼š\nçœ‹äº†ä¸‹åŠŸèƒ½ï¼Œå…¶å®è¿™ä¸ªè½¯ä»¶å°±æ˜¯é›†æˆäº†å„ç§ç‰ˆæœ¬çš„PHPï¼Œå¯ä»¥æ–¹ä¾¿åˆ‡æ¢PHPç‰ˆæœ¬ï¼›åŒæ—¶è‡ªå¸¦ä¸€ä¸ªApacheå’ŒMySQLï¼Œå„ç§é…ç½®ç®¡ç†èµ·æ¥ä¹ŸæŒºæ–¹ä¾¿çš„ã€‚ ï¼ˆæ„Ÿè§‰dalaoä»¬åº”è¯¥ä¸æ€ä¹ˆä¼šç”¨è¿™ä¹ˆç™½ç—´çš„ä¸œè¥¿ï¼Œ233\u0026hellip;\nè£…å¥½ä¹‹åï¼Œå¯åŠ¨ä¸€ä¸‹æœåŠ¡ï¼Œç‚¹å‡»ä¸€ä¸‹phpMyAdminï¼Œçœ‹çœ‹å®ƒæ‰“å¼€çš„ç½‘ç«™æ˜¯å¦èƒ½ç™»å½•åˆ°æœ¬åœ°çš„MySQLæ•°æ®åº“ã€‚\nå¦‚æœå¯ä»¥ï¼Œè¯´æ˜PHPç¯å¢ƒåº”è¯¥æ˜¯æ­£å¸¸çš„äº†ï¼›å¦‚æœæœ‰é—®é¢˜ï¼Œè¯·è‡ªè¡Œè°·æ­Œäº†\u0026hellip;\næ¥ç€åˆ‡æ¢PHPç‰ˆæœ¬åˆ°æ„å‘ç‰ˆæœ¬ï¼Œç‚¹å‡»ä¸€ä¸‹è¿è¡Œæ¨¡å¼æ—è¾¹çš„â€œåˆ‡æ¢ç‰ˆæœ¬â€å°±å¯ä»¥é€‰æ‹©ç‰ˆæœ¬äº†ã€‚\nxdebugè®¾ç½® xdebugæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ\n1 2 3 4 5 6 7 8 Xdebugä½œä¸ºPHPè°ƒè¯•å·¥å…·ï¼Œæä¾›äº†ä¸°å¯Œçš„è°ƒè¯•å‡½æ•°ï¼Œ ä¹Ÿå¯å°†Xdebugå®‰è£…é…ç½®ä¸ºzend studioã€editplusè°ƒè¯•PHPçš„ç¬¬ä¸‰æ–¹æ’ä»¶ï¼Œ é€šè¿‡å¼€å¯è‡ªåŠ¨è·Ÿè¸ª(auto_trace)å’Œåˆ†æå™¨åŠŸèƒ½ï¼Œå¯ä»¥ç›´è§‚çš„çœ‹åˆ°PHPæºä»£ç çš„æ€§èƒ½æ•°æ®ï¼Œ ä»¥ä¾¿ä¼˜åŒ–PHPä»£ç ã€‚ å¼•ç”¨è‡ªï¼š[PHPè°ƒè¯•å·¥å…·Xdebugå®‰è£…é…ç½®æ•™ç¨‹] (http://www.cnblogs.com/qiantuwuliang/archive/2011/01/23/1942382.html) æˆ‘ä»¬å¯ä»¥åœ¨xdebug.orgï¼ˆè‡ªå¤‡æ¢¯å­ï¼‰ä¸Šé¢ä¸‹è½½åˆ°PHPå„ä¸ªç‰ˆæœ¬çš„xdebug dllä½¿ç”¨ã€‚\nä¸è¿‡å½“æˆ‘æ‰“å¼€phpStudyçš„php-iniæ‰“ç®—æ‰‹åŠ¨å¼€å¯debugçš„æ—¶å€™ï¼Œéå¸¸é«˜å…´å¾—å‘ç°å·²ç»phpStudyå·²è‡ªå¸¦äº†å¯¹åº”ç‰ˆæœ¬çš„xdebugï¼Œè€Œä¸”è·¯å¾„éƒ½é…å¥½äº†ã€‚\nphpStudyçš„php.iniåœ¨â€œå…¶ä»–é€‰é¡¹-æ‰“å¼€é…ç½®æ–‡ä»¶-php-iniâ€ï¼Œå¦‚ä¸‹å›¾ï¼š\næŠŠæ–‡æ¡£æ‹‰åˆ°æœ€åï¼Œçœ‹å¾—åˆ°xdebugçš„é…ç½®å¦‚ä¸‹ï¼š\nphpStudyå·²ç»å¸®æˆ‘ä»¬é…ç½®å¥½xdebug dllçš„è·¯å¾„äº†ï¼Œæˆ‘ä»¬åªéœ€è¦æ‰‹åŠ¨åœ¨zend_extensionä¸Šé¢æ·»åŠ è¿œç¨‹è°ƒè¯•å’Œè‡ªåŠ¨å¯åŠ¨é…ç½®å³å¯ï¼Œä»£ç å¦‚ä¸‹ï¼š\n1 2 3 xdebug.remote_enable = 1 xdebug.remote_autostart= 1 å®Œæ•´é…ç½®å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 [XDebug] ;xdebug.profiler_output_dir=\u0026#34;C:\\phpStudy\\tmp\\xdebug\u0026#34; ;xdebug.trace_output_dir=\u0026#34;C:\\phpStudy\\tmp\\xdebug\u0026#34; xdebug.remote_enable = 1 xdebug.remote_autostart= 1 ;ä½ çš„PHPç‰ˆæœ¬çš„php_xdebug.dllï¼ŒphpStudyè‡ªåŠ¨è®¾ç½®çš„ zend_extension=\u0026#34;C:\\phpStudy\\php\\php-5.5.38\\ext\\php_xdebug.dll\u0026#34; ä¿å­˜æ–‡ä»¶ï¼Œé‡å¯ä¸€ä¸‹phpStudyæœåŠ¡ã€‚\nVisual Studio Code è®¾ç½®ç”¨æˆ·é…ç½®å’Œè°ƒè¯•é…ç½® è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬éšä¾¿åœ¨PHPæ–‡ä»¶å¤¹ä¸­æ‰“å¼€vs codeï¼Œvs codeä¼šè‡ªåŠ¨æç¤ºæˆ‘ä»¬ï¼šCannot validate since no PHP executable is set. Use the setting \u0026lsquo;php.validate.executablePath\u0026rsquo; to configure the PHP executable.\nå—¯ï¼Œæ²¡æœ‰è®¾ç½®PHPæ‰§è¡Œæ–‡ä»¶ï¼Œå¯ä»¥é€šè¿‡è®¾ç½®php.validate.executablePathå±æ€§æ¥é…ç½®å®ƒã€‚\nè¿™ä¸ªåœ¨å“ªé…ç½®å‘¢ï¼Ÿåœ¨â€œæ–‡ä»¶-é¦–é€‰é¡¹-è®¾ç½®â€ï¼Œæ‰“å¼€ä¹‹åå¦‚ä¸‹å›¾ï¼š\nè¿™ä¸ªphp.validate.executablePathå¯¹åº”å°±æ˜¯å½“å‰phpStudyä¸­è¿è¡Œçš„php.exeçš„è·¯å¾„ï¼Œå¯ä»¥åœ¨phpStudy-å…¶ä»–é€‰é¡¹èœå•-æ‰“å¼€æ–‡ä»¶ä½ç½®-PHPä¸­æ‰¾åˆ°æ­¤è·¯å¾„ã€‚\nä¿å­˜å¥½äº†ä¹‹åï¼Œå›åˆ°Visual Studio Codeç•Œé¢ï¼Œè½¬åˆ°Debugï¼Œé€‰æ‹©æ·»åŠ é…ç½®ï¼Œä¹‹åé€‰æ‹©PHPï¼Œç”Ÿæˆå¦‚ä¸‹å›¾çš„launch.jsonï¼š\nä¸ç”¨æ”¹ä»»ä½•ä¸œè¥¿ï¼Œç›´æ¥å¼€æ’¸\u0026hellip;\nå¼€å¯Debug ç¡®ä¿phpStudyå¯åŠ¨äº†ï¼Œç½‘ç«™ä¹Ÿæ­£å¸¸è¿è¡Œèµ·æ¥äº†,ç„¶ååœ¨Visual Studio Codeä¸­å¯åŠ¨è°ƒè¯•ï¼Œæ‰“ä¸Šè¦çš„æ–­ç‚¹ï¼Œæ¥ç€å¯åŠ¨è°ƒè¯•ã€‚\nå¦‚ä¸‹å›¾ï¼š\næ¥ç€è®¿é—®ä½ è¦è°ƒè¯•çš„é¡µé¢å¯¹åº”çš„PHPä»£ç ï¼Œæ‰“ä¸Šä½ çš„æ–­ç‚¹ï¼Œåä¸½ä¸½çš„Debugå‡ºæ¥äº†\u0026hellip;\nF10å•æ­¥è°ƒè¯•ï¼ŒF11è·³å…¥å‡½æ•°ï¼ŒF5ç›´æ¥è¿è¡Œä¹‹ç±»çš„å¿«æ·é”®è‡ªå·±ç©å§ã€‚\nå…¶ä»–è¿è¡Œç¯å¢ƒä¸‹çš„é…ç½® åŸºæœ¬æ²¡ä»€ä¹ˆåŒºåˆ«ï¼Œé…ç½®php.iniï¼Œä¸‹è½½åˆ°å¯¹åº”ç‰ˆæœ¬çš„xdebug.dllï¼Œphp.validate.executablePathé…ç½®æ­£ç¡®å°±å®Œäº‹ã€‚\nå…¶ä»–å‚è€ƒé“¾æ¥ï¼š\nå¦‚ä½•ä½¿ç”¨XDebugè°ƒè¯•php\nXAMPPç¯å¢ƒä¸‹ç”¨phpStorm+XDebugè¿›è¡Œæ–­ç‚¹è°ƒè¯•çš„é…ç½®\nPHPStormä¸‹XDebugé…ç½®\nPS:æœç„¶æ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€\u0026hellip;(é€ƒ ","date":"2017-03-17T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/%E7%94%A8visual-studio-code-debug%E4%B8%96%E7%95%8C%E4%B8%8A%E6%9C%80%E5%A5%BD%E7%9A%84%E8%AF%AD%E8%A8%80/","title":"ç”¨Visual Studio Code Debugä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€"},{"content":"æ‰‹æŠŠæ‰‹æ•™ä½ ç”¨.NET Coreå†™çˆ¬è™« å†™åœ¨å‰é¢ è‡ªä»ä¸Šä¸€ä¸ªé¡¹ç›®58HouseSearchä».NETè¿ç§»åˆ°.NET coreä¹‹åï¼Œç£•ç£•ç¢°ç¢°ç£¨è¹­äº†ä¸€ä¸ªæœˆæ‰æ­£å¼ä¸Šçº¿åˆ°æ–°ç‰ˆæœ¬ã€‚ ç„¶åæœ€è¿‘åˆå¼€äº†ä¸ªæ–°å‘ï¼Œæäº†ä¸ªDy2018Crawlerç”¨æ¥çˆ¬dy2018ç”µå½±å¤©å ‚ä¸Šé¢çš„ç”µå½±èµ„æºã€‚è¿™é‡Œä¹Ÿå€Ÿæœºç®€å•ä»‹ç»ä¸€ä¸‹å¦‚ä½•åŸºäº.NET Coreå†™ä¸€ä¸ªçˆ¬è™«ã€‚ PSï¼šå¦‚æœ‰åé”™ï¼Œæ•¬è¯·æŒ‡æ˜\u0026hellip; PPS:è¯¥å»ç”µå½±é™¢è¿˜æ˜¯å¤šå»ç”µå½±é™¢ï¼Œæ¯•ç«Ÿç¾äººè‰¯æ—¶å¯æ— ä»·ã€‚\nå‡†å¤‡å·¥ä½œï¼ˆ.NET Coreå‡†å¤‡ï¼‰ é¦–å…ˆï¼Œè‚¯å®šæ˜¯å…ˆå®‰è£….NET Coreå’¯ã€‚ä¸‹è½½åŠå®‰è£…æ•™ç¨‹åœ¨è¿™é‡Œï¼š.NET - Powerful Open Source Developmentã€‚æ— è®ºä½ æ˜¯Windowsã€linuxè¿˜æ˜¯macï¼Œç»Ÿç»Ÿå¯ä»¥ç©ã€‚\næˆ‘è¿™é‡Œçš„ç¯å¢ƒæ˜¯ï¼šWindows10 + VS2015 community updata3 + .NET Core 1.1.0 SDK + .NET Core 1.0.1 tools Preview 2.\nç†è®ºä¸Šï¼Œåªéœ€è¦å®‰è£…ä¸€ä¸‹ .NET Core 1.1.0 SDK å³å¯å¼€å‘.NET Coreç¨‹åºï¼Œè‡³äºç”¨ä»€ä¹ˆå·¥å…·å†™ä»£ç éƒ½æ— å…³ç´§è¦äº†ã€‚\nå®‰è£…å¥½ä»¥ä¸Šå·¥å…·ä¹‹åï¼Œåœ¨VS2015çš„æ–°å»ºé¡¹ç›®å°±å¯ä»¥çœ‹åˆ°.NET Coreçš„æ¨¡æ¿äº†ã€‚å¦‚ä¸‹å›¾ï¼š\nä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘ä»¬åˆ›å»ºçš„æ—¶å€™ï¼Œç›´æ¥é€‰æ‹©VS .NET Core toolsè‡ªå¸¦çš„æ¨¡æ¿ã€‚\nä¸€ä¸ªçˆ¬è™«çš„è‡ªæˆ‘ä¿®å…» åˆ†æç½‘é¡µ å†™çˆ¬è™«ä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆè¦å…ˆå»äº†è§£ä¸€ä¸‹å³å°†è¦çˆ¬å–çš„ç½‘é¡µæ•°æ®ç»„æˆã€‚\nå…·ä½“åˆ°ç½‘é¡µçš„è¯ï¼Œä¾¿æ˜¯åˆ†ææˆ‘ä»¬è¦æŠ“å–çš„æ•°æ®åœ¨HTMLé‡Œé¢æ˜¯ç”¨ä»€ä¹ˆæ ‡ç­¾æŠ‘æˆ–æœ‰ä»€ä¹ˆæ ·çš„æ ‡è®°ï¼Œç„¶åä½¿ç”¨è¿™ä¸ªæ ‡è®°æŠŠæ•°æ®ä»HTMLä¸­æå–å‡ºæ¥ã€‚åœ¨æˆ‘è¿™é‡Œçš„è¯ï¼Œç”¨çš„æ›´å¤šçš„æ˜¯HTMLæ ‡ç­¾çš„IDå’ŒCSSå±æ€§ã€‚\nä»¥æœ¬æ–‡ç« æƒ³è¦çˆ¬å–çš„dy2018.comä¸ºä¾‹,ç®€å•æè¿°ä¸€ä¸‹è¿™ä¸ªè¿‡ç¨‹ã€‚dy2018.comä¸»é¡µå¦‚ä¸‹å›¾ï¼š\nåœ¨chromeé‡Œé¢ï¼ŒæŒ‰F12è¿›å…¥å¼€å‘è€…æ¨¡å¼ï¼Œæ¥ç€å¦‚ä¸‹å›¾ä½¿ç”¨é¼ æ ‡é€‰æ‹©å¯¹åº”é¡µé¢æ•°æ®ï¼Œç„¶åå»åˆ†æé¡µé¢HTMLç»„æˆã€‚\næ¥ç€æˆ‘ä»¬å¼€å§‹åˆ†æé¡µé¢æ•°æ®:\nç»è¿‡ç®€å•åˆ†æHTMLï¼Œæˆ‘ä»¬å¾—åˆ°ä»¥ä¸‹ç»“è®ºï¼š\nwww.dy2018.comé¦–é¡µçš„ç”µå½±æ•°æ®å­˜å‚¨åœ¨ä¸€ä¸ªclassä¸ºco_content222çš„divæ ‡ç­¾é‡Œé¢\nç”µå½±è¯¦æƒ…é“¾æ¥ä¸ºaæ ‡ç­¾ï¼Œæ ‡ç­¾æ˜¾ç¤ºæ–‡æœ¬å°±æ˜¯ç”µå½±åç§°ï¼ŒURLå³è¯¦æƒ…URL\né‚£ä¹ˆæ€»ç»“ä¸‹æ¥ï¼Œæˆ‘ä»¬çš„å·¥ä½œå°±æ˜¯ï¼šæ‰¾åˆ°class=\u0026lsquo;co_content222\u0026rsquo; çš„divæ ‡ç­¾ï¼Œä»é‡Œé¢æå–æ‰€æœ‰çš„aæ ‡ç­¾æ•°æ®ã€‚\nå¼€å§‹å†™ä»£ç \u0026hellip; ä¹‹å‰åœ¨å†™58HouseSearché¡¹ç›®è¿ç§»åˆ°asp.net coreç®€å•æè¿‡AngleSharpåº“ï¼Œä¸€ä¸ªåŸºäº.NETï¼ˆC#ï¼‰å¼€å‘çš„ä¸“é—¨ä¸ºè§£æxHTMLæºç çš„DLLç»„ä»¶ã€‚\nAngleSharpä¸»é¡µåœ¨è¿™é‡Œï¼šhttps://anglesharp.github.io/ï¼Œ\nåšå®¢å›­æ–‡ç« ï¼šè§£æHTMLåˆ©å™¨AngleSharpä»‹ç»ï¼Œ\nNugetåœ°å€:Nuget AngleSharp å®‰è£…å‘½ä»¤ï¼šInstall-Package AngleSharp\nè·å–ç”µå½±åˆ—è¡¨æ•°æ® 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 private static HtmlParser htmlParser = new HtmlParser(); private ConcurrentDictionary\u0026lt;string, MovieInfo\u0026gt; _cdMovieInfo = new ConcurrentDictionary\u0026lt;string, MovieInfo\u0026gt;(); private void AddToHotMovieList() { //æ­¤æ“ä½œä¸é˜»å¡å½“å‰å…¶ä»–æ“ä½œï¼Œæ‰€ä»¥ä½¿ç”¨Task // _cdMovieInfo ä¸ºçº¿ç¨‹å®‰å…¨å­—å…¸ï¼Œå­˜å‚¨äº†å½“æœŸæ‰€æœ‰çš„ç”µå½±æ•°æ® Task.Factory.StartNew(()=\u0026gt; { try { //é€šè¿‡URLè·å–HTML var htmlDoc = HTTPHelper.GetHTMLByURL(\u0026#34;http://www.dy2018.com/\u0026#34;); //HTML è§£ææˆ IDocument var dom = htmlParser.Parse(htmlDoc); //ä»domä¸­æå–æ‰€æœ‰class=\u0026#39;co_content222\u0026#39;çš„divæ ‡ç­¾ //QuerySelectorAllæ–¹æ³•æ¥å— é€‰æ‹©å™¨è¯­æ³• var lstDivInfo = dom.QuerySelectorAll(\u0026#34;div.co_content222\u0026#34;); if (lstDivInfo != null) { //å‰ä¸‰ä¸ªDIVä¸ºæ–°ç”µå½± foreach (var divInfo in lstDivInfo.Take(3)) { //è·å–divä¸­æ‰€æœ‰çš„aæ ‡ç­¾ä¸”aæ ‡ç­¾ä¸­å«æœ‰\u0026#34;/i/\u0026#34;çš„ //Contains(\u0026#34;/i/\u0026#34;) æ¡ä»¶çš„è¿‡æ»¤æ˜¯å› ä¸ºåœ¨æµ‹è¯•ä¸­å‘ç°è¿™ä¸€å—divä¸­çš„aæ ‡ç­¾æœ‰å¯èƒ½æ˜¯å¹¿å‘Šé“¾æ¥ divInfo.QuerySelectorAll(\u0026#34;a\u0026#34;).Where(a =\u0026gt; a.GetAttribute(\u0026#34;href\u0026#34;).Contains(\u0026#34;/i/\u0026#34;)).ToList().ForEach( a =\u0026gt; { //æ‹¼æ¥æˆå®Œæ•´é“¾æ¥ var onlineURL = \u0026#34;http://www.dy2018.com\u0026#34; + a.GetAttribute(\u0026#34;href\u0026#34;); //çœ‹ä¸€ä¸‹æ˜¯å¦å·²ç»å­˜åœ¨äºç°æœ‰æ•°æ®ä¸­ if (!_cdMovieInfo.ContainsKey(onlineURL)) { //è·å–ç”µå½±çš„è¯¦ç»†ä¿¡æ¯ MovieInfo movieInfo = FillMovieInfoFormWeb(a, onlineURL); //ä¸‹è½½é“¾æ¥ä¸ä¸ºç©ºæ‰æ·»åŠ åˆ°ç°æœ‰æ•°æ® if (movieInfo.XunLeiDownLoadURLList != null \u0026amp;\u0026amp; movieInfo.XunLeiDownLoadURLList.Count != 0) { _cdMovieInfo.TryAdd(movieInfo.Dy2018OnlineUrl, movieInfo); } } }); } } } catch(Exception ex) { } }); } è·å–ç”µå½±è¯¦ç»†ä¿¡æ¯ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 private MovieInfo FillMovieInfoFormWeb(AngleSharp.Dom.IElement a, string onlineURL) { var movieHTML = HTTPHelper.GetHTMLByURL(onlineURL); var movieDoc = htmlParser.Parse(movieHTML); //http://www.dy2018.com/i/97462.html åˆ†æè¿‡ç¨‹è§ä¸Šï¼Œä¸å†èµ˜è¿° //ç”µå½±çš„è¯¦ç»†ä»‹ç» åœ¨idä¸ºZoomçš„æ ‡ç­¾ä¸­ var zoom = movieDoc.GetElementById(\u0026#34;Zoom\u0026#34;); //ä¸‹è½½é“¾æ¥åœ¨ bgcolor=\u0026#39;#fdfddf\u0026#39;çš„tdä¸­ï¼Œæœ‰å¯èƒ½æœ‰å¤šä¸ªé“¾æ¥ var lstDownLoadURL = movieDoc.QuerySelectorAll(\u0026#34;[bgcolor=\u0026#39;#fdfddf\u0026#39;]\u0026#34;); //å‘å¸ƒæ—¶é—´ åœ¨class=\u0026#39;updatetime\u0026#39;çš„spanæ ‡ç­¾ä¸­ var updatetime = movieDoc.QuerySelector(\u0026#34;span.updatetime\u0026#34;); var pubDate = DateTime.Now; if(updatetime!=null \u0026amp;\u0026amp; !string.IsNullOrEmpty(updatetime.InnerHtml)) { //å†…å®¹å¸¦æœ‰â€œå‘å¸ƒæ—¶é—´ï¼šâ€å­—æ ·ï¼Œreplaceæˆ\u0026#34;\u0026#34;ä¹‹åå†å»è½¬æ¢ï¼Œè½¬æ¢å¤±è´¥ä¸å½±å“æµç¨‹ DateTime.TryParse(updatetime.InnerHtml.Replace(\u0026#34;å‘å¸ƒæ—¶é—´ï¼š\u0026#34;, \u0026#34;\u0026#34;), out pubDate); } var movieInfo = new MovieInfo() { //InnerHtmlä¸­å¯èƒ½è¿˜åŒ…å«fontæ ‡ç­¾ï¼Œåšå¤šä¸€ä¸ªReplace MovieName = a.InnerHtml.Replace(\u0026#34;\u0026lt;font color=\\\u0026#34;#0c9000\\\u0026#34;\u0026gt;\u0026#34;,\u0026#34;\u0026#34;).Replace(\u0026#34;\u0026lt;font color=\\\u0026#34;\t#0c9000\\\u0026#34;\u0026gt;\u0026#34;,\u0026#34;\u0026#34;).Replace(\u0026#34;\u0026lt;/font\u0026gt;\u0026#34;, \u0026#34;\u0026#34;), Dy2018OnlineUrl = onlineURL, MovieIntro = zoom != null ? WebUtility.HtmlEncode(zoom.InnerHtml) : \u0026#34;æš‚æ— ä»‹ç»...\u0026#34;,//å¯èƒ½æ²¡æœ‰ç®€ä»‹ï¼Œè™½ç„¶å¥½åƒä¸æ€ä¹ˆå¯èƒ½ XunLeiDownLoadURLList = lstDownLoadURL != null ? lstDownLoadURL.Select(d =\u0026gt; d.FirstElementChild.InnerHtml).ToList() : null,//å¯èƒ½æ²¡æœ‰ä¸‹è½½é“¾æ¥ PubDate = pubDate, }; return movieInfo; } HTTPHelper è¿™è¾¹æœ‰ä¸ªå°å‘ï¼Œdy2018ç½‘é¡µç¼–ç æ ¼å¼æ˜¯GB2312,.NET Coreé»˜è®¤ä¸æ”¯æŒGB2312ï¼Œä½¿ç”¨Encoding.GetEncoding(\u0026ldquo;GB2312\u0026rdquo;)çš„æ—¶å€™ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚\nè§£å†³æ–¹æ¡ˆæ˜¯æ‰‹åŠ¨å®‰è£…System.Text.Encoding.CodePagesåŒ…(Install-Package System.Text.Encoding.CodePages),\nç„¶ååœ¨Starup.csçš„Configureæ–¹æ³•ä¸­åŠ å…¥Encoding.RegisterProvider(CodePagesEncodingProvider.Instance),æ¥ç€å°±å¯ä»¥æ­£å¸¸ä½¿ç”¨Encoding.GetEncoding(\u0026ldquo;GB2312\u0026rdquo;)äº†ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 using System; using System.Net.Http; using System.Net.Http.Headers; using System.Text; namespace Dy2018Crawler { public class HTTPHelper { public static HttpClient Client { get; } = new HttpClient(); public static string GetHTMLByURL(string url) { try { System.Net.WebRequest wRequest = System.Net.WebRequest.Create(url); wRequest.ContentType = \u0026#34;text/html; charset=gb2312\u0026#34;; wRequest.Method = \u0026#34;get\u0026#34;; wRequest.UseDefaultCredentials = true; // Get the response instance. var task = wRequest.GetResponseAsync(); System.Net.WebResponse wResp = task.Result; System.IO.Stream respStream = wResp.GetResponseStream(); //dy2018è¿™ä¸ªç½‘ç«™ç¼–ç æ–¹å¼æ˜¯GB2312, using (System.IO.StreamReader reader = new System.IO.StreamReader(respStream, Encoding.GetEncoding(\u0026#34;GB2312\u0026#34;))) { return reader.ReadToEnd(); } } catch (Exception ex) { Console.WriteLine(ex.ToString()); return string.Empty; } } } } å®šæ—¶ä»»åŠ¡çš„å®ç° å®šæ—¶ä»»åŠ¡æˆ‘è¿™é‡Œä½¿ç”¨çš„æ˜¯Pomelo.AspNetCore.TimedJobã€‚\nPomelo.AspNetCore.TimedJobæ˜¯ä¸€ä¸ª.NET Coreå®ç°çš„å®šæ—¶ä»»åŠ¡jobåº“ï¼Œæ”¯æŒæ¯«ç§’çº§å®šæ—¶ä»»åŠ¡ã€ä»æ•°æ®åº“è¯»å–å®šæ—¶é…ç½®ã€åŒæ­¥å¼‚æ­¥å®šæ—¶ä»»åŠ¡ç­‰åŠŸèƒ½ã€‚\nç”±.NET Coreç¤¾åŒºå¤§ç¥å…¼å‰å¾®è½¯MVPAmamiyaYuuko(å…¥èŒå¾®è½¯ä¹‹åå°±å¸ä»»MVP\u0026hellip;)å¼€å‘ç»´æŠ¤ï¼Œä¸è¿‡å¥½åƒæ²¡æœ‰å¼€æºï¼Œå›å¤´é—®ä¸‹çœ‹çœ‹èƒ½ä¸èƒ½å¼€æºæ‰ã€‚\nnugetä¸Šæœ‰å„ç§ç‰ˆæœ¬ï¼ŒæŒ‰éœ€è‡ªå–ã€‚åœ°å€ï¼šhttps://www.nuget.org/packages/Pomelo.AspNetCore.TimedJob/1.1.0-rtm-10026\nä½œè€…è‡ªå·±çš„ä»‹ç»æ–‡ç« ï¼šTimed Job - Pomeloæ‰©å±•åŒ…ç³»åˆ—\nStartup.csç›¸å…³ä»£ç  æˆ‘è¿™è¾¹ä½¿ç”¨çš„è¯ï¼Œé¦–å…ˆè‚¯å®šæ˜¯å…ˆå®‰è£…å¯¹åº”çš„åŒ…ï¼šInstall-Package Pomelo.AspNetCore.TimedJob -Pre\nç„¶ååœ¨Startup.csçš„ConfigureServiceså‡½æ•°é‡Œé¢æ·»åŠ Service,åœ¨Configureå‡½æ•°é‡Œé¢Useä¸€ä¸‹ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 // This method gets called by the runtime. Use this method to add services to the container. public void ConfigureServices(IServiceCollection services) { // Add framework services. services.AddMvc(); //Add TimedJob services services.AddTimedJob(); } public void Configure(IApplicationBuilder app, IHostingEnvironment env, ILoggerFactory loggerFactory) { //ä½¿ç”¨TimedJob app.UseTimedJob(); if (env.IsDevelopment()) { app.UseDeveloperExceptionPage(); app.UseBrowserLink(); } else { app.UseExceptionHandler(\u0026#34;/Home/Error\u0026#34;); } app.UseStaticFiles(); app.UseMvc(routes =\u0026gt; { routes.MapRoute( name: \u0026#34;default\u0026#34;, template: \u0026#34;{controller=Home}/{action=Index}/{id?}\u0026#34;); }); Encoding.RegisterProvider(CodePagesEncodingProvider.Instance); } Jobç›¸å…³ä»£ç  æ¥ç€æ–°å»ºä¸€ä¸ªç±»ï¼Œæ˜æ˜ä¸ºXXXJob.cs,å¼•ç”¨å‘½åç©ºé—´using Pomelo.AspNetCore.TimedJobï¼ŒXXXJobç»§æ‰¿äºJobï¼Œæ·»åŠ ä»¥ä¸‹ä»£ç ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 public class AutoGetMovieListJob:Job { // Begin èµ·å§‹æ—¶é—´ï¼›Intervalæ‰§è¡Œæ—¶é—´é—´éš”ï¼Œå•ä½æ˜¯æ¯«ç§’ï¼Œå»ºè®®ä½¿ç”¨ä»¥ä¸‹æ ¼å¼ï¼Œæ­¤å¤„ä¸º3å°æ—¶ï¼›SkipWhileExecutingæ˜¯å¦ç­‰å¾…ä¸Šä¸€ä¸ªæ‰§è¡Œå®Œæˆï¼Œtrueä¸ºç­‰å¾…ï¼› [Invoke(Begin = \u0026#34;2016-11-29 22:10\u0026#34;, Interval = 1000 * 3600*3, SkipWhileExecuting =true)] public void Run() { //Jobè¦æ‰§è¡Œçš„é€»è¾‘ä»£ç  //LogHelper.Info(\u0026#34;Start crawling\u0026#34;); //AddToLatestMovieList(100); //AddToHotMovieList(); //LogHelper.Info(\u0026#34;Finish crawling\u0026#34;); } } é¡¹ç›®å‘å¸ƒç›¸å…³ æ–°å¢runtimesèŠ‚ç‚¹ ä½¿ç”¨VS2015æ–°å»ºçš„æ¨¡æ¿å·¥ç¨‹ï¼Œproject.jsoné…ç½®é»˜è®¤æ˜¯æ²¡æœ‰runtimesèŠ‚ç‚¹çš„.\næˆ‘ä»¬æƒ³è¦å‘å¸ƒåˆ°éWindowså¹³å°çš„æ—¶å€™ï¼Œéœ€è¦æ‰‹åŠ¨é…ç½®ä¸€ä¸‹æ­¤èŠ‚ç‚¹ä»¥ä¾¿ç”Ÿæˆã€‚\n1 2 3 4 5 6 7 8 \u0026#34;runtimes\u0026#34;: { \u0026#34;win7-x64\u0026#34;: {}, \u0026#34;win7-x86\u0026#34;: {}, \u0026#34;osx.10.10-x64\u0026#34;: {}, \u0026#34;osx.10.11-x64\u0026#34;: {}, \u0026#34;ubuntu.14.04-x64\u0026#34;: {} } åˆ é™¤/æ³¨é‡ŠscriptsèŠ‚ç‚¹ ç”Ÿæˆæ—¶ä¼šè°ƒç”¨node.jsè„šæœ¬æ„å»ºå‰ç«¯ä»£ç ï¼Œè¿™ä¸ªä¸èƒ½ç¡®ä¿æ¯ä¸ªç¯å¢ƒéƒ½æœ‰bowerå­˜åœ¨\u0026hellip;æ³¨é‡Šå®Œäº‹ã€‚\n1 2 3 4 5 //\u0026#34;scripts\u0026#34;: { // \u0026#34;prepublish\u0026#34;: [ \u0026#34;bower install\u0026#34;, \u0026#34;dotnet bundle\u0026#34; ], // \u0026#34;postpublish\u0026#34;: [ \u0026#34;dotnet publish-iis --publish-folder %publish:OutputPath% --framework %publish:FullTargetFramework%\u0026#34; ] //}, åˆ é™¤/æ³¨é‡ŠdependenciesèŠ‚ç‚¹é‡Œé¢çš„type 1 2 3 4 5 \u0026#34;dependencies\u0026#34;: { \u0026#34;Microsoft.NETCore.App\u0026#34;: { \u0026#34;version\u0026#34;: \u0026#34;1.1.0\u0026#34; //\u0026#34;type\u0026#34;: \u0026#34;platform\u0026#34; }, project.jsonçš„ç›¸å…³é…ç½®è¯´æ˜å¯ä»¥çœ‹ä¸‹è¿™ä¸ªå®˜æ–¹æ–‡æ¡£ï¼šProject.json-file, æˆ–è€…å¼ å–„å‹è€å¸ˆçš„æ–‡ç« .NET Coreç³»åˆ— ï¼š 2 ã€project.json è¿™è‘«èŠ¦é‡Œå–çš„ä»€ä¹ˆè¯\nå¼€å‘ç¼–è¯‘å‘å¸ƒ 1 2 3 4 5 //è¿˜åŸå„ç§åŒ…æ–‡ä»¶ dotnet restore; //å‘å¸ƒåˆ°C:\\code\\website\\Dy2018Crawleræ–‡ä»¶å¤¹ dotnet publish -r ubuntu.14.04-x64 -c Release -o \u0026#34;C:\\code\\website\\Dy2018Crawler\u0026#34;; æœ€åï¼Œç…§æ—§å¼€æº\u0026hellip;\u0026hellip;ä»¥ä¸Šä»£ç éƒ½åœ¨ä¸‹é¢æ‰¾åˆ°ï¼š\nGayhubåœ°å€ï¼šhttps://github.com/liguobao/Dy2018Crawler\nåœ¨çº¿åœ°å€ï¼šhttp://codelover.win/\nPS:å›å¤´å†™ä¸ªçˆ¬ç‰‡å¤§å®¶æ»‹æŒä¸å•Š\u0026hellip;\n","date":"2016-12-04T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E7%94%A8.net-core%E5%86%99%E7%88%AC%E8%99%AB/","title":"æ‰‹æŠŠæ‰‹æ•™ä½ ç”¨.NET Coreå†™çˆ¬è™«"},{"content":"è‡ªåŠ¨åŒæ­¥git repositoryè„šæœ¬ ç”±äºå¹³æ—¶å¶å°”éœ€è¦mergeä¸åŒåˆ†æ”¯ä»£ç åˆ°æ­£å¼ç‰ˆæœ¬ç”¨äºå‘å¸ƒç‰ˆæœ¬ï¼Œmergeå‰å°±éœ€è¦å…ˆæŠŠå„ç§åˆ†æ”¯ä»£ç æ›´æ–°åˆ°æœ€æ–°ï¼Œæ¥ç€å†å»åšmergeå·¥ä½œã€‚\nç»å¸¸ä½¿ç”¨çš„åˆ†æ”¯å…¶å®ä¸ç®—å¤ªå¤šï¼Œä¸è¿‡ä»“åº“å€’æ˜¯æœ‰å¥½å‡ ä¸ªã€‚æ¥æ¥å»å»å†™å‘½ä»¤è¡Œæˆ–è€…GUIæ“ä½œå¤šäº†è§‰å¾—æœ‰ç‚¹ç¹çï¼Œå°±ç¢ç£¨æ¥å†™ä¸ªè„šæœ¬åšå§ã€‚\nPSï¼šå·æ‡’æ˜¯äººç±»è¿›æ­¥çš„åŠ¨åŠ›\u0026hellip;\næ‰¾äº†ä¸‹èµ„æ–™ï¼Œæ— å¤–ä¹å°±æ˜¯bat/shè„šæœ¬è°ƒç”¨git cmd,ä¹‹å‰å†™è¿‡batå‘½ä»¤ï¼Œæ‰€ä»¥ä¸€å¼€å§‹æ˜¯èµ°è¿™ä¸ªæ€è·¯çš„ã€‚\nä¸æ–™åœ¨PATHä¸Šé…ç½®å¥½äº†git binçš„è·¯å¾„ä¹‹åï¼Œä½¿ç”¨gitå‘½ä»¤æ²¡é—®é¢˜äº†ï¼Œä¸è¿‡pull rebaseçš„æ—¶å€™æç¤ºpublickeyæ— æ•ˆã€‚å¯æ˜¯æˆ‘çš„publickeyä¸€ç›´éƒ½åœ¨.sshé‡Œé¢,ä¸å­˜åœ¨æ— æ•ˆçš„é—®é¢˜\u0026hellip;\næ‡’å¾—çº ç»“ï¼Œæ¢shellå§ã€‚\nå‚è€ƒèµ„æ–™ï¼š\nè¯·é—®å¦‚ä½•å†™ä¸€ä¸ªæ‰¹å¤„ç†è‡ªåŠ¨æ‰“å¼€ gitbashï¼Œç„¶åè‡ªåŠ¨æ‰§è¡Œä¸€ç³»åˆ—gitå‘½ä»¤ï¼ˆwindowså¹³å°ï¼‰ï¼Ÿ\nShow Code ä½¿ç”¨shellå°±æ›´å¥½ç©äº†ï¼Œç›´æ¥æŠŠgit bashè¿è¡Œçš„å‘½ä»¤æ‰”åˆ°.shæ–‡ä»¶é‡Œé¢å°±å®Œäº‹äº†ã€‚æ‰€ä»¥\u0026hellip;å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 printf \u0026#34;Start rebase 58HouseSearch. \\r\\n\u0026#34; cd ./58HouseSearch; git checkout master; git pull --rebase origin master; printf \u0026#34;Finish Pull Rebase 58HouseSearch release and master.\\r\\n\u0026#34; read -p \u0026#34;Press any key to continue.\u0026#34;; cd ..; printf \u0026#34;Start rebase hexoforblog;\\r\\n\u0026#34; cd ./hexoforblog; git checkout master; git pull --rebase origin master; git checkout master; printf \u0026#34;Finish Pull Rebase hexoforblog.\\r\\n\u0026#34; read -p \u0026#34;Press any key to continue.\u0026#34;; cd ..; è¯´æ˜ï¼š\nprintf ä¸ºæ‰“å°å‡½æ•°ï¼Œå°±åƒCè¯­è¨€é‚£æ ·ç”¨å°±å¥½ï¼› read -p \u0026ldquo;Press any key to continue.\u0026rdquo;; è¿™ä¸ªæ˜¯æ¥å—è¾“å…¥ï¼Œç»“åˆèµ·æ¥å¯ä»¥åšæ›´å¤æ‚çš„è¡Œä¸ºå’¯ã€‚ è¾“å‡ºå†…å®¹å’Œæˆ‘ä»¬åœ¨git bashé‡Œé¢æ“ä½œæ˜¯ä¸€è‡´çš„ã€‚ ","date":"2016-11-25T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/%E8%87%AA%E5%8A%A8%E5%90%8C%E6%AD%A5git-repository%E8%84%9A%E6%9C%AC/","title":"è‡ªåŠ¨åŒæ­¥git repositoryè„šæœ¬"},{"content":"ASP.NET MVC å¾®ä¿¡JS-SDKè®¤è¯ å†™åœ¨å‰é¢ å‰é˜µå­å› ä¸ºæœ‰ä¸ªé¡¹ç›®éœ€è¦åšå¾®ä¿¡è‡ªå®šä¹‰åˆ†äº«åŠŸèƒ½ï¼Œå› è€Œå»ç ”ç©¶äº†ä¸‹å¾®ä¿¡JS-SDKç›¸å…³çŸ¥è¯†ã€‚\næ­¤æ–‡åšä¸ªç®€å•çš„è®°(tu)å½•(cao)\u0026hellip;\nå¼€å§‹ æ‰€æœ‰çš„ä¸œè¥¿éƒ½ä»æ–‡æ¡£å¼€å§‹:å¾®ä¿¡JSSDKè¯´æ˜æ–‡æ¡£\né¡¹ç›®éœ€è¦ç”¨åˆ°çš„æ˜¯åˆ†äº«æ¥å£ ä¸è¿‡ä½¿ç”¨å¾®ä¿¡JS-SDKä¹‹å‰ï¼Œéœ€è¦åšJSæ¥å£è®¤è¯ã€‚\nè®¤è¯å¦‚ä¸‹ï¼š\næ­¥éª¤ä¸€ï¼šç»‘å®šåŸŸå\næ­¥éª¤äºŒï¼šå¼•å…¥JSæ–‡ä»¶\næ­¥éª¤ä¸‰ï¼šé€šè¿‡configæ¥å£æ³¨å…¥æƒé™éªŒè¯é…ç½®\næ­¥éª¤å››ï¼šé€šè¿‡readyæ¥å£å¤„ç†æˆåŠŸéªŒè¯\næ­¥éª¤äº”ï¼šé€šè¿‡erroræ¥å£å¤„ç†å¤±è´¥éªŒè¯\næ­¥éª¤ä¸€ä¸­å…è®¸ä½¿ç”¨åŸŸå/å­åŸŸåï¼Œåªè¦xx.com/xxx.txtæˆ–è€…xx.com/mp/xxx.txtèƒ½è®¿é—®å°±å¥½ã€‚åŸŸåè®¤è¯é€šè¿‡ä¹‹åï¼Œæ­¤åŸŸåä¸‹çš„æ‰€æœ‰ç«¯å£çš„ç½‘ç«™éƒ½å¯ä»¥ä½¿ç”¨JS-SDKã€‚\næ­¥éª¤äºŒæ²¡ä»€ä¹ˆé—®é¢˜ï¼Œç•¥è¿‡ã€‚\næ­¥éª¤ä¸‰æœ€ç£¨äººï¼Œä¸‹é¢å•ç‹¬è®²è§£ã€‚\nconfigæ¥å£æ³¨å…¥æƒé™éªŒè¯é…ç½® å…ˆæ¥ä¸€æ®µè¯´æ˜ï¼š\næ‰€æœ‰éœ€è¦ä½¿ç”¨JS-SDKçš„é¡µé¢å¿…é¡»å…ˆæ³¨å…¥é…ç½®ä¿¡æ¯ï¼Œå¦åˆ™å°†æ— æ³•è°ƒç”¨ ï¼ˆåŒä¸€ä¸ªurlä»…éœ€è°ƒç”¨ä¸€æ¬¡ï¼Œå¯¹äºå˜åŒ–urlçš„SPAçš„web appå¯åœ¨æ¯æ¬¡urlå˜åŒ–æ—¶è¿›è¡Œè°ƒç”¨, ç›®å‰Androidå¾®ä¿¡å®¢æˆ·ç«¯ä¸æ”¯æŒpushStateçš„H5æ–°ç‰¹æ€§ï¼Œ æ‰€ä»¥ä½¿ç”¨pushStateæ¥å®ç°web appçš„é¡µé¢ä¼šå¯¼è‡´ç­¾åå¤±è´¥ï¼Œæ­¤é—®é¢˜ä¼šåœ¨Android6.2ä¸­ä¿®å¤ï¼‰ã€‚\n1 2 3 4 5 6 7 8 9 wx.config({ debug: true, // å¼€å¯è°ƒè¯•æ¨¡å¼,è°ƒç”¨çš„æ‰€æœ‰apiçš„è¿”å›å€¼ä¼šåœ¨å®¢æˆ·ç«¯alertå‡ºæ¥ï¼Œ //è‹¥è¦æŸ¥çœ‹ä¼ å…¥çš„å‚æ•°ï¼Œå¯ä»¥åœ¨pcç«¯æ‰“å¼€ï¼Œå‚æ•°ä¿¡æ¯ä¼šé€šè¿‡logæ‰“å‡ºï¼Œä»…åœ¨pcç«¯æ—¶æ‰ä¼šæ‰“å°ã€‚ appId: \u0026#39;\u0026#39;, // å¿…å¡«ï¼Œå…¬ä¼—å·çš„å”¯ä¸€æ ‡è¯† timestamp: , // å¿…å¡«ï¼Œç”Ÿæˆç­¾åçš„æ—¶é—´æˆ³ nonceStr: \u0026#39;\u0026#39;, // å¿…å¡«ï¼Œç”Ÿæˆç­¾åçš„éšæœºä¸² signature: \u0026#39;\u0026#39;,// å¿…å¡«ï¼Œç­¾åï¼Œè§é™„å½•1 jsApiList: [] // å¿…å¡«ï¼Œéœ€è¦ä½¿ç”¨çš„JSæ¥å£åˆ—è¡¨ï¼Œæ‰€æœ‰JSæ¥å£åˆ—è¡¨è§é™„å½•2 }); çœ‹åˆ°è¿™é‡Œè‚¯å®šæ‡µé€¼äº†ï¼Œè¿™æ˜¯éƒ½ä»€ä¹ˆé¬¼\u0026hellip;æ€ä¹ˆç©å•Šã€‚\næç¤ºæˆ‘ä»¬å»çœ‹é™„å½•1\u0026hellip;çœ‹å®Œä¹‹åæ€»ç»“å¦‚ä¸‹ï¼š\nä½¿ç”¨configæ¥å£æ³¨å…¥æƒé™éªŒè¯é…ç½®ï¼Œé‡ç‚¹æ˜¯ç”Ÿæˆåˆæ³•çš„signatrue ç”Ÿæˆsignatureéœ€è¦é€šè¿‡appidå’Œsecretè·å–token æ—¶é—´æˆ³å’Œè°ƒç”¨æ¥å£URLå¿…ä¸å¯å°‘ æ­¤æ“ä½œéœ€è¦æœåŠ¡ç«¯å®Œæˆï¼Œä¸èƒ½ä½¿ç”¨å®¢æˆ·ç«¯å®ç° æ•´ä¸ªè¿‡ç¨‹å˜æˆï¼š\né€šè¿‡appidå’Œsecretè·å–access_tokenï¼Œæ¥ç€ä½¿ç”¨tokenè·å–jsapi_ticketï¼›\næ‹¿åˆ°jsapi_ticketä¹‹åï¼ŒæŠŠjsapi_ticketã€æ—¶é—´æˆ³ã€éšæœºå­—ç¬¦ä¸²ã€æ¥å£è°ƒç”¨é¡µé¢URL æ‹¼æ¥æˆå®Œæ•´å­—ç¬¦ä¸²ï¼Œä½¿ç”¨sha1ç®—æ³•åŠ å¯†å¾—åˆ°signatureã€‚\næœ€åè¿”å›è‡³é¡µé¢ï¼Œåœ¨wx.configé‡Œé¢å¡«å…¥appidï¼Œä¸Šä¸€æ­¥çš„æ—¶é—´æˆ³timestampï¼Œä¸Šä¸€éƒ¨çš„éšæœºå­—ç¬¦ä¸²ã€sha1æ‹¿åˆ°çš„signatureï¼Œæƒ³è¦ä½¿ç”¨çš„JSæ¥å£ã€‚\nåºŸè¯å°‘è¯´ï¼Œç›´æ¥ä¸Šä»£ç å§ã€‚\nä»£ç æ—¶é—´ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 public class WeiXinController : Controller { public static readonly string appid = System.Web.Configuration.WebConfigurationManager.AppSettings[\u0026#34;wxappid\u0026#34;]; public static readonly string secret = System.Web.Configuration.WebConfigurationManager.AppSettings[\u0026#34;wxsecret\u0026#34;]; public static readonly bool isDedug = System.Web.Configuration.WebConfigurationManager.AppSettings[\u0026#34;IsDebug\u0026#34;] ==\u0026#34;true\u0026#34;; public static string _ticket = \u0026#34;\u0026#34;; public static DateTime _lastTimestamp; public ActionResult Info(string url,string noncestr) { if (string.IsNullOrEmpty(_ticket) || _lastTimestamp == null || (_lastTimestamp - DateTime.Now).Milliseconds \u0026gt; 7200) { var resultString = HTTPHelper.GetHTMLByURL(\u0026#34;https://api.weixin.qq.com/cgi-bin/token?grant_type=client_credential\u0026amp;appid=\u0026#34; + appid + \u0026#34;\u0026amp;secret=\u0026#34; + secret); dynamic resultValue = JsonConvert.DeserializeObject\u0026lt;dynamic\u0026gt;(resultString); if (resultValue == null || resultValue.access_token == null || resultValue.access_token.Value == null) { return Json(new { issuccess = false, error = \u0026#34;è·å–tokenå¤±è´¥\u0026#34; }); } var token = resultValue.access_token.Value; resultString = HTTPHelper.GetHTMLByURL (\u0026#34;https://api.weixin.qq.com/cgi-bin/ticket/getticket?access_token=\u0026#34; + token + \u0026#34;\u0026amp;type=jsapi\u0026#34;); dynamic ticketValue = JsonConvert.DeserializeObject\u0026lt;dynamic\u0026gt;(resultString); if (ticketValue == null || ticketValue.errcode == null || ticketValue.errcode.Value != 0 || ticketValue.ticket == null) return Json(new { issuccess = false, error = \u0026#34;è·å–ticketValueå¤±è´¥\u0026#34; }); _ticket = ticketValue.ticket.Value; _lastTimestamp = DateTime.Now; var timestamp = GetTimeStamp(); var hexString = string.Format(\u0026#34;jsapi_ticket={0}\u0026amp;noncestr={3}\u0026amp;timestamp={1}\u0026amp;url={2}\u0026#34;, _ticket, timestamp, url,noncestr); return Json(new { issuccess = true, sha1value = GetSHA1Value(hexString), timestamp = timestamp, url = url, appid = appid, debug=isDedug, tiket=_ticket }); } else { var timestamp = GetTimeStamp(); var hexString = string.Format(\u0026#34;jsapi_ticket={0}\u0026amp;noncestr=1234567890123456\u0026amp;timestamp={1}\u0026amp;url={2}\u0026#34;, _ticket, timestamp, url); return Json(new { issuccess = true, sha1value = GetSHA1Value(hexString), timestamp = timestamp, url = url, appid = appid, debug = isDedug,tiket = _ticket }); } } private string GetSHA1Value(string sourceString) { var hash = SHA1.Create().ComputeHash(Encoding.UTF8.GetBytes(sourceString)); return string.Join(\u0026#34;\u0026#34;, hash.Select(b =\u0026gt; b.ToString(\u0026#34;x2\u0026#34;)).ToArray()); } private static string GetTimeStamp() { TimeSpan ts = DateTime.Now - new DateTime(1970, 1, 1, 0, 0, 0, 0); return Convert.ToInt64(ts.TotalSeconds).ToString(); } } public class HTTPHelper { public static string GetHTMLByURL(string url) { string htmlCode = string.Empty; try { HttpWebRequest webRequest = (System.Net.HttpWebRequest)System.Net.WebRequest.Create(url); webRequest.Timeout = 30000; webRequest.Method = \u0026#34;GET\u0026#34;; webRequest.UserAgent = \u0026#34;Mozilla/4.0\u0026#34;; webRequest.Headers.Add(\u0026#34;Accept-Encoding\u0026#34;, \u0026#34;gzip, deflate\u0026#34;); HttpWebResponse webResponse = (System.Net.HttpWebResponse)webRequest.GetResponse(); //è·å–ç›®æ ‡ç½‘ç«™çš„ç¼–ç æ ¼å¼ string contentype = webResponse.Headers[\u0026#34;Content-Type\u0026#34;]; Regex regex = new Regex(\u0026#34;charset\\\\s*=\\\\s*[\\\\W]?\\\\s*([\\\\w-]+)\u0026#34;, RegexOptions.IgnoreCase); if (webResponse.ContentEncoding.ToLower() == \u0026#34;gzip\u0026#34;)//å¦‚æœä½¿ç”¨äº†GZipåˆ™å…ˆè§£å‹ { using (System.IO.Stream streamReceive = webResponse.GetResponseStream()) { using (var zipStream = new System.IO.Compression.GZipStream(streamReceive, System.IO.Compression.CompressionMode.Decompress)) { //åŒ¹é…ç¼–ç æ ¼å¼ if (regex.IsMatch(contentype)) { Encoding ending = Encoding.GetEncoding (regex.Match(contentype).Groups[1].Value.Trim()); using (StreamReader sr = new System.IO.StreamReader(zipStream, ending)) { htmlCode = sr.ReadToEnd(); } } else { using (StreamReader sr = new System.IO.StreamReader(zipStream, Encoding.UTF8)) { htmlCode = sr.ReadToEnd(); } } } } } else { using (System.IO.Stream streamReceive = webResponse.GetResponseStream()) { var encoding = Encoding.Default; if (contentype.Contains(\u0026#34;utf\u0026#34;)) encoding = Encoding.UTF8; using (System.IO.StreamReader sr = new System.IO.StreamReader(streamReceive, encoding)) { htmlCode = sr.ReadToEnd(); } } } return htmlCode; } catch (Exception ex) { return \u0026#34;\u0026#34;; } } } PSï¼šè¿™é‡Œè¦æ³¨æ„ç¼“å­˜ä¸€ä¸‹_ticketï¼ˆå³access_tokenï¼‰ï¼Œç…§å¾®ä¿¡æ–‡æ¡£è¯´çš„ï¼Œaccess_tokenä¸¤ä¸ªå°æ—¶å†…æœ‰æ•ˆï¼Œä¸éœ€è¦é¢‘ç¹è°ƒç”¨ã€‚è€Œä¸”è·å–access_tokençš„æ¥å£æœ‰è°ƒç”¨æ¬¡æ•°çš„é™åˆ¶ï¼Œå¦‚æœè¶…è¿‡äº†æ¬¡æ•°ï¼Œå°±ä¸å…è®¸è°ƒç”¨äº†ã€‚\nPPS:å»ºè®®noncestrå’ŒURLç”±å‰å°ä¼ å…¥æ¯”è¾ƒé€‚åˆï¼Œä½¿ç”¨ var theWebUrl = window.location.href.split(\u0026rsquo;#\u0026rsquo;)[0] è·å–URLï¼Œnoncestrå°±éšæ„äº†ã€‚\nPPPS:é‡åˆ°è¯¡å¼‚çš„invalid signatureçš„æ—¶å€™ï¼Œé¦–å…ˆæ£€æŸ¥urlå‚æ•°ï¼Œç„¶åæ£€æŸ¥noncestrï¼Œå†ä¸è¡Œé‡å¯ä¸€ä¸‹ç¨‹åºè·å–ä¸€ä¸ªæ–°çš„tokenå›æ¥ç»§ç»­ç©ã€‚\n","date":"2016-11-01T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/asp.net-mvc-%E5%BE%AE%E4%BF%A1js-sdk%E8%AE%A4%E8%AF%81/","title":"ASP.NET MVC å¾®ä¿¡JS-SDKè®¤è¯"},{"content":"å†™åœ¨å‰é¢ æœ€æ—©æ¥è§¦javascriptçš„æ—¶å€™ï¼Œjavascriptä»£ç ç›´æ¥æ‰”åœ¨scriptæ ‡ç­¾é‡Œé¢å°±å®Œäº‹äº†ã€‚\nåæ­£ä»£ç ä¸å¤šï¼Œäº¤äº’ç®€å•ï¼Œé€»è¾‘ä¸éš¾ï¼Œå’ŒHTMLæ··åœ¨ä¸€èµ·ä¹Ÿæœªå°ä¸å¯ã€‚\nåæ¥äº¤äº’è¶Šæ¥è¶Šå¤æ‚ï¼Œä»£ç è¶Šå¤šè¶Šå¤šäº†ï¼Œæˆ‘ä»¬å°±å¼€å§‹æŠŠJSä»£ç ç‹¬ç«‹åˆ°äº†å•ç‹¬çš„JSæ–‡ä»¶ä¸­ã€‚\nå…¬å…±çš„åº“å¼•ç”¨åœ¨å‰ï¼Œè‡ªå·±çš„é€»è¾‘ä»£ç å¼•ç”¨åœ¨åï¼Œå…¨å±€å˜é‡å®šä¹‰åœ¨HTMLå†…éƒ¨ï¼Œåœ¨ç‹¬ç«‹JSæ–‡ä»¶ä¸­ç›´æ¥ä½¿ç”¨å˜é‡å°±å¥½ã€‚\næˆ‘ä»¬ä¼šç»å¸¸çœ‹åˆ°ä¸‹é¢è¿™ç§ä»£ç ï¼š\n1 2 3 4 5 6 \u0026lt;script src=\u0026#34;1.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script src=\u0026#34;2.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script src=\u0026#34;3.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script src=\u0026#34;4.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script src=\u0026#34;5.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script src=\u0026#34;6.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; é€šè¿‡scriptæ ‡ç­¾é¡ºåºå»jsç®¡ç†ä¾èµ–å…³ç³»ã€‚\né˜®ä¸€å³°è€å¸ˆåœ¨Javascriptæ¨¡å—åŒ–ç¼–ç¨‹ï¼ˆä¸‰ï¼‰ï¼šrequire.jsçš„ç”¨æ³• ä¸€æ–‡ä¸­æ€»ç»“äº†è¿™æ ·å†™æ³•çš„ç¼ºç‚¹ï¼š\n1 2 3 4 5 é¦–å…ˆï¼ŒåŠ è½½çš„æ—¶å€™ï¼Œæµè§ˆå™¨ä¼šåœæ­¢ç½‘é¡µæ¸²æŸ“ï¼ŒåŠ è½½æ–‡ä»¶è¶Šå¤šï¼Œç½‘é¡µå¤±å»å“åº”çš„æ—¶é—´å°±ä¼šè¶Šé•¿ï¼› å…¶æ¬¡ï¼Œç”±äºjsæ–‡ä»¶ä¹‹é—´å­˜åœ¨ä¾èµ–å…³ç³»ï¼Œå› æ­¤å¿…é¡»ä¸¥æ ¼ä¿è¯åŠ è½½é¡ºåºï¼ˆæ¯”å¦‚ä¸Šä¾‹çš„1.jsè¦åœ¨2.jsçš„å‰é¢ï¼‰ï¼Œä¾èµ–æ€§æœ€å¤§çš„æ¨¡å—ä¸€å®šè¦æ”¾åˆ°æœ€ååŠ è½½. å½“ä¾èµ–å…³ç³»å¾ˆå¤æ‚çš„æ—¶å€™ï¼Œä»£ç çš„ç¼–å†™å’Œç»´æŠ¤éƒ½ä¼šå˜å¾—å›°éš¾ã€‚ è€Œrequirejsçš„è¯ç”Ÿä¾¿æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ã€‚\nrequirejs åœ¨å®˜ç½‘æŠŠrequirejs ä¸‹è½½å›æ¥ä¹‹åã€‚ä½¿ç”¨ä¸€èˆ¬çš„æ–¹æ³•å¼•å…¥ï¼š\n1 \u0026lt;script src=\u0026#34;js/require.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; ä½†æ˜¯è¿™æ ·çš„æ–¹æ³•ï¼Œè¿˜æ˜¯å¯èƒ½åœ¨åŠ è½½require.jsçš„æ—¶å€™å¯¼è‡´ç½‘é¡µå¤±å»å“åº”ã€‚è§£å†³æ–¹æ¡ˆä¸€èˆ¬æœ‰ä¸¤ç§ï¼š\næŠŠä¸Šé¢çš„ä»£ç æ”¾åˆ°ç½‘é¡µåº•éƒ¨\nä½¿ç”¨å¼‚æ­¥çš„æ–¹æ³•åŠ è½½ï¼Œå¦‚ä¸‹ï¼š\n1 \u0026lt;script src=\u0026#34;js/require.js\u0026#34; defer async=\u0026#34;true\u0026#34; \u0026gt;\u0026lt;/script\u0026gt; asyncå±æ€§ è¡¨æ˜è¿™ä¸ªæ–‡ä»¶éœ€è¦å¼‚æ­¥åŠ è½½ï¼Œé¿å…ç½‘é¡µå¤±å»å“åº”ã€‚\nä¸è¿‡IEä¸‹ä¸æ”¯æŒè¿™ä¸ªå±æ€§ï¼Œåªæ”¯æŒdeferï¼Œæ‰€ä»¥å¯ä»¥æŠŠdeferä¹Ÿå†™ä¸Šã€‚\nåŠ è½½ä¸»æ¨¡å— åœ¨ä¸Šä¸€æ­¥ï¼Œæˆ‘ä»¬å·²ç»å¼•å…¥äº†requireäº†ï¼Œé‚£ä¹ˆrequireæ€ä¹ˆçŸ¥é“æˆ‘ä»¬ç©¶ç«Ÿè¦åŠ è½½ä»€ä¹ˆä¸œè¥¿å‘¢ï¼Ÿç­”æ¡ˆæ˜¯ä½¿ç”¨data-mainå±æ€§ã€‚ å‡è®¾æˆ‘ä»¬çš„ä¸»æ¨¡å—ä¸ºjs/home.js,å¼•å…¥ä»£ç åº”è¯¥å¦‚ä¸‹ï¼š\n1 2 \u0026lt;script src=\u0026#34;js/require.js\u0026#34; data-main=\u0026#34;js/home\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; //require.jsé»˜è®¤æ–‡ä»¶åç¼€ä¸ºjsï¼Œæ‰€ä»¥home.jså¯ä»¥å†™æˆhomeã€‚ æ¥ä¸‹æ¥æˆ‘ä½¿ç”¨58HouseSearch çš„ä»£ç æ¥è®²è§£é‡æ„è¿‡ç¨‹ã€‚\nåœ¨æ­¤é¡¹ç›®é‡Œé¢ï¼Œé‡æ„å‰å¤§æ¦‚å°±æ˜¯JSå˜é‡æ¼«å¤©é£ï¼Œjsæ–‡ä»¶é‡Œé¢å„ç§å‡½æ•°åˆ°å¤„ä¹±æ”¾ã€‚ä¸€å¼€å§‹ç”¨èµ·æ¥è¿˜æ²¡ä»€ä¹ˆï¼Œåæ¥åŠ å…¥äº†æ›´å¤šåŠŸèƒ½çš„æ—¶å€™ï¼ŒJSä»£ç ç»´æŠ¤èµ·æ¥å°±ç–¼ä¸æ¬²ç”Ÿäº†ã€‚å› æ­¤æ‰˜äº†ä¸ªå°ä¼™ä¼´å¸®å¿™ä½¿ç”¨æ¨¡å—åŒ–æ€æƒ³é‡æ„äº†ä¸€ä¸‹JSä»£ç ã€‚\nä¸Šé¢è¯´äº†ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦åˆ›å»ºæˆ‘ä»¬çš„æ¨¡å—ï¼Œåœ¨è¿™ä¸ªé¡¹ç›®é‡Œé¢ï¼Œä¸»æ¨¡å—å«home.jsã€‚\nhome.jsä¸­æˆ‘ä»¬éœ€è¦é…ç½®ä¸€ä¸‹require.config.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 require.config({ baseUrl: \u0026#39;/DomainJS/\u0026#39;, paths: { jquery: \u0026#34;lib/jquery-1.11.3.min\u0026#34;, \u0026#34;AMUI\u0026#34;: \u0026#34;lib/amazeui.2.7.1.min\u0026#34;, \u0026#34;jquery.range\u0026#34;: \u0026#34;lib/jquery.range\u0026#34;, \u0026#34;es5\u0026#34;: \u0026#34;lib/es5\u0026#34;, \u0026#34;mapController\u0026#34;: \u0026#34;mapController\u0026#34;, \u0026#34;addToolbar\u0026#34;: \u0026#34;addToolbar\u0026#34;, }, shim: { \u0026#34;addToolbar\u0026#34;: { deps: [\u0026#34;jquery\u0026#34;] }, \u0026#34;jquery.range\u0026#34;: { deps: [\u0026#34;jquery\u0026#34;] } } }); åœ¨è¿™é‡Œæˆ‘ä¸»è¦é…ç½®äº†ä¸€ä¸‹baseURL(æ‰€æœ‰æ¨¡å—çš„æŸ¥æ‰¾æ ¹è·¯å¾„)ï¼Œpaths(åç§°æ˜ å°„)ï¼Œshim( ä¸ºé‚£äº›æ²¡æœ‰ä½¿ç”¨define()æ¥å£°æ˜ä¾èµ–å…³ç³»ã€è®¾ç½®æ¨¡å—çš„\u0026quot;æµè§ˆå™¨å…¨å±€å˜é‡æ³¨å…¥\u0026quot;å‹è„šæœ¬åšä¾èµ–å’Œå¯¼å‡ºé…ç½®ã€‚)\nå…³äºrequire.configçš„è¯¦ç»†å†…å®¹å¯ä»¥çœ‹ä¸‹ä¸‹é¢è¿™äº›æ–‡ç« ï¼š\nRequireJSè¿›é˜¶:é…ç½®æ–‡ä»¶çš„å­¦ä¹  RequireJSè¿›é˜¶:æ¨¡å—çš„ä¼˜åŒ–åŠé…ç½®çš„è¯¦è§£ é…ç½®åšå®Œäº†ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å¼€å§‹çœŸæ­£å†™æˆ‘ä»¬çš„é€»è¾‘ä»£ç äº†,æˆ‘ä»¬ä½¿ç”¨requireæ¥åŠ è½½æˆ‘ä»¬éœ€è¦çš„åº“ã€‚ ä»£ç å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 require([\u0026#39;domready!\u0026#39;, \u0026#39;jquery\u0026#39;, \u0026#39;AMUI\u0026#39;, \u0026#39;mapController\u0026#39;, \u0026#39;city\u0026#39;, \u0026#39;commuteGo\u0026#39;], function (doc, $, AMUI, mapController, city, commuteGo) { city.initAllCityInfo(); mapController.init(); $(\u0026#34;input[name=\u0026#39;locationType\u0026#39;]\u0026#34;).bind(\u0026#39;click\u0026#39;, mapController.locationMethodOnChange) $(\u0026#34;input[name=\u0026#39;vehicle\u0026#39;]\u0026#34;).bind(\u0026#39;click\u0026#39;, commuteGo.go) $(\u0026#39;#Get58Data\u0026#39;).bind(\u0026#39;click\u0026#39;, function(e) { e.preventDefault(); mapController.Get58DataClick(); e.stopPropagation(); }); $.ajax({ type: \u0026#34;post\u0026#34;, url: \u0026#34;../Commom/GetPVCount\u0026#34;, data: { }, success: function (result) { if (result.IsSuccess){ $(\u0026#34;#lblPVCount\u0026#34;).text(result.PVCount); }else { $(\u0026#34;#lblPVCount\u0026#34;).text(0); console.log(result.Error); } } }); $(\u0026#39;#search-offcanvas\u0026#39;).offCanvas({ effect: \u0026#39;overlay\u0026#39; }); $(\u0026#34;.amap-sug-result\u0026#34;).css(\u0026#34;z-index\u0026#34;, 9999); }) å¿½ç•¥functioné‡Œé¢çš„å…·ä½“é€»è¾‘ï¼ŒåŠ è½½å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 require([\u0026#39;domready!\u0026#39;, \u0026#39;jquery\u0026#39;, \u0026#39;AMUI\u0026#39;, \u0026#39;mapController\u0026#39;, \u0026#39;city\u0026#39;, \u0026#39;commuteGo\u0026#39;], function (doc, $, AMUI, mapController, city, commuteGo){ //todo }); ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºä¸€ä¸ªæ•°ç»„ï¼Œè¡¨ç¤ºæ‰€ä¾èµ–çš„æ¨¡å—ï¼Œæ­¤å¤„ä¸º[\u0026lsquo;domready!\u0026rsquo;, \u0026lsquo;jquery\u0026rsquo;, \u0026lsquo;AMUI\u0026rsquo;, \u0026lsquo;mapController\u0026rsquo;, \u0026lsquo;city\u0026rsquo;, \u0026lsquo;commuteGo\u0026rsquo;]ï¼›\nç¬¬äºŒä¸ªå‚æ•°ä¸ºå›è°ƒå‡½æ•°ï¼Œå½“å‰é¢æŒ‡å®šçš„æ¨¡å—éƒ½å…¨éƒ¨åŠ è½½æˆåŠŸä¹‹åï¼Œä¾¿è°ƒç”¨æ­¤å‡½æ•°ã€‚åŠ è½½çš„æ¨¡å—ä¼šä»¥å‚æ•°å½¢å¼ä¼ å…¥æ­¤å‡½æ•°ï¼Œä»è€Œåœ¨å›è°ƒå‡½æ•°å†…éƒ¨å°±å¯ä»¥ä½¿ç”¨è¿™äº›æ¨¡å—å•¦ã€‚\nrequire()å¼‚æ­¥åŠ è½½æ‰€éœ€æ¨¡å—çš„æ—¶å€™ï¼Œæ­¤æ—¶æµè§ˆå™¨å¹¶ä¸ä¼šå¤±å»å“åº”ï¼›å½“å‰é¢çš„æ¨¡å—åŠ è½½æˆåŠŸä¹‹åï¼Œæ‰§è¡Œå›è°ƒå‡½æ•°æ‰ä¼šè¿è¡Œæˆ‘ä»¬çš„é€»è¾‘ä»£ç ï¼Œå› æ­¤è§£å†³äº†ä¾èµ–æ€§é—®é¢˜ã€‚\nè®²å®Œäº†æ¨¡å—åŠ è½½ï¼Œæˆ‘ä»¬ä¸‹é¢è®²ä¸€ä¸‹æ¨¡å—ç¼–å†™ã€‚\nAMDæ¨¡å—ç¼–å†™ require.jsåŠ è½½çš„æ¨¡å—çš„é‡‡ç”¨çš„AMDè§„èŒƒã€‚æ‰€ä»¥æˆ‘ä»¬çš„æ¨¡å—å¿…é¡»æŒ‰ç…§AMDçš„è§„å®šæ¥å†™ã€‚\nå…³äºAMDè§„èŒƒè¯¦æƒ…å¯ä»¥çœ‹è¿™ä¸ªæ–‡ç« ï¼šJavascriptæ¨¡å—åŒ–ç¼–ç¨‹ï¼ˆäºŒï¼‰ï¼šAMDè§„èŒƒ\næ¨¡å—æœ‰ä¸¤ä¸ªæƒ…å†µï¼Œä¸ä¾èµ–å…¶ä»–æ¨¡å—å’Œä¾èµ–å…¶ä»–æ¨¡å—ã€‚\nä¸ä¾èµ–å…¶ä»–æ¨¡å— ç›´æ¥defineå®šä¹‰ï¼Œä½¿ç”¨functionå›è°ƒã€‚\n58HouseSearch/DomainJS/helper.js\n1 2 3 4 5 6 7 8 9 10 11 12 define(function () { //è·å–URLä¸­çš„å‚æ•° var getQueryString= function (name) { var reg = new RegExp(\u0026#34;(^|\u0026amp;)\u0026#34; + name + \u0026#34;=([^\u0026amp;]*)(\u0026amp;|$)\u0026#34;); var r = window.location.search.substr(1).match(reg); if (r != null) return unescape(r[2]); return null; } return { getQueryString: getQueryString, }; }) ä¾èµ–å…¶ä»–æ¨¡å— defineä¸­å¦‚åŒrequireä¸€æ ·ï¼Œç”¨æ•°ç»„è¡¨æ˜éœ€è¦åŠ è½½çš„æ¨¡å—ï¼Œfunctionå›è°ƒã€‚\n58HouseSearch/DomainJS/marker.js\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 define([\u0026#39;mapSignleton\u0026#39;, \u0026#39;city\u0026#39;, \u0026#39;transfer\u0026#39;], function(mapSignleton, city, transfer) { var _map = mapSignleton.map; var _workMarker = null; var _markerArray = []; var load = function(x, y, locationName) { _workMarker = new AMap.Marker({ map: _map, title: locationName, icon: \u0026#39;http://webapi.amap.com/theme/v1.3/markers/n/mark_r.png\u0026#39;, position: [x, y] }); } var add = function(address, rent, href, markBG) { new AMap.Geocoder({ city: city.name, radius: 1000 }).getLocation(address, function(status, result) { if (status === \u0026#34;complete\u0026#34; \u0026amp;\u0026amp; result.info === \u0026#39;OK\u0026#39;) { var geocode = result.geocodes[0]; var rentMarker = new AMap.Marker({ map: _map, title: address, icon: markBG ? \u0026#39;IMG/Little/\u0026#39; + markBG : \u0026#39;http://webapi.amap.com/theme/v1.3/markers/n/mark_b.png\u0026#39;, position: [geocode.location.getLng(), geocode.location.getLat()] }); _markerArray.push(rentMarker); rentMarker.content = \u0026#34;\u0026lt;div\u0026gt;\u0026lt;a target = \u0026#39;_blank\u0026#39; href=\u0026#39;\u0026#34; + href + \u0026#34;\u0026#39;\u0026gt;æˆ¿æºï¼š\u0026#34; + address + \u0026#34; ç§Ÿé‡‘ï¼š\u0026#34; + rent + \u0026#34;\u0026lt;/a\u0026gt;\u0026lt;div\u0026gt;\u0026#34; rentMarker.on(\u0026#39;click\u0026#39;, function(e) { transfer.add(e, address); }); } }) }; var clearArray = function() { if (_markerArray \u0026amp;\u0026amp; _markerArray.length \u0026gt; 0) _map.remove(_markerArray); _markerArray = []; } var clear = function() { if (_workMarker) { _map.remove(_workMarker); } } return { load: load, add: add, clearArray: clearArray, clear: clear }; }); è¿™æ ·çš„è¯ï¼Œä¸€ä¸ªä¾›requireè°ƒç”¨çš„æ¨¡å—ä¹Ÿå°±å†™å¥½äº†ã€‚\næœ€åæ„Ÿè°¢å°ä¼™ä¼´Larry Sean å¸®å¿™é‡æ„ä»£ç ã€‚\nå…¨æ–‡å®Œã€‚\n","date":"2016-10-22T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/%E4%BD%BF%E7%94%A8requirejs%E7%BC%96%E5%86%99%E6%A8%A1%E5%9D%97%E5%8C%96%E4%BB%A3%E7%A0%81/","title":"ä½¿ç”¨requirejsç¼–å†™æ¨¡å—åŒ–ä»£ç "},{"content":"ctrl+s ä¿å­˜ï¼ˆè¿™ä¸ªç¡®å®å¾ˆç®€å•ï¼Œè¦è¯´å¸¸ç”¨ï¼Œè¿™ç©æ„ç»å¯¹æ’åç¬¬ä¸€ï¼‰\nctrl+Shift+S ä¿å­˜æ‰€æœ‰VSä¸­æ‰“å¼€çš„æ‰€æœ‰æ–‡ä»¶\nctrl+O æ‰“å¼€æ–°æ–‡ä»¶\nctrl+Shift+O æ‰“å¼€é¡¹ç›®\nctrl+Shift+A å½“å‰é¡¹ç›®ä¸­æ·»åŠ æ–°å»ºé¡¹\nctrl+F4 å…³é—­å½“å‰æ‰“å¼€é¡µ\nctrl+F6 è·³åˆ°ä¸‹ä¸€ä¸ªçª—å£\nctrl+Shift+F6 è·³åˆ°å‰ä¸€ä¸ªæ‰“å¼€çš„çª—å£\nF12 è½¬åˆ°å‡½æ•°å®šä¹‰å®ç°å¤„ï¼Œæˆ–è€…è½¬åˆ°å˜é‡å®šä¹‰å¤„ï¼ˆä¸€å †ä»£ç ä¸­ä½¿ç”¨è¿™ä¸ªé”®ç¡®å®é€»è¾‘ä¼šæ›´æ¸…æ™°ä¸€ç‚¹ï¼‰\nctrl+- è¿™ä¸ªç›¸å¯¹æ¥è¯´è·ŸF12æ˜¯é…å¥—ä½¿ç”¨çš„ï¼ŒF12åˆ°å‡½æ•°å®šä¹‰ï¼Œç„¶åè¿”å›åŸä»£ç ä¸­ç»§ç»­æŸ¥çœ‹\nshift+ctrl+- ç›¸å¯¹äºä¸Šä¸€ä¸ªæ­¥éª¤ï¼Œè¿™ä¸ªå¯ä»¥å†æ¬¡è½¬åˆ°å‡½æ•°å®šä¹‰çš„åœ°æ–¹\nctrl+tab é¡µé¢åˆ‡æ¢ï¼Œæ‰“å¼€é¡µé¢è¿‡å¤šçš„è¯ï¼Œåˆ‡æ¢ç”¨çš„è¿˜æ˜¯æ¯”è¾ƒå¤šçš„\nctrl+F æœç´¢ï¼ŒæŸ¥æ‰¾ï¼ŒåŠŸèƒ½ç®€å•ç²—æš´æœ‰çš„æ—¶å€™æ¯”å¾ˆé«˜æ•ˆ\nctrl+F3 åœ¨é€‰ä¸­åŒºåŸŸæœç´¢\nctrl+Kï¼Œctrl+D æ•´ä¸ªæ–‡æ¡£æ ¼å¼åŒ–\nctrl+K,ctrl+F æ ¼å¼åŒ–é€‰ä¸­éƒ¨åˆ†ä»£ç \nctrl+Kï¼Œctrl+C ä»£ç æ³¨é‡Š\nctrl+Kï¼Œctrl+U å–æ¶ˆä»£ç æ³¨é‡Š\nctrl+L åˆ é™¤ï¼Œåˆ é™¤å½“å‰è¡Œæˆ–è€…åˆ é™¤é€‰ä¸­è¡Œ\nShift+Alt+Enter å½“å‰ä»£ç åŒºåŸŸå…¨å±ï¼Œå†æŒ‰ä¸€æ¬¡å–æ¶ˆå…¨å±\nctrl+Mï¼Œctrl+M å†™ä»£ç éƒ½å–œæ¬¢æŠ˜å ï¼ŒæŠ˜å ä¹‹åè¿˜æ˜¯è¿˜è¦æ‰“å¼€çš„ï¼Œå¯ä»¥è¯•è¯•è¿™ä¸ªå¿«æ·é”®\nctrl+space ä»£ç è¡¥å…¨\nctrl+Enter å‡å¦‚ç°åœ¨å½“å‰è¡Œä¸Šé¢æ·»åŠ ä»£ç å…‰æ ‡è·³åˆ°å½“å‰è¡Œçš„ä¸Šä¸€è¡Œ\nctrl+Shift+Enterå‡å¦‚ç°åœ¨å½“å‰è¡Œä¸‹é¢æ·»åŠ ä»£ç å…‰æ ‡è·³åˆ°å½“å‰è¡Œçš„ä¸‹ä¸€è¡Œ\nShift+F12 æŸ¥æ‰¾å‡½æ•°æˆ–è€…å˜é‡çš„æ‰€æœ‰å¼•ç”¨\nctrl+g æŸ¥æ‰¾è¡Œï¼Œè·³è½¬åˆ°ä½ æƒ³è¦è·³è½¬çš„è¡Œæ•°\nctrl+Shift+â†‘ å‘ä¸ŠæŸ¥æ‰¾å¼•ç”¨\nctrl+Shift+â†“ å‘ä¸‹æŸ¥æ‰¾å¼•ç”¨\nShift+Alt+â†‘ å‘ä¸Šç”»ä¸€æ¡ç›´çº¿ï¼Œé€šå¸¸å¦‚æœæ‹·è´ä»£ç çš„æ—¶å€™æœ‰è¡Œå·å¯ä»¥è¿™æ ·å»é™¤\nShift+Alt+â†“ å‘ä¸‹ç”»ä¸€æ¡ç›´çº¿ï¼ŒåŒä¸Š\nShift+â†‘ å‘ä¸Šé€‰ä¸­ä»£ç åŒºåŸŸ\nShift+â†“ å‘ä¸‹é€‰ä¸­ä»£ç åŒºåŸŸ\n","date":"2016-10-14T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/vs%E5%BF%AB%E6%8D%B7%E9%94%AE/","title":"VSå¿«æ·é”®"},{"content":"58HouseSearché¡¹ç›®è¿ç§»åˆ°asp.net core 58HouseSearchè¿™ä¸ªé¡¹ç›®åŸæœ¬æ˜¯åŸºäºASP.NET MVC 4å†™çš„ï¼Œå¼€å‘ç¯å¢ƒæ˜¯Windows+VS2015ï¼Œå‘å¸ƒå¹³å°æ˜¯linux+mono+jexusï¼Œè¿™æ ·çœ‹æ¥æ•´ä¸ªé¡¹ç›®åŸºæœ¬å·²ç»æ»¡è¶³è·¨å¹³å°çš„éœ€æ±‚ã€‚\nè¿™æ ·ä¸€æ¥ï¼Œæœ¬æ¥æˆ‘æ˜¯æ²¡ä»€ä¹ˆåŠ¨åŠ›å»åšè¿ç§»çš„ï¼Œå¥½å¥½çš„ä¸œè¥¿é—²ç€æ²¡äº‹å¹²æ‰è¿ç§»å‘¢ã€‚\nä¸è¿‡ï¼Œè¿™ä¸å›½åº†äº†ä¹ˆï¼Ÿç©·äººä¸æ˜¯åœ¨å®¶ç©·æ¸¸å¤©ä¸‹ä¹ˆï¼Ÿæ‰€ä»¥\u0026hellip;çœŸçš„æœ‰ç‚¹é—²ç€æ²¡äº‹å¹²äº†ã€‚\nè¿ç§»å¯è¡Œæ€§æ¢è®¨ é¡¹ç›®è¿ç§»å‰ï¼Œæˆ‘ä»¬è¿˜æ˜¯å…ˆæ¥è®¨è®ºä¸€ä¸‹è¿ç§»å¯è¡Œæ€§ã€‚ä¸ºå˜›è¦è¿›è¡Œå¯è¡Œæ€§æ¢è®¨å‘¢ï¼ŸåŸå› æ˜¯.NET COREæ˜¯ä¸€ä¸ªè·¨å¹³å°çš„æ¡†æ¶ï¼Œå’Œä¸Šä¸€ä»£çš„.NETå­˜åœ¨ä¸å…¼å®¹ã€‚\nä¸ªäººæ€»ç»“ä¸€ä¸‹ï¼Œè¿ç§»çš„ä¸»è¦çš„é—®é¢˜åœ¨äºï¼šä»£ç ä¸å…¼å®¹ã€ç±»åº“ä¸å…¼å®¹ã€ä¸¥é‡ä¾èµ–Windows APIæˆ–è€…COMç»„ä»¶ç­‰ã€‚\nä»£ç ä¸å…¼å®¹ ä»£ç ä¸å…¼å®¹å…¶å®ä¸ç®—éº»çƒ¦ã€‚æ¯•ç«Ÿä»£ç æ˜¯æ´»çš„ï¼Œä½ æˆ‘ä¹Ÿæ˜¯æ´»çš„ï¼Œä¸å°±æ˜¯ä¸€ä¸ªæ”¹å­—ç½¢äº†ã€‚èŠ±ç‚¹æ—¶é—´æ…¢æ…¢æ”¹ï¼Œæ€»æ˜¯èƒ½ææ‚çš„ã€‚\nç±»åº“ä¸å…¼å®¹,è¦ä¸å°±å¼ƒç”¨ï¼Œè¦ä¸å°±æ‰¾æ›¿ä»£å“ã€‚\nä¸¥é‡ä¾èµ–Windows APIæˆ–è€…COMç»„ä»¶\né¢ï¼Ÿæ‰¾æ›¿ä»£å“ï¼Œæ‰¾ä¸åˆ°å¯ç”¨æ›¿ä»£å“çš„è¯ã€‚æ”¾å¼ƒå§ï¼Œè¿™ä¸ªé¡¹ç›®åˆ«è€ƒè™‘è¿ç§»äº†ã€‚\nè¿™ä¸ªæ•…äº‹å‘Šè¯‰æˆ‘ä»¬ï¼Œåšè·¨å¹³å°é¡¹ç›®çš„æ—¶å€™ï¼Œå°‘ç‚¹ç”¨ç³»ç»ŸAPIæˆ–è€…ç»„å»ºã€‚\nå›åˆ°58HouseSearché¡¹ç›®ä¸Šé¢ã€‚\nè¿™ä¸ªé¡¹ç›®çš„ä»£ç åŸºæœ¬éƒ½æ˜¯æˆ‘å†™çš„ï¼Œæ‰€ä»¥é‡å†™ä»£ç æ²¡ä»€ä¹ˆé—®é¢˜ã€‚ ä¾èµ–çš„ç±»åº“æœ‰ä¸‹é¢å‡ ä¸ª:\nAngleSharp\nNewtonsoft.Json\nlog4net\nAngleSharpæ˜¯ç”¨æ¥è§£æHTMLçš„ç±»åº“ï¼Œç”¨linqçš„æ–¹å¼æ¥æ“ä½œHTMLï¼Œç”¨èµ·æ¥å®åœ¨çˆ½å¿«ã€‚\nå¦‚æœè¿™è´§åœ¨.net coreä¸Šä¸èƒ½è·‘ï¼Œæˆ‘åº”è¯¥ç«‹é©¬æ”¾å¼ƒäº†ã€‚ ä¸è¿‡ï¼Œè¿™ä¸ªå®åœ¨ç»™åŠ›\u0026hellip;\nNewtonsoft.Json\nåœ¨è¿™ä¸ªé¡¹ç›®é‡Œé¢ä¸»è¦æ˜¯ç”¨æ¥è®°å½•PVæ•°æ®çš„ï¼Œéæ ¸å¿ƒåŠŸèƒ½ï¼Œå¯æœ‰å¯æ— ã€‚ä¸è¿‡çœ‹äº†ä¸‹nugetä¸Šçš„ä»‹ç»ï¼Œä¹Ÿæ˜¯æ”¯æŒ.net coreçš„ã€‚\nå‰©ä¸‹log4net\u0026hellip;å—¯ï¼Œå¹¶ä¸æ”¯æŒlog4netã€‚ä¸è¿‡è¿™ä¸ªå°±æ›´åŠ æ˜¯éæ ¸å¿ƒå†…å®¹äº†ï¼Œç›´æ¥ä¸¢äº†ã€‚ PS:è€ƒè™‘åæœŸåŠ å…¥Nlogæ›¿ä»£log4netã€‚\nè‡³äºä¾èµ–Windows APIä¹‹ç±»çš„ï¼Œåœ¨è¿™ä¸ªé¡¹ç›®é‡Œé¢åŸºæœ¬æ²¡æœ‰ï¼Œæ‰€ä»¥ç•¥è¿‡\u0026hellip;\nå‡†å¤‡å·¥ä½œ Visual Studio Community 2015 with Update 3 â€“ Free .NET Core SDK .NET Core .NET Core 1.0.1 - VS 2015 Tooling Preview 2 å‹æƒ…æç¤ºï¼š\nVisual Studio Community 2015 with Update 3 ä¸‹è½½é•œåƒæ¥å®‰è£…ã€‚ é”™è¯¯æ“ä½œå¦‚ä¸‹ï¼š æ­£ç¡®æ‰“å¼€æ–¹å¼ï¼š\nå®‰è£….NET Core SDKå’Œ.NET Coreä¹‹åå†å®‰è£….NET Core 1.0.1 - VS 2015 Tooling Preview 2\nå®‰è£….NET Core 1.0.1 - VS 2015 Tooling Preview 2 è¿™è´§çš„å¯èƒ½ä¼šæŠ¥é”™0x80072f8aæœªæŒ‡å®šçš„é”™è¯¯\nè§£å†³æ–¹æ¡ˆè§ä¸‹å›¾ï¼š\nè¯¦ç»†è§é“¾æ¥ï¼šå®‰è£…DotNetCore.1.0.1-VS2015Tools.Preview2.0.2å‡ºç°0x80072f8aæœªæŒ‡å®šçš„é”™è¯¯\nä¸Šé¢éƒ½å¼„å¥½ä¹‹åï¼Œç†è®ºä¸Šåœ¨VS2O15-æ–°å»ºé¡¹ç›®é‡Œé¢å¯ä»¥çœ‹åˆ°ASP.NET COREçš„æ¨¡æ¿äº†ã€‚å¦‚ä¸‹å›¾ï¼š é¡¹ç›®è¿ç§» æ–°å»ºç©ºç™½ASP.NET COREé¡¹ç›® æ–°å»ºå¥½äº†ä¹‹åå¦‚ä¸‹å›¾ï¼š\nNugetè·å–å¼•ç”¨ https://www.nuget.org/packages/AngleSharp/\nhttps://www.nuget.org/packages/Newtonsoft.Json\næ·»åŠ Controllersæ–‡ä»¶å¤¹ ç„¶åæŠŠä¹‹å‰é¡¹ç›®çš„Controllersæ‹·è´è¿‡æ¥ï¼Œæ”¹æ‰å‘½åç©ºé—´ï¼Œå»æ‰æ— ç”¨ä»£ç ï¼Œæ·»åŠ ç›¸åº”å¼•ç”¨ã€‚\næ·»åŠ Viewsæ–‡ä»¶å¤¹ æœ¬é¡¹ç›®ç›´æ¥æŠŠä¹‹å‰é¡¹ç›®çš„Viewsæ‹·è´è¿‡æ¥æ˜¯å®Œå…¨æ²¡æœ‰é—®é¢˜çš„ã€‚\né™æ€æ–‡ä»¶å¤„ç† asp.net core MVCä¸­çš„æ–‡ä»¶ç»“æ„å’Œasp.net mvcçš„æ–‡ä»¶ç»“æ„ç•¥æœ‰ä¸åŒã€‚\nasp.net core MVCåœ¨viewä¸­â€œIMG/Little/PaleGreen.pngâ€å¯¹åº”çš„æ–‡ä»¶å¯¹åº”äºâ€œé¡¹ç›®è·¯å¾„/webroot/IMG/Little/PaleGreen.pngâ€ï¼›\nè€Œasp.net mvcä¸­ï¼Œå¯¹åº”è·¯å¾„ä¸ºâ€œé¡¹ç›®/IMG/Little/PaleGreen.pngâ€ã€‚\nå› è€Œï¼Œæˆ‘ä»¬çš„æ‰€æœ‰é™æ€æ–‡ä»¶éƒ½åº”è¯¥æ”¾åˆ°ï¼šwebrootæ–‡ä»¶å¤¹ä¸‹ã€‚\nä¸Šé¢çš„éƒ½åšå®Œäº†ä¹‹åï¼Œé¡¹ç›®ç»“æ„å¦‚ä¸‹ï¼š\næ¥ä¸‹æ¥å°±æ˜¯æ”¹ä»£ç äº†ã€‚\nä»£ç è¿ç§» Startup.csæ·»åŠ MVC 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 public class Startup { // This method gets called by the runtime. Use this method to add services to the container. // For more information on how to configure your application, visit http://go.microsoft.com/fwlink/?LinkID=398940 public void ConfigureServices(IServiceCollection services) { //æ·»åŠ MVCæ¡†æ¶ services.AddMvc(); } // This method gets called by the runtime. Use this method to configure the HTTP request pipeline. public void Configure(IApplicationBuilder app, IHostingEnvironment env, ILoggerFactory loggerFactory) { loggerFactory.AddConsole(); if (env.IsDevelopment()) { app.UseDeveloperExceptionPage(); } //å¯ç”¨é™æ€æ–‡ä»¶ä¸­é—´ä»¶ app.UseStaticFiles(); //å¯åŠ¨MVCè·¯ç”± app.UseMvcWithDefaultRoute(); //è®¾ç½®é»˜è®¤é¡µé¢ app.UseMvc(routes =\u0026gt; { routes.MapRoute( name: \u0026#34;default\u0026#34;, template: \u0026#34;{controller=House}/{action=Index}/{id?}\u0026#34;); }); } } æ”¹å†™GetHTMLByURLæ–¹æ³• ä¹‹å‰çš„æ–¹æ³•ï¼š\n.net coreé‡å†™äº†HttpWebRequestï¼Œå˜æˆäº†WebRequest,æ‰€ä»¥ä¸Šé¢çš„ä»£ç åºŸäº†ã€‚\né‡å†™å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 public static string GetHTMLByURL(string Url, string type = \u0026#34;UTF-8\u0026#34;) { try { Url = Url.ToLower(); System.Net.WebRequest wReq = System.Net.WebRequest.Create(Url); // Get the response instance. System.Net.WebResponse wResp = wReq.GetResponseAsync().Result; System.IO.Stream respStream = wResp.GetResponseStream(); using (System.IO.StreamReader reader = new System.IO. StreamReader(respStream, Encoding.GetEncoding(type))) { return reader.ReadToEnd(); } } catch (System.Exception ex) { return string.Empty; } } æ”¹å†™Controllerä»£ç  å—¯ï¼Œæ¢äº†å‘½åç©ºé—´ï¼Œåˆ«çš„ä¸€å¥éƒ½æ²¡æ”¹ç›´æ¥æ‹‰è¿‡æ¥äº†\u0026hellip;ç•¥è¿‡ã€‚\nå‘å¸ƒåˆ°ubuntu Install for Ubuntu 14.04, 16.04 \u0026amp; Linux Mint 17\nç¬¬ä¸€æ­¥\n1 2 3 4 5 6 7 8 9 10 //Ubuntu 14.04 / Linux Mint 17 sudo sh -c \u0026#39;echo \u0026#34;deb [arch=amd64] https://apt-mo.trafficmanager.net/repos/dotnet-release/ trusty main\u0026#34; \u0026gt; /etc/apt/sources.list.d/dotnetdev.list\u0026#39; sudo apt-key adv --keyserver apt-mo.trafficmanager.net --recv-keys 417A0893 sudo apt-get update //Ubuntu 16.04 sudo sh -c \u0026#39;echo \u0026#34;deb [arch=amd64] https://apt-mo.trafficmanager.net/repos/dotnet-release/ xenial main\u0026#34; \u0026gt; /etc/apt/sources.list.d/dotnetdev.list\u0026#39; sudo apt-key adv --keyserver apt-mo.trafficmanager.net --recv-keys 417A0893 sudo apt-get update ç¬¬äºŒæ­¥\n1 sudo apt-get install dotnet-dev-1.0.0-preview2-003131 å®‰è£…å¥½äº†ä¹‹åï¼Œè¾“å…¥ dotnet -v åº”è¯¥èƒ½çœ‹åˆ°ç‰ˆæœ¬ä¿¡æ¯ï¼Œå¦‚ä¸‹å›¾ï¼š\nè¿™æ ·çš„ä¸‹ï¼Œä¸€å¥å®Œæˆäº†ubuntu è¿è¡Œasp.net coreçš„ç¯å¢ƒæ­å»ºäº†ã€‚\nproject.jsoné‡Œé¢éšè—çš„å‘ dependencies NET Core 1.0.1 - VS 2015 Tooling Preview 2æ¨¡æ¿çš„asp.net core ç‰ˆæœ¬å’Œubuntu çš„asp.net core ç‰ˆæœ¬ä¸ä¸€è‡´ã€‚\næ ¹æ®å¾®è½¯çˆ¸ç»™çš„æ•™ç¨‹ï¼Œæˆ‘ä»¬åœ¨ubuntuä¸Šå®‰è£…çš„.NET Core 1.0.0ï¼Œè§ä¸Šå›¾ã€‚\nç„¶è€Œæˆ‘ä»¬åˆ›å»ºé¡¹ç›®çš„æ¨¡æ¿æ˜¯.NET Core 1.0.1ï¼Œè§ä¸‹å›¾:\næ€ä¹ˆåŠï¼Ÿè¦ä¸å‡çº§ubuntuçš„asp.net coreï¼Œè¦ä¸é™çº§ã€‚\nç”±äºæ²¡æ‰¾åˆ°.NET Core 1.0.1 ubuntuçš„å®‰è£…åŒ…ï¼Œæ‰€ä»¥æˆ‘é€‰æ‹©äº†é™çº§åˆ°.NET Core 1.0.0.\nå…¶ä¸­éœ€è¦æŠŠMicrosoft.NETCore.App version ã€Microsoft.AspNetCore.Server.Kestrelã€Microsoft.AspNetCore.Mvc è¿™ä¸‰ä¸ªèŠ‚ç‚¹éƒ½æ”¹æˆâ€œ1.0.0â€ã€‚å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 \u0026#34;dependencies\u0026#34;: { \u0026#34;Microsoft.NETCore.App\u0026#34;: { \u0026#34;version\u0026#34;: \u0026#34;1.0.1\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;platform\u0026#34; }, \u0026#34;Microsoft.AspNetCore.Diagnostics\u0026#34;: \u0026#34;1.0.0\u0026#34;, \u0026#34;Microsoft.AspNetCore.Server.IISIntegration\u0026#34;: \u0026#34;1.0.0\u0026#34;, \u0026#34;Microsoft.AspNetCore.Server.Kestrel\u0026#34;: \u0026#34;1.0.1\u0026#34;, \u0026#34;Microsoft.Extensions.Logging.Console\u0026#34;: \u0026#34;1.0.0\u0026#34;, \u0026#34;Microsoft.AspNetCore.Mvc\u0026#34;: \u0026#34;1.0.1\u0026#34;, \u0026#34;Microsoft.AspNetCore.StaticFiles\u0026#34;: \u0026#34;1.0.0\u0026#34;, \u0026#34;Newtonsoft.Json\u0026#34;: \u0026#34;9.0.1\u0026#34;, \u0026#34;AngleSharp\u0026#34;: \u0026#34;0.9.8.1\u0026#34; }, publishOptions å‘å¸ƒè¾“å‡ºåŒ…æ‹¬Viewsæ–‡ä»¶å¤¹\n1 2 3 4 5 6 7 \u0026#34;publishOptions\u0026#34;: { \u0026#34;include\u0026#34;: [ \u0026#34;wwwroot\u0026#34;, \u0026#34;web.config\u0026#34;, \u0026#34;Views\u0026#34; ] }, runtimes runtimes é…ç½®ä¸ºæ¨¡æ¿è¿è¡Œå¹³å°ã€‚ è¯¦ç»†è§é“¾æ¥ï¼šhttps://docs.nuget.org/ndocs/schema/project.json\n1 \u0026#34;runtimes\u0026#34;: { \u0026#34;ubuntu.14.04-x64\u0026#34;: {} } ä¸Šé¢éƒ½å¼„å¥½ä¹‹åï¼Œè·‘ä¸€ä¸‹çœ‹,å¦‚ä¸‹å›¾ï¼š\n1 2 3 dotnet restore dotnet run æ¥ä¸ªè¯·æ±‚çœ‹çœ‹ï¼š\njexusè½¬å‘/åå‘ä»£ç† ASP.NET Core \u0026ldquo;å®Œæ•´å‘å¸ƒ,è‡ªå¸¦è¿è¡Œæ—¶\u0026rdquo; åˆ°jexus\n","date":"2016-10-04T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/58housesearch%E9%A1%B9%E7%9B%AE%E8%BF%81%E7%A7%BB%E5%88%B0asp.net-core/","title":"58HouseSearché¡¹ç›®è¿ç§»åˆ°asp.net core"},{"content":"58åŒåŸé«˜å¾·æœæˆ¿é¡¹ç›®JSç›¸å…³çŸ¥è¯† åœ¨çº¿åœ°å€ï¼š58åŒåŸå“ç‰Œå…¬å¯“é«˜å¾·æœæˆ¿\nGithubåœ°å€ï¼šhttps://github.com/liguobao/58HouseSearch\nçŸ¥ä¹ä¸“æ (ç‚¹èµç”¨çš„)ï¼šé«˜å¾·API+Pythonè§£å†³ç§Ÿæˆ¿é—®é¢˜(.NETç‰ˆ)\nç»è¿‡äº†ä¸€ä¸ªæ˜ŸæœŸçš„ä¿®è¡¥è¡¥ï¼Œä»¥åŠå°ä¼™ä¼´é£é™©çš„ä»£ç ï¼Œæ•´ä¸ªé¡¹ç›®åŸºæœ¬å¤„äºåŸºæœ¬ç¨³å®šè¿è¡Œçš„çŠ¶æ€ã€‚\nåŒæ—¶åŠ å…¥äº†ä¸€ä¸‹æ–°åŠŸèƒ½ï¼š\nIPå®šä½ï¼šè°ƒç”¨é«˜å¾·åœ°å›¾IPå®šä½åŠŸèƒ½å®ç° ç§»åŠ¨åœ°å›¾ä¸­å¿ƒå®šä½ï¼šè°ƒç”¨é«˜å¾·åœ°å›¾ç§»åŠ¨åœ°å›¾å®šä½å®ç° å®šä½åŸå¸‚åè½¬58åŒåŸåŸå¸‚åä»¥è·å¾—å‡†ç¡®58åŒåŸåŸå¸‚åŸŸåï¼šæŠ“å–58åŒåŸåŸå¸‚åˆ†ç±»ä¿¡æ¯ ä¼˜åŒ–æ•°æ®æºã€å»é™¤å¹¿å‘Šæ•°æ®ï¼šå°ä¼™ä¼´å¥‰çŒ®ä»£ç  ä»Šå¤©ä¸»è¦ç®€å•è®²è§£ä¸€ä¸‹å…¶ä¸­ä½¿ç”¨çš„ä¸€äº›é«˜å¾·åœ°å›¾APIæ¥å£ã€‚\né«˜å¾·åœ°å›¾JavaScript API ä¸»ä½“ä¸ºmapå¯¹è±¡ï¼ŒåŸºæœ¬æ‰€æœ‰çš„æ“ä½œéƒ½æ˜¯é€šè¿‡mapå¯¹è±¡æ¥å®ç°çš„ã€‚ mapå¯¹è±¡å®ä¾‹åŒ–æ˜¯é€šè¿‡ Amapç±»æ¥åšçš„ã€‚å¦‚ä»¥ä¸‹ä»£ç ï¼š\n1 2 3 4 5 6 map = new AMap.Map(\u0026#34;container\u0026#34;, { resizeEnable: true, zoomEnable: true, center: [121.297428, 31.1345],//ç»çº¬åº¦ï¼Œæ­¤å¤„ä¸ºä¸Šæµ· zoom: 11 }); IPå®šä½ è°ƒç”¨Map.CitySearch()è·å¾—å½“å‰IPæ‰€åœ¨åŸå¸‚ï¼Œç›´æ¥å°†åœ°å›¾æ˜¾ç¤ºæˆå½“å‰åŸå¸‚ã€‚ä»£ç å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 function showCityInfo(map) { //å®ä¾‹åŒ–åŸå¸‚æŸ¥è¯¢ç±» var citysearch = new AMap.CitySearch(); //è‡ªåŠ¨è·å–ç”¨æˆ·IPï¼Œè¿”å›å½“å‰åŸå¸‚ citysearch.getLocalCity(function (status, result) { if (status === \u0026#39;complete\u0026#39; \u0026amp;\u0026amp; result.info === \u0026#39;OK\u0026#39;) { if (result \u0026amp;\u0026amp; result.city \u0026amp;\u0026amp; result.bounds) { var cityinfo = result.city;//è·å¾—XXå¸‚ var citybounds = result.bounds;//ç”¨äºè®¾ç½®åœ°å›¾æ˜¾ç¤ºä½ç½®çš„å®ä¾‹ cityName = cityinfo.substring(0, cityinfo.length - 1);//å»æ‰å¸‚è¿™ä¸ªå­— ConvertCityCNNameToShortCut();//åŸå¸‚åè½¬æ¢æˆ58åŒåŸåŸå¸‚åŸŸåå­—æ¯ï¼Œå¦‚ä¸Šæµ·-\u0026gt;sh,è‹å·-\u0026gt;su, //ä¸‹é¢ä¼šæœ‰å®ç°ä»£ç  document.getElementById(\u0026#39;IPLocation\u0026#39;).innerHTML = \u0026#39;æ‚¨å½“å‰æ‰€åœ¨åŸå¸‚ï¼š\u0026#39; + cityName; //åœ°å›¾æ˜¾ç¤ºå½“å‰åŸå¸‚ map.setBounds(citybounds); } } else { document.getElementById(\u0026#39;IPLocation\u0026#39;).innerHTML = result.info; } }); } ç§»åŠ¨åœ°å›¾è‡ªåŠ¨ä¸­å¿ƒå®šä½ ä¹‹å‰æœ‰ä¸€ç‰ˆæ˜¯è®©ç”¨æˆ·è¾“å…¥åŸå¸‚åï¼Œç„¶åç›´æ¥å®šä½åˆ°è¾“å…¥çš„åŸå¸‚çš„ã€‚ è¿™ä¸ªåŠŸèƒ½å¡åœ¨äº†è®¾ç½®åœ°å›¾æ˜¾ç¤ºä½ç½®ä¸Šï¼Œå¦‚æœæ˜¯ä½¿ç”¨é«˜å¾·åœ°å›¾æä¾›çš„æœç´¢æ§ä»¶çš„è¯ï¼Œåˆå­˜åœ¨è¾“å…¥ç»“æœä¹‹åæœç´¢ç»“æœå¯èƒ½æ˜¯å¤šä¸ªçš„é—®é¢˜ã€‚è€Œä¸”è¿™ç‚¹æˆ‘åªæ˜¯è¦å–åˆ°ç”¨æˆ·æƒ³è¦å®šä½çš„åŸå¸‚è€Œå·²ï¼Œæ„Ÿè§‰æ²¡å¿…è¦åšå¾—å¤ªå¤æ‚ã€‚ æ˜¨æ™šåœ¨çœ‹é«˜å¾·åœ°å›¾APIçš„æ—¶å€™å‘ç°ï¼Œæœ‰ä¸€ä¸ªç§»åŠ¨åœ°å›¾è·å¾—åœ°å›¾ä¸­å¿ƒæ‰€åœ¨ä½ç½®çš„æ ·ä¾‹ï¼Œé©¬ä¸Šçœ¼å‰ä¸€äº®äº†ã€‚è¿™ä¸ªåŠŸèƒ½æ¯”æˆ‘æƒ³è¦çš„è¿˜è¦å¥½\u0026hellip;æœæ–­ä¸Šã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 function MapMoveToLocationCity() { map.on(\u0026#39;moveend\u0026#39;, getCity); function getCity() { map.getCity(function (data) { if (data[\u0026#39;province\u0026#39;] \u0026amp;\u0026amp; typeof data[\u0026#39;province\u0026#39;] === \u0026#39;string\u0026#39;) { var cityinfo = (data[\u0026#39;city\u0026#39;] || data[\u0026#39;province\u0026#39;]); cityName = cityinfo.substring(0, cityinfo.length - 1); ConvertCityCNNameToShortCut();//åŸå¸‚åè½¬58åŒåŸåœ°åŒºåŸŸå document.getElementById(\u0026#39;IPLocation\u0026#39;).innerHTML = \u0026#39;åœ°å›¾ä¸­å¿ƒæ‰€åœ¨åŸå¸‚ï¼š\u0026#39; + cityName; } }); } } æ•´ä¸ªä»£ç çš„æ„æ€æ˜¯ï¼Œç»™mapç»‘å®šä¸€ä¸‹ç§»åŠ¨æ—¶é—´ï¼Œç§»åŠ¨å®Œäº†ä¹‹åï¼Œè°ƒç”¨getCityçš„æ–¹æ³•è·å–å½“å‰åœ°å›¾ä¸­å¿ƒæ‰€åœ¨åŸå¸‚ä¿¡æ¯ã€‚\nè¿™ä¸ªæ—¶å€™è¦æ³¨æ„ï¼ŒåŸå¸‚åå¯èƒ½åœ¨cityå¯¹è±¡é‡Œé¢ï¼Œä¹Ÿå¯èƒ½åœ¨provinceé‡Œé¢ã€‚\nåŸå› å¾ˆç®€å•ï¼šæ™®é€šåŸå¸‚ç­‰çº§å°±æ˜¯åŸå¸‚ï¼Œæˆ‘å›½è¿˜å­˜åœ¨ä¸€ä¸ªå’Œçœä»½ä¸€ä¸ªç­‰çº§çš„åŸå¸‚ï¼šç›´è¾–å¸‚ã€‚å› æ­¤ç›´è¾–å¸‚çš„åŸå¸‚åæ˜¯åœ¨provinceé‡Œé¢çš„ã€‚\nåŸå¸‚ååŒ¹é…58åŒåŸåœ°åŒºåŸŸå è¿™ä¸ªæ˜¯ä¸Šä¸ªç‰ˆæœ¬(ä¸¤ä¸‰å¤©å‰)çš„ä¸€ä¸ªbugå¼•å‡ºæ¥çš„æ–°åŠŸèƒ½ã€‚\nä¸Šä¸ªç‰ˆæœ¬æ˜¯è®©ç”¨æˆ·è¾“å…¥åŸå¸‚åï¼Œç„¶åæå–åŸå¸‚åçš„ä¸­æ–‡æ‹¼éŸ³é¦–å­—æ¯ä½œä¸º58åŒåŸåœ°åŒºåŸŸåã€‚å¦‚ä¸Šæµ· =shï¼Œå¹¿å·=gzï¼ŒåŒ—äº¬=bjï¼Œæˆéƒ½=cdã€‚\nè¿™ä¸ªåŠŸèƒ½ä½¿ç”¨çš„æ˜¯ç½‘ä¸Šåˆ«äººå†™çš„ä¸€ä¸ªJSåº“ï¼Œé€šè¿‡æ±‰å­—åŒ¹é…å®ç°çš„ã€‚è½¬æ¢å‡ºæ¥çš„æ•°æ®æ²¡ä»€ä¹ˆé—®é¢˜ï¼Œä¸è¿‡æˆ‘å›½æ±‰å­—å®åœ¨å¥¥å¦™ã€‚\nå¹¿å·=gzï¼Œèµ£å·=gzï¼› é‚å®=snï¼›ç»¥å®=snï¼› æƒ å·=hzï¼Œæ­å·=hzã€‚\nè¿™æ ·ä¸€æ¥ï¼Œä¸Šé¢è¿™ä¸ªåšæ³•å°±æ²¡æ³•ç©äº†ã€‚\næƒ³äº†ä¸‹æ€ä¹ˆè§£å†³è¿™ä¸ªé—®é¢˜ï¼Œçµæœºä¸€åŠ¨ã€‚åæ­£æ˜¯åœ¨çˆ¬58çš„æ•°æ®ï¼Œè¿™ä¸ªåŸå¸‚åå’ŒåŸå¸‚åŸŸåæ•°æ®58åŒåŸè‚¯å®šæœ‰å•Šï¼Œç„¶åæ‰¾åˆ°äº†è¿™ä¸ªã€‚ 58åŒåŸåŸå¸‚åˆ†ç±»å¯¼èˆª\nå¾ˆæ˜æ˜¾ï¼Œæˆ‘è¦çš„æ‰€æœ‰åŸå¸‚åå’ŒåŸå¸‚åŸŸåéƒ½æ˜¯é‡Œé¢äº†ã€‚\næ™šä¸Šå’Œè¡£è¡£è¯´äº†ä¸‹ï¼Œè¡£è¡£ä¸€å¤§æ—©å°±æŠŠå¤„ç†å¥½çš„jsonæ•°æ®ç»™æˆ‘äº†ã€‚\näºæ˜¯æ¥äº†ä¸‹é¢ä¸€æ®µä»£ç ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 //åŠ è½½jsonæ–‡ä»¶ $.getJSON(\u0026#34;DomainJS/city.json\u0026#34;, function (data) { allCityInfo = data; }); function ConvertCityCNNameToShortCut() { var filterarray = $.grep(allCityInfo, function (obj) { return obj.cityName == cityName; });//æ‰¾åˆ°å½“å‰åŸå¸‚åå¯¹åº”çš„jsonå¯¹è±¡ //è·å–jsonå¯¹è±¡çš„åœ°åŒºåŸŸå cityNameCNPY = filterarray instanceof Array ? filterarray[0].shortCut : filterarray != null ? filterarray.shortCut : \u0026#34;\u0026#34;; } é«˜å¾·åœ°å›¾è‡ªåŠ¨è¡¥å…¨åŠŸèƒ½ 1 2 3 \u0026lt;div class=\u0026#34;control-input\u0026#34;\u0026gt; \u0026lt;input id=\u0026#34;work-location\u0026#34; type=\u0026#34;text\u0026#34; style=\u0026#34;width:60%\u0026#34;\u0026gt; \u0026lt;/div\u0026gt; 1 2 3 4 5 var auto = new AMap.Autocomplete({ input: \u0026#34;work-location\u0026#34; }); AMap.event.addListener(auto, \u0026#34;select\u0026#34;, workLocationSelected); çœ‹æ–¹æ³•å‰é¢ä¹ŸçŸ¥é“ï¼Œå…¶å®è¿™å°±æ˜¯æŠŠIDä¸ºwork-locationçš„inputåˆå§‹åŒ–ä¸ºåœ°å›¾æ’ä»¶ï¼Œç„¶åç»™Amapå¢åŠ äº†ä¸€ä¸ªç›‘å¬äº‹ä»¶ã€‚ å½“å…¶ä¸­é€‰ä¸­æŸä¸€ä¸ªæ•°æ®çš„æ—¶å€™ï¼Œè§¦å‘workLocationSelectedå‡½æ•°ã€‚æ•ˆæœå¦‚ä¸‹ï¼š\nåœ¨è¿™é‡ŒlocationSelectedæ˜¯å®šä½åˆ°æ‰€é€‰ä½ç½®ï¼Œä»£ç å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 function workLocationSelected(e) { workAddress = e.poi.name; loadWorkLocation(); } function loadWorkLocation() { delWorkLocation(); var geocoder = new AMap.Geocoder({ city: cityName, radius: 1000 }); geocoder.getLocation(workAddress, function (status, result) { if (status === \u0026#34;complete\u0026#34; \u0026amp;\u0026amp; result.info === \u0026#39;OK\u0026#39;) { var geocode = result.geocodes[0]; x = geocode.location.getLng(); y = geocode.location.getLat(); loadWorkMarker(x, y); loadWorkRange(x, y, 60, \u0026#34;#3f67a5\u0026#34;, vehicle); map.setZoomAndCenter(12, [x, y]); } }) } è‡³äºå¯¼èˆªåŠŸèƒ½ä»£ç æˆ‘æ²¡æ€ä¹ˆåŠ¨ï¼Œæ²¡å»ç ”ç©¶å°±ä¸çŒ®ä¸‘äº†\u0026hellip;\næœ€åæ¥ä¸ªæ•ˆæœå›¾ã€‚\nåŒ—äº¬ æˆéƒ½ è‹å· æ·±åœ³ ","date":"2016-10-04T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/58%E5%90%8C%E5%9F%8E%E9%AB%98%E5%BE%B7%E6%90%9C%E6%88%BF%E9%A1%B9%E7%9B%AEjs%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86/","title":"58åŒåŸé«˜å¾·æœæˆ¿é¡¹ç›®JSç›¸å…³çŸ¥è¯†"},{"content":"åœ¨å¤§ç¥çš„å¸¦é¢†ä¸‹ä½“éªŒäº†ä¸€ä¸‹asp.net coreï¼Œæ„Ÿè§‰å¾ˆä¸é”™ï¼Œç®€å•å†™ä¸ªæ‰‹æŠŠæ‰‹æ•™ç¨‹ã€‚\nç¯å¢ƒè¦æ±‚ï¼šVS2015 update2ï¼Œç‰ˆæœ¬ä¸é™ã€‚\né¦–å…ˆåˆ°è¿™é‡Œï¼šhttps://www.microsoft.com/net/download\nä¸‹è½½.NET Core Install å’ŒSDK Installã€‚\nå¦‚ä¸‹å›¾ï¼š æ¥ç€æ— è„‘å®‰è£…ã€‚ ä¸¤ä¸ªéƒ½è£…å®Œä¹‹åç¯å¢ƒå·²ç»æ­å¥½äº†ã€‚ä¸è¿‡åœ¨VSä¸­è¿˜æ²¡å¯¹åº”çš„.NET Coreæ¨¡æ¿ã€‚ æˆ‘ä»¬è¿˜éœ€è¦å»ä¸‹è½½ä¸€ä¸ª .NET Core Tooling Preview 1 for Visual Studio 2015\nè¿™ä¸ªå®‰è£…ç•¥æ…¢ï¼Œç¨ç­‰ã€‚\nä¸Šé¢çš„éƒ½å®‰è£…å¥½äº†ä¹‹åï¼Œæ‰“å¼€VSï¼Œæ–°å»ºé¡¹ç›®ï¼Œé€‰ä¸­webï¼Œå³å¯çœ‹åˆ°asp.net core. å¦‚ä¸‹å›¾ï¼š å®Œäº‹\u0026hellip;. ä¸‹æ¬¡å†æ¥èŠasp.net coreé¡¹ç›®\u0026hellip;\n","date":"2016-10-04T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/asp.net-core-%E5%88%9D%E4%BD%93%E9%AA%8C/","title":"ASP.NET core åˆä½“éªŒ"},{"content":"åœ¨ASP.NET æ—¶ä»£ï¼Œä¸€èˆ¬æ¥è¯´æˆ‘ä»¬å¾ˆå°‘ä¼šç”¨åˆ°HttpModule/HttpHandlerï¼Œç„¶è€Œæœ‰äº›åœºæ™¯æˆ‘ä»¬ä½¿ç”¨HttpModule/HttpHandlerå€’æ–¹ä¾¿å¿«æ·å®Œæˆæˆ‘ä»¬çš„éœ€æ±‚ã€‚æœ‰å…´è¶£äº†è§£HttpModule/HttpHandlerä»¥åŠä½¿ç”¨åœºæ™¯çš„è¯ï¼Œå¯ä»¥çœ‹ä¸‹é¢è¿™ä¸ªé“¾æ¥çš„å†…å®¹ã€‚\né€‰æ‹©HttpHandlerè¿˜æ˜¯HttpModuleï¼Ÿ\næ¥åˆ°ASP.NET Coreæ—¶ä»£ï¼Œç±»ä¼¼åŠŸèƒ½çš„å†…å®¹å¯èƒ½æˆ‘ä»¬çœ‹å¾—å°±è¦å¤šå¾—å¤šäº†ã€‚å› ä¸ºåœ¨ASP.NET Coreæ—¶ä»£ï¼Œå¾®è½¯å°†HttpModuleâ€œå˜æ›´â€ä¹‹åï¼Œå¹¶ä¸ºå®ƒæˆäºˆäº†æ›´çµæ´»åº”ç”¨åœºæ™¯ã€‚\nè¿™å°±æ˜¯è¿™ä¸ªæ–‡ç« è¦ä»‹ç»çš„ä¸»è§’ï¼šMiddlewareï¼ˆä¸­é—´ä»¶ï¼‰ã€‚ Middleware ä¸ºäº†ä½¿ç”¨è·¨å¹³å°ï¼ŒASP.NET Coreæ•´ä¸ªæ¶æ„å’Œä»£ç éƒ½é‡å†™äº†ä¸€éï¼Œæ‰€ä»¥ HttpModule è‡ªç„¶ä¹Ÿå°±ä¸å­˜åœ¨äº†ã€‚ä½†æ˜¯ç›¸ä¼¼çš„åŠŸèƒ½è¿˜æ˜¯æœ‰çš„ï¼Œå®ƒçš„åå­—å«ï¼š Middlewareã€‚å’Œä»¥å‰ä¸åŒï¼Œåœ¨ASP.NET Coreä¸­æˆ‘ä»¬å°†ä¼šç»å¸¸çœ‹åˆ° Middlewareçš„å­˜åœ¨ï¼Œå› ä¸ºç°åœ¨çš„æ¯ä¸€ä¸ªæœåŠ¡éƒ½æ˜¯ç”¨Middlewareçš„æ–¹å¼å‘ˆç°åœ¨ASP.NET Core ç®¡é“ä¸­ã€‚ä¸ä»…å¦‚æ­¤ï¼Œmeddlewareæ¯”èµ·ä¹‹å‰çš„HttpModuleä¹Ÿæ›´å¼¹æ€§æ˜“ç”¨äº†ã€‚\né¦–å…ˆå…ˆæ¥çœ‹çœ‹ä»€ä¹ˆæ˜¯middlewareã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 public void Configure(IApplicationBuilder app, IHostingEnvironment env, ILoggerFactory loggerFactory) { loggerFactory.AddConsole(Configuration.GetSection(\u0026#34;Logging\u0026#34;)); loggerFactory.AddDebug(); app.UseStaticFiles(); app.UseMvc(routes =\u0026gt; { routes.MapRoute(\u0026#34;default\u0026#34;, \u0026#34;{controller=Home}/{action=Index}/{id?}\u0026#34;); }); } çœ‹è¿‡ASP.NET Coreé¡¹ç›®çš„è¯ï¼Œç›¸ä¿¡å¤§å®¶å¯¹Satarup.cså¹¶ä¸ä¼šé™Œç”Ÿã€‚åœ¨Starup.csé‡Œé¢ä¾¿æœ‰ä¸€ä¸ªConfigure()å‡½æ•°ç”¨äºå®šä¹‰é¡¹ç›®éœ€è¦ä½¿ç”¨å“ªäº›middlewareã€‚\nä¸Šé¢çš„ä¾‹å­ä½¿ç”¨äº†ä¸¤ä¸ªmiddlewareï¼Œä¸€ä¸ªæ˜¯ UseStaticFilesï¼Œå¦ä¸€ä¸ªæ˜¯ UseMvcã€‚è¿™ä¸¤ä¸ªéƒ½æ˜¯coreè‡ªå¸¦çš„middlewareï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚UseStaticFiles æ˜¯ä¸ºHTTP Requestæä¾›å­˜å–ç½‘ç«™çš„æ–‡ä»¶ï¼Œç®€å•ç†è§£å°±æ˜¯ä½¿å¾—ç½‘ç«™ä¸Šçš„é™æ€æ–‡ä»¶å¯è®¿é—®ï¼Œè€ŒUseMvcå°±æ˜¯å¯ç”¨MVC routingæœºåˆ¶ã€‚æœ‰äº†è¿™ä¸¤ä¸ªmiddlewareï¼Œæˆ‘ä»¬çš„çš„ç½‘ç«™å°±æœ‰äº†MVC routingå’Œè¯»å–é™æ€æ–‡ä»¶çš„åŠŸèƒ½ã€‚\nå¦‚æœæˆ‘ä»¬æŠŠUseMvcå»æ‰ï¼Œé‚£ä¹ˆMVC routingä¹Ÿå°±ä¸å­˜åœ¨äº†ï¼Œæˆ‘ä»¬è¾“å…¥ http://website/[Controller]/[Action] ç±»ä¼¼çš„åœ°å€ä¹Ÿå°±æ— æ•ˆäº†ã€‚\nå’ŒHttpModuleçš„ä¸åŒä¹‹å¤„ åœ¨ä½¿ç”¨HttpModuleçš„æ—¶å€™ï¼Œæˆ‘ä»¬æ˜¯åœ¨å®ç°/é‡å†™æ¥å£ï¼Œè¿™ä¸ªæ—¶å€™å°±è¦æ±‚æˆ‘ä»¬åœ¨é€‚å½“çš„åœ°æ–¹åšé€‚å½“çš„äº‹æƒ…ã€‚ä¾‹å¦‚ï¼Œè¦åš authorization çš„è¯å°±æœ€å¥½åœ¨ HttpModule å®šä¹‰å¥½çš„ Authorization äº‹ä»¶ (AuthorizatRequest) ä¸­å®Œæˆè¿™ä¸ªåŠŸèƒ½ã€‚åœ¨ ASP.NET life cycle çš„æ–‡ä»¶é‡Œæˆ‘ä»¬å¯ä»¥æŸ¥åˆ° HttpModule å®šä¹‰äº†é‚£äº›äº‹ä»¶ï¼Œæ¯ä¸€å€‹äº‹ä»¶éƒ½æœ‰å“ªäº›ç‰¹åˆ¥çš„åŠŸèƒ½ã€‚å› æ­¤æˆ‘ä»¬éœ€è¦å…¨é¢äº†è§£ä¹‹åå†æ¥é€‰æ‹©å®ç°/é‡å†™æˆ‘ä»¬éœ€è¦çš„äº‹ä»¶ã€‚è€Œåœ¨Middlewareä¸­ï¼Œå®Œå…¨æ²¡æœ‰è¿™æ ·çš„é™åˆ¶ï¼Œä¹Ÿä¸å­˜åœ¨è¿™æ ·çš„äº‹ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªè¡Œè®¾è®¡å®ç°æˆ‘ä»¬çš„æœºåˆ¶ã€‚\nMiddleware æµç¨‹ https://docs.asp.net/en/latest/fundamentals/middleware.html è¿™ä¸ªæ–‡ç« ä¸­è¯´æ˜äº†åŸºæœ¬çš„middlewareæ¦‚å¿µã€‚ç›®å‰asp.net docsé‡Œé¢æœ‰ä¸å°‘çš„å†…å®¹éƒ½æ˜¯å¼€æºç¤¾åŒºå¼€å‘è€…è´¡çŒ®çš„\nåœ¨è¿™ä¸ªæ–‡ç« é‡Œé¢æœ‰ä¸€ä¸ªç®€å•çš„æµç¨‹å›¾è¯´æ˜äº†ASP.NET runtimeä¸­middlewareçš„æ‰§è¡Œè¿‡ç¨‹ã€‚\nåœ¨ middleware é‡Œé¢ä¸€å®šè¦å®šä¹‰ Invoke()å‡½æ•°ï¼Œå› ä¸ºè¿™æ˜¯è®© engine é»˜è®¤è°ƒç”¨ middleware çš„Incokeå‡½æ•°ã€‚Middleware é‡Œé¢æ‰€éœ€è¦åšä»€ä¹ˆäº‹æƒ…å°±æ”¾åœ¨ Invoke() é‡Œé¢ï¼ŒåŒæ—¶ Invoke() é‡Œé¢è¿˜éœ€è¦è°ƒç”¨ä¸‹ä¸€ä¸ª middlewareã€‚å› æ­¤æ‰§è¡Œå†…å®¹å°±å¦‚ä¸Šå›¾æ‰€ç¤ºã€‚Middleware ä¹‹é—´é™¤äº†å¿…é¡»ä¼ é€ HttpContextä¹‹å¤–ï¼Œä¹Ÿå¯ä»¥è‡ªå®šä¹‰ä¼ å…¥å…¶ä»–çš„å‚æ•°ï¼Œè¿™æ¯”ä»¥å‰çš„HttpModuleæ–¹ä¾¿å¤šäº†ã€‚\næ‰€ä»¥å½“ HTTP request è¿›æ¥ä¹‹åï¼Œengine ä¾¿ä¼šå‘¼å«ç¬¬ä¸€ä¸ª middleware çš„ Invoke()ï¼ŒåŒæ—¶æŠŠä¼ å…¥HttpContextï¼Œç„¶åç¬¬ä¸€ä¸ª middleware å¯ä»¥å†æ¥ç€å‘¼å«ç¬¬äºŒä¸ª middleware çš„ Invoke()ï¼ŒåŒæ—¶å†æŠŠ HttpContext ç»§ç»­ä¼ å…¥ï¼Œä¸€ç›´åˆ°æœ€åä¸€ä¸ªmiddleware çš„ Invoke() ç»“æŸä¹‹åï¼Œæ•´ä¸ª HttpContext çš„å…§å®¹å¯èƒ½åœ¨ middleware é‡Œé¢æ–°å¢æˆ–è¢«æ”¹å˜äº†ï¼Œæœ€åå†æŒ‰ç…§æ•´å€‹åŸå…ˆçš„ call stack ä»æœ€åä¸€ä¸ª middleware å›åˆ°ç¬¬ä¸€ä¸ª middlewareï¼Œå†é€šè¿‡ engine å›ä¼ åˆ°client ç«¯ï¼Œå®Œæˆrequest.\nä¸‹æ¥é€šè¿‡ä¸€ä¸ªä¾‹å­æˆ‘ä»¬ä¸€èµ·æ¥äº†è§£ä¸€ä¸‹Middlewareã€‚\nç¼–å†™ç®€å•çš„ Middleware 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 public class SampleMiddleware { private readonly RequestDelegate _next; public SampleMiddleware(RequestDelegate next) { _next = next; } public async Task Invoke(HttpContext context) { if (string.IsNullOrEmpty(context.User.Identity.Name)) { context.Response.Redirect(\u0026#34;/NoName.html\u0026#34;); return; } await _next.Invoke(context); } } è¿™ä¸€ä¸ªmiddlewareçš„åå­—å«SampleMiddlewareã€‚å®ƒæœ‰ä¸€ä¸ªæ„é€ å‡½æ•°ä»¥åŠInvokeå‡½æ•°ï¼Œè€ŒInvoke()åªæ¥æ”¶ä¸€ä¸ªå‚æ•°HttpContextã€‚\n_nextæ˜¯ä¸€ä¸ªå« RequestDelegateç±»å‹ï¼Œæ¢è¨€ä¹‹è¿™å°±æ˜¯ä¸€ä¸ªdelegateï¼Œç”¨äºä»£è¡¨ä¸‹ä¸€ä¸ªmiddlewareæ˜¯è°ã€‚æ‰€ä»¥åœ¨æ„é€ å‡½æ•°ä¸­è¦æŠŠä¸‹ä¸€ä¸ªmiddleware delegateä¼ å…¥ã€‚çœ‹åˆ°è¿™é‡Œæˆ–è®¸ä¼šè§‰å¾—å¥‡æ€ªï¼Œæˆ‘ä»¬çš„middlewareåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­æ€ä¹ˆä¼šçŸ¥é“ä¸‹ä¸€ä¸ªmiddlewareæ˜¯è°ï¼Ÿè¿™ä¸€éƒ¨åˆ†ç¨åè§£é‡Šã€‚\nåœ¨ Invoke() é‡Œé¢ï¼Œåœ¨ await _next.Invoke() ä¹‹å‰éƒ½æ˜¯å½“å‰middlewareçš„é€»è¾‘ä»£ç ï¼Œä»ä¸Šé¢æµç¨‹å›¾æ¥çœ‹çš„è¯å°±æ˜¯ç”±å·¦è‡ªå³çš„æ–¹å‘ï¼ await _next.Invoke() ä¹‹åçš„ä»£ç æ˜¯å°±æ˜¯æµç¨‹å›¾ä¸Šç”±å³è‡³å³çš„æ–¹å‘ï¼Œå› æ­¤ï¼Œé€éè¿™æ ·ç®€å•çš„è®¾è®¡ï¼Œå¼€å‘è€…å°±èƒ½å¾ˆæ˜ç¡®åœ°æ§åˆ¶ä»€ä¹ˆæ ·é€»è¾‘è¦å…ˆåšæˆ–ååšäº†ã€‚\nåœ¨ SampleMiddleware ä¹‹ä¸­ï¼Œè¿™é‡Œåªåšäº†ä¸€å€‹å¾ˆç®€å•çš„åŠ¨ä½œï¼Œå¦‚æœ username æ˜¯ç©ºç™½çš„è¯ï¼Œå°±å°†è¯¥è¿æ¥é‡å®šå‘åˆ°åˆ° NoName.html ç„¶åä¸­æ–­ middleware çš„æ‰§è¡Œã€‚\nä¸ºäº†èƒ½è®©è¿™ä¸ªmiddlewareä½œä¸º ApplicationBuilderæ¥ä½¿ç”¨ï¼Œæˆ‘ä»¬å¦å¤–éœ€è¦å†™ä¸€ä¸ªæ‰©å±•æ–¹æ³•ã€‚ä»£ç å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 public static partial class MiddlewareExtensions { public static IApplicationBuilder UseSampleMiddleware( this IApplicationBuilder builder) { return builder.UseMiddleware\u0026lt;SampleMiddleware\u0026gt;(); } } è¿™ç»™æ‰©å±•æ–¹æ³•å»ºç«‹äº†UseSampleMiddleware()ï¼Œä½¿å¾—æˆ‘ä»¬å¯ä»¥è®©ApplicationBuilder å»è¯» SampleMiddlewareã€‚\nè¿™æ˜¯å›åˆ°Startup.csä¸­ï¼Œåœ¨ Configure() é‡Œé¢æˆ‘ä»¬å°±å¯ä»¥æŠŠ SampleMiddleware åŠ å…¥åˆ°æˆ‘ä»¬çš„ pipelineä¸­äº†ã€‚å…·ä½“ä»£ç å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 public void Configure(IApplicationBuilder app,IHostingEnvironment env, ILoggerFactory loggerFactory) { loggerFactory.AddConsole(Configuration.GetSection(\u0026#34;Logging\u0026#34;)); loggerFactory.AddDebug(); app.UseStaticFiles(); app.UseSampleMiddleware(); // \u0026lt;-- SampleMiddleware app.UseMvc(routes =\u0026gt; { routes.MapRoute(\u0026#34;default\u0026#34;, \u0026#34;{controller=Home}/{action=Index}/{id?}\u0026#34;); }); } æŠŠ SampleMiddleware æ”¾åœ¨ UseStaticFiles å’Œ UseMvc ä¹‹é—´ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨ http request è¿˜æ²’è¿›å…¥åˆ° MVC routing ä¹‹å‰ï¼Œå°±ä¼šå…ˆæ£€æŸ¥ HttpContext é‡Œé¢æ˜¯ä¸æ˜¯æœ‰ç©ºç™½çš„ usernameã€‚å¾ˆæ˜¾ç„¶usernameè‚¯å®šæ˜¯ç©ºç™½çš„ï¼Œå› ä¸ºæˆ‘å¹¶æ²’æœ‰åŠ å…¥ä»»ä½•ä½¿ç”¨è€…éªŒè¯ä»£ç è¿™é‡Œé¢ï¼Œæ‰€ä»¥åˆ©ç”¨ dotnet run ä¾†è¿è¡Œè¿™ä¸ªé¡¹ç›®çš„æ—¶å€™ï¼Œä½ å°±ä¼šçœ‹åˆ° Http code 302 å‡ºç¾ï¼Œå®ƒçš„æ„æ€å°±æ˜¯ http redirectï¼Œä¹Ÿå°±æ˜¯ SampleMiddleware é‡Œé¢é¢æ‰€åšçš„ redirect å‘ç”Ÿä½œç”¨äº†ã€‚\nMiddleware çš„æ‰§è¡Œé¡ºåºå¾ˆé‡è¦ å‰é¢è§£é‡Šäº† middleware æ‰§è¡Œè¿‡ç¨‹æ˜¯ä¸€ä¸ªæ¥ç€ä¸€ä¸ªçš„ï¼ä¸åŒçš„ middleware å¯¹ HttpContext çš„å…§å®¹éƒ½å¯èƒ½æœ‰ä¸åŒçš„å¤„ç†æˆ–æ›´æ”¹ï¼Œå› æ­¤æ‰§è¡Œèˆ’æœä¾¿æ ¼å¤–é‡è¦ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœå°†ä¸Šé¢ Configure() çš„ä»£ç å˜æ›´å¦‚ä¸‹:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 public void Configure(IApplicationBuilder app, IHostingEnvironment env, ILoggerFactory loggerFactory) { loggerFactory.AddConsole(Configuration.GetSection(\u0026#34;Logging\u0026#34;)); loggerFactory.AddDebug(); app.UseSampleMiddleware(); // SampleMiddleware app.UseStaticFiles(); // StaticFiles app.UseMvc(routes =\u0026gt; { routes.MapRoute(\u0026#34;default\u0026#34;,\u0026#34;{controller=Home}/{action=Index}/{id?}\u0026#34;); }); } æˆ‘ä»¬æŠŠSampleMiddleware æ”¾åˆ°StaticFiles ä¹‹å‰ã€‚è¿™å°±å¯¼è‡´åœ¨ SampleMiddleware é‡Œé‡å®šå‘åˆ° NoName.htmlä¼šå¤±è´¥ã€‚\nä¸ºä»€ä¹ˆä¼šå¤±è´¥å‘¢? å› ä¸ºæˆ‘ä»¬çš„ ApplicationBuilder æ‰§è¡Œåˆ°è¡Œåˆ° SampleMiddleware æ—¶å€™é‡å®šå‘åˆ°NoName.htmlï¼Œä¹Ÿå°±æ˜¯åšè¯»å–é™æ€é¡µé¢ï¼Œè€Œè¿™ä¸ªåŠŸèƒ½æœåŠ¡æ–¹æ˜¯åœ¨ä¸‹ä¸€ä¸ª middleware (StaticFiles) æ‰ä¼šæä¾›çš„ï¼Œå› æ­¤ ApplicationBuilder æ— æ³•æ‰¾åˆ° NoName.htmlï¼Œæ‰€ä»¥åœ¨æµè§ˆå™¨ä¸Šä¹Ÿå°±çœ‹ä¸åˆ° NoName.html çš„å…§å®¹ã€‚\nMiddleware è¿™æ ·çš„è®¾è®¡å¸¦æ¥äº†å¾ˆå¤§çš„æ–¹ä¾¿å’Œå¼¹æ€§ï¼ŒåŒæ™‚æˆ‘ä»¬è‡ªå·±ä¹Ÿè¦å°å¿ƒ middleware å‰åç›¸ä¾æ€§çš„é—®é¢˜ã€‚ Middleware èƒŒååŸç† ç°åœ¨ ASP.NET Core å·²æ˜¯å¼€æºé¡¹ç›®äº†ï¼Œæ‰€ä»¥æœ€åè¯´æ˜ä¸€ä¸‹ middleware åŸç†çš„åŸºæœ¬æ¦‚å¿µï¼æ•´å€‹ ASP.NET fundamental çš„éƒ¨ä»½ç”¨äº†è®¸å¤šçš„ function delegate , task, denepdency injection çš„ç¼–å†™æ–¹æ³•ï¼Œæ‰€ä»¥è¦çœ‹ source code ä¹‹å‰ï¼Œå»ºè®®å…ˆå¯¹è¿™ä¸‰ä¸ªä¸œè¥¿å…ˆè¡Œäº†è§£ï¼Œè¿™æ ·å¯¹ç†è§£ ASP.NET Coreæºç å¾ˆæœ‰å¸®åŠ©ï¼\nåœ¨å‰é¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ° RequestDelegate, é¡¾åæ€ä¹‰å°±çŸ¥é“è¿™æ˜¯ä¸€ä¸ªdelegateï¼ˆå§”æ‰˜ï¼‰ï¼Œå®ƒæ˜¯ç”¨æ¥ä»£è¡¨ middleware çš„ delegate. å®ƒçš„ source code åœ¨ RequestDelegate.cs\nIApplicationBuilder interface æ˜¯ä¸€å€‹ç›¸å½“é‡è¦çš„æ¥å£ï¼Œå®ƒå®šä¹‰äº†æ•´å€‹APPè¦ç”¨å“ªäº›æœåŠ¡å’Œåƒæ•¸ï¼Œå½“ç„¶ä¹ŸåŒ…å«è¦ä½¿ç”¨é‚£äº› middlewareï¼Œå®ƒçš„ souce code åœ¨ IApplicationBuilder.csã€‚\nå…¶ä¸­ä½ å¯ä»¥çœ‹åˆ° Use()ï¼Œé€šè¿‡ Use() çš„å®ä¾‹å°±å¯ä»¥æŠŠ middleware delegate æ³¨å†Œåˆ° host engine ä¸Šã€‚\nå¦å¤–ä¸€ä¸ªå°±æ˜¯ UseMiddlewareExtensions ï¼Œå‰é¢çš„ä»£ç æ›¾ç”¨äº† builder.UseMiddleware(); å®ƒä¼šæ£€æŸ¥ä½ å†™çš„ middleware æ˜¯ä¸æ˜¯åˆæ³•çš„ï¼Œæ¯”å¦‚æœ‰æ²’æœ‰ Invoke()ï¼Œæ˜¯ä¸æ˜¯åªæœ‰ä¸€ä¸ªInvoke()ï¼ŒInvoke() çš„å‚æ•°æœ‰æ²’æœ‰ä¸€ä¸ªæ˜¯ HttpContext typeï¼Œæ‰€æœ‰çš„æ£€æŸ¥éƒ½é€šè¿‡ä¹‹åä¾¿å»ºç«‹å‡ºè¯¥middleware instance çš„ delegateã€‚\nå› æ­¤ï¼Œå½“ä½ çš„ ASP.NET Core APPåˆšå¯åŠ¨çš„æ—¶å€™ï¼Œåœ¨ Startup.cs çš„ Configure() å°±ä¼šæŠŠæ‰€æœ‰çš„ middleware delegate å»ºç«‹èµ·ä¾†ï¼Œç„¶åä¾åºåœ°æ”¾åˆ°å…§éƒ¨çš„ stack ç»“æ„ä¸­ã€‚ä»¥ä¸Šé¢çš„èŒƒä¾‹æ¥è¯´ï¼Œ stack ç»“æ„ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯ StaticFiles, ç„¶åæ˜¯ SampleMiddleware æœ€åæ˜¯ Mvcã€‚æ¥ç€æ¯å€‹ middleware è¦è¢«å»ºç«‹æ—¶æ˜¯åš stack pop çš„æ“ä½œï¼Œæ‰€ä»¥ Mvc çš„ _next æ˜¯ engine é‡Œä¸€äº›å…§éƒ¨çš„ middleware å¤„ç†å™¨ï¼Œç„¶å¾Œ pop å‡º SampleMiddleware æ—¶ï¼Œå°±æŠŠ SampleMiddleware çš„ _next æŒ‡å‘å‰é¢ä¸€å€‹ pop å‡ºä¾†çš„ Mvcã€‚ä¾ç…§ç€è¿™æ ·çš„é€»è¾‘ä¸€ç›´åˆ°æœ€å‰é¢çš„ middlewareã€‚æ‰€ä»¥åœ¨ host engine åœ¨ Build() ä¹‹å‰è¿™äº›åŠ¨ä½œéƒ½ä¼šå®Œæˆï¼Œç„¶å host engine æ‰èƒ½æ‰§è¡ŒRun()ã€‚æœ‰å…³ host engine å¯åƒè€ƒ WebHostBuilder.cs\nå…¨æ–‡å®Œã€‚\næœ¬æ–‡æ•´ç†äºhttps://dotblogs.com.tw/aspnetshare/2016/03/20/201603191å¹¶å·²å¾å¾—ä½œè€…åŒæ„ã€‚\n","date":"2016-10-04T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/asp.net-core-%E7%9A%84-middleware/","title":"ASP.NET Core çš„ Middleware"},{"content":"ASP.NET Core å¯åŠ¨æ–¹å¼ï¼ˆHostingï¼‰ ä¹‹å‰ç‰ˆæœ¬çš„ASP.NETç¨‹åºå¿…é¡»ä¾èµ–IISæ¥å¯åŠ¨ï¼Œè€ŒIISä¸Šä¼šä¸ºæŒ‚è½½åœ¨å…¶ä¸­çš„ASP.NET æ³¨å†Œä¸€ä¸ªISAPI filterã€‚æ¯å½“httpè¯·æ±‚è¿‡æ¥æ—¶ï¼ŒIISåˆ™ä¼šå¯åŠ¨w3wpçš„worker processæ¥å¼€å§‹æ•´ä¸ªASP.NET runtimeç¨‹åºã€‚ç›¸ä¿¡å¤§å®¶éƒ½è¿™æ ·çš„æµç¨‹éƒ½æœ‰ç›¸åº”çš„äº†è§£ã€‚åœ¨.net coreä¹‹å‰ï¼ŒASP.NETçš„ä¸»è¦åœºæ™¯éƒ½æ˜¯è¿è¡Œåœ¨Windowså¹³å°çš„ï¼ŒIISä¹Ÿå°±æ˜¯web serverçš„é¦–é€‰äº†ã€‚è™½ç„¶ä¹Ÿæœ‰ç±»ä¼¼äºjexusçš„linux webserverå¯ç”¨ï¼Œä½†æ˜¯åŸºäºmonoçš„.NET æ€»ä½“è¿˜æ˜¯ä¸å¤ŸMicrosoft åŸç”Ÿçš„å¼ºã€‚\nä¸è¿‡åˆ°äº†ç°åœ¨ï¼Œä¸€åˆ‡éƒ½ä¸åŒäº†ã€‚\næ–°ç‰ˆASP.NET Coreæœ‰äº†.NET Coreçš„æ”¯æ´åå·²ç»å¼€å§‹äº†å®ƒçš„è·¨å¹³å°ä¹‹æ—…äº†ï¼Œå› æ­¤ASP.NET Coreçš„å¯åŠ¨æ–¹å¼ä¹Ÿå¾—å¼€å§‹é‡æ–°è®¾è®¡ä»¥é€‚åº”æ–°éœ€æ±‚äº†ã€‚ 1ã€Kestrel å’Œ IIS platform handler åœ¨ ASP.NET Core ä¸­ï¼Œæ•´ä¸ªruntimeéƒ½æ˜¯é‡å†™è¿‡çš„ï¼Œæ‰€ä»¥å®ƒå’ŒIISä¹‹é—´çš„å…³ç³»ä¹Ÿæœ‰æ‰€æ”¹å˜ã€‚è€ŒASP.NET Coreä¸ºäº†è·¨å¹³å°ï¼Œå®ƒç°åœ¨çš„æ‰§è¡Œæ–¹å¼å°±å¦‚ä¸€èˆ¬çš„Console appä¸€æ ·ã€‚ASP.NET Coreè‡ªå¸¦ä¸€ä¸ªé«˜æ€§èƒ½çš„I/Oç»„ä»¶ - Kestrelï¼Œä½¿å¾—å®ƒå¯ä»¥ä¸ä¾èµ–IISçš„å­˜åœ¨ä¾¿å¯åŠ¨äº†runtimeã€‚ä¸è¿‡Kestrel ä¹Ÿåªæ˜¯ä¸€ä¸ªI/Oç»„ä»¶ï¼Œå¹¶æ²¡æœ‰æƒ³IISæä¾›å…¶å®ƒçš„åŠŸèƒ½æ¥ä¿æŠ¤å’Œç®¡ç†ASP.NET åº”ç”¨ç¨‹åºã€‚ASP.NET CoreåŒæ ·å¯ä»¥é€šè¿‡IISè¿›è¡Œå¤„ç†ã€‚ä½†æ˜¯å¦‚æœé€šè¿‡IISæ¥è¿›è¡Œå¤„ç†çš„è¯ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬ä¾¿éœ€è¦ä¸€ä¸ªâ€œä¸­é—´äººâ€çš„è§’è‰²æ¥è´Ÿè´£è¿™ä¸ªåŠŸèƒ½äº†ã€‚è¿™ä¸ªâ€œä¸­é—´äººâ€çš„åå­—å« Http Platform Handlerï¼Œä¸»è¦è¡¨ç°åœ¨web.configæ–‡æ¡£ä¸­çš„è®¾ç½®ï¼Œå…¶ä¸­åŒ…æ‹¬å¯åŠ¨ASP.NET Core ç¨‹åºçš„çš„è·¯å¾„å’Œåç§°ï¼Œéœ€è¦ä¼ å…¥çš„å‚æ•°ä»¥åŠä¸€äº›å…¶ä»–çš„è®¾ç½®é€‰é¡¹ã€‚Http Platform Handlerçš„å…·ä½“è®¾ç½®ä¾‹å­å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 \u0026lt;system.webServer\u0026gt; \u0026lt;handlers\u0026gt; \u0026lt;add name=\u0026#34;httpPlatformHandler\u0026#34; path=\u0026#34;*\u0026#34; verb=\u0026#34;*\u0026#34; modules=\u0026#34;httpPlatformHandler\u0026#34; resourceType=\u0026#34;Unspecified\u0026#34;/\u0026gt; \u0026lt;/handlers\u0026gt; \u0026lt;httpPlatform processPath=\u0026#34;WebApp.exe\u0026#34; arguments=\u0026#34;\u0026#34; stdoutLogEnabled=\u0026#34;false\u0026#34; startupTimeLimit=\u0026#34;3600\u0026#34;/\u0026gt; \u0026lt;/system.webServer\u0026gt; å…³äºHttp Platform Handlerçš„ç›¸å…³èµ„æ–™å¯ä»¥çœ‹è¿™ä¸ªé“¾æ¥ï¼š http://www.iis.net/downloads/microsoft/httpplatformhandler\nä»ä¸Šé¢çš„ä¾‹å­å¯ä»¥çœ‹å‡ºæ¥ï¼ŒASP.NET Coreç¼–è¯‘ä¹‹åä¾¿æ˜¯ä¸€ä¸ªEXEç¨‹åºï¼Œä½¿å¾—ä½ å¯ä»¥ç›´æ¥è¿è¡Œã€‚å› æ­¤ï¼Œå½“HTTPè¯·æ±‚è¿›æ¥æ—¶ï¼ŒIISå…ˆæ¥å—è¯·æ±‚ï¼Œç„¶åæ ¹æ®ä½ è®¾ç½®çš„web.configçš„å†…å®¹å°†è¯·æ±‚è½¬å‘ç»™WebApp.exeï¼ˆä½ çš„ASP.NET Coreç¨‹åºï¼‰ï¼Œç„¶åWebApp.exeå¼€å§‹æ‰§è¡Œæ—¶ä¾¿ä¼šå¯åŠ¨Kestrelï¼Œæ¥ç€è¿™ä¸ªHTTPè¯·æ±‚ä¾¿è¿›å…¥äº†ASP.NET Core runtimeçš„ä¸–ç•Œã€‚è¿™æ ·çœ‹æ¥ï¼ŒIISè¿™æ—¶å€™åªæ˜¯ä¸€ä¸ªç®€å•çš„proxy/forwarderè§’è‰²ã€‚\nPSï¼šåœ¨æˆ‘ç¿»è¯‘æ•´ç†è¿™ä¸ªæ–‡ç« çš„æ—¶å€™ï¼Œä¸–ç•Œå·²ç»å‘ç”Ÿäº†å˜åŒ–ï¼šä¸‹ä¸ªç‰ˆæœ¬çš„asp.net core å°†ä¼šæœ‰å…¨æ–°çš„IIS moduleæ¥å–ä»£Http Platform Handlerã€‚\nå…·ä½“è¯¦ç»†èµ„æ–™è§ï¼šhttps://github.com/aspnet/IISIntegration/issues/105\n2ã€Main() ASP.NET Coreå’Œå…¶ä»–çš„.NET ç¨‹åºä¸€æ ·æ‹¥æœ‰ä¸€ä¸ªstatic void Main(),è¿™æ˜¯æ•´ä¸ªruntimeçš„è¿›å…¥ç‚¹ã€‚ä¸‹é¢çœ‹ä¸€ä¸ªæ ·ä¾‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 public static void Main(string[] args) { var host = new WebHostBuilder() .UseServer(\u0026#34;Microsoft.AspNetCore.Server.Kestrel\u0026#34;) .UseContentRoot(Directory.GetCurrentDirectory()) .UseDefaultConfiguration(args) .UseIISPlatformHandlerUrl() .UseStartup\u0026lt;Startup\u0026gt;() .Build(); host.Run(); } ASP.NET Core host engine çš„å»ºç«‹è€…æ˜¯ WebHostBuilderï¼\nå®ƒå®è´¨ä¸Šæ˜¯ä¸€ä¸ªäº† IWebHostBuilder interfaceï¼Œå…¶ä¸­ UseServer() æ˜¯ç”¨äºæŒ‡å®šä½¿ç”¨ä»€ä¹ˆæ ·çš„ serverã€‚\nå…¶ä¸­ UseServer() æœ‰ä¸€ä¸ªæ‰©å±•æ–¹æ³•UseServer(string assemblyName)ã€‚è¿™æ ·çš„è¯æˆ‘ä»¬å¯ä»¥ç›´æ¥ä¼ å…¥Kestrelçš„ç¨‹åºé›†åç§°:\u0026ldquo;Microsoft.AspNetCore.Server.Kestrel\u0026rdquo;ã€‚å½“ç„¶ï¼Œè¿™åªæ˜¯å…¶ä¸­ä¸€ç§é€‰é¡¹ã€‚ä½ ä¹Ÿå¯ä»¥è‡ªå·±å®ç°ä¸€ä¸ªè‡ªå·±çš„ serverï¼Œåªè¦ä½ çš„ server å®ç°äº† IServerFactory interface å³å¯ã€‚è¿™æ ·çš„è®¾è®¡æä¾›äº†ä¸€ä¸ªå¾ˆå¤§çš„å¼¹æ€§ç©ºé—´è®©æˆ‘ä»¬è‡ªè¡Œé€‰æ‹©hosting serverï¼ˆæ‰˜ç®¡æœåŠ¡ï¼‰ã€‚\nUseContentRoot() è¿™ä¸ªæ‰©å±•æ–¹æ³•æ˜¯è®©æˆ‘ä»¬æŒ‡å®šåº”ç”¨ç¨‹åºçš„å·¥ä½œç›®å½•ï¼ˆworking directoryï¼‰ï¼Œå¦‚æœæˆ‘ä»¬æ²¡æœ‰æŒ‡å®šçš„è¯ï¼Œåˆ™ä¼šé»˜è®¤ä¸ºæˆ‘ä»¬çš„åº”ç”¨ï¼ˆwebapp.exeï¼‰æ‰€åœ¨ç›®å½•ä¸ºå·¥ä½œç›®å½•ã€‚ UseDefaultConfiguration() è¿™ä¸ªæ‰©å±•æ–¹æ³•ä½¿å¾—æˆ‘ä»¬åœ¨IWebHostBuilder å»ºç«‹å¯ä»¥ä¼ å…¥ä¸€äº›å‚æ•°ï¼Œæ¯”å¦‚ application key, environment name, server factory location, content root path ç­‰ç­‰ï¼å› æ­¤ï¼Œå½“æˆ‘ä»¬åœ¨è¿è¡Œ WebApp.exe çš„æ—¶å€™ï¼ŒåŒæ—¶å¯ä»¥å¸¦å…¥æˆ‘ä»¬éœ€è¦ç”¨åˆ°çš„hostingå‚æ•°ï¼ˆPSï¼šè¿™æ ·çš„åšæ³•å°±åƒè¿è¡Œå‘½ä»¤è¡Œç¨‹åºæ—¶å¸¦å…¥å‚æ•°ï¼Œå¤šå¥½ç©ï¼‰ã€‚è¿™äº›å‚æ•°ä¹Ÿå¯ä»¥å†™åœ¨appsettings.jsoné‡Œé¢é€šè¿‡Configurationæ¥è¯»å–ã€‚ æ‰€ä»¥ï¼ŒUseDefaultConfiguration() ä¹Ÿä¸ä¸€å®šéè¦å­˜åœ¨äº Main() ä¹‹ä¸­ã€‚ï¼ˆï¼Ÿï¼Ÿï¼Ÿä¸ªäººä¸æ˜¯å¾ˆç†è§£ï¼‰ PSï¼šåŸä½œè€…åŸè¯ï¼Œ\u0026ldquo;å¦‚æœæˆ‘æ²’è®°é”™çš„è¯ï¼Œåœ¨å†™è¿™ä¸ªæ–‡ç« çš„æ—¶å€™ï¼ŒUseDefaultConfiguration() å·²ç»è¢«æ”¹ä¸ºæˆäº†UseDefaultHostingConfiguration()ï¼æ˜¾ç„¶è¿™ä¸ªåç§°æ›´èƒ½æ¸…æ¥šæ˜ç™½ï¼\u0026quot;(ï¼Ÿï¼Ÿï¼Ÿä¸ªäººè¿˜æ²¡å®è·µ)\nUseIISPlatofmrHandleUrl() è¿™ä¸ª IWebHostBuilder çš„ æ‰©å±•æ–¹æ³•æ¯”è¾ƒç‰¹æ®Šã€‚å¦‚æœä½ è¦æŠŠ ASP.NET Core æ”¾åœ¨ IIS ä¸‹ï¼Œè¿™ä¸ªæ‰©å±•æ–¹æ³•ä¼šè¯»å– IIS http platform handler çš„ server port å’Œ application pathï¼Œç”¨äºä½œä¸º ASP.NET Core çš„å¯åŠ¨ä½ç½®ï¼Œå¦‚ http://localhost:5000/startï¼å¦‚æœä½ æ²’ç”¨ IISï¼Œè¿™ä¸ªæ‰©å±•æ–¹æ³•å¯¹ä½ æ¥è¯´åŸºæœ¬æ˜¯ç”¨ä¸ä¸Šçš„ï¼ UseStartup\u0026lt;\u0026gt;() è¿™æ˜¯ WebHostBuilder é‡Œç›¸å½“é‡è¦çš„ä¸€ä¸ªæ‰©å±•æ–¹æ³•ã€‚å®ƒçš„æ–¹æ³•ç­¾åå¦‚ä¸‹ï¼š 1 2 3 public static IWebHostBuilder UseStartup\u0026lt;TStartup\u0026gt; (this IWebHostBuilder hostBuilder) where TStartup : class è¿™é‡Œä½ å¯ä»¥å¾ˆæ¸…æ¥šåœ°çœ‹åˆ° \u0026lt;\u0026gt; é‡Œé¢è¦æ”¾çš„å°±æ˜¯ä¸€ä¸ª classã€‚\nåœ¨æˆ‘ä»¬è¿™é‡Œçš„èŒƒä¾‹ä¸­ï¼Œå®ƒçš„åå­—æ˜¯ Startupï¼Œé‡Œé¢æœ€é‡è¦çš„å°±æ˜¯éœ€è¦å®šä¹‰è¦ä½¿ç”¨é‚£äº›æœåŠ¡(service)ä»¥åŠè¦ä½¿ç”¨é‚£äº›ä¸­é—´ä»¶(middleware)ã€‚\n3ã€Startup è¿™æ˜¯ä¸€ä¸ªéå¸¸éå¸¸é‡è¦çš„class,åœ¨ASP.NET CoreèŒƒä¾‹ä¸­ä¸€èˆ¬éƒ½æŠŠå®ƒå‘½åæˆStartupã€‚å…¶å®æˆ‘ä»¬æŠŠå®ƒå‘½åæˆå…¶ä»–åå­—ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œæˆ–è€…è®¾å®šå¤šä¸ªStartupã€‚ä¸Šé¢çš„å†…å®¹å¯ä»¥çœ‹åˆ°ï¼ŒUseStartup()æŒ‡å®šäº†è°æ˜¯starup classã€‚ç„¶ååœ¨Build()ä¾¿ä¼šå®ä¾‹åŒ–starup classï¼Œä¹‹åä¾¿æ‰§è¡Œé‡Œé¢ä¸¤ä¸ªé‡è¦çš„æ–¹æ³•ï¼šConfigureServices() å’Œ Configure()ã€‚\næˆ‘ä»¬å…ˆä¾†çœ‹ Startup çš„æ„é€ å‡½æ•°.\n1 2 3 4 5 6 7 8 9 public Startup(IHostingEnvironment env) { // Set up configuration sources. var builder = new ConfigurationBuilder() .AddJsonFile(\u0026#34;appsettings.json\u0026#34;) .AddJsonFile($\u0026#34;appsettings.{env.EnvironmentName}.json\u0026#34;, optional: true) .AddEnvironmentVariables(); Configuration = builder.Build().ReloadOnChanged(\u0026#34;appsettings.json\u0026#34;); } Host engine åœ¨è¢«æ‰§è¡Œ Build()æ—¶å·²ç»çŸ¥é“ startup type æ˜¯ Startup classï¼Œæ‰€ä»¥åœ¨ Build() çš„æ—¶å€™ä¼šå…ˆåˆ›å»ºæœŸç¤ºä¾‹ã€‚åœ¨æˆ‘ä»¬è¿™é‡Œçš„æ˜¯è°ƒç”¨Startupç±»å¸¦å‚æ•°çš„æ„é€ å‡½æ•°ã€‚\nåœ¨æˆ‘ä»¬è¿™ä¸ªä¾‹å­ä¸­é€‰æ‹©çš„æ˜¯ä¼ å…¥IHostingEnvironmentç¤ºä¾‹ï¼Œå®ƒä¸ºæˆ‘ä»¬å¸¦æ¥äº†ç¯å¢ƒå˜é‡ï¼ˆEnvironmentNameï¼‰ã€‚\næˆ‘ä»¬è¿™é‡Œä¸»è¦ç›®çš„æ˜¯æŠŠConfigurationå®ä¾‹åŒ–ã€‚è¿™æ˜¯ä¸€ä¸ªè›®é‡è¦çš„åŸºç¡€ç»„ä»¶ï¼Œä»¥åä¼šæœ‰æ–‡ç« æ¥è¯´æ˜å®ƒã€‚\nåœ¨è¿™é‡Œæˆ‘ä»¬ç‰¹åˆ«è¯´æ˜ä¸€ä¸‹ï¼Œä¸Šé¢çš„ç¤ºä¾‹ä»£ç ä¸­ï¼Œæˆ‘ä»¬æ‰§è¡Œäº†ä¸¤æ¬¡ AddJsonFile()ï¼Œè€Œä¸”ç¬¬äºŒä¸ªjson fileçš„å‚æ•°å’Œç¬¬ä¸€ä¸ªçš„è¿˜ä¸å¤ªä¸€æ ·ã€‚è¿™æ ·çš„ç›®çš„æ˜¯ä¸ºäº†è®©å¼€å‘è€…å¯ä»¥æŠŠå¼€å‘ç¯å¢ƒä½¿ç”¨çš„ç¯å¢ƒå‚æ•°å’Œå…¶ä»–ç¯å¢ƒä½¿ç”¨çš„å‚æ•°æœ‰æ‰€åŒºåˆ«ã€‚æ¯”å¦‚ï¼Œä½ ä½¿ç”¨çš„å¼€å‘ç¯å¢ƒç”¨çš„æ˜¯appsettings.jsonï¼Œè¿™ä¸ªæ–‡ä»¶åªå­˜åœ¨äºä½ çš„ç”µè„‘ä¸­ã€‚å¦ä¸€ä¸ªæ–‡æ¡£æ˜¯appsettings.production.jsonï¼Œè¿™æ˜¯æ­£å¼ç¯å¢ƒä½¿ç”¨çš„å‚æ•°è®¾å®šæ–‡æ¡£ã€‚ç¬¬äºŒå€‹ AddJsonFile() ç¬¬äºŒå€‹å‚æ•°æ˜¯ trueï¼Œä¹Ÿå°±æ˜¯å¯èƒ½ä¸å­˜åœ¨çš„æ„æ€ã€‚æ‰€ä»¥è‹¥é‡åˆ°é‡å¤åç§°å‚æ•°æ—¶ï¼Œappsettings.production.json ä¼šè¦†ç›– appsettings.json çš„å…§å®¹ã€‚è¿™æ ·ä½¿å¾—å¼€å‘ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒå¾—ä»¥åŒºåˆ†ã€‚\næ¥ä¸‹æ¥ï¼Œåœ¨ IWebHostBuilder çš„ Build()é‡Œé¢ä¼šæ‰§è¡Œ host engine åˆå§‹åŒ–çš„ç¨‹åºï¼Œå…¶ä¸­å°±ä¼šå»æ‰¾Startup classé‡Œé¢çš„ä¸¤ä¸ªæ–¹æ³•ï¼š ConfigureServices() å’Œ Configure()ã€‚\nConfigureSerivces() æ˜¯å®šä¹‰äº†è¿™ä¸ª web application è¦ä½¿ç”¨é‚£äº›æœåŠ¡ï¼Œç„¶åå°†è¿™äº›æœåŠ¡æ”¾åœ¨ service container (IServiceCollection) è£¡é¢ã€‚å¦‚ä¸‹é¢çš„æ ·ä¾‹ï¼š\n1 2 3 4 5 6 7 8 9 10 public void ConfigureServices(IServiceCollection services) { // add entity framework services.AddEntityFramework() .AddDbContext\u0026lt;BlogsContext\u0026gt;(o =\u0026gt; o.UseSqlServer(Configuration[\u0026#34;Data1:DefaultConnection:ConnectionString\u0026#34;])) // Add framework services. services.AddMvc(); } å®ƒå®šä¹‰äº†entity frameworkå’Œmvcä¸¤ä¸ªæœåŠ¡ã€‚è¿™é‡Œæ‰€è°“çš„æœåŠ¡ï¼ˆservicesï¼‰çš„æ„æ€ä¹Ÿå°±æ˜¯é€šè¿‡å®ƒä»¬å¸¦å…¥æ›´åºå¤§çš„ç¨‹åºä»£ç ã€‚è¿™å¬èµ·æ¥å¥½åƒæœ‰ç‚¹æç¬‘ï¼Œä½†ä¹ŸçœŸçš„å¦‚æ­¤ã€‚åƒEntity framework é‡Œé¢æœ‰è¿™ä¹ˆå¤šçš„ä»£ç ï¼Œä¸€å®šéƒ½éœ€è¦å¸¦å…¥è®¸å¤šå®šä¹‰å¥½çš„ç‰©ä»¶æˆ–è€…å‚æ•°ï¼Œè€Œä¸åªæ˜¯ä¸€ä¸ªç¨‹åºçš„è¿›å»ç‚¹è€Œå·²ï¼Œæ‰€ä»¥services çš„ç›®çš„å°±æ˜¯åœ¨è¿™é‡Œã€‚\nConfigure() ä¸»è¦æ˜¯å®šä¹‰äº†ä¸­é—´ä»¶ï¼ˆmiddlewareï¼‰ä»¥åŠå®ƒä»¬çš„é¡ºåºï¼\n1 2 3 4 5 6 7 8 9 public void Configure(IApplicationBuilder app, IHostingEnvironment env, ILoggerFactory loggerFactory) { loggerFactory.AddConsole(Configuration.GetSection(\u0026#34;Logging\u0026#34;)); loggerFactory.AddDebug(); app.UseStaticFiles(); app.UseMvcWithDefaultRoute(); } 4ã€Build å’Œ Run æœ€åï¼Œåœ¨IHostWebBuilderé‡Œæœ€åçš„ä¸¤ä¸ªåŠ¨ä½œä¾¿æ˜¯ï¼šBuild and Run.\nBuild() è¿™ä¸ªæ–¹æ³•åšçš„å·¥ä½œä¾¿æ˜¯å»ºç«‹ hosting serviceï¼ŒæŠŠ Startup ä¸­å®šä¹‰çš„çš„ services å’Œ middleware æ¥æ”¶è¿‡æ¥ï¼Œç„¶åç¡®å®šcontent root path å’Œ application nameï¼Œæ¥ç€ä¸€å¥å‰é¢è¿™äº›èµ„æ–™å†åŠ ä¸ŠConfigurationè¿‡æ¥çš„æ•°æ®æ¥åˆå§‹åŒ–host engine (WebHost.cs)ï¼ Run() è¿™ä¸ªæ˜¯å¯åŠ¨ host engine çš„ æ‰©å±•æ–¹æ³•ï¼Œå®ƒåœ¨å¯åŠ¨ä¹‹å‰åŠ å…¥äº†ä¸€ä¸ª CancelKeyPress çš„äº‹ä»¶ï¼å› ä¸ºåœ¨ Run() æ–¹æ³• ä¸­ä¼ å…¥å…¥äº† CancellationTokenSource() ï¼Œè®©æˆ‘ä»¬æœ‰ä¸€ä¸ªæ–¹æ³•å¯ä»¥éšæ—¶ä¸­æ–­host engineçš„æ‰§è¡Œã€‚ ç›®å‰çš„åšæ³•å°±ç”¨æ˜¯ CancelKeyPress äº‹ä»¶ï¼Œæ‰€ä»¥ä½ å¯ä»¥æŒ‰ä¸‹ Ctrl+C ä¾†ä¸­æ­¢ host engine çš„æ‰§è¡Œï¼\næ¯”è¾ƒç‰¹åˆ¥çš„æ˜¯ï¼Œè¿™ä¸€æ®µä¸­æ­¢çš„æ–‡å­—è¯´æ˜å±…ç„¶æ˜¯ç”¨ hard codeï¼Œåƒè€ƒå¦‚ä¸‹:\nhost.Run(cts.Token, \u0026ldquo;Application started. Press Ctrl+C to shut down.\u0026rdquo;);\nä¸è¿‡è¿™æ ·çš„è¯ï¼Œè¿™é‡Œä½ ä¹Ÿä¸èƒ½å†™ä¸­æ–‡\u0026hellip;\nå…¨æ–‡å·®ä¸å¤šå°±è¿™æ ·äº†ï¼ŒåŸæ–‡åœ¨è¿™é‡Œï¼šASP.NET Core çš„å•Ÿå‹•æ–¹å¼ (Hosting)\næ„Ÿè°¢ASP.NET Core è³‡è¨Šåˆ†äº«ã€‚\n","date":"2016-10-04T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/asp.net-core-%E5%90%AF%E5%8A%A8%E6%96%B9%E5%BC%8Fhosting/","title":"ASP.NET Core å¯åŠ¨æ–¹å¼ï¼ˆHostingï¼‰"},{"content":"æœ‰æ—¶å€™æˆ‘ä»¬ä¼šé‡åˆ°éœ€è¦æŠŠæ•°æ®åŠ å¯†ä¹‹åå†ç½‘ç»œä¸Šä¼ è¾“çš„éœ€æ±‚ï¼Œè¿™æ ·çš„è¯ä¸€èˆ¬ä½¿ç”¨AES256ä¹‹ç±»çš„ç®—æ³•ï¼Œç»è¿‡è¿ç®—ä¹‹åå¾—åˆ°ä¸€ä¸ªbyteæ•°ç»„ï¼Œæ¥ç€è½¬æ¢æˆstringï¼Œå°±æ‰”å‡ºå»äº†ã€‚å¯¹æ–¹æ‹¿åˆ°ä¹‹åï¼Œç”¨å¯†é’¥è§£å¯†ä¹‹åä¾¿å¾—åˆ°äº†å¯¹åº”çš„æ•°æ®ã€‚\nåœ¨C#é‡Œé¢ï¼ŒByteæ•°ç»„è½¬Stringå­—ç¬¦ä¸²æˆ‘ä»¬ä¸€èˆ¬ç”¨Convert.ToBase64()å®Œæˆã€‚\nä»£ç å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 public string BytesToString(byte[] buff) { return Convert.ToBase64String(buff); } public byte[] StringToBytes(string input) { return Encoding.UTF8.GetBytes(input); } ä¸€èˆ¬æ¥è¯´è¿™æ ·ä¹Ÿæ²¡æ’’é—®é¢˜äº†ï¼Œä¸è¿‡ï¼Œå¦‚æœè¿™ä¸ªæ•°æ®æ˜¯é€šè¿‡URLçš„æ–¹å¼ç»™å‡ºå»çš„ï¼Œè¿™æ—¶å€™å°±è¦è€ƒè™‘ä¸€ä¸‹ç‰¹æ®Šå­—ç¬¦ç¼–ç é—®é¢˜äº†ã€‚+ã€ç©ºæ ¼ã€%ä¹‹ç±»çš„ç‰¹æ®Šå­—ç¬¦å¯èƒ½ä¼šå¯¼è‡´åˆ‡æ–­URLä¼ å‚çš„æ•°æ®ï¼Œå¯¼è‡´å¾—åˆ°çš„æ•°æ®ä¸ä¸€è‡´ã€‚è¿™æ ·çš„è¯ï¼Œè§£å¯†ä¹Ÿåšä¸ä¸‹å»äº†ã€‚\nç›¸å…³èµ„æ–™ï¼š\nå…³äºURLç¼–ç  URLç¼–ç \u0026mdash;-urlå‚æ•°ä¸­æœ‰+ã€ç©ºæ ¼ã€=ã€%ã€\u0026amp;ã€#ç­‰ç‰¹æ®Šç¬¦å·çš„é—®é¢˜è§£å†³ ä¸è¿‡ä¹Ÿå¥½åœ¨ï¼ŒC#æä¾›äº†ä¸€ä¸ªHttpUtility.UrlEncode(input)å’ŒHttpUtility.UrlEncode(input)è¿™ä¸¤ä¸ªå‡½æ•°ï¼Œè®©æˆ‘ä»¬ç›´æ¥æŠŠä¸Šé¢çš„ç‰¹æ®Šå­—ç¬¦è½¬æ¢æˆURLå¯è¯†åˆ«çš„è½¬ä¹‰å­—ç¬¦ã€‚ æ•°æ®å‡ºå»ä¹‹åå…ˆEncodeä¸€ä¸‹ï¼Œå›æ¥ä¹‹åDecodeä¸€ä¸‹ï¼Œå¥½åƒé—®é¢˜éƒ½è§£å†³äº†å§ã€‚\nç„¶è€Œæˆ‘ä»¬éƒ½å¿˜äº†ä¸€ä»¶äº‹æƒ…ï¼ŒURLåˆ°äº†æµè§ˆå™¨ä¹‹åï¼Œè‡ªç„¶ä¼šå¯¹URLé‡Œé¢çš„ä¸œè¥¿Decodeä¸€æ¬¡ã€‚ æˆ‘å®ç°çš„æ—¶å€™ï¼Œåœ¨åå°éªŒè¯çš„æ—¶å€™åˆDecodeä¸€æ¬¡,è¿™å°±å‡ºé—®é¢˜äº†ã€‚\né—®é¢˜åœ¨å“ªå‘¢ï¼Ÿä¸€ä¸ªencodeçš„å­—ç¬¦è¢«decodeä¸¤æ¬¡ï¼Œå†…å®¹å·²ç»è¢«æ”¹æ‰äº†\u0026hellip; è¿™å°±å¯¼è‡´è§£å¯†çš„æ—¶å€™ç›´æ¥æŒ‚äº†\u0026hellip;.\nè¿™æ ·çœ‹æ¥ï¼Œ Convert.ToBase64String()è¿™ä¸ªä¸å¤Ÿé è°±ï¼Œå‡ºæ¥çš„æ•°æ®å¯èƒ½ä¼šæœ‰ç‰¹æ®Šå­—ç¬¦çš„é—®é¢˜ã€‚ æ€ä¹ˆè§£å†³å‘¢ï¼Ÿé‚£å¤©æ™šä¸Šå’Œè€å¤§/CTOéƒ½åœ¨çœ‹è¿™ä¸ªbugã€‚ä¸€ä¸‹å­éƒ½æ²¡æ’’å¥½åŠæ³•\u0026hellip;.\nåæ¥CTOæƒ³äº†ä¸€ä¸‹ï¼Œè¯´byteä¸å°±æ˜¯æœ€å¤§ä¸ä¹…255ä¹ˆï¼Ÿç›´æ¥è½¬16è¿›åˆ¶å­—ç¬¦å°±æ˜¯å˜›ã€‚ äºæ˜¯æœ‰äº†ä¸‹é¢çš„ä»£ç ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 /// \u0026lt;summary\u0026gt; /// byteæ•°ç»„è½¬string /// \u0026lt;/summary\u0026gt; /// \u0026lt;param name=\u0026#34;bytes\u0026#34;\u0026gt;\u0026lt;/param\u0026gt; /// \u0026lt;returns\u0026gt;\u0026lt;/returns\u0026gt; private static string BytesToString(byte[] bytes) { if (bytes == null) return string.Empty; return string.Join(string.Empty, bytes.Select(b =\u0026gt; string.Format(\u0026#34;{0:x2}\u0026#34;, b)).ToArray()); } /// \u0026lt;summary\u0026gt; /// stringè½¬byteæ•°ç»„ /// \u0026lt;/summary\u0026gt; /// \u0026lt;param name=\u0026#34;str\u0026#34;\u0026gt;\u0026lt;/param\u0026gt; /// \u0026lt;returns\u0026gt;\u0026lt;/returns\u0026gt; private static byte[] StringToBytes(string str) { if (string.IsNullOrEmpty(str)) return null; byte[] bytes = new byte[str.Length / 2]; for (int i = 0; i \u0026lt; str.Length; i += 2) { bytes[i / 2] = Convert.ToByte(\u0026#34;0x\u0026#34; + str[i] + str[i + 1], 16); } return bytes; } é—®é¢˜è§£å†³ã€‚\n","date":"2016-10-04T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/byte-to-string/","title":"byte to string"},{"content":"Join è¿æ¥ï¼šå†…è¿æ¥ã€å¤–è¿æ¥ã€å·¦è¿æ¥ã€å³è¿æ¥ã€‚ SQLçš„Joinè¿™é‡Œå°±ä¸å¤šè¯´äº†ï¼Œ ä»Šå¤©ä¸»è¦æ˜¯çœ‹ä¸€ä¸‹LINQçš„Joinç”¨æ³•ï¼Œä»¥åŠEnumerable.Join()çš„ç”¨æ³•ã€‚\nJoinç”¨äºè¿æ¥æ•°æ®ï¼Œé¦–å…ˆå°±æ˜¯æ•°æ®ä¹‹é—´æœ‰è”ç³»å’¯ã€‚\nå…ˆè¯´Enumerable.Join()ã€‚ å‚æ•°ç±»å‹å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 public static IEnumerable\u0026lt;TResult\u0026gt; Join\u0026lt;TOuter, TInner, TKey, TResult\u0026gt; ( this IEnumerable\u0026lt;TOuter\u0026gt; outer, IEnumerable\u0026lt;TInner\u0026gt; inner, Func\u0026lt;TOuter, TKey\u0026gt; outerKeySelector, Func\u0026lt;TInner, TKey\u0026gt; innerKeySelector, Func\u0026lt;TOuter, TInner, TResult\u0026gt; resultSelector ) ç±»å‹å‚æ•° TOuter ç¬¬ä¸€ä¸ªåºåˆ—ä¸­çš„å…ƒç´ çš„ç±»å‹ã€‚ TInner ç¬¬äºŒä¸ªåºåˆ—ä¸­çš„å…ƒç´ çš„ç±»å‹ã€‚ TKey é”®é€‰æ‹©å™¨å‡½æ•°è¿”å›çš„é”®çš„ç±»å‹ã€‚ TResult ç»“æœå…ƒç´ çš„ç±»å‹ã€‚ å‚æ•° outer ç±»å‹ï¼šSystem.Collections.Generic.IEnumerable è¦è”æ¥çš„ç¬¬ä¸€ä¸ªåºåˆ—ã€‚ inner ç±»å‹ï¼šSystem.Collections.Generic.IEnumerable è¦ä¸ç¬¬ä¸€ä¸ªåºåˆ—è”æ¥çš„åºåˆ—ã€‚ outerKeySelector ç±»å‹ï¼šSystem.Func\u0026lt;TOuter, TKey\u0026gt; ç”¨äºä»ç¬¬ä¸€ä¸ªåºåˆ—çš„æ¯ä¸ªå…ƒç´ æå–è”æ¥é”®çš„å‡½æ•°ã€‚ innerKeySelector ç±»å‹ï¼šSystem.Func\u0026lt;TInner, TKey\u0026gt; ç”¨äºä»ç¬¬äºŒä¸ªåºåˆ—çš„æ¯ä¸ªå…ƒç´ æå–è”æ¥é”®çš„å‡½æ•°ã€‚ resultSelector ç±»å‹ï¼šSystem.Func\u0026lt;TOuter, TInner, TResult\u0026gt; ç”¨äºä»ä¸¤ä¸ªåŒ¹é…å…ƒç´ åˆ›å»ºç»“æœå…ƒç´ çš„å‡½æ•°ã€‚ è¿”å›å€¼ ç±»å‹ï¼šSystem.Collections.Generic.IEnumerable IEnumerable\u0026lt;T\u0026gt; that has elements of type TResult that are obtained by performing an inner join on two sequences.\u0026quot; xml:space=\u0026ldquo;preserve\u0026rdquo;\u0026gt;ä¸€ä¸ªå…·æœ‰ TResult ç±»å‹å…ƒç´ çš„ IEnumerableï¼Œè¿™äº›å…ƒç´ æ˜¯é€šè¿‡å¯¹ä¸¤ä¸ªåºåˆ—æ‰§è¡Œå†…éƒ¨è”æ¥å¾—æ¥çš„ã€‚ ä½¿ç”¨è¯´æ˜ åœ¨ Visual Basic å’Œ C# ä¸­ï¼Œå¯ä»¥åœ¨ IEnumerable ç±»å‹çš„ä»»ä½•å¯¹è±¡ä¸Šå°†æ­¤æ–¹æ³•ä½œä¸ºå®ä¾‹æ–¹æ³•æ¥è°ƒç”¨ã€‚å½“ä½¿ç”¨å®ä¾‹æ–¹æ³•è¯­æ³•è°ƒç”¨æ­¤æ–¹æ³•æ—¶ï¼Œè¯·çœç•¥ç¬¬ä¸€ä¸ªå‚æ•°ã€‚æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜… æ‰©å±•æ–¹æ³• (Visual Basic) æˆ– æ‰©å±•æ–¹æ³•ï¼ˆC# ç¼–ç¨‹æŒ‡å—ï¼‰ã€‚\nå…ˆä¸Šä¸€ä¸ªMSDNçš„ä¾‹å­ã€‚\npublic static void JoinEx1() { Person magnus = new Person { Name = \u0026quot;Hedlund, Magnus\u0026quot; }; Pet barley = new Pet { Name = \u0026quot;Barley\u0026quot;, Owner = terry }; Person terry = new Person { Name = \u0026quot;Adams, Terry\u0026quot; }; Person charlotte = new Person { Name = \u0026quot;Weiss, Charlotte\u0026quot; }; Pet boots = new Pet { Name = \u0026quot;Boots\u0026quot;, Owner = terry }; Pet whiskers = new Pet { Name = \u0026quot;Whiskers\u0026quot;, Owner = charlotte}; Pet daisy = new Pet { Name = \u0026quot;Daisy\u0026quot;, Owner = magnus }; List\u0026lt;Person\u0026gt; people = new List\u0026lt;Person\u0026gt; { magnus, terry, charlotte }; List\u0026lt;Pet\u0026gt; pets = new List\u0026lt;Pet\u0026gt; { barley, boots, whiskers, daisy }; // Create a list of Person-Pet pairs where // each element is an anonymous type that contains a // Pet's name and the name of the Person that owns the Pet. var query = people.Join( pets,//éœ€è¦Joinçš„å¦ä¸€ä¸ªæ•°æ®æº person =\u0026gt; person,//è‡ªå·±ç”¨æ¥æ¯”è¾ƒçš„keyï¼Œ lambda è¡¨è¾¾å¼ pet =\u0026gt; pet.Owner,//å¦ä¸€ä¸ªæ•°æ®æºç”¨æ¥æ¯”è¾ƒçš„keyï¼Œ lambda è¡¨è¾¾å¼ (person, pet) =\u0026gt;new { OwnerName = person.Name, Pet = pet.Name } //æƒ³è¦å–å‡ºæ¥çš„æ•°æ®ï¼Œæ”¯æŒåŒ¿åå¯¹è±¡ï¼Œ lambda è¡¨è¾¾å¼); foreach (var obj in query) { Console.WriteLine( \u0026quot;{0} - {1}\u0026quot;,obj.OwnerName,obj.Pet); } } LINQçš„Join åŒæ ·æ˜¯ä¸Šé¢çš„æ•°æ®ï¼Œå¦‚æœæ¢æˆLINQçš„Joinï¼Œå†™æ³•å¦‚ä¸‹ï¼š var query = from person in people // ç¬¬ä¸€ä¸ªæ•°æ®æº join pet in pets //ç¬¬äºŒä¸ªæ•°æ®æº on person equals pet.Owner //Joinæ¡ä»¶ select new { OwnerName = person.Name, Pet = pet.Name };\n//è¦åˆ°å¾—åˆ°çš„æ•°æ®ã€‚\nä¸Šé¢ä¸¤ç§å†™æ³•å¾—åˆ°çš„ç»“æœéƒ½æ˜¯å†…é“¾æ¥ç»“æœï¼Œè‡³äºå·¦è¿æ¥ã€å³è¿æ¥ã€å¤–è¿æ¥\u0026hellip;. ç­‰æˆ‘ä¸‹æ¬¡æœ‰å¿ƒæƒ…å†æ›´æ–°å§ï¼Œå†ä¸èµ°å®¶é‡Œçš„é”®ç›˜åˆè¦åäº†ã€‚\nä¸€äº›èµ„æ–™é“¾æ¥ï¼š https://msdn.microsoft.com/zh-cn/library/bb311040.aspx https://msdn.microsoft.com/zh-cn/library/bb534675%28v=vs.110%29.aspx?f=255\u0026MSPPError=-2147217396 http://www.cnblogs.com/Ivony/archive/2008/08/18/1270555.html http://www.cnblogs.com/Ivony/archive/2008/08/28/1278643.html http://www.cnblogs.com/Ivony/archive/2008/10/14/1309807.html ;\nLINQ GroupJoin å®ç°å·¦è¿æ¥ var queryGroup = from person in people // ç¬¬ä¸€ä¸ªæ•°æ®æº join pet in pets //ç¬¬äºŒä¸ªæ•°æ®æº on person equals pet.Owner into ps //åŠ äº†into,åä¸½å˜èº«GroupJoin select new { OwnerName = person.Name, Pet = ps }; //è¦åˆ°å¾—åˆ°çš„æ•°æ®ã€‚\n","date":"2016-10-04T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/c%23-join%E7%94%A8%E6%B3%95/","title":"C# joinç”¨æ³•"},{"content":"LINQ ä¼˜ç‚¹ æ€»ç»“(è½¬è½½) åŸæ–‡é“¾æ¥ï¼šhttp://www.cnblogs.com/c-jquery-linq-sql-net-problem/archive/2011/01/15/LINQ_Merit.html\nè¿™å‡ å¤©åœ¨è¯»ä¸€æœ¬LINQæ–¹é¢çš„ä¹¦ã€ŠEssential LINQã€‹,åœ¨è¿™é‡Œå’Œå¤§å®¶åˆ†äº«ä¸‹ã€‚\nç”±äºå¯¹LINQçš„æ·±å…¥æ€»ç»“éœ€è¦å¤§é‡çš„ç¯‡å¹…ï¼Œå› æ­¤åœ¨è¿™é‡Œåˆ†æˆå‡ ä¸ªéƒ¨åˆ†æ¥è®²ã€‚\nï¼ˆ*æˆ‘çœ‹ã€ŠEssential LINQã€‹æ˜¯è‹±æ–‡ç‰ˆçš„ï¼Œæœ‰äº›åè¯ä¸èƒ½ç¿»è¯‘æˆæ­£ç»Ÿçš„ä¸­æ–‡è§£é‡Šè¯·ç»™äºˆè°…è§£ï¼‰\nLINQçš„ä¼˜ç‚¹ï¼š\nLINQåŸºæœ¬æœ‰ä»¥ä¸‹ä¸ƒä¸ªä¼˜ç‚¹ï¼Œè®©æˆ‘æ¥ä¸€ä¸€ä¸¾ä¾‹è¯´æ˜ï¼š\nIntegratedï¼šæ‰€è°“çš„Integratedï¼ˆé›†æˆåŒ–ï¼‰ï¼ŒLINQæ˜¯ä»ä»¥ä¸‹æ–¹é¢ä½“ç°é›†æˆçš„ï¼š (1):æŠŠæŸ¥è¯¢è¯­æ³•èå…¥äº†C#(VB)è¿™äº›è¯­è¨€ä¸­ï¼Œè®©ä»–å˜æˆäº†ä¸€ç§è¯­æ³•ã€‚è¿™æ ·å°±èƒ½å’ŒC#ä¸­çš„å…¶ä»–è¯­æ³•ä¸€æ ·æ”¯æŒï¼š\nè¯­å¥é«˜äº®æ˜¾ç¤ºï¼Œç±»å‹æ£€æŸ¥ï¼Œå…è®¸ä½¿ç”¨debuggerè°ƒè¯•\n(2):æŠŠä»¥å‰å¤æ‚çš„æŸ¥è¯¢å‰çš„å·¥ä½œéƒ½é›†æˆå°è£…èµ·æ¥ï¼Œè®©å¼€å‘äººå‘˜ä¾§é‡äºæŸ¥è¯¢ã€‚\n(3):é›†æˆåçš„è¯­æ³•æ›´åŠ çš„æ¸…æ™°æ˜“æ‡‚ï¼Œå¯è¯»æ€§è¾ƒé«˜ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 æ¯”è¾ƒï¼š //åŸæ¥çš„æ ¼å¼ SqlConnection sqlConn = new SqlConnection(connectionString);\u0026gt; sqlConn.Open(); SqlCommand command = new SqlCommand(); command.Connection = sqlConn; command.CommandText = \u0026#34;Select * From Customer\u0026#34;; SqlDataReader dataReader = command.ExecuteReader(CommandBehavior.CloseConnection); //LINQçš„æ ¼å¼ NORTHWNDDataContext dc = new NORTHWNDDataContext(); var query = from c in dc.Customers select c; Unitiveï¼šæ‰€è°“Unitive(ç»Ÿä¸€åŒ–)å°±æŒ‡ä¸ç®¡å¯¹ä»»ä½•ç±»å‹å¤–éƒ¨å’Œå†…éƒ¨æ•°æ®æº(å¯¹è±¡é›†åˆ,xlm,æ•°æ®åº“æ•°æ®)éƒ½ä½¿ç”¨ç»Ÿä¸€çš„æŸ¥è¯¢è¯­æ³•ã€‚ ä½¿ç”¨ç»Ÿä¸€åŒ–æŸ¥è¯¢è¯­è¨€çš„å¥½å¤„åœ¨äºä»¥ä¸‹å‡ ç‚¹ï¼š\nä½ ä¸ç”¨å› ä¸ºè¦ä½¿ç”¨ä¸å¤ªç†Ÿæ‚‰çš„æ•°æ®æºè€ŒèŠ±å¾ˆå¤šç²¾åŠ›å»äº†è§£å®ƒï¼Œä½ å¯ä»¥å¿«é€Ÿç®€å•çš„ä½¿ç”¨LINQè¯­æ³•å¯¹èµ·æŸ¥è¯¢ã€‚ ç”±äºä½¿ç”¨äº†ç»Ÿä¸€çš„è¯­æ³•ï¼Œå¯ä»¥ä½¿ä»£ç ç»´æŠ¤å˜çš„æ›´åŠ ç®€å•ã€‚ ä»¥ä¸‹ä»£ç ä½“ç°äº†LINQçš„ç»Ÿä¸€åŒ–ï¼š\n1 2 3 4 5 6 7 8 9 10 //æ•°æ®æº:å¯¹è±¡é›†åˆ var query = from c in GetCustomers() select c; //æ•°æ®æº:SQL var query1 = from c in dc.Customers select c; //æ•°æ®æº:XML var query2 = from c in customers.Descendants(\u0026#34;Customer\u0026#34;) select c; Extensibleï¼šæ‰€è°“Extensible(å¯æ‰©å±•)æŒ‡ä»¥ä¸‹2ä¸ªæ–¹é¢: (1).å¯æŸ¥è¯¢æ•°æ®æºçš„æ‰©å±•ã€‚ LINQæä¾›äº†ä¸ªLINQ provider modelï¼Œä½ å¯ä»¥ä¸ºLINQåˆ›å»ºæˆ–æä¾›providerè®©LINQæ”¯æŒæ›´å¤šçš„æ•°æ®æºã€‚\n(2).å¯æ‰©å±•æŸ¥è¯¢æ–¹æ³•ã€‚å¼€å‘è€…å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚ä¸ºLINQé‡å†™å’Œæ‰©å±•æŸ¥è¯¢æ–¹æ³•ã€‚\nä»¥ä¸‹æ˜¯äº›ç¬¬ä¸‰æ–¹çš„LINQ providerï¼š\nLINQ Extender, LINQ to JavaScript, LINQ to JSON, LINQ to MySQL, LINQ to Flickr, LINQ to Google\nDeclarativeï¼šæ‰€è°“Declarative(å£°æ˜å¼)ï¼Œç®€å•çš„æ¥è¯´æŒ‡çš„æ˜¯å¼€å‘äººå‘˜åªè¦å‘Šè¯‰ç¨‹åºåšä»€ä¹ˆï¼Œç¨‹åºè‡ªå·±åˆ¤æ–­æ€ä¹ˆåšã€‚ Declarative programming(å£°æ˜å¼ç¼–ç¨‹)çš„ä¼˜ç‚¹ä½“ç°åœ¨ä»¥ä¸‹2ç‚¹ï¼š\n(1).æé«˜äº†å¼€å‘é€Ÿåº¦ã€‚å› ä¸ºå¼€å‘è€…ä¸ç”¨ä¹¦å†™å¤§é‡çš„ä»£ç æ¥å…·ä½“åŒ–æ‰§è¡Œæ­¥éª¤ï¼Œåªè®¸å‘Šè¯‰ç¨‹åºåšä»€ä¹ˆã€‚\n(2).æé«˜ä»£ç ä¼˜åŒ–ç©ºé—´ã€‚å› ä¸ºå¼€å‘è€…ä¸ç”¨å‚ä¸å¹²æ¶‰å¯¹ç¨‹åºæ‰§è¡Œçš„å…·ä½“æ­¥éª¤ï¼Œè¿™æ ·å°±æä¾›ç»™ç¼–è¯‘å™¨æ›´å¤šçš„ç©ºé—´å»ä¼˜åŒ–ä»£ç ã€‚\nä¸¾ä¾‹SQLæ¥è¯´ï¼ŒLINQç”Ÿæˆçš„SQLè¯­å¥å¾€å¾€æ¯”ä¸€å¯¹SQLæ°´å¹³ä¸€èˆ¬çš„å¼€å‘è€…èƒ½å†™å‡ºæ›´å¥½çš„SQLè¯­å¥ã€‚\næ¯”è¾ƒDeclarative programming ä¸ Imperative programmingï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 //å£°æ˜å¼ç¼–ç¨‹ List\u0026lt;List\u0026lt;int\u0026gt;\u0026gt; lists = new List\u0026lt;List\u0026lt;int\u0026gt;\u0026gt; { new List\u0026lt;int\u0026gt; { 1, 2, 3 }, new List\u0026lt;int\u0026gt; { 4, 5 } }; var query = from list in lists from num in list where num % 3 == 0 orderby num descending select num; //å‘½ä»¤å¼ç¼–ç¨‹ List\u0026lt;int\u0026gt; list1 = new List\u0026lt;int\u0026gt;(); list1.Add(1); list1.Add(2); list1.Add(3); List\u0026lt;int\u0026gt; list2 = new List\u0026lt;int\u0026gt;(); list2.Add(4); list2.Add(5); List\u0026lt;List\u0026lt;int\u0026gt;\u0026gt; lists1 = new List\u0026lt;List\u0026lt;int\u0026gt;\u0026gt;(); lists1.Add(list1); lists1.Add(list2); List\u0026lt;int\u0026gt; newList = new List\u0026lt;int\u0026gt;(); foreach (var item in lists1) foreach (var num in item) if (num % 3 == 0) newList.Add(num); newList.Reverse(); .Hierarchicalï¼šæ‰€è°“Hierarchical(å±‚æ¬¡åŒ–)æŒ‡ä½¿ç”¨é¢å‘å¯¹è±¡çš„æ–¹å¼æŠ½è±¡æ•°æ®ã€‚ SQLæ˜¯å…³ç³»å‹æ•°æ®åº“ï¼Œå®ƒä»¥å…³ç³»çš„æ–¹å¼æè¿°æ•°æ®ä»¥æ•°æ®çš„è”ç³»ï¼Œä½†æˆ‘ä»¬çš„ç¨‹åºè®¾è®¡æˆé¢å‘å¯¹è±¡çš„å› æ­¤æˆ‘ä»¬åœ¨ç¨‹åºé‡Œå¾—åˆ°çš„æ•°æ®åº“æ•°æ®å¾€å¾€éƒ½æ˜¯\nrectangular gridï¼ˆå¹³é¢çš„æ˜¾ç¤ºæ•°æ®ï¼‰ã€‚ä½†æ˜¯LINQé€šè¿‡æ‰€è°“çš„O-R Mappingæ–¹å¼ï¼ŒæŠŠå…³ç³»å‹è½¬æ¢æˆå¯¹è±¡ä¸å¯¹è±¡æ–¹å¼æè¿°æ•°æ®ã€‚\nè¿™æ ·å¸¦æ¥çš„å¥½å¤„æ˜¯ï¼šå¼€å‘è€…èƒ½ç›´æ¥ä»¥å¯¹è±¡çš„æ–¹å¼å»æ“ä½œæ•°æ®ï¼Œå¯¹ä¹ æƒ¯é¢å‘å¯¹è±¡çš„å¼€å‘è€…æ¥è¯´é¢å‘å¯¹è±¡æ¨¡å‹æ›´æ˜“ç†è§£ã€‚\n.Composableï¼šæ‰€è°“Composable(å¯ç»„æˆ)æŒ‡LINQå¯ä»¥æŠŠä¸€ä¸ªå¤æ‚çš„æŸ¥è¯¢æ‹†åˆ†æˆå¤šä¸ªç®€å•æŸ¥è¯¢ã€‚ LINQè¿”å›çš„ç»“æœéƒ½æ˜¯åŸºäºæ¥å£ï¼šIEnumerableï¼Œå› æ­¤èƒ½å¯¹æŸ¥è¯¢ç»“æœç»§ç»­æŸ¥è¯¢ï¼Œè€Œä¸”LINQå…·æœ‰å»¶è¿Ÿæ‰§è¡Œçš„ç‰¹æ€§å› æ­¤æ‹†åˆ†æ‰§è¡Œä¸ä¼šå½±å“æ•ˆç‡ã€‚\nä¼˜ç‚¹åœ¨äºï¼š\n(1).æ–¹ä¾¿è°ƒè¯•ã€‚æŠŠå¤æ‚çš„æŸ¥è¯¢æ‹†åˆ†æˆç®€å•çš„æŸ¥è¯¢ï¼Œç„¶åé€ä¸ªè°ƒè¯•ã€‚\n(2).ä¾¿äºä»£ç ç»´æŠ¤ã€‚æŠŠä»£ç æ‹†åˆ†åèƒ½ä½¿ä»£ç å˜çš„æ›´æ˜“ç†è§£ã€‚\nä»¥ä¸‹ä»£ç ä½“ç°äº†å¯ç»„æˆæ€§ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 //ä»¥ä¸‹ä»£ç ä½“ç°äº†Composable List\u0026lt;List\u0026lt;int\u0026gt;\u0026gt; lists = new List\u0026lt;List\u0026lt;int\u0026gt;\u0026gt; { new List\u0026lt;int\u0026gt; { 1, 2, 3 }, new List\u0026lt;int\u0026gt; { 4, 5 } }; var query1 = from list in lists from num in list select num; var query2 = from num in query1 where num % 3 == 0 select num; var query3 = from num in query2 orderby num descending select num; ######7.Transformativeï¼šæ‰€è°“Transformative(å¯è½¬æ¢)æŒ‡çš„æ˜¯LINQèƒ½æŠŠä¸€ç§æ•°æ®æºçš„å†…å®¹è½¬æ¢åˆ°å…¶ä»–æ•°æ®æºã€‚\næ–¹ä¾¿ç”¨æˆ·åšæ•°æ®ç§»æ¤ã€‚\nä»¥ä¸‹ä»£ç ä½“ç°äº†è½¬æ¢çš„ç‰¹æ€§ï¼š\n1 2 3 4 5 6 //æŠŠå…³ç³»å‹æ•°æ®è½¬æ¢æˆXMLå‹ var query = new XElement(\u0026#34;Orders\u0026#34;, from c in dc.Customers where c.City == \u0026#34;Paris\u0026#34; select new XElement(\u0026#34;Order\u0026#34;, new XAttribute(\u0026#34;Address\u0026#34;, c.Address))); ä»¥ä¸Šå°±æ˜¯LINQçš„å‡ å¤§ä¼˜ç‚¹ï¼Œå¾ˆé«˜å…´èƒ½åœ¨è¿™é‡Œå’Œå¤§å®¶åˆ†äº«ã€‚æœ‰ä»»ä½•ä¸è¶³ä¹‹å¤„è¯·ç»™äºˆè¡¥å……å’Œçº æ­£ï¼Œè°¢è°¢å…‰ä¸´å°èˆã€‚\n//2011/1/28 è¡¥å……(LINQ TO SQL)\nåœ¨LINQ TO SQL æ–¹é¢ï¼Œå¦‚æœä½¿ç”¨LINQ TO SQLå¯ä»¥æœ‰æ•ˆçš„é˜²æ­¢SQLæ³¨å…¥ï¼ŒLINQ TO SQL ä¼šæŠŠæ³¨å…¥çš„ä»£ç å½“åšæ— ç”¨çš„å‚æ•°å¤„ç†ã€‚\nhttp://www.cnblogs.com/c-jquery-linq-sql-net-problem/archive/2011/01/15/LINQ_Merit.html\n","date":"2016-10-04T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/c%23-linq/","title":"C# LINQ"},{"content":"å‘¨æœ«é—²ç€æ— äº‹åˆ·çŸ¥ä¹å‘ç°ä¸€ä¸ªçˆ¬è™«æ•™ç¨‹ï¼ˆé«˜å¾·API+Pythonè§£å†³ç§Ÿæˆ¿é—®é¢˜ ï¼‰ï¼Œæ­£ä¸­æœ€è¿‘æƒ³è¦æ¢åœ°æ–¹ä½çš„ç—›ç‚¹ã€‚ç„¶åå¤§æ—©ä¸Šæ‡’è§‰éƒ½æ²¡ç¡å°±å±é¢ å±é¢ å¼€å§‹ç ”ç©¶è¿™ä¸ªæ•™ç¨‹äº†ã€‚è¿™æ ·æ•™ç¨‹åœ¨å®éªŒæ¥¼ç½‘ç«™é‡Œé¢æœ‰æ‰‹æŠŠæ‰‹æ­¥éª¤ï¼Œæœ‰å…´è¶£è‡ªå–ï¼ˆå®éªŒæ¥¼ï¼šé«˜å¾·API+Pythonè§£å†³ç§Ÿæˆ¿é—®é¢˜ï¼‰ã€‚\næ•´ä½“é¡¹ç›®ä¸»è¦åˆ†æˆä¸¤æ­¥ï¼š\nç¬¬ä¸€æ­¥:pythonçˆ¬å–æ•°æ®ï¼Œç”Ÿæˆæ•°æ®æ–‡ä»¶;\nç¬¬äºŒéƒ¨ï¼šå¯¼å…¥æ•°æ®æ–‡ä»¶ï¼Œåœ¨åœ°å›¾ä¸Šæ˜¾ç¤ºæˆ¿æºï¼Œè®¾å®šä¸Šç­åœ°ç‚¹åè‡ªåŠ¨è®¡ç®—å‡ºè¡Œè·¯çº¿å’Œè·¯ç¨‹æ—¶é—´ã€‚\nç ”ç©¶äº†ä¸€ä¸‹è¿™ä¸ªæ•™ç¨‹ä¹‹åå‘ç°è¿™è´§åšå¾—å®åœ¨æœ‰ç‚¹ç²—ç³™ï¼Œåªèƒ½å½“æ•™ç¨‹ç”¨ï¼Œå®Œå…¨æ²¡æœ‰é€šç”¨å®é™…ä»·å€¼ã€‚\nè€Œä¸”è¿™é‡Œé¢è¿˜æœ‰ä¸ªæ›´å¤§çš„é—®é¢˜ï¼šæ•™ç¨‹æ˜¯åŸºäºåŒ—äº¬çš„æ•°æ®æ¥åšçš„ï¼Œè€Œæˆ‘åœ¨ä¸Šæµ·\u0026hellip;\nè™½ç„¶è¯´æ”¹æ”¹pythonæ•°æ®æºï¼Œæ”¹æ”¹å¯¼èˆªé¡µé¢JSå®Œäº‹ã€‚ä¸è¿‡æ˜¯åœ¨éš¾ç”¨\u0026hellip;\näºæ˜¯ï¼Œå¼€å§‹è‡ªå·±åŠ¨æ‰‹äº†ã€‚å…ˆçœ‹åŸæœ‰çš„pythonä»£ç ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 #-*- coding:utf-8 -*- from bs4 import BeautifulSoup from urlparse import urljoin import requests import csv url = \u0026#34;http://bj.58.com/pinpaigongyu/pn/{page}/?minprice=2000_4000\u0026#34; #å·²å®Œæˆçš„é¡µæ•°åºå·ï¼Œåˆæ—¶ä¸º0 page = 0 csv_file = open(\u0026#34;rent.csv\u0026#34;,\u0026#34;wb\u0026#34;) csv_writer = csv.writer(csv_file, delimiter=\u0026#39;,\u0026#39;) while True: page += 1 print \u0026#34;fetch: \u0026#34;, url.format(page=page) response = requests.get(url.format(page=page)) html = BeautifulSoup(response.text) house_list = html.select(\u0026#34;.list \u0026gt; li\u0026#34;) # å¾ªç¯åœ¨è¯»ä¸åˆ°æ–°çš„æˆ¿æºæ—¶ç»“æŸ if not house_list: break for house in house_list: house_title = house.select(\u0026#34;h2\u0026#34;)[0].string.encode(\u0026#34;utf8\u0026#34;) house_url = urljoin(url, house.select(\u0026#34;a\u0026#34;)[0][\u0026#34;href\u0026#34;]) house_info_list = house_title.split() # å¦‚æœç¬¬äºŒåˆ—æ˜¯å…¬å¯“ååˆ™å–ç¬¬ä¸€åˆ—ä½œä¸ºåœ°å€ if \u0026#34;å…¬å¯“\u0026#34; in house_info_list[1] or \u0026#34;é’å¹´ç¤¾åŒº\u0026#34; in house_info_list[1]: house_location = house_info_list[0] else: house_location = house_info_list[1] house_money = house.select(\u0026#34;.money\u0026#34;)[0].select(\u0026#34;b\u0026#34;)[0].string.encode(\u0026#34;utf8\u0026#34;) csv_writer.writerow([house_title, house_location, house_money, house_url]) csv_file.close() æ•´ä¸ªä»£ç åŸºæœ¬æ€è·¯å°±æ˜¯ï¼Œçˆ¬å–http://bj.58.com/pinpaigongyu/pn/{page}/?minprice=2000_4000é¡µé¢æ•°æ®ï¼Œç„¶åæ‰”åˆ°åˆ›å»ºçš„csvæ–‡ä»¶é‡Œé¢ä½œä¸ºä¸‹ä¸€æ­¥çš„æ•°æ®æºã€‚ é€šè¿‡ç ”ç©¶http://bj.58.com/pinpaigongyu/pn/{page}/?minprice=2000_4000è¿™ä¸ªé¡µé¢çš„æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“å‘ç°ï¼Œåœ¨é¡µé¢ä¸­ï¼Œæ¯æ¡æ•°æ®éƒ½æ˜¯ä¸€ä¸ªliæ ‡ç­¾ã€‚\nå¦‚ä¸‹å›¾ï¼š\nliç»“æ„å¦‚ä¸‹ï¼š 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 \u0026lt;li logr=\u0026#34;\u0026#34; class=\u0026#34;\u0026#34;\u0026gt; \u0026lt;a href=\u0026#34;/pinpaigongyu/26851774057013x.shtml\u0026#34; target=\u0026#34;_blank\u0026#34; onclick=\u0026#34;clickLog(\u0026#39;from=fcpc_list_gy_sh_tupian\u0026#39;)\u0026#34; tongji_label=\u0026#34;listclick\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;img\u0026#34;\u0026gt; \u0026lt;img lazy_src=\u0026#34;\u0026#34; alt=\u0026#34;\u0026#34; src=\u0026#34;\u0026#34;\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;des\u0026#34;\u0026gt; \u0026lt;h2\u0026gt;ã€åˆç§Ÿã€‘èŠå›­æ–°åŒº æŸ³æ¹–æ™¯åº­ 3å®¤æ¬¡å§\u0026lt;/h2\u0026gt; \u0026lt;p class=\u0026#34;room\u0026#34;\u0026gt; 3å®¤1å…1å«\u0026amp;nbsp; \u0026amp;nbsp; 13mÂ²\u0026amp;nbsp;\u0026amp;nbsp; 3/6å±‚\u0026amp;nbsp; \u0026lt;/p\u0026gt; \u0026lt;p class=\u0026#34;dist\u0026#34;\u0026gt;\u0026lt;/p\u0026gt; \u0026lt;p class=\u0026#34;spec\u0026#34;\u0026gt; \u0026lt;span class=\u0026#34;spec1\u0026#34;\u0026gt;å…¬å…±é˜³å°\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026#34;spec2\u0026#34;\u0026gt;å…¬å…±å«ç”Ÿé—´\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026#34;spec3\u0026#34;\u0026gt;ç¦»åœ°é“è¿‘\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026#34;spec4\u0026#34;\u0026gt;å¨æˆ¿\u0026lt;/span\u0026gt; \u0026lt;/p\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;money\u0026#34;\u0026gt; \u0026lt;span\u0026gt;\u0026lt;b\u0026gt;1100\u0026lt;/b\u0026gt;å…ƒ/æœˆ \u0026lt;/span\u0026gt; \u0026lt;p\u0026gt;ç§Ÿæˆ¿æœˆä»˜\u0026lt;/p\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/a\u0026gt; \u0026lt;/li\u0026gt; ç…§ç€pythonçš„æ€è·¯ï¼Œæ˜¯æŠŠæ‰€æœ‰çš„liæ ‡ç­¾çš„æ•°æ®æå–å‡ºæ¥çš„ã€‚\næˆ‘è‡ªå·±ç ”ç©¶çš„æ—¶å€™åˆçœ‹äº†ä¸‹ï¼Œå…¶å®æ•°æ®éƒ½åœ¨ä¸€ä¸ªå±æ€§ä¸ºtongji_label=\u0026ldquo;listclick\u0026quot;çš„aæ ‡ç­¾é‡Œé¢ã€‚\nä¸€èˆ¬æ¥è¯´ï¼Œå­—ç¬¦åŒ¹é…ç”¨æ­£åˆ™è¡¨è¾¾å¼å®Œäº‹ï¼Œå¥ˆä½•æ­£åˆ™æ°´å¹³å®åœ¨ä¸ä½³ã€‚æˆ‘è¿˜æ˜¯é€‰æ‹©ç›´æ¥ä¸ŠHtmlAgilityPackç®—äº†ã€‚ å…³äºHtmlAgilityPackçš„ä»‹ç»è¿˜æ˜¯çœ‹å®˜ç½‘ç®—äº†ã€‚HtmlAgilityPack\nHtmlAgilityPackæ˜¯.NETä¸€ä¸ªæ¯”è¾ƒå¼ºå¤§çš„HTMLå¤„ç†ç±»åº“äº†ï¼ŒåŸºæœ¬å¯ä»¥è®©ä½ åƒJSæ¥æ“ä½œHTMLæ ‡ç­¾ã€‚ å®‰è£…è¿™è´§å¾ˆç®€å•ï¼Œç›´æ¥åœ¨Nuget PMåŒ…ç®¡ç†å·¥å…·é‡Œé¢è¾“å…¥ä¸‹é¢å‘½ä»¤å°±å®Œäº‹äº†ã€‚\n1 Install-Package HtmlAgilityPack æœ‰éœ€è¦ä½¿ç”¨æ•™ç¨‹å¯ä»¥çœ‹è¿™ä¸ªï¼šHtml Agility PackåŸºç¡€ç±»ä»‹ç»åŠè¿ç”¨\nä¸‹é¢ç›´æ¥è´´controlleræºç ç®—äº†ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 /// \u0026lt;/summary\u0026gt; /// \u0026lt;param name=\u0026#34;costFrom\u0026#34;\u0026gt;ä»·æ ¼åŒºé—´èµ·å§‹å€¼\u0026lt;/param\u0026gt; /// \u0026lt;param name=\u0026#34;costTo\u0026#34;\u0026gt;ä»·æ ¼åŒºé—´ç»ˆæ­¢å€¼\u0026lt;/param\u0026gt; /// \u0026lt;param name=\u0026#34;cnName\u0026#34;\u0026gt;åŸå¸‚æ‹¼éŸ³é¦–å­—æ¯\u0026lt;/param\u0026gt; /// \u0026lt;returns\u0026gt;\u0026lt;/returns\u0026gt; public ActionResult Get58CityRoomData(int costFrom, int costTo, string cnName) { if (costTo\u0026lt;=0 || costTo \u0026lt; costFrom) { return Json(new { IsSuccess = false, Error = \u0026#34;è¾“å…¥æ•°æ®æœ‰è¯¯ï¼Œè¯·é‡æ–°è¾“å…¥ã€‚\u0026#34; }); } if (string.IsNullOrEmpty(cnName)) { return Json(new { IsSuccess = false, Error = \u0026#34;åŸå¸‚å®šä½å¤±è´¥ï¼Œå»ºè®®æ¸…é™¤æµè§ˆå™¨ç¼“å­˜åé‡æ–°è¿›å…¥ã€‚\u0026#34; }); } try { var lstHouse = new List\u0026lt;HouseInfo\u0026gt;(); string tempURL = \u0026#34;http://\u0026#34; + cnName + \u0026#34;.58.com/pinpaigongyu//pn/{0}/?minprice=\u0026#34; + costFrom + \u0026#34;_\u0026#34; + costTo; Uri uri = new Uri(tempURL); var htmlResult = HTTPHelper.GetHTMLByURL(string.Format(tempURL, 1)); HtmlDocument htmlDoc = new HtmlDocument(); htmlDoc.LoadHtml(htmlResult); var countNodes = htmlDoc.DocumentNode. SelectSingleNode(\u0026#34;.//span[contains(@class,\u0026#39;list\u0026#39;)]\u0026#34;); int pageCount = 10; if (countNodes != null \u0026amp;\u0026amp; countNodes.HasChildNodes) { pageCount = Convert.ToInt32(countNodes.ChildNodes[0].InnerText) / 20; if(pageCount==0) { return Json(new { IsSuccess = false, Error =string.Format(\u0026#34;æ²¡æœ‰æ‰¾åˆ°ä»·æ ¼åŒºé—´ä¸º{0} - {1}çš„æˆ¿å­ã€‚\u0026#34;, costFrom,costTo)}); } } for (int pageIndex = 1; pageIndex \u0026lt;= pageCount; pageIndex++) { htmlResult = HTTPHelper.GetHTMLByURL(string.Format(tempURL, pageIndex)); htmlDoc.LoadHtml(htmlResult); var roomList = htmlDoc.DocumentNode .SelectNodes(\u0026#34;.//a[contains(@tongji_label,\u0026#39;listclick\u0026#39;)]\u0026#34;); foreach (var room in roomList) { var houseTitle = room.SelectSingleNode(\u0026#34;.//h2\u0026#34;).InnerHtml; var houseURL = uri.Host + room.Attributes[\u0026#34;href\u0026#34;].Value; var house_info_list = houseTitle.Split(\u0026#39; \u0026#39;); var house_location = string.Empty; if (house_info_list[1].Contains(\u0026#34;å…¬å¯“\u0026#34;) || house_info_list[1].Contains(\u0026#34;é’å¹´ç¤¾åŒº\u0026#34;)) { house_location = house_info_list[0]; } else { house_location = house_info_list[1]; } var momey = room.SelectSingleNode(\u0026#34;.//b\u0026#34;).InnerHtml; lstHouse.Add(new HouseInfo() { HouseTitle = houseTitle, HouseLocation = house_location, HouseURL = houseURL, Money = momey, }); } } return Json(new { IsSuccess = true, HouseInfos = lstHouse }); } catch (Exception ex) { return Json(new { IsSuccess = false, Error = \u0026#34;è·å–æ•°æ®å¼‚å¸¸ã€‚\u0026#34; + ex.ToString() }); } } ä¸‹é¢è§£é‡Šä¸€ä¸‹æ ¸å¿ƒä»£ç ã€‚\nç‰‡æ®µä¸€ï¼šè·å–æ€»æ•°ã€‚\nåœ¨è§‚å¯Ÿ58åŒåŸé¡µé¢çš„æ—¶å€™ï¼Œæ— æ„å‘ç°å…¶å®ç¬¬ä¸€ä¸ªåŠ è½½çš„é¡µé¢ä¸­æœ‰ä¸€ä¸ªæ•°æ®æ€»æ¡æ•°ï¼Œéšè—åœ¨é¡µé¢é‡Œé¢çš„ã€‚\n1 \u0026lt;span class=\u0026#34;listsum\u0026#34;\u0026gt;\u0026lt;em\u0026gt;1813\u0026lt;/em\u0026gt;æ¡ç»“æœ\u0026lt;/span\u0026gt; è¿™æ ·ä¸€æ¥ï¼Œæ€»é¡µé¢å°±å¾ˆæ¸…æ™°äº†ã€‚é¡µé¢=æ€»æ•°/æ¯é¡µ20æ¡ã€‚ç„¶åæˆ‘ä»¬æ ¹æ®å·²çŸ¥çš„æ•°æ®è§„åˆ™å»å¾ªç¯è¯·æ±‚é¡µé¢ï¼Œä¹Ÿå°±èƒ½æ‹¿åˆ°æ‰€æœ‰çš„æœç´¢æ•°æ®äº†ã€‚\næ ¸å¿ƒä»£ç ï¼Œè·å–æ€»æ¡æ•°ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 var countNodes = htmlDoc.DocumentNode. SelectSingleNode(\u0026#34;.//span[contains(@class,\u0026#39;list\u0026#39;)]\u0026#34;); int pageCount = 10; if (countNodes != null \u0026amp;\u0026amp; countNodes.HasChildNodes) { pageCount = Convert.ToInt32(countNodes.ChildNodes[0].InnerText) / 20; if(pageCount==0) { return Json(new { IsSuccess = false, Error =string.Format(\u0026#34;æ²¡æœ‰æ‰¾åˆ°ä»·æ ¼åŒºé—´ä¸º{0} - {1}çš„æˆ¿å­ã€‚\u0026#34;, costFrom,costTo)}); } } åœ¨HTMLDocé‡Œé¢æ‰¾åˆ°ä¸€ä¸ªspançš„classåŒ…å«listçš„èŠ‚ç‚¹ï¼Œè·å–å®ƒå­èŠ‚ç‚¹ï¼ˆå³emï¼‰çš„å†…å®¹ï¼Œå¼ºåˆ¶è½¬æ¢æˆæ•°å­—ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬è¦æ‰¾çš„æ€»æ¡æ•°äº†ã€‚æ€»æ¡æ•°é™¤ä»¥20å°±å¾—åˆ°äº†é¡µæ•°ï¼Œä¸‹é¢å°±æ˜¯å¼€å§‹å¾ªç¯è¯·æ±‚é¡µé¢äº†ã€‚\nåœ¨æœ€ä¸Šé¢æˆ‘ä»¬åˆ†æè¿‡å…¬å¯“æ•°æ®åˆ†å¸ƒï¼Œæ•°æ®æ˜¯lié‡Œé¢å¥—aæ ‡ç­¾ï¼Œæˆ‘ä»¬éœ€è¦çš„åœ°ç†ä½ç½®ã€æˆ¿é—´åç§°ã€ä»·æ ¼éƒ½åœ¨aæ ‡ç­¾é‡Œé¢ã€‚\nè¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬è¿™è¦è·å¾—åˆ°é¡µé¢æ‰€æœ‰å¸¦æœ‰å±æ€§ä¸ºtongji_label=\u0026ldquo;listclick\u0026quot;çš„aæ ‡ç­¾æ•°æ®ï¼Œä¹Ÿå°±å¾—åˆ°äº†æˆ‘ä»¬æ‰€æœ‰éœ€è¦çš„æ•°æ®ã€‚\nçœ‹ä¸€ä¸‹aæ ‡ç­¾çš„æ•°æ®ç»„æˆï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 \u0026lt;a href=\u0026#34;/pinpaigongyu/26851774057013x.shtml\u0026#34; target=\u0026#34;_blank\u0026#34; onclick=\u0026#34;clickLog(\u0026#39;from=fcpc_list_gy_sh_tupian\u0026#39;)\u0026#34; tongji_label=\u0026#34;listclick\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;img\u0026#34;\u0026gt; \u0026lt;img lazy_src=\u0026#34;\u0026#34; alt=\u0026#34;\u0026#34; src=\u0026#34;\u0026#34;\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;des\u0026#34;\u0026gt; \u0026lt;h2\u0026gt;ã€åˆç§Ÿã€‘èŠå›­æ–°åŒº æŸ³æ¹–æ™¯åº­ 3å®¤æ¬¡å§\u0026lt;/h2\u0026gt; \u0026lt;p class=\u0026#34;room\u0026#34;\u0026gt; 3å®¤1å…1å«\u0026amp;nbsp; \u0026amp;nbsp; 13mÂ²\u0026amp;nbsp;\u0026amp;nbsp; 3/6å±‚\u0026amp;nbsp; \u0026lt;/p\u0026gt; \u0026lt;p class=\u0026#34;dist\u0026#34;\u0026gt;\u0026lt;/p\u0026gt; \u0026lt;p class=\u0026#34;spec\u0026#34;\u0026gt; \u0026lt;span class=\u0026#34;spec1\u0026#34;\u0026gt;å…¬å…±é˜³å°\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026#34;spec2\u0026#34;\u0026gt;å…¬å…±å«ç”Ÿé—´\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026#34;spec3\u0026#34;\u0026gt;ç¦»åœ°é“è¿‘\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026#34;spec4\u0026#34;\u0026gt;å¨æˆ¿\u0026lt;/span\u0026gt; \u0026lt;/p\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;money\u0026#34;\u0026gt; \u0026lt;span\u0026gt;\u0026lt;b\u0026gt;1100\u0026lt;/b\u0026gt;å…ƒ/æœˆ \u0026lt;/span\u0026gt; \u0026lt;p\u0026gt;ç§Ÿæˆ¿æœˆä»˜\u0026lt;/p\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/a\u0026gt; æˆ‘ä»¬è¦çš„æˆ¿é—´ä¿¡æ¯åœ¨ä¸€ä¸ªh2çš„æ ‡ç­¾é‡Œé¢ï¼Œå…¬å¯“ç§Ÿé‡‘ä»·é’±åœ¨class=\u0026ldquo;money\u0026quot;çš„divæ ‡ç­¾é‡Œé¢ã€‚\näºæ˜¯æœ‰äº†ä¸€ä¸‹ä»£ç ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 for (int pageIndex = 1; pageIndex \u0026lt;= pageCount; pageIndex++) { htmlResult = HTTPHelper.GetHTMLByURL(string.Format(tempURL, pageIndex)); htmlDoc.LoadHtml(htmlResult); //æ‰¾åˆ°æ‰€æœ‰çš„å¸¦æœ‰å±æ€§ä¸ºtongji_label=\u0026#34;listclick\u0026#34;çš„aæ ‡ç­¾æ•°æ® var roomList = htmlDoc.DocumentNode.SelectNodes(\u0026#34;.//a[contains(@tongji_label,\u0026#39;listclick\u0026#39;)]\u0026#34;); foreach (var room in roomList) { //è·å–å…¶ä¸­ä¸ºh2çš„æˆ¿é—´æ•°æ®ï¼Œç„¶åç”¨ç©ºæ ¼åˆ†å‰²æˆæ•°ç»„ var houseTitle = room.SelectSingleNode(\u0026#34;.//h2\u0026#34;).InnerHtml; var houseURL = uri.Host + room.Attributes[\u0026#34;href\u0026#34;].Value; var house_info_list = houseTitle.Split(\u0026#39; \u0026#39;); var house_location = string.Empty; //åˆ†å‰²å‡ºæ¥çš„æ•°ç»„ï¼Œç¬¬äºŒä¸ªåŒ…å«å…¬å¯“æˆ–é’å¹´ç¤¾åŒºï¼Œåˆ™å–ç¬¬ä¸€ä¸ªæ•°æ®ä¸ºæ‰€åœ¨åœ°åŒºï¼Œå¦åˆ™å–ç¬¬äºŒä¸ªæ•°æ® //ã€åˆç§Ÿã€‘èŠå›­æ–°åŒº æŸ³æ¹–æ™¯åº­ 3å®¤æ¬¡å§ // æ‰€åœ¨åœ°åŒºä¸ºï¼šèŠå›­æ–°åŒº if (house_info_list[1].Contains(\u0026#34;å…¬å¯“\u0026#34;) || house_info_list[1].Contains(\u0026#34;é’å¹´ç¤¾åŒº\u0026#34;)) { house_location = house_info_list[0]; } else { house_location = house_info_list[1]; } //è·å–æ ‡ç­¾ä¸ºbçš„æ•°æ®ï¼Œä»·æ ¼å°±åœ¨é‡Œé¢äº† var momey = room.SelectSingleNode(\u0026#34;.//b\u0026#34;).InnerHtml; lstHouse.Add(new HouseInfo() { HouseTitle = houseTitle, HouseLocation = house_location, HouseURL = houseURL, Money = momey, }); } } åç«¯æ¥è¯´ï¼ŒåŸºæœ¬å°±è¿™äº›å†…å®¹äº†ã€‚\nè¿˜æœ‰ä¸€äº›å‰ç«¯é«˜å¾·åœ°å›¾æ¥å£è°ƒç”¨ä¸‹æ¬¡å†è®²å§ï¼Œè¦é™ªå¥³ç¥¨ç©æ¸¸æˆå»äº†\u0026hellip;\n^-^\nä»¥ä¸Šæºç åœ°å€ï¼šhttps://github.com/liguobao/58HouseSearch\nåœ¨çº¿åœ°å€ï¼š58å…¬å¯“é«˜å¾·æœæˆ¿(å…¨å›½ç‰ˆ)ï¼šhttps://woyaozufang.live\n","date":"2016-10-04T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/c%23-58%E5%90%8C%E5%9F%8E%E5%93%81%E7%89%8C%E5%85%AC%E5%AF%93%E7%88%AC%E8%99%AB/","title":"C#-58åŒåŸå“ç‰Œå…¬å¯“çˆ¬è™«"},{"content":"dotnetæ‰˜ç®¡å †å’Œåƒåœ¾å›æ”¶ æ‰˜ç®¡å †åŸºç¡€ ç®€è¿°ï¼šæ¯ä¸ªç¨‹åºéƒ½è¦ä½¿ç”¨è¿™æ ·æˆ–é‚£æ ·çš„èµ„æºï¼ŒåŒ…æ‹¬æ–‡ä»¶ã€å†…å­˜ç¼“å†²åŒºã€å±å¹•ç©ºé—´ã€ç½‘ç»œè¿æ¥\u0026hellip;..äº‹å®ä¸Šï¼Œåœ¨é¢å‘å¯¹è±¡çš„ç¯å¢ƒä¸­ï¼Œæ¯ä¸ªç±»å‹éƒ½ä»£è¡¨å¯ä¾›ç¨‹åºä½¿ç”¨çš„ä¸€ç§èµ„æºã€‚è¦ä½¿ç”¨è¿™äº›èµ„æºï¼Œå¿…é¡»ä¸ºä»£è¡¨èµ„æºçš„ç±»å‹åˆ†é…å†…å­˜ã€‚ ä»¥ä¸‹æ˜¯è®¿é—®ä¸€ä¸ªèµ„æºæ‰€éœ€æ­¥éª¤ï¼š\nè°ƒç”¨ILæŒ‡ä»¤newobjï¼Œä¸ºä»£è¡¨èµ„æºçš„ç±»å‹åˆ†é…å†…å­˜ã€‚(C# newæ“ä½œç¬¦) åˆå§‹åŒ–å†…å­˜ï¼Œè®¾ç½®èµ„æºçš„åˆå§‹çŠ¶æ€ã€‚ï¼ˆä¸€èˆ¬æŒ‡æ„é€ å‡½æ•°ï¼‰ è®¿é—®ç±»å‹çš„æˆå‘˜æ¥ä½¿ç”¨èµ„æºã€‚ï¼ˆä½¿ç”¨æˆå‘˜å˜é‡ã€æ–¹æ³•ã€å±æ€§ç­‰ï¼‰ æ‘§æ¯èµ„æºçš„çŠ¶æ€ä»¥è¿›è¡Œæ¸…é™¤ã€‚ï¼ˆDisposeï¼Ÿï¼Ÿï¼Ÿï¼‰ é‡Šæ”¾å†…å­˜ã€‚ï¼ˆGCï¼‰ ä»æ‰˜ç®¡å †åˆ†é…èµ„æº CLRè¦æ±‚æ‰€æœ‰çš„å¯¹è±¡éƒ½ä»æ‰˜ç®¡å †åˆ†é…ã€‚ è¿›ç¨‹åˆå§‹åŒ–ï¼ŒCLRåˆ’å‡ºä¸€ä¸ªåœ°å€ç©ºé—´åŒºåŸŸä½œä¸ºæ‰˜ç®¡å †ã€‚CLRè¿˜è¦ç»´æŠ¤ä¸€ä¸ªæŒ‡é’ˆï¼Œå§‘ä¸”å«NextObjPtrï¼Œè¯¥æŒ‡é’ˆæŒ‡å‘ä¸‹ä¸€ä¸ªå¯¹è±¡åœ¨å †ä¸­çš„åˆ†é…ä½ç½®ã€‚åˆšå¼€å§‹çš„æ—¶å€™ï¼Œ NextObjPtr è®¾ä¸ºåœ°å€ç©ºé—´åŒºåŸŸçš„åŸºåœ°å€ã€‚ ä¸€ä¸ªåŒºåŸŸè¢«éåƒåœ¾å¯¹è±¡å¡«æ»¡åï¼ŒCLRä¼šåˆ†é…æ›´å¤šçš„åŒºåŸŸã€‚\nè¿™ä¸€ä¸ªè¿‡ç¨‹ä¸€ç›´é‡å¤ï¼Œç›´è‡³æ•´ä¸ªè¿›ç¨‹åœ°å€ç©ºé—´è¢«å¡«æ»¡ã€‚æ‰€ä»¥ï¼Œåº”ç”¨ç¨‹åºå†…å­˜æ”¶è¿›ç¨‹çš„è™šæ‹Ÿåœ°å€ç©ºé—´çš„é™åˆ¶ã€‚\n32ä½è¿›ç¨‹æœ€å¤šèƒ½åˆ†é…1.5GBï¼Œ64ä½è¿›ç¨‹æœ€å¤šèƒ½åˆ†é…8Tã€‚ æ³¨ï¼šè¿›ç¨‹å†…å­˜å¤§å°çš„ç›¸å…³èµ„æ–™\nMemory Support and Windows Operating Systems\nè¿›ç¨‹åœ°å€ç©ºé—´\n32ä½æ¨¡å¼ä¸‹C/C++ç¨‹åºå¯ç”¨æœ€å¤§å†…å­˜\nC# çš„newæ“ä½œç¬¦å¯¼è‡´CLRæ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š è®¡ç®—ç±»å‹çš„å­—æ®µï¼ˆä»¥åŠä»åŸºç±»å‹ç»§æ‰¿çš„å­—æ®µï¼‰æ‰€éœ€è¦çš„å­—èŠ‚æ•°ã€‚\nåŠ ä¸Šå¯¹è±¡çš„å¼€é”€æ‰€éœ€çš„å­—èŠ‚æ•°ã€‚æ¯ä¸ªå¯¹è±¡éƒ½æœ‰ä¸¤ä¸ªå¼€é”€å­—æ®µï¼šç±»å‹å¯¹è±¡æŒ‡é’ˆå’ŒåŒæ­¥å—ç´¢å¼•ã€‚å¯¹äº32ä½åº”ç”¨ç¨‹åºï¼Œè¿™ä¸¤ä¸ªå­—æ®µå„éœ€è¦32ä½ï¼Œæ‰€ä»¥æ¯ä¸ªå¯¹è±¡éœ€è¦å¢åŠ 8å­—èŠ‚ã€‚å¯¹äº64ä½åº”ç”¨ç¨‹åºï¼Œè¿™ä¸¤ä¸ªå­—æ®µå„éœ€è¦64ä½ï¼Œæ‰€ä»¥æ¯ä¸ªå¯¹è±¡è¦å¢åŠ 16å­—èŠ‚ã€‚\nCLRæ£€æŸ¥åŒºåŸŸä¸­æ˜¯å¦æœ‰åˆ†é…å¯¹è±¡æ‰€éœ€çš„å­—èŠ‚æ•°ã€‚å¦‚æœæ‰˜ç®¡å †æœ‰è¶³å¤Ÿçš„å¯ç”¨ç©ºé—´ï¼Œå°±åœ¨NetxObjPtræŒ‡é’ˆæŒ‡å‘çš„åœ°å€å¤„æ”¾å…¥å¯¹è±¡ï¼Œä¸ºå¯¹è±¡åˆ†é…çš„å­—èŠ‚ä¼šè¢«æ¸…é›¶ã€‚æ¥ç€è°ƒç”¨ç±»å‹çš„æ„é€ å™¨ï¼ˆä¸ºthiså‚æ•°ä¼ é€’NextObjPtrï¼‰ï¼Œnewæ“ä½œç¬¦è¿”å›å¯¹è±¡å¼•ç”¨ã€‚å°±åœ¨è¿”å›è¿™ä¸ªå¯¹è±¡å¼•ç”¨ä¹‹å‰ï¼ŒNextObjPtræŒ‡é’ˆçš„å€¼ä¼šåŠ ä¸Šè¿™ä¸ªå¯¹è±¡å ç”¨çš„å­—èŠ‚æ•°æ¥å¾—åˆ°ä¸€ä¸ªæ–°å€¼ï¼Œå³ä¸‹ä¸ªå¯¹è±¡æ”¾å…¥æ‰˜ç®¡å †æ—¶çš„åœ°å€ã€‚å¦‚ä¸‹å›¾ï¼š\nåƒåœ¾å›æ”¶ç®—æ³• ####CLRä½¿ç”¨å¼•ç”¨è·Ÿè¸ªç®—æ³•ã€‚\nå¼•ç”¨è·Ÿè¸ªç®—æ³•åªå…³å¿ƒå¼•ç”¨ç±»å‹çš„å˜é‡ï¼Œå› ä¸ºåªæœ‰è¿™ç§å˜é‡æ‰èƒ½å¼•ç”¨å †ä¸Šé¢çš„å¯¹è±¡ï¼› å€¼ç±»å‹å˜é‡ç›´æ¥åŒ…å«å€¼ç±»å‹å®ä¾‹ã€‚å¼•ç”¨ç±»å‹å˜é‡å¯åœ¨è®¸å¤šåœºåˆä½¿ç”¨ï¼ŒåŒ…æ‹¬ç±»çš„é™æ€å’Œå®ä¾‹å­—æ®µï¼Œæˆ–è€…æ–¹æ³•çš„å‚æ•°å’Œå±€éƒ¨å˜é‡ã€‚è¿™é‡Œæˆ‘ä»¬å°†æ‰€æœ‰å¼•ç”¨ç±»å‹çš„å˜é‡éƒ½ç§°ä¸ºæ ¹ã€‚ CLRå¼€å§‹GCæ—¶ï¼Œé¦–å…ˆæš‚åœæ‰€æœ‰çš„çº¿ç¨‹ã€‚(è¿™æ ·å¯ä»¥é˜²æ­¢çº¿ç¨‹åœ¨CLRæ£€æŸ¥æœŸé—´è®¿é—®å¯¹è±¡å¹¶æ›´æ”¹å…¶çŠ¶æ€ã€‚) ç„¶åCLRè¿›å…¥GCæ ‡è®°é˜¶æ®µã€‚åœ¨è¿™ä¸ªé˜¶æ®µï¼ŒCLRéå†å †ä¸­çš„æ‰€æœ‰å¯¹è±¡ï¼Œå°†åŒæ­¥å—ç´¢å¼•å­—æ®µä¸­çš„ä¸€ä½è®¾ä¸º0ã€‚è¿™è¡¨æ˜æ‰€æœ‰çš„å¯¹è±¡éƒ½åº”åˆ é™¤ã€‚ç„¶åï¼ŒCLRæ£€æŸ¥æ‰€æœ‰çš„æ´»åŠ¨æ ¹ï¼ŒæŸ¥çœ‹ä»–ä»¬å¼•ç”¨äº†å“ªäº›å¯¹è±¡ã€‚è¿™æ­£æ˜¯CLRçš„GCè¢«ç§°ä½œå¼•ç”¨è·Ÿè¸ªGCçš„åŸå› ã€‚å¦‚æœä¸€ä¸ªæ ¹åŒ…å«nullï¼ŒCLRå¿½ç•¥è¿™ä¸ªæ ¹å¹¶ç»§ç»­æ£€æŸ¥ä¸‹ä¸€ä¸ªæ ¹ã€‚ ä¸‹å›¾å±•ç¤ºä¸€ä¸ªå †ï¼Œå…¶ä¸­åŒ…å«å‡ ä¸ªå¯¹è±¡ã€‚ åº”ç”¨ç¨‹åºçš„æ ¹ç›´æ¥å¼•ç”¨å¯¹è±¡A ã€Cã€D ã€Fã€‚æ‰€æœ‰çš„å¯¹è±¡éƒ½å·²ç»è¢«æ ‡è®°ã€‚æ ‡è®°å¯¹è±¡Dæ—¶ï¼ŒGCå‘ç°è¿™ä¸ªå¯¹è±¡å«æœ‰ä¸€ä¸ªå¼•ç”¨å¯¹è±¡Hçš„å­—æ®µï¼Œé€ æˆå¯¹è±¡Hä¹Ÿè¢«æ ‡è®°ã€‚æ ‡è®°è¿‡ç¨‹ä¼šæŒç»­ï¼Œç›´è‡³åº”ç”¨ç¨‹åºçš„æ‰€æœ‰æ ¹æ‰€æœ‰æ£€æŸ¥å®Œæ¯•ã€‚ æ£€æŸ¥å®Œæ¯•åï¼Œå †ä¸­çš„å¯¹è±¡è¦ä¹ˆå·²æ ‡è®°ï¼Œè¦ä¹ˆæœªæ ‡è®°ã€‚å·²æ ‡è®°çš„å¯¹è±¡ä¸èƒ½è¢«åƒåœ¾å›æ”¶ï¼Œå› ä¸ºè‡³å°‘æœ‰ä¸€ä¸ªæ ¹åœ¨å¼•ç”¨å®ƒã€‚æˆ‘ä»¬è¯´è¿™ç§å¯¹è±¡æ˜¯å¯è¾¾çš„ï¼Œå› ä¸ºåº”ç”¨ç¨‹åºå¯ä»¥é€šè¿‡å¼•ç”¨å®ƒçš„å˜é‡æŠµè¾¾å®ƒã€‚ æœªæ ‡è®°çš„å¯¹è±¡æ˜¯ä¸å¯è¾¾çš„ï¼Œå› ä¸ºåº”ç”¨ç¨‹åºä¸­ä¸å­˜åœ¨ä½¿å¯¹è±¡èƒ½è¢«å†æ¬¡è®¿é—®çš„æ ¹ã€‚\nCLRçŸ¥é“å“ªäº›å¯¹è±¡å¯ä»¥å¹¸å­˜ï¼Œå“ªäº›å¯ä»¥è¢«åˆ é™¤åï¼Œè¿›å…¥GCçš„å‹ç¼©ï¼ˆç±»ä¼¼äºç¢ç‰‡æ•´ç†ï¼‰é˜¶æ®µã€‚åœ¨å‹ç¼©é˜¶æ®µï¼ŒCLRå¯¹å †ä¸­å·²æ ‡è®°çš„å¯¹è±¡è¿›è¡Œâ€œä¹¾å¤å¤§æŒªç§»â€ï¼Œæ•´ç†æ‰€æœ‰å¹¸å­˜ä¸‹æ¥çš„å¯¹è±¡ï¼Œä½¿ä»–ä»¬å ç”¨è¿ç»­çš„å†…å­˜ã€‚\nè¿™æ ·åšçš„å¥½å¤„åœ¨äºï¼š\næ‰€æœ‰å¹¸å­˜å¯¹è±¡åœ¨å†…å­˜ä¸­ç´§æŒ¨åœ¨ä¸€èµ·ï¼Œæ¢å¤äº†å¼•ç”¨çš„â€œå±€éƒ¨æ€§â€ï¼Œå‡å°‘äº†åº”ç”¨ç¨‹åºçš„å·¥ä½œé›†ï¼Œä»è€Œæå‡äº†å°†æ¥è®¿é—®è¿™äº›å¯¹è±¡æ—¶çš„æ€§èƒ½ï¼›\nç»è¿‡æ•´ç†åï¼Œå¯ç”¨ç©ºé—´ä¹Ÿæ˜¯è¿ç»­çš„ï¼Œæ•´ä¸ªåœ°å€ç©ºé—´åŒºæ®µå¾—åˆ°äº†è§£æ”¾ï¼Œå…è®¸å…¶ä»–ä¸œè¥¿è¿›é©»ã€‚\nåœ¨å†…å­˜ä¸­ç§»åŠ¨äº†å¯¹è±¡ä¹‹åæœ‰ä¸€ä¸ªé—®é¢˜äºŸå¾…è§£å†³ã€‚å¼•ç”¨å¹¸å­˜å¯¹è±¡çš„æ ¹ç°åœ¨å¼•ç”¨çš„è¿˜æ˜¯å¯¹è±¡æœ€åˆåœ¨å†…å­˜ä¸­çš„ä½ç½®ï¼Œè€Œéç§»åŠ¨åçš„ä½ç½®ã€‚è¢«æš‚åœçš„çº¿ç¨‹æ¢å¤æ‰§è¡Œæ—¶ï¼Œå°†è®¿é—®æ—§çš„å†…å­˜ä½ç½®ï¼Œä¼šé€ æˆå†…å­˜æŸåã€‚ è¿™æ˜¾ç„¶æ˜¯ä¸èƒ½å®¹å¿çš„ï¼Œæ‰€ä»¥ä½œä¸ºå‹ç¼©é˜¶æ®µçš„ä¸€éƒ¨åˆ†ï¼ŒCLRè¿˜è¦ä»æ¯ä¸ªæ ¹å‡å»æ‰€å¼•ç”¨å¯¹è±¡åœ¨å†…å­˜ä¸­åç§»çš„å­—èŠ‚æ•°ã€‚è¿™æ ·å°±èƒ½ä¿è¯æ¯ä¸ªæ ¹è¿˜æ˜¯å¼•ç”¨å’Œä¹‹å‰ä¸€æ ·çš„å¯¹è±¡ï¼Œåªæ˜¯å¯¹è±¡åœ¨å†…å­˜ä¸­å˜æ¢äº†ä½ç½®ã€‚ å¦‚å›¾ï¼š ä»£ï¼šæå‡æ€§èƒ½ (å¾…ç»­) CLRçš„GCæ˜¯åŸºäºä»£çš„åƒåœ¾å›æ”¶å™¨ï¼Œå®ƒå¯¹ä½ çš„ä»£ç åšå‡ºäº†ä»¥ä¸‹å‡ ç‚¹å‡è®¾ï¼š\nå¯¹è±¡è¶Šæ–°ï¼Œç”Ÿå­˜å‘¨æœŸè¶ŠçŸ­ã€‚\nå¯¹è±¡è¶Šè€ï¼Œç”Ÿå­˜å‘¨æœŸè¶Šé•¿ã€‚\nå›æ”¶å †çš„ä¸€éƒ¨åˆ† ï¼Œé€Ÿåº¦å¿«äºå›æ”¶æ•´ä¸ªå †ã€‚\nå¤§é‡ç ”ç©¶è¡¨æ˜ï¼Œè¿™äº›å‡è®¾å¯¹äºç°ä»Šå¤§å¤šæ•°çš„åº”ç”¨ç¨‹åºéƒ½æ˜¯æˆç«‹çš„ï¼Œå®ƒä»¬å½±å“äº†åƒåœ¾å›æ”¶å™¨çš„å®ç°æ–¹å¼ã€‚è¿™é‡Œå°†è§£é‡Šä»£çš„å·¥ä½œåŸç†ã€‚\næ‰˜ç®¡å †åœ¨åˆå§‹åŒ–æ—¶ä¸åŒ…æ‹¬å¯¹è±¡ã€‚æ·»åŠ åˆ°å †çš„å¯¹è±¡æˆä¸ºç¬¬0ä»£å¯¹è±¡ã€‚ç®€å•æ¥è¯´ï¼Œç¬¬0ä»£å¯¹è±¡å°±æ˜¯é‚£äº›æ–°æ„é€ çš„å¯¹è±¡ï¼Œåƒåœ¾å›æ”¶å™¨ä»æœªæ£€æŸ¥è¿‡å®ƒä»¬ã€‚å¦‚ä¸‹å›¾ï¼Œæ–°å¯åŠ¨çš„åº”ç”¨ç¨‹åºï¼Œåˆ†é…äº†5ä¸ªå¯¹è±¡ï¼ˆä»Aåˆ°Eï¼‰ã€‚è¿‡äº†ä¸€ä¼šï¼ŒCå’ŒEå˜å¾—ä¸å¯è¾¾äº†ã€‚\nCLRåˆå§‹åŒ–ç¬¬0ä»£å¯¹è±¡é€‰æ‹©ä¸€ä¸ªé¢„ç®—å®¹é‡ã€‚å¦‚æœåˆ†é…ä¸€ä¸ªæ–°å¯¹è±¡é€ æˆç¬¬0ä»£è¶…é¢„ç®—ï¼Œå°±å¿…é¡»å¯åŠ¨ä¸€æ¬¡GCã€‚å‡è®¾å¯¹è±¡Aåˆ°Eåˆšå¥½ç”¨å®Œäº†ç¬¬0ä»£çš„ç©ºé—´ï¼Œé‚£ä¹ˆåˆ†é…å¯¹è±¡Få°±å¿…é¡»å¯åŠ¨GCã€‚GCä¹‹åå­˜æ´»çš„å¯¹è±¡ç°åœºæˆä¸ºç¬¬1ä»£å¯¹è±¡ã€‚å¦‚ä¸‹å›¾ï¼š\nä¸€æ¬¡GCä¹‹åï¼Œç¬¬0ä»£å°±ä¸åŒ…å«ä»»ä½•å¯¹è±¡ã€‚å’Œå‰é¢ä¸€æ ·ï¼Œæ–°å¯¹è±¡ä¼šåˆ†é…åˆ°ç¬¬0ä»£ã€‚æ–°åˆ†é…å¯¹è±¡Fåˆ°å¯¹è±¡Kéƒ½åˆ°äº†ç¬¬0ä»£ã€‚ ä¹‹åï¼Œç¨‹åºç»§ç»­è¿è¡Œï¼ŒBã€Hã€Jå˜å¾—ä¸å¯è¾¾ï¼Œå®ƒä»¬çš„å†…å­˜å°†åœ¨æŸä¸€ä¸ªæ—¶åˆ»å›æ”¶ã€‚\nå‡è®¾ç°åœ¨æ–°åˆ†é…å¯¹è±¡Lä¼šé€ æˆç¬¬0ä»£è¶…å‡ºé¢„ç®—,é€ æˆå¿…é¡»å¯åŠ¨åƒåœ¾å›æ”¶ã€‚\nå¼€å§‹åƒåœ¾å›æ”¶æ—¶,åƒåœ¾å›æ”¶å™¨å¿…é¡»å†³å®šæ£€æŸ¥å“ªäº›ä»£ã€‚å‰é¢è¯´è¿‡,CLRåˆå§‹åŒ–æ—¶ä¼šä¸ºç¬¬0ä»£å¯¹è±¡é€‰æ‹©é¢„ç®—.äº‹å®ä¸Š,å®ƒè¿˜å¿…é¡»ä¸ºç¬¬1ä»£é€‰æ‹©é¢„ç®—.\nå¼€å§‹ä¸€æ¬¡åƒåœ¾å›æ”¶æ—¶,åƒåœ¾å›æ”¶å™¨è¿˜ä¼šæ£€æŸ¥ç¬¬ä¸€ä»£å ç”¨äº†å¤šå°‘å†…å­˜ã€‚åœ¨æœ¬ä¾‹ä¸­,ç”±äºç¬¬1ä»£å ç”¨å†…å­˜è¿œå°‘äºé¢„ç®—,æ‰€ä»¥åƒåœ¾å›æ”¶å™¨åªæ£€æŸ¥ç¬¬0ä»£å¯¹è±¡ã€‚å›é¡¾ä¹‹å‰åŸºäºä»£çš„åƒåœ¾å›æ”¶å™¨åšå‡ºçš„ç¬¬ä¸€ä¸ªå‡è®¾ï¼šå¯¹è±¡è¶Šæ–°ï¼Œç”Ÿå­˜æœŸè¶ŠçŸ­ã€‚ å› æ­¤ï¼Œç¬¬0ä»£åŒ…å«æ›´å¤šçš„åƒåœ¾çš„å¯èƒ½æ€§æ›´å¤§ï¼Œèƒ½å›æ”¶æ›´å¤šçš„å†…å­˜ã€‚ç”±äºå¿½ç•¥ç¬¬1ä»£ä¸­çš„å¯¹è±¡ï¼Œæ‰€ä»¥åŠ å¿«äº†åƒåœ¾å›æ”¶é€Ÿåº¦ã€‚\næ˜¾ç„¶ï¼Œå¿½ç•¥ç¬¬1ä»£ä¸­çš„å¯¹è±¡èƒ½æå‡åƒåœ¾å›æ”¶å™¨çš„æ€§èƒ½ã€‚ä½†å¯¹æ€§èƒ½æœ‰æ›´å¤§ææŒ¯ä½œç”¨çš„æ˜¯ç°åœ¨ä¸å¿…éå†æ‰˜ç®¡å †ä¸­çš„æ¯ä¸ªå¯¹è±¡ã€‚å¦‚æœæ ¹æˆ–å¯¹è±¡å¼•ç”¨äº†è€ä¸€ä»£çš„æŸä¸ªå¯¹è±¡ï¼Œåƒåœ¾å›æ”¶å™¨å°±å¯ä»¥å¿½ç•¥è€å¯¹è±¡å†…éƒ¨çš„æ‰€æœ‰å¼•ç”¨ï¼Œèƒ½åœ¨æ›´çŸ­çš„æ—¶é—´å†…æ„é€ å¥½å¯è¾¾å¯¹è±¡å›¾ã€‚å½“ç„¶ï¼Œå¦‚æœè€å¯¹è±¡çš„å­—æ®µä¹Ÿå¯èƒ½å¼•ç”¨æ–°å¯¹è±¡ã€‚ä¸ºäº†ç¡®ä¿å¯¹è€å¯¹è±¡çš„å·²æ›´æ–°å­—æ®µè¿›è¡Œæ£€æŸ¥ï¼Œåƒåœ¾å›æ”¶å™¨åˆ©ç”¨äº†JITç¼–è¯‘å™¨å†…éƒ¨çš„ä¸€ä¸ªæœºåˆ¶ã€‚è¿™ä¸ªæœºåˆ¶åœ¨å¯¹è±¡çš„å¼•ç”¨å­—æ®µå‘ç”Ÿå˜åŒ–æ—¶ï¼Œä¼šè®¾ç½®ä¸€ä¸ªå¯¹åº”çš„æ ‡å¿—ä½ã€‚è¿™æ ·ï¼Œåƒåœ¾å›æ”¶å™¨å°±çŸ¥é“è‡ªä¸Šä¸€æ¬¡åƒåœ¾å›æ”¶ä»¥æ¥ï¼Œå“ªäº›è€å¯¹è±¡ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰å·²è¢«å†™å…¥ã€‚åªæœ‰å­—æ®µå‘ç”Ÿå˜åŒ–çš„è€å¯¹è±¡æ‰éœ€è¦æ£€æŸ¥æ˜¯å¦å¼•ç”¨äº†ç¬¬0ä»£ä¸­çš„ä»»ä½•æ–°å¯¹è±¡ã€‚\nåŸºäºä»£çš„åƒåœ¾å›æ”¶å™¨è¿˜å‡è®¾è¶Šè€çš„å¯¹è±¡æ´»å¾—è¶Šé•¿ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œç¬¬1ä»£å¯¹è±¡åœ¨åº”ç”¨ç¨‹åºä¸­æœ‰å¯èƒ½æ˜¯ç»§ç»­å¯è¾¾çš„ã€‚å¦‚æœåƒåœ¾å›æ”¶å™¨æ£€æŸ¥ç¬¬1ä»£çš„å¯¹è±¡ï¼Œå¾ˆæœ‰å¯èƒ½æ‰¾ä¸åˆ°å¤šå°‘åƒåœ¾ï¼Œç»“æœæ˜¯ä¹Ÿå›æ”¶ä¸äº†å¤šå°‘å†…å­˜ã€‚å› æ­¤ï¼Œå¯¹ç¬¬1ä»£è¿›è¡Œåƒåœ¾å›æ”¶å¾ˆå¯èƒ½æ˜¯æµªè´¹æ—¶é—´çš„ã€‚å¦‚æœç¬¬ä¸€ä»£çœŸæœ‰åƒåœ¾ï¼Œåƒåœ¾å°†ç•™åœ¨é‚£é‡Œã€‚å¦‚ä¸‹å›¾ï¼š ç¨‹åºç»§ç»­è¿è¡Œï¼Œç»§ç»­å¾€ç¬¬0ä»£åˆ†é…å¯¹è±¡ï¼ŒåŒæ—¶ç¨‹åºåœæ­¢å¯¹ç¬¬1ä»£æŸå¯¹è±¡çš„ä½¿ç”¨ã€‚\nå¦‚ä¸‹å›¾ï¼š åˆ†é…å¯¹è±¡På¯¼è‡´ç¬¬0ä»£è¶…é¢„ç®—ï¼Œå¼€å§‹GCã€‚ç¬¬1ä»£çš„æ‰€æœ‰å¯¹è±¡å æ®å†…å­˜ä»å°äºé¢„ç®—ï¼Œåƒåœ¾å›æ”¶å™¨å†æ¬¡å†³å®šåªå›æ”¶ç¬¬0ä»£ã€‚å¿½ç•¥ç¬¬1ä»£ä¸­çš„åƒåœ¾å¯¹è±¡ã€‚å¦‚ä¸‹å›¾ï¼š ç¨‹åºç»§ç»­è¿è¡Œï¼Œå‡è®¾ç¬¬ä¸€ä»£çš„å¢é•¿å¯¼è‡´å®ƒçš„å…¨éƒ¨å¯¹è±¡å ç”¨äº†å…¨éƒ¨é¢„ç®—ã€‚è¿™æ—¶å€™åº”ç”¨ç¨‹åºåˆ†é…å¯¹è±¡Påˆ°å¯¹è±¡Sï¼Œä½¿ç¬¬0ä»£å¯¹è±¡è¾¾åˆ°å®ƒçš„é¢„ç®—æ€»å’Œã€‚å¦‚ä¸‹å›¾ï¼š è¿™æ—¶å€™ï¼Œåº”ç”¨ç¨‹åºå‡†å¤‡åˆ†é…å¯¹è±¡Tï¼Œç”±äºç¬¬ä¸€ä»£å·²æ»¡ï¼Œæ‰€ä»¥å¿…é¡»å¼€å§‹GCã€‚ä½†è¿™ä¸€æ¬¡åƒåœ¾å›æ”¶å™¨å‘ç°ç¬¬ä¸€ä»£å ç”¨äº†å¤ªå¤šå†…å­˜ï¼Œä»¥è‡³äºç”¨å®Œäº†é¢„ç®—ã€‚ç”±äºå‰å‡ æ¬¡å¯¹ç¬¬0ä»£è¿›è¡ŒGCæ—¶ï¼Œç¬¬1ä»£ä¸­å¯èƒ½å·²ç»æœ‰å¾ˆå¤šå¯¹è±¡å˜å¾—ä¸å¯è¾¾ã€‚æ‰€ä»¥è¿™æ¬¡åƒåœ¾å›æ”¶å™¨å†³å®šæ£€æŸ¥ç¬¬1ä»£å’Œç¬¬0ä»£ä¸­çš„æ‰€æœ‰å¯¹è±¡ã€‚ä¸¤ä»£éƒ½è¢«åƒåœ¾å›æ”¶åï¼Œå †çš„æƒ…å†µå¦‚ä¸‹å›¾ï¼š æ‰˜ç®¡å †åªæ”¯æŒä¸‰ä»£ï¼šç¬¬0ä»£ã€ç¬¬1ä»£å’Œç¬¬2ä»£ã€‚\nCLRåˆå§‹åŒ–æ—¶ï¼Œä¼šä¸ºæ¯ä¸€ä»£é€‰æ‹©é¢„ç®—ã€‚\nç„¶è€Œï¼ŒCLRçš„åƒåœ¾å›æ”¶æ˜¯è‡ªè°ƒèŠ‚çš„ã€‚\nè¿™æ„å‘³ç€åƒåœ¾å›æ”¶å™¨ä¼šåœ¨æ‰§è¡Œåƒåœ¾å›æ”¶çš„è¿‡ç¨‹äº†è§£ç¨‹åºçš„è¡Œä¸ºã€‚\nä¾‹å¦‚ï¼šå‡è®¾åº”ç”¨ç¨‹åºæ„é€ äº†è®¸å¤šå¯¹è±¡ï¼Œä½†æ¯ä¸ªå¯¹è±¡çš„æ—¶é—´éƒ½å¾ˆçŸ­ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯¹ç¬¬0ä»£çš„åƒåœ¾å›æ”¶ä¼šå›æ”¶åˆ°å¤§é‡çš„å†…å­˜ã€‚äº‹å®ä¸Šï¼Œç¬¬0ä»£çš„æ‰€æœ‰å¯¹è±¡éƒ½å¯èƒ½è¢«å›æ”¶ã€‚\nå¦‚æœåƒåœ¾å›æ”¶å™¨å‘ç°åœ¨å›æ”¶ç¬¬0ä»£åå­˜æ´»ä¸‹æ¥çš„å¯¹è±¡å¾ˆå°‘ï¼Œå°±å¯èƒ½å‡å°‘ç¬¬0ä»£çš„é¢„ç®—ã€‚å·²åˆ†é…ç©ºé—´çš„å‡å°‘æ„å‘³ç€åƒåœ¾å›æ”¶å°†æ›´é¢‘ç¹åœ°å‘ç”Ÿï¼Œä½†åƒåœ¾å›æ”¶å™¨æ¯æ¬¡åšçš„äº‹æƒ…ä¹Ÿå‡å°‘ï¼Œè¿™å‡å°‘äº†è¿›ç¨‹çš„å·¥ä½œé›†ã€‚\nå¦ä¸€æ–¹é¢ï¼Œå¦‚æœåƒåœ¾å›æ”¶å™¨å›æ”¶äº†ç¬¬0ä»£ï¼Œå‘ç°è¿˜æœ‰å¾ˆå¤šå¯¹è±¡å­˜æ´»ï¼Œæ²¡å¤šå°‘å†…å­˜å¯ä»¥è¢«å›æ”¶ï¼Œå°±ä¼šå¢å¤§ç¬¬0ä»£çš„é¢„ç®—ã€‚\nåŒæ ·çš„å¯å‘æ€§ç®—æ³•è°ƒæ•´é¢„ç®—é€‚ç”¨äºäº†ç¬¬1ä»£å’Œç¬¬2ä»£çš„é¢„ç®—ã€‚\nå¼•è‡ªï¼šã€ŠCLR VIA C# -21ç« ã€‹\nè‡ªåŠ¨å†…å­˜ç®¡ç†\nåƒåœ¾å›æ”¶çš„åŸºç¡€\nä»£æ•°\n","date":"2016-10-04T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/c%23.net%E6%89%98%E7%AE%A1%E5%A0%86%E5%92%8C%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/","title":"C#.NETæ‰˜ç®¡å †å’Œåƒåœ¾å›æ”¶"},{"content":"æ‰˜ç®¡å †å’Œåƒåœ¾å›æ”¶(ç»­) å¤§å¯¹è±¡ CLRå°†å¯¹è±¡åˆ†æˆå¤§å¯¹è±¡å’Œå°å¯¹è±¡ã€‚ç›®å‰è®¤ä¸º85000å­—èŠ‚æˆ–è€…æ›´å¤§çš„å¯¹è±¡æ˜¯å¤§å¯¹è±¡ã€‚CLRä»¥ä¸åŒæ–¹å¼å¯¹å¾…å¤§å°å¯¹è±¡ã€‚\nå¤§å¯¹è±¡ä¸æ˜¯åœ¨å°å¯¹è±¡çš„åœ°å€ç©ºé—´åˆ†é…çš„ï¼Œè€Œæ˜¯åœ¨è¿›ç¨‹åœ°å€ç©ºé—´çš„å…¶ä»–åœ°æ–¹åˆ†é…ã€‚\nç›®å‰ç‰ˆæœ¬çš„GCä¸â€œå‹ç¼©â€å¤§å¯¹è±¡ï¼Œå› ä¸ºåœ¨å†…å­˜ä¸­ç§»åŠ¨å®ƒä»¬ä»£ä»·è¿‡é«˜ã€‚ä½†è¿™å¯èƒ½åœ¨è¿›ç¨‹ä¸­çš„å¤§å¯¹è±¡ä¹‹é—´é€ æˆåœ°å€ç©ºé—´ç¢ç‰‡åŒ–ï¼Œä»¥è‡³äºæŠ›å‡ºOutMemoryExceptionã€‚CLRå°†æ¥çš„ç‰ˆæœ¬å¯èƒ½ä¼šå‹ç¼©å¤§å¯¹è±¡ã€‚\nå¤§å¯¹è±¡æ€»æ˜¯ç¬¬2ä»£ï¼Œç»ä¸å¯èƒ½æ˜¯ç¬¬0ä»£æˆ–è€…ç¬¬1ä»£ã€‚æ‰€ä»¥åªèƒ½ä¸ºéœ€è¦é•¿æ—¶é—´å­˜æ´»çš„èµ„æºåˆ›å»ºå¤§å¯¹è±¡ã€‚åˆ†é…çŸ­æ—¶é—´å­˜æ´»çš„å¤§å¯¹è±¡ä¼šå¯¼è‡´ç¬¬2ä»£è¢«æ›´é¢‘ç¹åœ°å›æ”¶ï¼ŒæŸå¤±æ€§èƒ½ã€‚å¤§å¯¹è±¡ä¸€èˆ¬æ˜¯å¤§å­—ç¬¦ä¸²ï¼ˆXML/JSONï¼‰æˆ–è€…ç”¨äºI/Oæ“ä½œçš„å­—èŠ‚æ•°ç»„ï¼ˆä»æ–‡ä»¶/ç½‘ç»œå°†å­—èŠ‚è¯»å…¥ç¼“å†²åŒºä»¥ä¾¿å¤„ç†ï¼‰ã€‚\nåƒåœ¾å›æ”¶æ¨¡å¼ CLRå¯åŠ¨æ—¶ä¼šé€‰æ‹©ä¸€ä¸ªGCæ¨¡å¼ï¼Œè¿›ç¨‹ä¸­ä¹‹å‰è¯¥æ¨¡å¼éƒ½ä¸ä¼šæ”¹å˜ã€‚\næœ‰ä¸¤ä¸ªåŸºæœ¬GCæ¨¡å¼ã€‚\nå·¥ä½œç«™ è¯¥æ¨¡å¼é’ˆå¯¹å®¢æˆ·ç«¯åº”ç”¨ç¨‹åºä¼˜åŒ–GCã€‚GCé€ æˆçš„å»¶æ—¶å¾ˆä½ï¼Œåº”ç”¨ç¨‹åºçº¿ç¨‹æŒ‚èµ·æ—¶é—´å¾ˆçŸ­ï¼Œé¿å…ç”¨æˆ·æ„Ÿåˆ°ç„¦è™‘ã€‚åœ¨è¯¥æ¨¡å¼ä¸­,GCå‡å®šæœºå™¨ä¸Šè¿è¡Œçš„å…¶ä»–åº”ç”¨ç¨‹åºéƒ½ä¸ä¼šæ¶ˆè€—å¤ªå¤šçš„CPUèµ„æºã€‚ æœåŠ¡å™¨ è¯¥æ¨¡å¼é’ˆå¯¹æœåŠ¡å™¨ç«¯åº”ç”¨ç¨‹åºä¼˜åŒ–GCã€‚è¢«ä¼˜åŒ–çš„ä¸»è¦æ˜¯ååé‡å’Œèµ„æºåˆ©ç”¨ã€‚GCå‡å®šæœºå™¨ä¸Šæ²¡æœ‰è¿è¡Œå…¶ä»–åº”ç”¨ç¨‹åºï¼ˆæ— è®ºå®¢æˆ·ç«¯è¿˜æ˜¯æœåŠ¡å™¨åº”ç”¨ç¨‹åºï¼‰ï¼Œå¹¶å‡å®šæœºå™¨çš„æ‰€æœ‰CPUéƒ½å¯ä»¥ç”¨æ¥è¾…åŠ©å®ŒæˆGCã€‚è¯¥æ¨¡å¼é€ æˆæ‰˜ç®¡å †è¢«æ‹†åˆ†æˆå‡ ä¸ªåŒºåŸŸï¼Œæ¯ä¸ªCPUä¸€ä¸ªã€‚å¼€å§‹åƒåœ¾å›æ”¶æ—¶ï¼Œåƒåœ¾å›æ”¶å™¨åœ¨æ¯ä¸ªCPUä¸Šè¿è¡Œä¸€ä¸ªç‰¹æ®Šçº¿ç¨‹ï¼›æ¯ä¸ªçº¿ç¨‹éƒ½å’Œå…¶ä»–çº¿ç¨‹å¹¶å‘å›æ”¶å®ƒè‡ªå·±çš„åŒºåŸŸã€‚å¯¹äºå·¥ä½œè€…çº¿ç¨‹è¡Œä¸ºä¸€è‡´çš„æœåŠ¡å™¨åº”ç”¨ç¨‹åºï¼Œå¹¶å‘å›æ”¶èƒ½å¾ˆå¥½è¿›è¡Œã€‚è¿™ä¸ªåŠŸèƒ½è¦æ±‚åº”ç”¨ç¨‹åºåœ¨å¤šCPUè®¡ç®—æœºä¸Šè¿è¡Œï¼Œæ˜¯çº¿ç¨‹èƒ½çœŸæ­£åŒæ—¶å·¥ä½œï¼Œä»è€Œå¾—åˆ°æ€§èƒ½ä¸Šçš„æå‡ã€‚ åº”ç”¨ç¨‹åºé»˜è®¤ä»¥â€œå·¥ä½œç«™â€GCæ¨¡å¼è¿è¡Œã€‚å¯„å®¿äº†CLRçš„æœåŠ¡å™¨åº”ç”¨ç¨‹åºï¼ˆå¦‚ASP.NET ï¼‰å¯è¯·æ±‚CLRåŠ è½½æœåŠ¡å™¨ GC.ä½†å¦‚æœåº”ç”¨ç¨‹åºåœ¨å•å¤„ç†å™¨è®¡ç®—æœºä¸Šè¿è¡Œï¼ŒCLRæ€»æ˜¯ä½¿ç”¨â€œå·¥ä½œç«™â€GCæ¨¡å¼ã€‚\nç‹¬ç«‹åº”ç”¨ç¨‹åºå¯ä»¥åˆ›å»ºä¸€ä¸ªé…ç½®æ–‡ä»¶å‘Šè¯‰CLR ä½¿ç”¨CLRä½¿ç”¨æœåŠ¡å™¨å›æ”¶å™¨ã€‚é…ç½®æ–‡ä»¶è¦ä¸ºåº”ç”¨ç¨‹åºæ·»åŠ gcServerå…ƒç´ ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç¤ºä¾‹é…ç½®æ–‡ä»¶ï¼š\n1 2 3 4 5 \u0026lt;configuration\u0026gt; \u0026lt;runtime\u0026gt; \u0026lt;gcServer enabled=\u0026#34;true\u0026#34;\u0026gt; \u0026lt;/runtime\u0026gt; \u0026lt;/configuration\u0026gt; å¯ä»¥ä½¿ç”¨GCSettingsç±»çš„åªè¯»Booleanå±æ€§IsServerGCå¾—åˆ°CLRæ˜¯å¦å¤„äºâ€œæœåŠ¡å™¨â€GCæ¨¡å¼ã€‚\né™¤äº†è¿™ä¸¤ç§æ¨¡å¼ï¼ŒGCè¿˜æ”¯æŒä¸¤ç§å­æ¨¡å¼ï¼šå¹¶å‘(é»˜è®¤)æˆ–è€…éå¹¶å‘ã€‚ åœ¨å¹¶å‘æ–¹å¼ä¸­ï¼Œåƒåœ¾å›æ”¶å™¨æœ‰ä¸€ä¸ªé¢å¤–çš„åå°çº¿ç¨‹ï¼Œå®ƒèƒ½åœ¨åº”ç”¨ç¨‹åºè¿è¡Œæ—¶å¹¶å‘æ ‡è®°å¯¹è±¡ã€‚ ç¨‹åºè¿è¡Œæ—¶ï¼Œåƒåœ¾å›æ”¶å™¨è¿è¡Œä¸€ä¸ªæ™®é€šä¼˜å…ˆçº§çš„åå°çº¿ç¨‹æ¥æŸ¥æ‰¾ä¸å¯è¾¾å¯¹è±¡ã€‚æ‰¾åˆ°ä¹‹åï¼Œåƒåœ¾å›æ”¶å™¨å†æ¬¡æŒ‚èµ·æ‰€ä»¥çº¿ç¨‹ï¼Œåˆ¤æ–­æ˜¯å¦è¦â€œå‹ç¼©â€å†…å­˜ã€‚å¦‚å†³å®šå‹ç¼©ï¼Œå†…å­˜ä¼šè¢«å‹ç¼©ï¼Œæ ¹å¼•ç”¨ä¼šè¢«ä¿®æ­£ï¼Œåº”ç”¨ç¨‹åºçº¿ç¨‹æ¢å¤è¿è¡Œã€‚è¿™ä¸€æ¬¡åƒåœ¾å›æ”¶èŠ±è´¹çš„æ—¶é—´æ¯”å¹³å¸¸å°‘ï¼Œå› ä¸ºä¸å¯è¾¾å¯¹è±¡é›†åˆå·²æ„é€ å¥½äº†ã€‚ä½†åƒåœ¾å›æ”¶å™¨ä¹Ÿå¯èƒ½å†³å®šä¸å‹ç¼©å†…å­˜ï¼›äº‹å®ä¸Šï¼Œåƒåœ¾å›æ”¶å™¨æ›´å€¾å‘ä¸å‹ç¼©ã€‚å¯ç”¨å†…å­˜å¤šï¼Œåƒåœ¾å›æ”¶å™¨ä¾¿ä¸ä¼šå‹ç¼©å †ï¼›è¿™æœ‰åˆ©äºå¢å¼ºæ€§èƒ½ï¼Œä½†ä¼šå¢å¤§ç¨‹åºçš„å·¥ä½œé›†ã€‚ä½¿ç”¨å¹¶å‘åƒåœ¾å›æ”¶å™¨ï¼Œåº”ç”¨ç¨‹åºæ¶ˆè€—çš„å†…å­˜é€šå¸¸æ¯”ä½¿ç”¨éå¹¶å‘åƒåœ¾å›æ”¶å™¨å¤šã€‚\n","date":"2016-10-04T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/c%23.net%E6%89%98%E7%AE%A1%E5%A0%86%E5%92%8C%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E7%BB%AD/","title":"C#.NETæ‰˜ç®¡å †å’Œåƒåœ¾å›æ”¶(ç»­)"},{"content":"C#é¿å…åœ¨å‡½æ•°æˆ–è€…æ“ä½œä¸­æŠ›å‡ºå¼‚å¸¸ å¼•è¨€ å¦‚æŸä¸ªåœºæ™¯ä¸‹ï¼Œä½ çš„å‡½æ•°æˆ–æ“ä½œéœ€è¦æ“ä½œä¸€ä¸ªåºåˆ—çš„å¯¹è±¡ï¼Œä¸”åœ¨å¤„ç†çš„è¿‡ç¨‹ä¸­æŠ›å‡ºäº†å¼‚å¸¸ã€‚è¿™æ—¶å¦‚æœæ²¡æœ‰ä¸€äº›çŠ¶æ€è®°å½•ä¹‹ç±»çš„æ•°æ®ï¼Œæˆ‘ä»¬ä¸äº†è§£å·²ç»å¤„ç†äº†å¤šå°‘çš„æ•°æ®ï¼Œä¹Ÿä¸çŸ¥é“åº”è¯¥é‡‡ç”¨æ€ä¹ˆæ ·çš„ç­–ç•¥å›æ»šï¼Œå› æ­¤æ ¹æœ¬æ— æ³•è¿”å›åˆ°ä¹‹å‰çš„çŠ¶æ€ã€‚ æˆ‘ä»¬çœ‹ä¸€ä¸‹ä¸‹é¢çš„ä¸€ä¸ªä»£ç ï¼š\n1 2 var allEmp = FindAllEmployees(); allEmp.ForEach(e =\u0026gt; e.MonthlySalary *=1.05M); è¿™æ ·çš„ä»£ç çœ‹èµ·æ¥æ²¡ä»€ä¹ˆé—®é¢˜ã€‚å¯æ˜¯æŸä¸€å¤©ï¼Œè¿™ä¸ªç¨‹åºè¿è¡Œæ—¶æŠ›å‡ºäº†å¼‚å¸¸ã€‚æŠ›å‡ºå¼‚å¸¸çš„ä½ç½®å¯èƒ½æœªçŸ¥ï¼Œå¯¼è‡´éƒ¨åˆ†å‘˜å·¥å¾—åˆ°äº†åŠ è–ªï¼Œå¦å¤–çš„ä¸€äº›å‘˜å·¥å´æ²¡æœ‰ã€‚ç»“æœæ˜¯é™¤äº†äººå·¥æ£€æŸ¥æ•°æ®ï¼Œæˆ‘ä»¬å·²ç»æ²¡æœ‰åŠæ³•é‡æ–°æ‰¾å›ä¸¢å¤±çš„çŠ¶æ€ã€‚\nè¿™æ ·çš„ä»£ç ä¿®æ”¹å…ƒç´ çš„æ–¹å¼å¯¼è‡´å‘ç”Ÿäº†ä¸Šé¢çš„é—®é¢˜ã€‚è¿™æ®µä»£ç å¹¶æ²¡æœ‰éµå¾ªâ€œå¼ºå¼‚å¸¸å®‰å…¨ä¿è¯â€è§„åˆ™ã€‚æ¢è€Œè¨€ä¹‹ï¼Œåœ¨è¿è¡Œæ—¶é‡åˆ°é”™è¯¯ï¼Œæˆ‘ä»¬æ— æ³•å¾—çŸ¥å…·ä½“å‘ç”Ÿäº†ä»€ä¹ˆï¼Œæ²¡æœ‰å‘ç”Ÿä»€ä¹ˆã€‚\nåŸåˆ™ï¼šå¦‚æœæˆ‘ä»¬èƒ½ä¿è¯å½“æ–¹æ³•æ— æ³•å®Œæˆæ—¶ï¼Œç¨‹åºçš„çŠ¶æ€ä¸ä¼šå‘ç”Ÿæ”¹å˜ï¼Œè¿™æ ·çš„é—®é¢˜å°±ä¸ä¼šå‘ç”Ÿã€‚ æˆ‘ä»¬æœ‰å‡ ç§æ–¹æ³•éƒ½å¯ä»¥å®ç°è¿™æ ·çš„éœ€æ±‚ï¼Œä½†æ˜¯æ¯ç§æ–¹æ³•éƒ½æœ‰å„è‡ªçš„ä¼˜åŠ¿å’Œé£é™©ã€‚\nåœ¨å‡½æ•°/æ“ä½œä¸­æŠ›å‡ºå¼‚å¸¸ æ˜¾è€Œæ˜“è§çš„ï¼Œä¸æ˜¯æ‰€æœ‰çš„æ–¹æ³•éƒ½ä¼šé‡åˆ°è¿™æ ·çš„é—®é¢˜ï¼ˆå¼‚å¸¸å¯¼è‡´çŠ¶æ€ä¸¢å¤±ï¼‰ã€‚å¾ˆå¤šæ—¶å€™æˆ‘ä»¬åªæ˜¯æ£€æŸ¥äº†ä¸€ä¸‹åºåˆ—ä¸­çš„å…ƒç´ ï¼Œè®¿é—®ä¹‹åå¹¶ä¸ä¼šä¿®æ”¹å…¶ä¸­çš„å…ƒç´ ã€‚è¿™ç±»çš„è¡Œä¸ºæˆ‘ä»¬å…¶å®å¹¶ä¸éœ€è¦å¤ªè¿‡äºå°å¿ƒã€‚ç°åœ¨æˆ‘ä»¬å›åˆ°æœ€å¼€å§‹çš„åœ°æ–¹ï¼Œå¯¹äºä¸Šé¢çš„åœºæ™¯ï¼ˆä¸ºæ¯ä½å‘˜å·¥åŠ è–ªç™¾åˆ†ä¹‹äº”ï¼‰ï¼Œå¦‚æœæˆ‘ä»¬æƒ³éµå¾ªâ€œå¼ºå¼‚å¸¸å®‰å…¨ä¿è¯â€åŸåˆ™ï¼Œé‚£åº”è¯¥å¦‚ä½•ä¿®æ”¹è¿™ä¸ªæ–¹æ³•å‘¢ï¼Ÿ\nç¬¬ä¸€ç§å¼‚å¸¸ï¼šè·å–æ•°æ®çš„æ—¶å€™å¼‚å¸¸ åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œå³ä½¿FindAllEmployees()å‡½æ•°æŠ›å‡ºå¼‚å¸¸ï¼Œå¯¼è‡´æˆ‘ä»¬æ— æ³•æ­£ç¡®è®©å‘˜å·¥åŠ è–ªã€‚è™½ç„¶è¿™æ ·çš„æƒ…å†µå¹¶ä¸æ˜¯å¯¼è‡´æˆ‘ä»¬çš„æ•°æ®äº§ç”Ÿé—®é¢˜ï¼Œä½†æ˜¯è¯¥åŠ è–ªçš„å¤§å®¶æ²¡æœ‰å¾—åˆ°åŠ è–ªï¼Œè¿™æ˜¯ä¸€ä¸ªå¤šä¹ˆæ²®ä¸§çš„äº‹æƒ…å‘¢ã€‚\nè§£å†³æ–¹æ³•ï¼šé‡å†™å‰é¢ä»¥lambdaè¡¨è¾¾å¼ç»™å‡ºçš„æ“ä½œæ–¹æ³•ï¼ˆå³FindAllEmployees()æ–¹æ³•ï¼‰ï¼Œè®©å…¶æ°¸è¿œä¸ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚ å¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬åœ¨å¼€å§‹ä¿®æ”¹æ•°æ®ä¹‹å‰ï¼Œå…ˆæ ¡éªŒæ•°æ®çš„åˆæ³•æ€§ä»¥åŠå‰”é™¤é”™è¯¯æ•°æ®ï¼ˆå¦‚æœå…è®¸å‰”é™¤çš„è¯ï¼‰å¹¶ä¸æ˜¯éå¸¸å›°éš¾ã€‚æˆ‘ä»¬æ˜¯å¯ä»¥é‡‡å–è¿™æ ·çš„æ–¹æ³•æ¥å®ç°æˆ‘ä»¬çš„ç›®çš„ã€‚ä¸è¿‡åœ¨è¿™é‡Œçš„è¯ï¼Œæˆ‘ä»¬å°±å¿…é¡»ä¸¥æ ¼å¤„ç†æ“ä½œæ–¹æ³•ï¼Œä½¿å¾—å®ƒèƒ½æ»¡è¶³æ‰€æœ‰æƒ…å†µä¸‹çš„éœ€æ±‚ã€‚\nç¬¬äºŒç§å¼‚å¸¸ï¼šlambdaè¡¨è¾¾å¼ä¸­æ“ä½œæ•°æ®å¼‚å¸¸ åŒæ ·æ˜¯ä¸Šé¢çš„ä¾‹å­ï¼Œå¦‚æœæˆ‘ä»¬åœ¨æ‰§è¡ŒåŠ è–ªæ“ä½œçš„æ—¶å€™ï¼Œæå‡äº†é‚£äº›å·²ç»ç¦»èŒçš„å‘˜å·¥è–ªèµ„å¯¼è‡´äº†å¼‚å¸¸ï¼Œä½¿å¾—ç¨‹åºä¸­æ–­ï¼ŒçŠ¶æ€ä¸¢å¤±ã€‚è¿™æ ·çš„æƒ…å†µï¼Œæˆ‘ä»¬åœ¨æ‰§è¡ŒåŠ è–ªæ“ä½œå‰å…ˆè¿‡æ»¤æ‰å·²ç¦»èŒçš„å‘˜å·¥ä¾¿æ˜¯ä¸€ç§æ­£ç¡®çš„åšæ³•ã€‚\nè§£å†³æ–¹æ³•ï¼šæ“ä½œæ•°æ®å‰é€šè¿‡æ ¡éªŒè¿‡æ»¤åå†æ‰§è¡Œæ“ä½œ å¦‚ï¼š allEmp.Where(emp=\u0026gt;emp.Active).ForEach(e =\u0026gt; e.MonthlySalary *=1.05M);\nç¬¬ä¸‰ç§å¼‚å¸¸ï¼šæ‰§è¡Œæ“ä½œçš„æ—¶å€™æŠ›å‡ºå¼‚å¸¸ æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬æ ¹æœ¬æ— æ³•ä¿è¯å¤„ç†æ–¹æ³•çš„æ—¶å€™ä¼šä¸ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚è¿™ä¸ªæ—¶å€™å°±å¿…é¡»é‡‡å–ä¸€äº›ä»£ä»·æ›´åŠ æ˜‚è´µçš„å¤„ç†æ–¹æ³•äº†ã€‚\nè§£å†³æ–¹æ³•ï¼šåˆ›å»ºå‰¯æœ¬å°è¯•æ‰§è¡Œæ“ä½œï¼Œå‰¯æœ¬æ— è¯¯åæ‰§è¡ŒçœŸæ­£æ“ä½œ æˆ‘ä»¬åœ¨ç¼–å†™è¿™ç±»ä»£ç çš„æ—¶å€™ï¼Œåº”è¯¥è€ƒè™‘æŠ›å‡ºå¼‚å¸¸ä¹‹åçš„å¤„ç†æ–¹æ¡ˆã€‚è¿™å°±æ„å‘³ç€ï¼Œæˆ‘ä»¬çš„æ“ä½œåº”è¯¥å…ˆåœ¨åŸæ•°æ®å‰¯æœ¬ä¸Šæ‰§è¡Œï¼Œéšåä»…åœ¨æ“ä½œæˆåŠŸä¹‹åå†å°†å…¶æ›¿æ¢åŸæœ‰çš„æ•°æ®ã€‚ å¦‚:\n1 2 3 4 5 6 7 8 9 var updatas = (from e in allEmp select new Emp { EmpID=e.EmpID, ..... MonthlySalary =e.MonthlySalary *=1.05M }).ToList(); allEmp = updatas; ä½†æ˜¯è¿™æ ·çš„ä¿®æ”¹ä¹Ÿå¼•å‘äº†å…¶ä»–çš„é—®é¢˜ï¼šä»£ç é‡å¢åŠ äº†ï¼ŒåŒæ—¶ç”Ÿæˆå‰¯æœ¬ä¹Ÿæ¶ˆè€—äº†å¤§é‡çš„èµ„æºã€‚è¿™æ ·çš„åšæ³•ä¹Ÿæœ‰ä¸€ä¸ªå¥½å¤„ï¼Œæˆ‘ä»¬åœ¨æ“ä½œå‰¯æœ¬æ•°æ®æ—¶é‡åˆ°å¼‚å¸¸ä¹‹åï¼Œæœ‰å……åˆ†çš„\u0026quot;ç©ºé—´\u0026quot;æ¥å¤„ç†è¿™äº›æ•°æ®ã€‚\nå®é™…ä¸­ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬è®©æŸ¥è¯¢è¡¨è¾¾å¼è¿”å›äº†æ–°åºåˆ—ï¼Œè€Œä¸æ˜¯å»ä¿®æ”¹åŸå…ˆåºåˆ—ä¸­çš„å…ƒç´ ã€‚è¿™æ ·çš„è¯ï¼Œæˆ‘ä»¬åœ¨å°è¯•å®Œæˆæ‰€æœ‰çš„æ“ä½œçš„åŒæ—¶ï¼Œå³ä½¿å¤±è´¥äº†ï¼Œä¹Ÿä¸ä¼šå½±å“åˆ°æˆ‘ä»¬ç¨‹åºçš„åŸæœ‰çŠ¶æ€ã€‚\n","date":"2016-10-04T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/c%23%E9%81%BF%E5%85%8D%E5%9C%A8%E5%87%BD%E6%95%B0%E6%88%96%E8%80%85%E6%93%8D%E4%BD%9C%E4%B8%AD%E6%8A%9B%E5%87%BA%E5%BC%82%E5%B8%B8/","title":"C#é¿å…åœ¨å‡½æ•°æˆ–è€…æ“ä½œä¸­æŠ›å‡ºå¼‚å¸¸"},{"content":"C# ç±»å­—æ®µä¸ç±»å±æ€§ å­—æ®µ å­—æ®µè¡¨ç¤ºåªè¯»æˆ–å¯è¯»/å¯å†™çš„æ•°æ®å€¼ã€‚ å­—æ®µå¯ä»¥æ˜¯é™æ€çš„ï¼Œè¿™ç§å­—æ®µè¢«è®¤ä¸ºæ˜¯ç±»å‹çŠ¶æ€çš„ä¸€éƒ¨åˆ†ã€‚ å­—æ®µä¹Ÿå¯ä»¥æ˜¯å®ä¾‹ï¼ˆéé™æ€ï¼‰ï¼Œè¿™ç§å­—æ®µè¢«è®¤ä¸ºæ˜¯å¯¹è±¡çŠ¶æ€çš„ä¸€éƒ¨åˆ†ã€‚ å¼ºçƒˆå»ºè®®æŠŠå­—æ®µå£°æ˜ä¸ºç§æœ‰ï¼Œé˜²æ­¢ç±»å‹æˆ–å¯¹è±¡çš„çŠ¶æ€è¢«ç±»å‹å¤–éƒ¨ä»£ç ç ´åã€‚ å±æ€§ å±æ€§å…è®¸ç”¨ç®€å•çš„ã€å­—æ®µé£æ ¼çš„è¯­æ³•è®¾ç½®æˆ–æŸ¥è¯¢ç±»å‹æˆ–å¯¹è±¡çš„é€»è¾‘çŠ¶æ€ï¼ŒåŒæ—¶ä¿è¯çŠ¶æ€ä¸è¢«ç ´åã€‚ ä½œç”¨äºç±»å‹ç§°ä¸ºé™æ€å±æ€§ï¼Œä½œç”¨äºå¯¹è±¡ç§°ä¸ºå®ä¾‹å±æ€§ã€‚ å±æ€§å¯ä»¥æ— å‚ï¼Œä¹Ÿå¯ä»¥æœ‰å¤šä¸ªå‚æ•°ï¼ˆç›¸å½“å°‘è§ï¼Œä½†é›†åˆç±»ç”¨çš„å¤šï¼‰ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 using System; public sealed class SomeType { // 1 // Nested class private class SomeNestedType { } // 2 // Constant, readÂ­only, and static read/write field private const Int32 c_SomeConstant = 1; // 3 private readonly String m_SomeReadOnlyField = \u0026#34;2\u0026#34;; // 4 private static Int32 s_SomeReadWriteField = 3; // 5 // Type constructor static SomeType() { } // 6 // Instance constructors public SomeType(Int32 x) { } // 7 public SomeType() { } // 8 // Instance and static methods private String InstanceMethod() { return null; } // 9 public static void Main() { } // 10 // Instance property public Int32 SomeProp { // 11 get { return 0; } // 12 set { } // 13 } // Instance parameterful property (indexer) public Int32 this[String s] { // 14 get { return 0; } // 15 set { } // 16 } // Instance event public event EventHandler SomeEvent; // 17 } ","date":"2016-10-04T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/c%23%E7%B1%BB%E5%AD%97%E6%AE%B5%E4%B8%8E%E7%B1%BB%E5%B1%9E%E6%80%A7/","title":"C#ç±»å­—æ®µä¸ç±»å±æ€§"},{"content":"å¯èƒ½æ˜¯å› ä¸ºæˆ‘ä»¬éƒ½ä¹ æƒ¯äºæ˜ç¡®å®šä¹‰ï¼Œä¸€èˆ¬è€Œè¨€,æ—¥å¸¸æˆ‘ä»¬å¾ˆå°‘ä½¿ç”¨åŒ¿åå¯¹è±¡ã€‚ ç„¶è€Œå¯¹äºå®ç°é‚£äº›çŸ­æ—¶é—´å­˜åœ¨çš„ã€å¹¶ä¸åœ¨åº”ç”¨ç¨‹åºé€»è¾‘ä¸­èµ·æ”¯é…åœ°ä½çš„ç±»å‹ï¼Œä½¿ç”¨åŒ¿åå¯¹è±¡å°±æ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©äº†å¦ä¸€ä¸ªæ–¹é¢ï¼Œå¯èƒ½ä¹Ÿæ˜¯å› ä¸ºåŒ¿åç±»å‹çš„ç”Ÿå‘½å‘¨æœŸæ— æ³•è·¨è¶ŠåŒ…å«æ”¹ç±»å‹çš„æ–¹æ³•ï¼Œå¯¼è‡´å¾ˆå¤šäººè§‰å¾—åŒ¿åå¯¹è±¡å¹¶ä¸å¥½ç”¨ï¼Œå› ä¸ºå…¶æ— æ³•åœ¨å¤šä¸ªæ–¹æ³•ä¹‹é—´ä¼ é€’ã€‚\nè¿™æ ·è¯´å¹¶ä¸å‡†ç¡®ã€‚æˆ‘ä»¬å®Œå…¨å¯ä»¥ä¸ºåŒ¿åç±»å‹ç¼–å†™æ³›å‹æ–¹æ³•ã€‚ä¸è¿‡è‹¥æ˜¯å¦‚æ­¤ï¼Œæˆ‘ä»¬ä¾¿ä¸èƒ½åœ¨æ³›å‹ç±»å‹æ–¹æ³•ä¸­å¤„ç†ä»»ä½•ç‰¹æ®Šçš„å…ƒç´ æˆ–è€…ç¼–å†™ä»»ä½•çš„ä¸“é—¨é€»è¾‘ã€‚ ä¸‹é¢æˆ‘ä»¬å°±æ¥å†™ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼Œç¤ºä¾‹åŠŸèƒ½ï¼šè¿”å›é›†åˆä¸­ä¸å¾…æŸ¥æ‰¾å¯¹è±¡ç›¸ç­‰çš„æ‰€æœ‰å…ƒç´ ã€‚\n1 2 3 4 5 6 7 8 static IEnumerable\u0026lt;T\u0026gt; FindValue(IEnumerable\u0026lt;T\u0026gt; enumerable, T value) { foreach (T element in enumerable) { if (element.Equals(value)) yield return element; } } è¿™ä¸ªæ–¹æ³•æ˜¯å¯ä»¥é…åˆåŒ¿åç±»å‹ä½¿ç”¨çš„ï¼Œä½†æ˜¯è¿™ä¸ªæ–¹æ³•æœ¬è´¨ä¸Šå…¶å®å°±æ˜¯ä¸€ä¸ªæ³›å‹æ–¹æ³•ï¼Œå¹¶ä¸äº†è§£åŒ¿åç±»å‹çš„ä¿¡æ¯ã€‚\n","date":"2016-10-04T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/c%23%E4%B8%BA%E5%8C%BF%E5%90%8D%E7%B1%BB%E5%9E%8B%E5%AE%9A%E4%B9%89%E5%B1%80%E9%83%A8%E5%87%BD%E6%95%B0/","title":"C#ä¸ºåŒ¿åç±»å‹å®šä¹‰å±€éƒ¨å‡½æ•°"},{"content":"CLRä¸ºæ¯ä¸ª ApDomain éƒ½æä¾›äº†ä¸€ä¸ª GCå¥æŸ„è¡¨ï¼ˆGC Handle tableï¼‰ï¼Œå…è®¸åº”ç”¨ç¨‹åºç›‘è§†æˆ–è€…æ‰‹åŠ¨æ§åˆ¶å¯¹è±¡çš„ç”Ÿå­˜æœŸã€‚è¿™ä¸ªè¡¨åœ¨ ApDomain åˆ›å»ºä¹‹åˆæ˜¯ç©ºç™½çš„ã€‚\nè¡¨ä¸­æ¯ä¸ªè®°å½•é¡¹éƒ½åŒ…å«ä¸€ä¸‹ä¸¤ç§ä¿¡æ¯ï¼š\nå¯¹æ‰˜ç®¡å †ä¸­çš„ä¸€ä¸ªå¯¹è±¡çš„å¼•ç”¨ï¼Œä»¥åŠä¹‹åˆå¦‚ä½•ç›‘è§†æˆ–è€…æ§åˆ¶å¯¹è±¡çš„æ ‡å¿—ï¼ˆflagï¼‰ã€‚\n","date":"2016-10-04T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/clr-%E6%89%8B%E5%8A%A8%E7%9B%91%E6%8E%A7%E5%92%8C%E6%8E%A7%E5%88%B6%E5%AF%B9%E8%B1%A1%E7%9A%84%E7%94%9F%E5%AD%98%E5%91%A8%E6%9C%9F/","title":"CLR æ‰‹åŠ¨ç›‘æ§å’Œæ§åˆ¶å¯¹è±¡çš„ç”Ÿå­˜å‘¨æœŸ"},{"content":"å¯¹äº.NETå¹³å°ä¸Šçš„ä»£ç ç”Ÿæˆå™¨æ¥è¯´ï¼Œcodesmithæ˜¯ä¸€ä¸ªéå¸¸å¥½çš„é€‰æ‹©ã€‚\nä»¥å‰åœ¨å­¦é™¢å®éªŒå®¤ç”¨çš„éƒ½æ˜¯SQL serveræ•°æ®åº“ï¼Œè€å¸ˆç»™çš„ä¸€å¥—codesmithæ¨¡æ¿ç”¨æ¥ç”Ÿæˆmodel/DAL/BLLå¾ˆæ˜¯æ–¹ä¾¿ã€‚\rä¸è¿‡åæ¥æ”¾å¼ƒSQL server æŠ•å…¥MySQLä¹‹åï¼Œåˆšå¼€å§‹éƒ½æ˜¯æ‰‹å†™SQLï¼Œè¿˜æ˜¯å¾ˆç—›è‹¦çš„ã€‚\rå†åæ¥åˆå»æ‰¾MySQL codesmithæ¨¡æ¿,è¿™ä¸ªå¯¹åº”çš„èµ„æ–™å°±ä¸å¤šäº†ã€‚ä¸è¿‡æœ€åè¿˜æ˜¯æ‰¾åˆ°äº†ä¸€å¥—ä¸é”™çš„ï¼Œå‡‘åˆèƒ½ç”¨ã€‚èµ·åˆä¹Ÿæ‡’ï¼Œcodesmithè¯­æ³•ä¸ç†Ÿï¼Œå°±æ²¡æƒ³è¿‡å»ä¿®æ”¹ä¸€ä¸‹äº†ã€‚\ræœ€è¿‘åˆè¦ç”¨åˆ°è¿™å¥—ä¸œè¥¿ï¼Œäºæ˜¯å†³å®šè¿˜æ˜¯å»ä¿®æ”¹ä¸€ç•ªï¼Œæ›´ä¾¿äºä½¿ç”¨ã€‚\rè¿™ä¸ªæ–‡ç« å°±ä¸»è¦è®²ä¸€ä¸‹ä¿®æ”¹è¿‡ç¨‹ï¼Œé¡ºä¾¿è¯´ä¸€ä¸‹codesmithçš„ç®€å•è¯­æ³•ã€‚\nå…ˆè¯´ä¸€ä¸‹æ“ä½œæ­¥éª¤ï¼š\næŠŠæ¨¡æ¿çš„æ–‡ä»¶å¤¹æ‰”åˆ°codesmithæ¨¡æ¿æ–‡ä»¶çš„è·¯å¾„ä¸‹ï¼Œæ¥ç€æ‰“å¼€Codesmithï¼Œæ‰¾åˆ°åˆšæ‰”è¿‡å»çš„æ–‡ä»¶å¤¹ï¼Œé€‰æ‹©Main.cst,å³é”®-execute-é€‰æ‹©å¯¹åº”çš„MySQLåº“-é€‰ä¸­è¡¨ã€‚ ï¼ˆæ³¨ï¼šcodesmithè¿æ¥MySQLæœ‰é—®é¢˜çš„è¯ï¼Œ ç§»æ­¥è¿™é‡Œè§£å†³ CodeSmith è¿æ¥MySQLæ•°æ®åº“æŠ¥â€œcan\u0026rsquo;t find .net framework data providerâ€)\nå¦‚ä¸‹å›¾ï¼š ç„¶åç‚¹å‡»Generateå°±èƒ½é¡ºåˆ©ç”Ÿæˆmodel/dal/blläº†ã€‚\nç”Ÿæˆä»£ç ç»“æ„å¦‚ä¸‹ï¼š è¿™æ ·æ“ä½œæ²¡ä»€ä¹ˆé—®é¢˜ï¼Œé¡ºåˆ©ç”Ÿæˆäº†æˆ‘ä»¬è¦çš„model/dal/blläº†ï¼Œç„¶å....æˆ‘æ‡’å˜›ã€‚\ræ¯æ¬¡éƒ½è¦æŠŠè¡¨ä¸€ä¸ªä¸ªé€‰ä¸€æ¬¡ï¼Œéº»ä¸éº»çƒ¦å•Šã€‚ç„¶åå°±æƒ³äº†ï¼Œèƒ½ä¸èƒ½æ”¹ä¸€ä¸‹æ¨¡æ¿å‘¢ã€‚äºæ˜¯ä¾¿å¼€å§‹googleç›¸å…³èµ„æ–™äº†ã€‚æ‰¾åˆ°äº†å‡ ä¸ªç›¸å…³æ–‡ç« ï¼Œå‚è€ƒè¿™å°±å¼€å§‹æ”¹é€ äº†ã€‚\rå…ˆçœ‹çœ‹åŸæ¥çš„Main.csté‡Œé¢å†™äº†æ’’ã€‚\r1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 \u0026lt;%@ CodeTemplate Language=\u0026#34;C#\u0026#34; ResponseEncoding=\u0026#34;UTF-8\u0026#34; TargetLanguage=\u0026#34;Text\u0026#34; Src=\u0026#34;\u0026#34; Inherits=\u0026#34;\u0026#34; Debug=\u0026#34;False\u0026#34; Description=\u0026#34;Template description here.\u0026#34; Output=\u0026#34;None\u0026#34;%\u0026gt; \u0026lt;%@ Register Name=\u0026#34;Models\u0026#34; Template=\u0026#34;DBMad.Models.cst\u0026#34; MergeProperties=\u0026#34;False\u0026#34; ExcludeProperties=\u0026#34;\u0026#34; %\u0026gt;\t\u0026lt;%@ Register Name=\u0026#34;DAL\u0026#34; Template=\u0026#34;DBMad.DAL.cst\u0026#34; MergeProperties=\u0026#34;False\u0026#34; ExcludeProperties=\u0026#34;\u0026#34; %\u0026gt; \u0026lt;%@ Register Name=\u0026#34;BLL\u0026#34; Template=\u0026#34;DBMad.BLL.cst\u0026#34; MergeProperties=\u0026#34;False\u0026#34; ExcludeProperties=\u0026#34;\u0026#34; %\u0026gt; \u0026lt;%@ Property Name=\u0026#34;SourceTable\u0026#34; Type=\u0026#34;SchemaExplorer.TableSchema\u0026#34; Optional=\u0026#34;False\u0026#34;%\u0026gt; \u0026lt;%@ Property Name=\u0026#34;RootNamespace\u0026#34; Default=\u0026#34;Net.Itcast.CN\u0026#34; Type=\u0026#34;System.String\u0026#34; Optional=\u0026#34;False\u0026#34;%\u0026gt; \u0026lt;%@ Assembly Name=\u0026#34;SchemaExplorer\u0026#34; %\u0026gt; \u0026lt;%@ Assembly Name=\u0026#34;System.Data\u0026#34; %\u0026gt; \u0026lt;%@ Import Namespace=\u0026#34;SchemaExplorer\u0026#34; %\u0026gt; \u0026lt;%@ Import Namespace=\u0026#34;System.Data\u0026#34; %\u0026gt; \u0026lt;script runat=\u0026#34;template\u0026#34;\u0026gt; private string _outputDirectory = String.Empty; [Editor(typeof(System.Windows.Forms.Design.FolderNameEditor), typeof(System.Drawing.Design.UITypeEditor))] [Description(\u0026#34;The directory to output the results to.\u0026#34;)] public string OutputDirectory { get {\treturn _outputDirectory; } set { if (value != null \u0026amp;\u0026amp; !value.EndsWith(\u0026#34;\\\\\u0026#34;)) { value += \u0026#34;\\\\\u0026#34;; } _outputDirectory = value; } } \u0026lt;/script\u0026gt; è¿™ä¸€æ®µåŸºæœ¬å°±æ˜¯åœ¨å£°æ˜é€‰é¡¹ä»¥åŠå¼•ç”¨å‘½åç©ºé—´ï¼Œè¡¨ç°å‡ºæ¥çš„ä¾¿æ˜¯æˆ‘ä»¬çœ‹åˆ°çš„ä¸‹å›¾ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 \u0026lt;% Models model = this.Create\u0026lt;Models\u0026gt;(); model.ModelsNamespace = this.RootNamespace+\u0026#34;.Model\u0026#34;; model.TargetTable = this.SourceTable; model.RenderToFile(this.OutputDirectory+\u0026#34;Model/\u0026#34;+model.GetFileName(),true); DAL dal = this.Create\u0026lt;DAL\u0026gt;(); dal.TargetTable = this.SourceTable; dal.ModelsNamespace = model.ModelsNamespace; dal.DALClassNameSurfix = \u0026#34;DAL\u0026#34;; dal.DALNamespace =this.RootNamespace+\u0026#34;.DAL\u0026#34;; dal.RenderToFile(this.OutputDirectory+\u0026#34;DAL/\u0026#34; +dal.GetFileName(),true); BLL bll = this.Create\u0026lt;BLL\u0026gt;(); bll.ModelsNamespace = model.ModelsNamespace; bll.DALClassNameSurfix = dal.DALClassNameSurfix; bll.DALNamespace = dal.DALNamespace; bll.BLLClassNameSurfix = \u0026#34;BLL\u0026#34;; bll.BLLNamespace = this.RootNamespace+\u0026#34;.BLL\u0026#34;; bll.TargetTable = this.SourceTable; bll.RenderToFile(this.OutputDirectory+\u0026#34;BLL/\u0026#34; +bll.GetFileName(),true); Response.Write(\u0026#34;ok,see \u0026#34;+this.OutputDirectory); %\u0026gt; è¿™ä¸€æ®µå°±æ˜¯æˆ‘ä»¬ç‚¹å‡»Generateä¹‹åæ‰§è¡Œçš„ä»£ç ï¼ŒåŸºæœ¬åŠŸèƒ½å°±æ˜¯è°ƒç”¨ DBMad.Models.cst,DBMad.DAL.cst,DBMad.BLL.cstã€‚ å› ä¸ºåœ¨ä¸Šé¢å£°æ˜æ•°æ®æºçš„æ—¶å€™ï¼Œä½¿ç”¨äº†SchemaExplorer.TableSchemaï¼Œå¯¼è‡´æˆ‘ä»¬é€‰æ‹©è¡¨çš„æ—¶å€™ä¸èƒ½å¤šé€‰ã€‚ä»£ç å¦‚ä¸‹ï¼š\n\u0026lt;%@ Property Name=\u0026ldquo;SourceTable\u0026rdquo; Type=\u0026ldquo;SchemaExplorer.TableSchema\u0026rdquo; Optional=\u0026ldquo;False\u0026rdquo;%\u0026gt;\nè¿™æ ·ä¸€æƒ³ï¼Œè¿™ä¸ªMain.cstå°±æ˜¯ä¸€ä¸ªå¯ä»¥å¤„ç†å•è¡¨çš„ç”Ÿæˆæ¨¡æ¿äº†ï¼Œæˆ‘ä»¬åªè¦è‡ªå·±å†™ä¸€ä¸ªå¯ä»¥å¤šé€‰è¡¨çš„æ¨¡æ¿ï¼Œç„¶åå¾ªç¯è°ƒç”¨è¿™ä¸ªæ¨¡æ¿å»ç”Ÿæˆï¼Œä¸å°±å®Œäº‹äº†ï¼Ÿ\næ‰¾äº†ä¸€ä¸‹èµ„æ–™ï¼Œå‘ç°åªéœ€è¦æŠŠä¸Šé¢çš„é€‰é¡¹Typeæ”¹ä¸€ä¸‹ï¼Œä¾¿å¯ä»¥å¤šé€‰è¡¨äº†ã€‚\nå¦‚ä¸‹ï¼š\n\u0026lt;%@ Property Name=\u0026ldquo;SourceTables\u0026rdquo; Type=\u0026ldquo;SchemaExplorer.TableSchemaCollection\u0026rdquo; Default=\u0026quot;\u0026quot; Optional=\u0026ldquo;False\u0026rdquo; Category=\u0026quot;\u0026quot;%\u0026gt;\næ•´ä½“ä»£ç å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 \u0026lt;%@ CodeTemplate Language=\u0026#34;C#\u0026#34; ResponseEncoding=\u0026#34;UTF-8\u0026#34; TargetLanguage=\u0026#34;Text\u0026#34; Src=\u0026#34;\u0026#34; Inherits=\u0026#34;\u0026#34; Debug=\u0026#34;False\u0026#34; Description=\u0026#34;Template description here.\u0026#34; Output=\u0026#34;None\u0026#34;%\u0026gt; \u0026lt;%@ Property Name=\u0026#34;SourceTables\u0026#34; Type=\u0026#34;SchemaExplorer.TableSchemaCollection\u0026#34; Default=\u0026#34;\u0026#34; Optional=\u0026#34;False\u0026#34; Category=\u0026#34;\u0026#34;%\u0026gt; \u0026lt;%@ Register Name=\u0026#34;SE\u0026#34; Template=\u0026#34;CreatSingleTable.cst\u0026#34; MergeProperties=\u0026#34;False\u0026#34; ExcludeProperties=\u0026#34;\u0026#34; %\u0026gt; \u0026lt;%@ Property Name=\u0026#34;RootNamespace\u0026#34; Default=\u0026#34;Net.Itcast.CN\u0026#34; Type=\u0026#34;System.String\u0026#34; Optional=\u0026#34;False\u0026#34;%\u0026gt; \u0026lt;%@ Assembly Name=\u0026#34;SchemaExplorer\u0026#34; %\u0026gt; \u0026lt;%@ Assembly Name=\u0026#34;System.Data\u0026#34; %\u0026gt; \u0026lt;%@ Import Namespace=\u0026#34;SchemaExplorer\u0026#34; %\u0026gt; \u0026lt;%@ Import Namespace=\u0026#34;System.Data\u0026#34; %\u0026gt; \u0026lt;%@ Import Namespace=\u0026#34;System.Collections\u0026#34; %\u0026gt; \u0026lt;script runat=\u0026#34;template\u0026#34;\u0026gt; private string _outputDirectory = String.Empty; [Editor(typeof(System.Windows.Forms.Design.FolderNameEditor), typeof(System.Drawing.Design.UITypeEditor))] [Description(\u0026#34;The directory to output the results to.\u0026#34;)] public string OutputDirectory { get {\treturn _outputDirectory; } set { if (value != null \u0026amp;\u0026amp; !value.EndsWith(\u0026#34;\\\\\u0026#34;)) { value += \u0026#34;\\\\\u0026#34;; } _outputDirectory = value; } } \u0026lt;/script\u0026gt; \u0026lt;% foreach(TableSchema ts in SourceTables) { SE s = new SE(); s.SourceTable = ts; s.RootNamespace = RootNamespace; s.OutputDirectory = OutputDirectory; s.Render(this.Response); } %\u0026gt; \u0026lt;script runat=\u0026#34;template\u0026#34;\u0026gt; \u0026lt;/script\u0026gt; å‰é¢ä¸€éƒ¨åˆ†è¿˜æ˜¯ä¸€æ ·çš„å£°æ˜ï¼Œ\n\u0026lt;%@ Property Name=\u0026ldquo;SourceTables\u0026rdquo; Type=\u0026ldquo;SchemaExplorer.TableSchemaCollection\u0026rdquo; Default=\u0026quot;\u0026quot; Optional=\u0026ldquo;False\u0026rdquo; Category=\u0026quot;\u0026quot;%\u0026gt;\nè¿™ä¸€å¥æŠŠé€‰é¡¹ç±»å‹ä¿®æ”¹æˆå¯å¤šé€‰çš„ï¼ˆæ—¢ é›†åˆï¼‰ã€‚ æ•ˆæœå¦‚ä¸‹å›¾ï¼š 1 2 3 4 5 6 7 8 9 10 11 12 \u0026lt;% foreach(TableSchema ts in SourceTables) { SE s = new SE(); s.SourceTable = ts; s.RootNamespace = RootNamespace; s.OutputDirectory = OutputDirectory; s.Render(this.Response); } %\u0026gt; \u0026lt;script runat=\u0026#34;template\u0026#34;\u0026gt; \u0026lt;/script\u0026gt; è¿™ä¸€æ®µä»£ç ä¾¿æ˜¯è·å–åˆšå¾—åˆ°çš„è¡¨é›†åˆï¼Œéå†é›†åˆç„¶åä¾æ¬¡è°ƒç”¨ä¹‹å‰çš„å•è¡¨ç”Ÿæˆæ¨¡æ¿ã€‚\nåˆ°è¿™é‡Œå·®ä¸å¤šå·²ç»å®Œæˆäº†æˆ‘è¦çš„æ•ˆæœï¼Œé€‰æ‹©å¤šè¡¨ï¼Œå®ç°ä¸€æ¬¡ç”Ÿæˆæ‰€æœ‰çš„è¡¨å¯¹åº”çš„model/dal/bllã€‚\nè¿™ä¸ªæ•ˆæœåŸºæœ¬å°±æ˜¯æˆ‘è¦çš„äº†ï¼Œä½†æ˜¯åæ¥åˆå‘ç°ï¼Œmodelé‡Œé¢çš„å­—æ®µå±…ç„¶æ²¡æœ‰æ³¨é‡Šï¼Œæˆ‘åœ¨å»ºè¡¨çš„æ—¶å€™å†™äº†å­—æ®µæ³¨é‡Šçš„å‘€ã€‚\næ‰“å¼€modelçš„cstæ–‡ä»¶ä¹‹åå‘ç°ï¼Œæ¨¡æ¿å¹¶æ²¡æœ‰åšæ³¨é‡Šè¿™ä¸ªå·¥ä½œã€‚ ä»£ç å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 \u0026lt;%@ CodeTemplate Language=\u0026#34;C#\u0026#34; TargetLanguage=\u0026#34;C#\u0026#34; Src=\u0026#34;ToolsCodeTemplate.cs\u0026#34; Inherits=\u0026#34;ToolsCodeTemplate\u0026#34;%\u0026gt; \u0026lt;%@ Property Name=\u0026#34;TargetTable\u0026#34; Type=\u0026#34;SchemaExplorer.TableSchema\u0026#34; Category=\u0026#34;Context\u0026#34; Description=\u0026#34;TargetTable that the object is based on.\u0026#34; %\u0026gt; \u0026lt;%@ Property Name=\u0026#34;ModelsNamespace\u0026#34; Default=\u0026#34;Model\u0026#34; Type=\u0026#34;System.String\u0026#34; Category=\u0026#34;Context\u0026#34; Description=\u0026#34;TargetTable that the object is based on.\u0026#34; %\u0026gt; \u0026lt;%@ Assembly Name=\u0026#34;SchemaExplorer\u0026#34; %\u0026gt; \u0026lt;%@ Assembly Name=\u0026#34;System.Data\u0026#34; %\u0026gt; \u0026lt;%@ Import Namespace=\u0026#34;SchemaExplorer\u0026#34; %\u0026gt; \u0026lt;%@ Import Namespace=\u0026#34;System.Data\u0026#34; %\u0026gt; \u0026lt;% PrintHeader(); %\u0026gt; using System; using System.Collections.Generic; using System.Text; namespace \u0026lt;%= ModelsNamespace %\u0026gt; {\t[Serializable()] public class \u0026lt;%= GetModelClassName() %\u0026gt; { \u0026lt;% foreach (ColumnSchema column in TargetTable.Columns) { %\u0026gt; private \u0026lt;%= GetPropertyType(column) %\u0026gt; _\u0026lt;%= GetPropertyName(column) %\u0026gt;;\t\u0026lt;% } %\u0026gt; \u0026lt;% foreach (ColumnSchema column in TargetTable.Columns) { %\u0026gt; public \u0026lt;%= GetPropertyType(column) %\u0026gt; \u0026lt;%= GetPropertyName(column) %\u0026gt; { get { return _\u0026lt;%= GetPropertyName(column) %\u0026gt;; } set { _\u0026lt;%= GetPropertyName(column) %\u0026gt; = value; } } \u0026lt;% } %\u0026gt;\t} } \u0026lt;script runat=\u0026#34;template\u0026#34;\u0026gt; public string GetModelClassName() { return GetModelClassName(TargetTable); } public override string GetFileName() { return this.GetModelClassName(this.TargetTable) + \u0026#34;.cs\u0026#34;; } \u0026lt;/script\u0026gt; è·å–è¡¨ä¸­å­—æ®µåä½¿ç”¨çš„æ˜¯GetPropertyName(column)ï¼Œå’¦ï¼Œåœ¨å“ªå®ç°äº†è¿™ä¸ªä¸œè¥¿å‘¢ï¼Ÿå›å»ç¿»ä¸€ä¸‹æ–‡ä»¶ï¼Œå“¦ï¼Œè¿˜æœ‰ä¸€ä¸ªToolsCodeTemplate.csæ–‡ä¸€ç›´æ²¡ç®¡å‘¢ã€‚\næœç„¶ï¼ŒGetPropertyName(column)åœ¨è¿™é‡Œã€‚\n1 2 3 4 5 6 7 8 9 public string GetPropertyName(ColumnSchema column) { return GetNameFromDBFieldName(column); } public string GetNameFromDBFieldName(ColumnSchema column) { return column.Name; } è¯»å–åˆ—åå°±æ˜¯è¿™ä¹ˆç®€å•ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯¹åº”å†™ä¸€ä¸ªå‡½æ•°è¯»å–ä¸€ä¸‹åˆ—æ³¨é‡Šï¼Œç„¶åå†modelé‡Œé¢è°ƒç”¨ä¸€ä¸‹ä¸å¥½äº†ã€‚\nåˆæŸ¥äº†ä¸€ä¸‹èµ„æ–™ï¼Œ\n1 2 3 4 public string GetColumnComment(ColumnSchema column) { return column.Description; } å—¯ï¼Œç†è®ºä¸Šè¿™æ ·æ˜¯å¯ä»¥çš„\u0026hellip; ç„¶è€Œï¼Œæˆ‘æƒ³å¤šäº†ã€‚å€’è…¾äº†å¥½ä¹…ï¼Œè¿™ä¸ªå±æ€§å€¼éƒ½æ˜¯ç©ºçš„\u0026hellip; googleäº†ä¸€åœˆä¹‹åå‘ç°ï¼ŒåŸæ¥æ˜¯SchemaExplorer.MySQLSchemaProvider.dll é‡Œé¢å‹æ ¹æ²¡å®ç°è¯»å–åˆ—æ³¨é‡Šçš„å®ç°\u0026hellip;.\nä¸è¿‡ä¹Ÿæœ‰å¯¹åº”çš„è§£å†³æ–¹æ³•ï¼š\nå®Œç¾è§£å†³CodeSmithæ— æ³•è·å–MySQLè¡¨åŠåˆ—Descriptionè¯´æ˜æ³¨é‡Šçš„æ–¹æ¡ˆ\næŠŠDLLæ›¿æ¢ä¸€ä¸‹å°±å¥½äº†ã€‚\næœ€åé™„ä¸Šæ¨¡æ¿è¿æ¥:CodeSmith-for-MySQL-Template\næ³¨ï¼š\næ¨¡æ¿ä¼šæŠŠMySQLçš„è¡¨åå‰ä¸‰ä¸ªå­—ç¬¦æˆªå–æ‰ï¼Œå»ºè®®æŠŠè¡¨æ˜è®¾ç½®ä¸ºtblå¼€å¤´ï¼Œæˆ–è€…è‡ªè¡Œä¿®æ”¹æ¨¡æ¿æ–‡ä»¶ã€‚ æƒ³è®©å­—æ®µæ³¨é‡Šç”Ÿæ•ˆè®°å¾—æ›¿æ¢SchemaExplorer.MySQLSchemaProvider.dll(æ›¿æ¢å‰è®°å¾—å¤‡ä»½ï¼) ","date":"2016-10-04T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/codesmith-for-mysql-template/","title":"CodeSmith for MySQL template"},{"content":"1ã€ä¸‹è½½ mysql-connector-net å®‰è£…\nmysql-connector-net\n2ã€mysql-connector-net å®‰è£…å®Œæ¯•ä¹‹åï¼Œåˆ°å¯¹åº”çš„å®‰è£…ç›®å½•ä¸‹ï¼ŒæŠŠå¯¹åº”çš„MySQL .NET dllæ‹·è´åˆ° CodeSmithçš„binç›®å½•å’ŒSchemaProvidersç›®å½•ã€‚\nä¸€èˆ¬DLLæ‰€åœ¨ç›®å½•æ˜¯ï¼š\nC:\\Program Files (x86)\\MySQL\\MySQL Connector Net 6.9.8\\Assemblies\\v4.0\n3ã€é‡å¯CodeSmithç”Ÿæ•ˆ\nå…¶ä½™è§£å†³æ–¹æ¡ˆï¼š codesmithæ— æ³•è¿æ¥Mysqlçš„è§£å†³æ–¹æ³•\ncodesmith6.5è¿æ¥Mysqlæç¤ºâ€œæ‰¾ä¸åˆ°è¯·æ±‚çš„ .Net Framework Data Providerã€‚å¯èƒ½æ²¡æœ‰å®‰è£…ã€‚â€è§£å†³æ–¹æ³•\n","date":"2016-10-04T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/codesmith-%E8%BF%9E%E6%8E%A5mysql%E6%95%B0%E6%8D%AE%E5%BA%93%E6%8A%A5cant-find-.net-framework-data-provider/","title":"CodeSmith è¿æ¥MySQLæ•°æ®åº“æŠ¥â€œcan't find .net framework data providerâ€"},{"content":"å…ˆçœ‹ä¸€æ®µä»£ç \n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 #region test1 é—­åŒ… public static void test1() { int index = 0; Func\u0026lt;IEnumerable\u0026lt;int\u0026gt;\u0026gt; sequence =()=\u0026gt;GetEnumrableInt(index); index = 20; foreach(int n in sequence()) Console.WriteLine(n); Console.WriteLine(\u0026#34;Done\u0026#34;); index = 100; foreach (int n in sequence()) Console.WriteLine(n); } public static IEnumerable\u0026lt;int\u0026gt; GetEnumrableInt(int index) { List\u0026lt;int\u0026gt; l = new List\u0026lt;int\u0026gt;(); for(int i=index;i\u0026lt;index+30;i++) { l.Add(i); } return l; } #endregion ä¸Šé¢ä¸€å¨ä»£ç æ¼”ç¤ºäº†åœ¨é—­åŒ…ä¸­ä½¿ç”¨äº†å¤–éƒ¨å˜é‡ï¼Œéšå³åˆåœ¨å¤–éƒ¨ä¿®æ”¹äº†è¿™äº›å˜é‡çš„æƒ…å†µï¼Œå¾—åˆ°çš„ç»“æœæ˜¯è¾“å‡ºäº†20-50çš„æ•°ï¼Œç„¶ååˆè¾“å‡ºäº†100-130ä¹‹é—´çš„æ•°ã€‚è¿™ç§è¡Œä¸ºæœ‰ç‚¹è¯¡å¼‚ï¼Œä½†æ˜¯ç¡®å®æœ‰å­˜åœ¨çš„æ„ä¹‰\u0026hellip;(ä¹¦æœ¬è¿™æ ·è¯´çš„ï¼Œæˆ‘åˆ°è§‰å¾—å¾ˆå°‘ä¼šç”¨åˆ°ã€‚)\nä¸ºäº†å°†æŸ¥è¯¢è¡¨è¾¾å¼è½¬æ¢æˆå¯æ‰§è¡Œä»£ç ï¼ŒC#ç¼–è¯‘å™¨åšäº†å¾ˆå¤šå·¥ä½œã€‚ä¸€èˆ¬è€Œè¨€ï¼ŒC#ç¼–è¯‘å™¨å°†æŸ¥è¯¢å’Œlambdaè¡¨è¾¾å¼è½¬æ¢æˆ \u0026ldquo;é™æ€å§”æ‰˜\u0026rdquo;ã€\u0026ldquo;å®ä¾‹å§”æ‰˜\u0026rdquo; æˆ– \u0026ldquo;é—­åŒ…\u0026rdquo;ã€‚ç¼–è¯‘å™¨å°†æ ¹æ®lambdaè¡¨è¾¾å¼ä¸­çš„ä»£ç é€‰æ‹©ä¸€ç§å®ç°æ–¹å¼ã€‚é€‰æ‹©å“ªç§æ–¹å¼ä¾èµ–äºlambdaè¡¨è¾¾å¼çš„ä¸»ä½“ï¼ˆbodyï¼‰ã€‚è¿™çœ‹ä¸Šå»ä¼¼ä¹æ˜¯ä¸€äº›è¯­è¨€ä¸Šçš„å®ç°ç»†èŠ‚ï¼Œä½†å®ƒå´ä¼šæ˜¾è‘—åœ°å½±å“åˆ°æˆ‘ä»¬çš„ä»£ç ã€‚ç¼–è¯‘å™¨é€‰æ‹©ä½•ç§å®ç°å°†å¯èƒ½å¯¼è‡´diamanteè¡Œä¸ºå‘ç”Ÿå¾®å¦™çš„å˜åŒ–ã€‚\nå¹¶ä¸æ˜¯ä»»ä½•çš„lambdaè¡¨è¾¾å¼éƒ½ä¼šç”ŸæˆåŒæ ·ç»“æ„çš„ä»£ç ã€‚\nå¯¹äºç¼–è¯‘å™¨æ¥è¯´ï¼Œæœ€ç®€å•çš„ä¸€ç§è¡Œä¸ºæ˜¯ä¸ºä»¥ä¸‹å½¢å¼çš„ä»£ç ç”Ÿæˆå§”æ‰˜ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 //æˆ‘ä»¬çš„lambdaè¡¨è¾¾å¼ public static void test2() { int[] someNum = {0,1,2,3,4,5,6,7,8,9,10 }; IEnumerable\u0026lt;int\u0026gt; ans = from n in someNum select n * n; foreach (int i in ans) Console.WriteLine(i); } ç¼–è¯‘å™¨å°†ä½¿ç”¨é™æ€å§”æ‰˜æ¥å®ç°n*nçš„lambdaè¡¨è¾¾å¼ï¼Œå…¶ä¸ºä¸Šé¢ä»£ç ç”Ÿæˆçš„ä»£ç å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 //ç¼–è¯‘å™¨ä¸ºæˆ‘ä»¬çš„lambdaç”Ÿæˆçš„ä»£ç  #region ç­‰ä»·äº test2() private static int HiddenFunc(int n) { return n * n; } //é™æ€å§”æ‰˜ private static Func\u0026lt;int, int\u0026gt; HiddenDelegate; public void test2_1() { int[] someNum = { 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 }; if(HiddenDelegate==null) { HiddenDelegate = new Func\u0026lt;int, int\u0026gt;(HiddenFunc); } IEnumerable\u0026lt;int\u0026gt; ans = someNum.Select\u0026lt;int, int\u0026gt;(HiddenDelegate); foreach(int i in ans) Console.WriteLine(i); } #endregion è¿™ä¸ªlambdaè¡¨è¾¾å¼ä¸»ä½“éƒ¨åˆ†å¹¶æ²¡æœ‰è®¿é—®ä»»ä½•çš„å®ä¾‹å˜é‡æˆ–è€…å±€éƒ¨å˜é‡ã€‚lambdaè¡¨è¾¾å¼ä»…ä»…è®¿é—®äº†å®ƒçš„å‚æ•°ã€‚å¯¹äºè¿™ç§æƒ…å†µï¼ŒC#ç¼–è¯‘å™¨å°†åˆ›å»ºä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œä½œä¸ºå§”æ‰˜çš„ç›®æ ‡ã€‚è¿™ä¹Ÿæ˜¯ç¼–è¯‘å™¨æ‰§è¡Œçš„æœ€ç®€å•çš„ä¸€ç§å¤„ç†æ–¹å¼ã€‚è‹¥è¡¨è¾¾å¼å¯ä»¥é€šè¿‡ç§æœ‰çš„é™æ€æ–¹æ³•å®ç°ï¼Œé‚£ä¹ˆç¼–è¯‘å™¨å°†ç”Ÿæˆè¯¥ç§æœ‰çš„é™æ€æ–¹æ³•ä»¥åŠç›¸å¯¹åº”çš„å§”æ‰˜å®šä¹‰ã€‚å¯¹äºä¸Šé¢çš„ä»£ç ä¾‹å­ä¸­çš„æƒ…å†µä»¥åŠä»…è®¿é—®äº†é™æ€å˜é‡çš„è¡¨è¾¾å¼ï¼Œç¼–è¯‘å™¨éƒ½ä¼šé‡‡ç”¨è¿™æ ·çš„æ–¹æ¡ˆã€‚\næ¥ä¸‹æ¥ä»‹ç»å¦ä¸€ç§è¾ƒä¸ºç®€å•çš„æƒ…å†µï¼š lambdaè¡¨è¾¾å¼éœ€è¦è®¿é—®ç±»å‹çš„å®ä¾‹å˜é‡ï¼Œä½†æ— éœ€è®¿é—®å¤–å±‚æ–¹æ³•ä¸­çš„å±€éƒ¨å˜é‡ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 public class ModFilter { private readonly int modules; public ModFilter(int mod) { modules = mod; } public IEnumerable\u0026lt;int\u0026gt; FindValues(IEnumerable\u0026lt;int\u0026gt; sequence) { return from n in sequence where n % modules == 0 //æ–°æ·»åŠ çš„è¡¨è¾¾å¼ select n * n; //å’Œå‰é¢çš„ä¾‹å­æ˜¯ä¸€æ ·çš„ } } /* åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç¼–è¯‘å™¨å°†ä¸ºè¡¨è¾¾å¼åˆ›å»ºä¸€ä¸ªå®ä¾‹æ–¹æ³•æ¥åŒ…è£…è¯¥å§”æ‰˜ã€‚ å…¶åŸºæœ¬æ¦‚å¿µå’Œå‰ä¸€ç§æƒ…å†µä¸€è‡´ï¼Œåªæ˜¯è¿™é‡Œä½¿ç”¨äº†å®ä¾‹æ–¹æ³•ï¼Œä»¥ä¾¿è¯»å–å¹¶ä¿®æ”¹å½“å‰å¯¹è±¡çš„çŠ¶æ€ã€‚ ä¸é™æ€å§”æ‰˜çš„ä¾‹å­ä¸€æ ·ï¼Œè¿™é‡Œç¼–è¯‘å™¨å°†æŠŠlambdaè¡¨è¾¾å¼è½¬æ¢æˆæˆ‘ä»¬ç†Ÿæ‚‰çš„ä»£ç ã€‚å…¶ä¸­åŒ…å«å§”æ‰˜çš„å®šä¹‰ä»¥åŠæ–¹æ³•è°ƒç”¨ã€‚ å¦‚ä¸‹ï¼š */ public class ModFilter_Other { private readonly int modules; //å®ä¾‹æ–¹æ³• private bool WhereClause(int n) { return ((n%this.modules) ==0); } private static int SelectClause(int n) { return n * n; } private static Func\u0026lt;int, int\u0026gt; SelectDelegate; public ModFilter_Other(int mod) { modules = mod; } public IEnumerable\u0026lt;int\u0026gt; FindValues(IEnumerable\u0026lt;int\u0026gt; sequence) { if(SelectDelegate==null) { SelectDelegate = new Func\u0026lt;int, int\u0026gt;(SelectClause); } return sequence.Where\u0026lt;int\u0026gt;( new Func\u0026lt;int, bool\u0026gt;(this.WhereClause)). Select\u0026lt;int, int\u0026gt;(SelectClause); } } æ¦‚æ‹¬æ¥è¯´ä¾¿æ˜¯ï¼šlambdaè¡¨è¾¾å¼ä¸­çš„ä»£ç è®¿é—®äº†å¯¹è±¡å®ä¾‹ä¸­çš„æˆå‘˜å˜é‡ï¼Œé‚£ä¹ˆç¼–è¯‘å™¨å°†ç”Ÿæˆå®ä¾‹æ–¹æ³•æ¥è¡¨ç¤ºlambdaè¡¨è¾¾å¼ä¸­çš„ä»£ç ã€‚å…¶å®è¿™å¹¶æ²¡æœ‰ä»€ä¹ˆå¥‡ç‰¹ä¹‹å¤„â€”â€”ç¼–è¯‘å™¨çœå»äº†æˆ‘ä»¬çš„ä¸€äº›ä»£ç è¾“å…¥å·¥ä½œï¼Œä»£ç ä¹Ÿå˜å¾—æ•´æ´å¾ˆå¤šï¼Œæœ¬è´¨æ¥è¯´è¿™è¿˜æ˜¯æ™®é€šçš„æ–¹æ³•è°ƒç”¨ã€‚\nä¸è¿‡è‹¥æ˜¯lambdaè¡¨è¾¾å¼ä¸­è®¿é—®åˆ°äº†å¤–éƒ¨æ–¹æ³•ä¸­çš„å±€éƒ¨å˜é‡æˆ–è€…æ–¹æ³•å‚æ•°ï¼Œé‚£ä¹ˆç¼–è¯‘å™¨å°†å¸®ä½ å®Œæˆå¾ˆå¤šå·¥ä½œã€‚\nè¿™é‡Œä¼šç”¨åˆ°é—­åŒ…ã€‚ç¼–è¯‘å™¨å°†ç”Ÿæˆä¸€ä¸ªç§æœ‰çš„åµŒå¥—ç±»å‹ï¼Œä»¥ä¾¿ä¸ºå±€éƒ¨å˜é‡å®ç°é—­åŒ…ã€‚\nå±€éƒ¨å˜é‡å¿…é¡»ä¼ å…¥åˆ°å®ç°äº†lambdaè¡¨è¾¾å¼ä¸»ä½“éƒ¨åˆ†çš„å§”æ‰˜é‡Œã€‚\næ­¤å¤–ï¼Œæ‰€æœ‰ç”±è¯¥lambdaè¡¨è¾¾å¼æ‰§è¡Œçš„å¯¹è¿™äº›å±€éƒ¨å˜é‡æ‰€ä½œçš„ä¿®æ”¹éƒ½å¿…é¡»èƒ½å¤Ÿåœ¨å¤–éƒ¨è®¿é—®åˆ°ã€‚\nå½“ç„¶ï¼Œä»£ç ä¸­å†…å±‚å’Œå¤–å±‚ä¸­å…±äº«çš„å¯èƒ½ä¸æ­¢æœ‰ä¸€ä¸ªå˜é‡ï¼Œä¹Ÿå¯èƒ½ä¸æ­¢ä¸€ä¸ªçš„æŸ¥è¯¢è¡¨è¾¾å¼ã€‚\næˆ‘ä»¬æ¥ä¿®æ”¹ä¸€ä¸‹è¯¥å®ä¾‹æ–¹æ³•ï¼Œè®©å…¶è®¿é—®ä¸€ä¸ªå±€éƒ¨å˜é‡ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 public class ModFilter { private readonly int modules; public ModFilter(int mod) { modules = mod; } public IEnumerable\u0026lt;int\u0026gt; FindValues(IEnumerable\u0026lt;int\u0026gt; sequence) { int numValues = 0; return from n in sequence where n % modules == 0 //æ–°æ·»åŠ çš„è¡¨è¾¾å¼ select n * n / ++ numValues; //è®¿é—®å±€éƒ¨å˜é‡ } } æ³¨æ„ï¼Œselectå­—å¥éœ€è¦è®¿é—®numValuesè¿™ä¸ªå±€éƒ¨å˜é‡ã€‚ç¼–è¯‘å™¨ä¸ºäº†åˆ›å»ºè¿™ä¸ªé—­åŒ…ï¼Œéœ€è¦ä½¿ç”¨åµŒå¥—ç±»å‹æ¥å®ç°ä½ æ‰€éœ€è¦çš„è¡Œä¸ºã€‚ä¸‹é¢å±•ç¤ºçš„æ˜¯ç¼–è¯‘å™¨ä¸ºä½ ç”Ÿæˆçš„ä»£ç ã€‚ public class ModFilter { private sealed class Closure { public ModFilter outer; public int numValues; public int SelectClause(int n) { return ((n * n) / ++this.numValues); } } private readonly int modules; //å®ä¾‹æ–¹æ³• private bool WhereClause(int n) { return ((n % this.modules) == 0); } public ModFilter(int mod) { modules = mod; } public IEnumerable\u0026lt;int\u0026gt; FindValues(IEnumerable\u0026lt;int\u0026gt; sequence) { Closure c = new Closure(); c.outer = this; c.numValues = 0; return sequence.Where\u0026lt;int\u0026gt;( new Func\u0026lt;int, bool\u0026gt;(this.WhereClause)). Select\u0026lt;int, int\u0026gt;(c.SelectClause); } } åœ¨ä¸Šé¢è¿™æ®µä»£ç ä¸­ï¼Œç¼–è¯‘å™¨ä¸“é—¨åˆ›å»ºäº†ä¸€ä¸ªåµŒå¥—ç±»ï¼Œç”¨æ¥å®¹çº³æ‰€æœ‰å°†åœ¨lambdaè¡¨è¾¾å¼ä¸­è®¿é—®æˆ–ä¿®æ”¹çš„å˜é‡ã€‚å®é™…ä¸Šï¼Œè¿™äº›å±€éƒ¨å˜é‡å°†å®Œå…¨è¢«åµŒå¥—ç±»çš„å­—æ®µæ‰€ä»£æ›¿ã€‚lambdaè¡¨è¾¾å¼å†…éƒ¨çš„ä»£ç ä»¥åŠè¡¨è¾¾å¼å¤–éƒ¨(ä½†ä»åœ¨å½“å‰æ–¹æ³•å†…)çš„ä»£ç è®¿é—®çš„å‡æ˜¯åŒä¸€ä¸ªå­—æ®µï¼Œlambdaè¡¨è¾¾å¼ä¸­çš„é€»è¾‘ä¹Ÿè¢«ç¼–è¯‘æˆäº†å†…éƒ¨ç±»çš„ä¸€ä¸ªæ–¹æ³•ã€‚\nå¯¹äºlambdaè¡¨è¾¾å¼ä¸­å°†è¦ç”¨åˆ°çš„å¤–éƒ¨æ–¹æ³•çš„å‚æ•°ï¼Œç¼–è¯‘å™¨ä¹Ÿä¼šä»¥å¯¹å¾…å±€éƒ¨å˜é‡çš„æ–¹å¼å®ç°ï¼šç¼–è¯‘å™¨å°†è¿™äº›å‚æ•°å¤åˆ¶åˆ°è¡¨ç¤ºè¯¥é—­åŒ…çš„åµŒå¥—ç±»ä¸­ã€‚\nå›åˆ°æœ€å¼€å§‹çš„é‚£ä¸ªç¤ºä¾‹ï¼Œè¿™æ˜¯æˆ‘ä»¬åº”è¯¥å¯ä»¥ç†è§£è¿™ç§çœ‹ä¼¼æ€ªå¼‚çš„è¡Œä¸ºäº†ã€‚å˜é‡indexåœ¨ä¼ å…¥é—­åŒ…åï¼Œä½†åœ¨æŸ¥è¯¢å¼€å§‹æ‰§è¡Œå‰æ›¾è¢«å¤–éƒ¨ä»£ç ä¿®æ”¹ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä½ ä¿®æ”¹äº†é—­åŒ…çš„å†…éƒ¨çŠ¶æ€ï¼Œç„¶åè¿˜æœŸå¾…å…¶èƒ½å¤Ÿå›åˆ°ä»å‰çš„çŠ¶æ€å¼€å§‹æ‰§è¡Œï¼Œæ˜¾ç„¶è¿™æ˜¯ä¸å¯èƒ½å®ç°çš„ã€‚\nè€ƒè™‘åˆ°å»¶è¿Ÿæ‰§è¡Œä¸­çš„äº¤äº’ä»¥åŠç¼–è¯‘å™¨å®ç°é—­åŒ…çš„æ–¹å¼ï¼Œä¿®æ”¹æŸ¥è¯¢ä¸å¤–éƒ¨ä»£ç ä¹‹é—´ç»‘å®šçš„å˜é‡å°†å¯èƒ½ä¼šå¼•å‘é”™è¯¯çš„è¡Œä¸ºã€‚ å› æ­¤ï¼Œæˆ‘ä»¬åº”è¯¥å°½é‡é¿å…åœ¨æ–¹æ³•ä¸­ä¿®æ”¹å“ªäº›å°†è¦ä¼ å…¥åˆ°é—­åŒ…ä¸­ï¼Œå¹¶å°†åœ¨é—­åŒ…ä¸­ä½¿ç”¨çš„å˜é‡ã€‚\n","date":"2016-10-04T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/dotnet-lmabda%E9%81%BF%E5%85%8D%E4%BF%AE%E6%94%B9%E7%BB%91%E5%AE%9A%E5%8F%98%E9%87%8F/","title":"dotnet lmabdaé¿å…ä¿®æ”¹ç»‘å®šå˜é‡"},{"content":"ä¼—æ‰€å‘¨çŸ¥ï¼Œåœ¨HTTPSé¡µé¢è¯·æ±‚HTTPèµ„æ–™çš„æ—¶å€™ï¼Œç°ä»£æµè§ˆå™¨ä¼šæ‹¦æˆªï¼Œæç¤ºç”¨æˆ·æ˜¯å¦ç»§ç»­ï¼Œæˆ–è€…ç›´æ¥æ‹¦æˆªï¼Œæç¤ºéƒ½ä¸å‡ºæ¥ã€‚\næœ€è¿‘ç»™è‡ªå·±åšäº†ä¸ªå¿«é€Ÿä¹¦ç­¾å·¥å…·ï¼Œç‚¹å‡»ä¹¦ç­¾å°±ç›´æ¥æŠŠä¹¦ç­¾å‘é€åˆ°æœåŠ¡å™¨åœ°å€ï¼Œç„¶åä¿å­˜åˆ°æˆ‘çš„ç½‘ç«™ä¸­ã€‚\nä¸€å¼€å§‹ä¸€åˆ‡éƒ½æŒºæ­£å¸¸çš„ï¼Œä¸è¿‡é‡åˆ°äº†httpsçš„ç½‘ç«™çš„æ—¶å€™ï¼Œå°±è·ªæ‰äº†ã€‚\nå¼€å§‹çš„æ—¶å€™çœ‹åˆ°HTTPSè¯ä¹¦æ˜¯æ”¶è´¹çš„ï¼Œæƒ³æƒ³è¿˜æ˜¯ç®—äº†ï¼Œåæ­£å‡‘åˆèƒ½ç”¨å°±æ˜¯ã€‚å‰å‡ å¤©å¶å°”çœ‹åˆ°æœ‰ä¸€ä¸ªå…è´¹ç”³è¯·HTTPSçš„å¼€æºè½¯ä»¶ï¼Œå–µäº†ä¸€ä¸‹çœ‹èµ·æ¥è¿˜ä¸é”™ï¼Œè¿™å‡ å¤©æœ‰ç©ºäº†ç«‹é©¬å¼€å¹²ã€‚ä¸‹é¢æœ‰ä¸€ä¸ªæ•™ç¨‹ï¼Œæˆ‘ç”³è¯·è¯ä¹¦å·®ä¸å¤šå°±æ˜¯æŒ‰ç…§è¿™ä¸ªæ¥å¤„ç†çš„ã€‚\nç”¨Letâ€™s Encryptè·å–å…è´¹è¯ä¹¦\nå…³äºè¿™ä¸ªLet\u0026rsquo;s Encryptï¼Œç»´åŸºç™¾ç§‘æ˜¯è¿™æ ·ä»‹ç»çš„ï¼š\nLet\u0026rsquo;s Encrypt æ˜¯ä¸€ä¸ªå°†äº2015å¹´æœ«æ¨å‡ºçš„æ•°å­—è¯ä¹¦è®¤è¯æœºæ„ï¼Œå°†é€šè¿‡æ—¨åœ¨æ¶ˆé™¤å½“å‰æ‰‹åŠ¨åˆ›å»ºå’Œå®‰è£…è¯ä¹¦çš„å¤æ‚è¿‡ç¨‹çš„è‡ªåŠ¨åŒ–æµç¨‹ï¼Œä¸ºå®‰å…¨ç½‘ç«™æä¾›å…è´¹çš„SSL/TLSè¯ä¹¦ã€‚ Let\u0026rsquo;s Encrypt æ˜¯ç”±äº’è”ç½‘å®‰å…¨ç ”ç©¶å°ç»„ï¼ˆISRGï¼Œä¸€ä¸ªå…¬ç›Šç»„ç»‡ï¼‰æä¾›çš„æœåŠ¡ã€‚ä¸»è¦èµåŠ©å•†åŒ…æ‹¬ç”µå­å‰å“¨åŸºé‡‘ä¼šï¼ŒMozillaåŸºé‡‘ä¼šï¼ŒAkamaiä»¥åŠæ€ç§‘ã€‚2015å¹´4æœˆ9æ—¥ï¼ŒISRGä¸LinuxåŸºé‡‘ä¼šå®£å¸ƒåˆä½œã€‚ç”¨ä»¥å®ç°è¿™ä¸€æ–°çš„æ•°å­—è¯ä¹¦è®¤è¯æœºæ„çš„åè®®è¢«ç§°ä¸ºè‡ªåŠ¨è¯ä¹¦ç®¡ç†ç¯å¢ƒï¼ˆACMEï¼‰ã€‚ GitHubä¸Šæœ‰è¿™ä¸€è§„èŒƒçš„è‰æ¡ˆï¼Œä¸”ææ¡ˆçš„ä¸€ä¸ªç‰ˆæœ¬å·²ä½œä¸ºä¸€ä¸ªInternetè‰æ¡ˆå‘å¸ƒã€‚Let\u0026rsquo;s Encrypt å®£ç§°è¿™ä¸€è¿‡ç¨‹å°†ååˆ†ç®€å•ã€è‡ªåŠ¨åŒ–å¹¶ä¸”å…è´¹ã€‚ 2015å¹´8æœˆ7æ—¥ï¼Œè¯¥æœåŠ¡æ›´æ–°å…¶æ¨å‡ºè®¡åˆ’ï¼Œé¢„è®¡å°†åœ¨2015å¹´9æœˆ7æ—¥å½“å‘¨æŸæ—¶å‘å¸ƒé¦–ä¸ªè¯ä¹¦ï¼Œéšåå‘åˆ—å…¥ç™½åå•çš„åŸŸåå‘è¡Œå°‘é‡è¯ä¹¦å¹¶é€æ¸æ‰©å¤§å‘è¡Œã€‚è‹¥ä¸€åˆ‡æŒ‰è®¡åˆ’è¿›è¡Œï¼Œè¯¥æœåŠ¡é¢„è®¡å°†åœ¨2015å¹´11æœˆ16æ—¥å½“å‘¨æŸæ—¶å…¨é¢å¼€å§‹æä¾›.\næ•´ä¸ªé¡¹ç›®åœ¨Githubæœ‰ä»£ç ï¼Œä¸»è¦æ˜¯é€šè¿‡å®¢æˆ·ç«¯æ¥ä¸ºæˆ‘ä»¬çš„ç½‘ç«™ç”Ÿæˆhttpsè¯ä¹¦ã€‚ é¦–å…ˆæˆ‘ä»¬å…ˆä¸‹è½½å®¢æˆ·ç«¯ï¼Œå¦‚ä¸‹ï¼š\n1 git clone https://github.com/letsencrypt/letsencrypt.git æ¥ç€è¿›å…¥è¿™ä¸ªä»“åº“å†…ï¼Œæ‰§è¡Œä¸‹é¢ä»£ç ï¼š\n1 2 3 ./letsencrypt-auto certonly -a webroot\\ --webroot-path ç½‘ç«™æ‰€åœ¨è·¯å¾„(å¦‚ï¼š/var/www/web/) \\ -d ä½ çš„åŸŸå(å¦‚ï¼štest.online) -d www.ä½ çš„åŸŸå(å¦‚ww.test.online) è¿™é‡Œéœ€è¦æ³¨æ„çš„äº‹ï¼Œæˆ‘è¿™é‡Œä¸ºäº†æ’ç‰ˆï¼Œç»™ä¸Šé¢çš„å‘½ä»¤åŠ äº†æ¢è¡Œï¼Œè¿è¡Œè¿™ä¸ªå‘½ä»¤çš„æ—¶å€™è®°å¾—æŠŠæ¢è¡Œç¬¦å»æ‰ã€‚ æ¢è¡Œç¬¦åœ¨webrootã€-d å‰é¢å„æœ‰ä¸€ä¸ªã€‚\nä¸€åˆ‡é¡ºåˆ©çš„è¯ï¼Œæˆ‘ä»¬åœ¨/etc/letsencrypt/live/åŸŸå/è¿™ä¸ªç›®å½•ä¸‹èƒ½çœ‹åˆ°å››ä¸ªæ–‡ä»¶ï¼Œåˆ†åˆ«æ˜¯ï¼š\nåŸŸåè¯ä¹¦æ–‡ä»¶ ç­¾å‘åŸŸåè¯ä¹¦çš„è¯ä¹¦é“¾æ–‡ä»¶ åŸŸåè¯ä¹¦+è¯ä¹¦é“¾æ–‡ä»¶ ç§é’¥æ–‡ä»¶ å¦‚ä¸‹å›¾ï¼š æ¥ç€å°±æ˜¯ä¸ºç½‘ç«™è®¾ç½®è¯ä¹¦äº†ã€‚\nJexusè®¾ç½®HTTPSè¦æ›´æ”¹jws.confæ–‡æ¡£ä»¥åŠç½‘ç«™çš„é…ç½®æ–‡æ¡£ã€‚\næ“ä½œæ­¥éª¤å¦‚ä¸‹ï¼š\nä¿®æ”¹jws.conf è¿›å…¥Jexusæ–‡ä»¶å¤¹ä¸­ï¼Œæ‰“å¼€ â€œjws.confâ€ï¼Œæ·»åŠ ä¸‹é¢ä¸¤å¥ï¼š 1 2 CertificateFile = /etc/letsencrypt/live/åŸŸå/fullchain.pem CertificateKeyFile = /etc/letsencrypt/live/åŸŸå/privkey.pem ä¿®æ”¹ä¹‹åæ•ˆæœå›¾å¦‚ä¸‹ï¼š å¼€å¯ç½‘ç«™çš„HTTPSåŠŸèƒ½ è¿›å…¥siteconf/æ–‡ä»¶å¤¹ï¼Œæ‰¾åˆ°å¯¹åº”çš„ç½‘ç«™confæ–‡ä»¶ï¼Œ\næŠŠç½‘ç«™æœåŠ¡ç«¯å£æ”¹ä¸º443ï¼š port=443\nå¯ç”¨httpsï¼š UseHttps=true\nä¿®æ”¹ä¹‹åçš„æ•ˆæœå›¾å¦‚ä¸‹ï¼š ç„¶åé‡å¯jexuså³å¯ã€‚\nå®Œäº†ä¹‹åï¼Œé€šè¿‡HTTPSå³å¯è®¿é—®ã€‚\næœ€åä¸Šä¸€ä¸ªHTTPSè¯ä¹¦çš„å›¾è¯æ˜ä¸€ä¸‹è¿™ä¸ªæ˜¯å¯è¡Œçš„ã€‚ æ’’èŠ±ï¼Œä¸‹æ¬¡å†è§ã€‚\n","date":"2016-10-04T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/jexus%E6%94%AF%E6%8C%81https%E5%8D%8F%E8%AE%AE/","title":"Jexusæ”¯æŒHTTPSåè®®"},{"content":"æœ€è¿‘å®‰è£…Microsoft .NET Core 1.0.0 VS 2015 Tooling Preview 2å®åœ¨æœ‰ç‚¹æ›²æŠ˜ï¼Œå¿ä¸ä½å†™ä¸ªæ–‡ç« æ¥è®²è¿™è´§çš„å‘çˆ¹ä¹‹æ—…äº†ã€‚\nä¸€èˆ¬æˆ‘ä»¬åœ¨.NET Downloads ä¸‹è½½å›æ¥çš„Microsoft .NET Core 1.0.0 VS 2015 Tooling Preview 2æ˜¯ä¸€ä¸ªç®€æ˜“å®‰è£…åŒ…ã€‚\nå®ƒåœ¨å®‰è£…è¿‡ç¨‹ä¸­ä¼šä¸æ–­å»ç½‘ç»œè¯·æ±‚éœ€è¦çš„msiæ–‡ä»¶ï¼Œç¾åæ›°ï¼šåœ¨çº¿å®‰è£…ã€‚\nç„¶è€Œåœ¨æˆ‘å›½çš„å›½æƒ…ä»¥åŠæˆ‘å›½ç½‘ç»œè¿è¥å•†çš„è¡¬æ‰˜ä¸‹ï¼Œåœ¨çº¿å®‰è£…è¿™ç§ä¸œè¥¿å®åœ¨ä¸å¯æ­ç»´ã€‚\næœ¬æ¥ç½‘ç»œç¨³å®šï¼Œåœ¨çº¿å®‰è£… è¿™ç§é¬¼ä¹Ÿè¿˜ç®—èƒ½ç”¨ï¼Œä¸è¿‡æœ€è¿‘å¾®è½¯çˆ¸çˆ¸ä¸çŸ¥é“ä¸ºå˜›äº†ï¼Œ.net coreç›¸å…³å®‰è£…åŒ…çš„ä¸‹è½½åœ°å€å…¨çº¿å¤±æ•ˆã€‚ å¦‚DotNetCore.1.0.1-SDK.1.0.0.Preview2-003133-x64.exeï¼Œç›´æ¥å‡º502 Bad Gatewayã€‚\nè¿™ä¸ªè¿˜èƒ½ç”¨è¿…é›·æˆ–è€…å‘½ä»¤è¡Œä¸‹è½½å›æ¥ï¼Œä½†æ˜¯DotNetCore.1.0.1-SDK.1.0.0.Preview2è¿™è´§å®‰è£…è¿‡ç¨‹ä¸­éœ€è¦çš„ä¸€ä¸‹msiå®‰è£…åŒ…ï¼Œå°±æ­»æ´»ä¸‹ä¸å›æ¥äº†ã€‚\nå®‰è£…è¿‡ç¨‹æŠ¥é”™ï¼š0x80070003 ç³»ç»Ÿæ‰¾ä¸åˆ°éœ€è¦çš„æ–‡ä»¶ã€‚ æ­¤å¤„å·²ç¡®è®¤æ˜¯å¾®è½¯çˆ¸çˆ¸çš„bugäº†ã€‚issueåœ¨è¿™é‡Œ\nåˆ†ælog æˆ‘ä»¬å»çœ‹å®‰è£…å¤±è´¥çš„logï¼Œèƒ½çœ‹åˆ°ç±»ä¼¼ä¸‹é¢çš„logï¼š\nError 0x80072efd: Failed attempt to download URL: \u0026lsquo;https://download.microsoft.com/download/A/3/8/A38489F3-9777-41DD-83F8-2CBDFAB2520C/packages/ancm_iis_express_x64_en_rc2_39.msi' to: \u0026lsquo;C:\\Users\\cneuss\\AppData\\Local\\Temp{C307771D-8D9A-45B5-B514-B6CA69C0C6E2}\\ANCM_IISExpress_x64\u0026rsquo;\nå¾ˆæ˜æ˜¾è¿™ä¸ªæ“ä½œä»\nhttps://download.microsoft.com/download/A/3/8/A38489F3-9777-41DD-83F8-2CBDFAB2520C/packages/ancm_iis_express_x64_en_rc2_39.msi\nä¸Šé¢ä¸‹è½½ancm_iis_express_x64_en_rc2_39.msiæ–‡ä»¶ã€‚\nç„¶è€Œæˆ‘ä»¬ç‚¹å‡»è¿›å»ï¼Œçœ‹åˆ°è¿™ä¸ªåŒæ ·çš„é—®é¢˜ï¼š502 Bad Gatewayã€‚\nå®‰è£…åˆ°è¿™é‡Œï¼Œå·²ç»GGäº†ã€‚\nä¸è¿‡æ—¢ç„¶çŸ¥é“æ˜¯å› ä¸ºä¸‹è½½æ–‡ä»¶çš„é—®é¢˜äº†ï¼Œé‚£ä¹ˆè§£å†³åŠæ³•ä¹Ÿåº”è¿è€Œç”Ÿäº†ã€‚\næˆ‘ä»¬å®Œå…¨æ‰‹åŠ¨ä¸‹è½½æ–‡ä»¶ï¼ˆç”¨è¿…é›·æˆ–è€…åˆ«çš„ä¸‹è½½å·¥å…·ï¼‰ï¼Œå‘å¸ƒåœ¨æœ¬åœ°ï¼Œæ”¹hostsåœ°å€è®©ä¸‹è½½è¯·æ±‚ç›´æ¥ä»æœ¬åœ°ä¸‹è½½æ–‡ä»¶ã€‚\nè¿™ä¸ªæ–¹æ¡ˆå¬èµ·æ¥æ˜¯æ²¡æœ‰ä»»ä½•çš„é—®é¢˜çš„ï¼Œæˆ‘ä¹ŸæˆåŠŸä½¿ç”¨è¿…é›·æŠŠæ— æ³•ä¸‹è½½çš„æ–‡ä»¶ä¸‹è½½åˆ°æœ¬åœ°äº†ã€‚ç„¶è€Œåœ¨æ”¹hoståœ°å€è¿™é‡Œå¡ä½äº†ã€‚\nä¸çŸ¥é“ä¸ºå˜›ï¼Œæ— è®ºæˆ‘æŠŠdownload.microsoft.comæŒ‡å‘æ€ä¹ˆæ”¹ï¼Œä¹Ÿæ— æ³•æŠŠè¯·æ±‚é‡å®šå‘åˆ°æœ¬åœ°ã€‚\nåæ¥è®¤çœŸçœ‹äº†ä¸‹å®‰è£…logï¼Œå‘ç°æ‰€ä»¥çš„ä¸‹è½½æ“ä½œéƒ½æ˜¯æŠŠæ–‡ä»¶ä¸‹è½½åˆ° C:\\Users\\cneuss\\AppData\\Local\\Temp ç›®å½•ï¼ˆå…·ä½“ç›®å½•çœ‹logæ–‡ä»¶å†…å®¹ï¼‰ä¸‹çš„ä¸´æ—¶è·¯å¾„ï¼ŒæŠ¥é”™æ˜¯ç³»ç»Ÿæ‰¾ä¸åˆ°éœ€è¦çš„æ–‡ä»¶ã€‚\né‚£ä¹ˆï¼Œæˆ‘ä»¬æ‰‹åŠ¨æŠŠéœ€è¦çš„æ–‡ä»¶æ”¾åˆ°å¯¹åº”çš„ä½ç½®ï¼Œé—®é¢˜ä¹Ÿå°±è§£å†³äº†ã€‚\næ‰€ä»¥ï¼Œä¸ºäº†æ¸…æ™°æ‰¾åˆ°ä¸´æ—¶è·¯å¾„ï¼Œå®‰è£…ä¹‹å‰å…ˆæŠŠâ€œC:\\Users\\cneuss\\AppData\\Local\\Tempâ€çš„æ–‡ä»¶æ¸…ç©ºï¼Œç„¶åç‚¹å‡»å®‰è£…åŒ…ã€‚\nå¾ˆå¿«å¯ä»¥åœ¨tempè·¯å¾„ä¸‹çœ‹åˆ°å†’å‡ºæ¥çš„{xxxxxxxxxxxxx}æ–‡ä»¶å¤¹ï¼Œç„¶åè¿…é€ŸæŠŠæˆ‘ä»¬é€šè¿‡è¿…é›·ä¸‹è½½å›æ¥çš„æ–‡ä»¶ä»åˆ°è¿™ä¸ªç›®å½•åº•ä¸‹ã€‚\nè¿…é€Ÿæ“ä½œçš„åŸå› æ˜¯ï¼Œåœ¨çº¿å®‰è£…åŒ…æ­£åœ¨ä¸‹è½½æ‰€éœ€è¦çš„æ–‡ä»¶ï¼Œå¦‚ï¼šancm_iis_express_x64_en_rc2_39.msiï¼Œæˆ‘ä»¬è¦åœ¨ä¸‹è½½è¶…æ—¶ä¹‹å‰æŠŠæ–‡ä»¶åº”è¯¥åœ¨çš„ä½ç½®ï¼Œè¿™æ ·çš„è¯å³ä½¿ä¸‹è½½æ²¡æ‹¿åˆ°æ–‡ä»¶ï¼Œå®‰è£…ç¨‹åºè¿˜æ˜¯å¯ä»¥æ‹¿æˆ‘ä»¬çš„æ–‡ä»¶å»æ‰§è¡Œå®‰è£…ã€‚\nåˆ«çš„å°±æ˜¯ä¸æ–­å°è¯•ï¼Œçœ‹ç¼ºå°‘é‚£ä¸ªmsiæ‰‹åŠ¨ä¸‹å“ªä¸ªmsiçš„äº‹æƒ…äº†ã€‚\næœ€ç»ˆæ–¹æ¡ˆ æœ€åï¼Œæ ¹æ®logæ–‡ä»¶ï¼Œè¿˜å‘ç°äº†ä¸€ä¸ªæ›´ç®€å•çš„æ–¹æ³•ï¼š\nåœ¨DotNetCore.1.0.1-SDK.1.0.0.Preview2-003133-x64.exeçš„åŒçº§ç›®å½•ä¸‹æ–°å»ºpackagesæ–‡ä»¶å¤¹ï¼ŒæŠŠä¸Šé¢æ— æ³•åœ¨çº¿ä¸‹è½½åˆ°çš„msiä»è¿›å»ï¼Œç„¶åå°±ä¸€è·¯ç»¿ç¯äº†ã€‚\n","date":"2016-10-04T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/microsoft-.net-core-1.0.0-vs-2015-tooling-preview-2-0x80070003/","title":"Microsoft .NET Core 1.0.0 VS 2015 Tooling Preview 2 0x80070003"},{"content":"å‰å‡ å¤©åœ¨åšä¸€ä¸ªä½¿ç”¨URLé€šè¿‡WebRequestè¯·æ±‚HTMLé¡µé¢çš„åŠŸèƒ½çš„æ—¶å€™é‡åˆ°äº†ç‚¹å‘ï¼Œç¨‹åºåœ¨å¼€å‘ç¯å¢ƒæ²¡æœ‰ä»»ä½•çš„é—®é¢˜ï¼Œéƒ¨ç½²åˆ°linux monoä¸Šä¹‹åå°±è·ªäº†ã€‚ä»£ç å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 public static string GetHTML(string url) { string htmlCode; try { HttpWebRequest webRequest = (System.Net.HttpWebRequest)System.Net.WebRequest.Create(url); webRequest.Timeout = 30000; webRequest.Method = \u0026#34;GET\u0026#34;; webRequest.UserAgent = \u0026#34;Mozilla/4.0\u0026#34;; webRequest.Headers.Add(\u0026#34;Accept-Encoding\u0026#34;, \u0026#34;gzip, deflate\u0026#34;); HttpWebResponse webResponse = (System.Net.HttpWebResponse)webRequest.GetResponse(); //è·å–ç›®æ ‡ç½‘ç«™çš„ç¼–ç æ ¼å¼ string contentype = webResponse.Headers[\u0026#34;Content-Type\u0026#34;]; Regex regex = new Regex(\u0026#34;charset\\\\s*=\\\\s*[\\\\W]?\\\\s*([\\\\w-]+)\u0026#34;, RegexOptions.IgnoreCase); if (webResponse.ContentEncoding.ToLower() == \u0026#34;gzip\u0026#34;)//å¦‚æœä½¿ç”¨äº†GZipåˆ™å…ˆè§£å‹ { using (System.IO.Stream streamReceive = webResponse.GetResponseStream()) { using (var zipStream = new System.IO.Compression.GZipStream(streamReceive, System.IO.Compression.CompressionMode.Decompress)) { //åŒ¹é…ç¼–ç æ ¼å¼ if (regex.IsMatch(contentype)) { Encoding ending = Encoding.GetEncoding(regex.Match(contentype).Groups[1].Value.Trim()); using (StreamReader sr = new System.IO.StreamReader(zipStream, ending)) { htmlCode = sr.ReadToEnd(); } } else { using (StreamReader sr = new System.IO.StreamReader(zipStream, Encoding.UTF8)) { htmlCode = sr.ReadToEnd(); } } } } } else { using (System.IO.Stream streamReceive = webResponse.GetResponseStream()) { using (System.IO.StreamReader sr = new System.IO.StreamReader(streamReceive, Encoding.Default)) { htmlCode = sr.ReadToEnd(); } } } return htmlCode; }catch(Exception ex) { LogHelper.WriteException(\u0026#34;GetHTML\u0026#34;, ex, new { Url = url }); return \u0026#34;\u0026#34;; } } å¼€å‘ç¯å¢ƒåœ¨Windows10 + VS2013,æ•´ä¸ªä»£ç è·‘èµ·æ¥æ²¡ä»€ä¹ˆé—®é¢˜ã€‚\næ— è®ºæ˜¯HTTPè¿˜æ˜¯HTTPSåè®®ï¼Œç½‘é¡µHTMLä¸€æ ·èƒ½è·å–å¾—åˆ°ã€‚\nç½‘ç«™éƒ¨ç½²åˆ°linux Jexusä¹‹åHTTPåè®®çš„ç½‘ç«™åŒæ ·å¯ä»¥è·å–åˆ°HTMLï¼Œé‡åˆ°HTTPSåè®®çš„ç½‘ç«™çš„æ—¶å€™å°±è·ªäº†ã€‚\næŠ“åˆ°çš„å¼‚å¸¸ä¿¡æ¯å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 System.Net.WebException: Error: TrustFailure (The authentication or decryption has failed.) ---\u0026gt; System.IO.IOException: The authentication or decryption has failed. ---\u0026gt; System.IO.IOException: The authentication or decryption has failed. ---\u0026gt; Mono.Security.Protocol.Tls.TlsException: Invalid certificate received from server. Error code: 0xffffffff800b0109 at Mono.Security.Protocol.Tls.RecordProtocol.EndReceiveRecord (IAsyncResult asyncResult) \u0026lt;0x41b58d80 + 0x0013e\u0026gt; in \u0026lt;filename unknown\u0026gt;:0 at Mono.Security.Protocol.Tls.SslClientStream.SafeEndReceiveRecord (IAsyncResult ar, Boolean ignoreEmpty) \u0026lt;0x41b58cb0 + 0x00031\u0026gt; in \u0026lt;filename unknown\u0026gt;:0 at Mono.Security.Protocol.Tls.SslClientStream.NegotiateAsyncWorker (IAsyncResult result) \u0026lt;0x41b72a40 + 0x0023f\u0026gt; in \u0026lt;filename unknown\u0026gt;:0 --- End of inner exception stack trace --- at Mono.Security.Protocol.Tls.SslClientStream.EndNegotiateHandshake (IAsyncResult result) \u0026lt;0x41ba07e0 + 0x000f3\u0026gt; in \u0026lt;filename unknown\u0026gt;:0 at Mono.Security.Protocol.Tls.SslStreamBase.AsyncHandshakeCallback (IAsyncResult asyncResult) \u0026lt;0x41ba0540 + 0x00086\u0026gt; in \u0026lt;filename unknown\u0026gt;:0 --- End of inner exception stack trace --- at Mono.Security.Protocol.Tls.SslStreamBase.EndRead (IAsyncResult asyncResult) \u0026lt;0x41b73fd0 + 0x00199\u0026gt; in \u0026lt;filename unknown\u0026gt;:0 at Mono.Net.Security.Private.LegacySslStream.EndAuthenticateAsClient (IAsyncResult asyncResult) \u0026lt;0x41b73f30 + 0x00042\u0026gt; in \u0026lt;filename unknown\u0026gt;:0 at Mono.Net.Security.Private.LegacySslStream.AuthenticateAsClient (System.String targetHost, System.Security.Cryptography.X509Certificates.X509CertificateCollection clientCertificates, SslProtocols enabledSslProtocols, Boolean checkCertificateRevocation) \u0026lt;0x41b6a660 + 0x00055\u0026gt; in \u0026lt;filename unknown\u0026gt;:0 at Mono.Net.Security.MonoTlsStream.CreateStream (System.Byte[] buffer) \u0026lt;0x41b69c30 + 0x00159\u0026gt; in \u0026lt;filename unknown\u0026gt;:0 --- End of inner exception stack trace --- at System.Net.HttpWebRequest.EndGetResponse (IAsyncResult asyncResult) \u0026lt;0x41b67660 + 0x001f9\u0026gt; in \u0026lt;filename unknown\u0026gt;:0 at System.Net.HttpWebRequest.GetResponse () \u0026lt;0x41b60920 + 0x0005a\u0026gt; in \u0026lt;filename unknown\u0026gt;:0 at WebBookmarkUI.Commom.HTTPHelper.GetHTML (System.String url) \u0026lt;0x41b59b70 + 0x00235\u0026gt; in \u0026lt;filename unknown\u0026gt;:0 æœ‰ç©ºçš„ä¿¡æ¯åŸºæœ¬å°±æ˜¯ï¼š\nInvalid certificate received from server The authentication or decryption has failed ä¸€å¼€å§‹ç™¾æ€ä¸å¾—å…¶è§£ï¼Œä¸ºå˜›å¥½å¥½çš„ç¨‹åºåœ¨å¼€å‘ç¯å¢ƒè·‘å¾—éƒ½å¥½çš„ï¼Œåˆ°äº†monoä¸Šå°±æŒ‚äº†ï¼Œå¤šç–‘çš„æˆ‘è¿˜ä»¥ä¸ºæ˜¯monoçš„bugã€‚ ä»Šå¤©é™ä¸‹å¿ƒæ¥å»æ‰¾äº†ä¸€ä¸‹èµ„æ–™ï¼Œå‘ç°Monoçš„æ–‡æ¡£æœ‰è¿™ä¸ªé—®é¢˜çš„æè¿°ï¼Œè®¤çœŸè¯»äº†ä¸€éï¼Œåˆå»è¯·æ•™äº†ä¸€ç•ªå®‡å†…æµäº‘å¤§å¤§ï¼Œç»ˆäºå¼„æ‡‚äº†æ˜¯ä»€ä¹ˆå›äº‹ã€‚ å…ˆè´´ä¸€ä¸‹ç›¸å…³èµ„æ–™ï¼š\nstackoverflow mono-webrequest-fails-with-https\nmono doc security\nè¿™ä¸ªé—®é¢˜æ˜¯å‡ºç°çš„åŸå› æ˜¯Windowsè‡ªå¸¦äº†HTPPSçš„æ ¹è¯ä¹¦ï¼Œlinuxé»˜è®¤åˆ™æ˜¯æ²¡æœ‰å¸¦æœ‰æ ¹è¯ä¹¦çš„ã€‚æˆ‘ä»¬çš„monoåœ¨è°ƒç”¨WebRequestå»è¯·æ±‚HTTPSåè®®çš„ç½‘ç«™çš„æ—¶å€™ï¼ŒæŠ›å‡ºä¸Šä¸Šé¢çš„å¼‚å¸¸äº†ã€‚\nè§£å†³æ–¹æ¡ˆä¹Ÿå¾ˆç®€å•ï¼Œä¸ºlinuxå¯¼å…¥ä¸€ä¸‹HTTPSæ ¹è¯ä¹¦å°±å¥½ã€‚\nåœ¨linuxæœåŠ¡å™¨ä¸Šé¢æ‰§è¡Œä¸‹é¢è¿™æ¡å‘½ä»¤ã€‚\n1 mozroots --import --ask-remove --machine ç„¶ååœ¨ç½‘ç«™çš„Application_Start()é‡Œé¢æ·»åŠ ä¸‹é¢ä»£ç ï¼š\n1 2 3 4 5 6 7 System.Net.ServicePointManager.ServerCertificateValidationCallback += delegate(object sender, System.Security.Cryptography.X509Certificates.X509Certificate certificate, System.Security.Cryptography.X509Certificates.X509Chain chain, System.Net.Security.SslPolicyErrors sslPolicyErrors) { return true; // **** Always accept }; å®Œäº‹ã€‚\nè¿™ä¸ªæ•…äº‹å‘Šè¯‰æˆ‘ä»¬ï¼Œlinuxå¹²æ´»éƒ½æ˜¯è¦äº²åŠ›äº²ä¸ºå‘€ã€‚\n","date":"2016-10-04T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/mono-webreques-https-exception/","title":"mono webreques https exception"},{"content":"å¤‡å¿˜ç½‘ç«™ Markdown è¯­æ³•è¯´æ˜ (ç®€ä½“ä¸­æ–‡ç‰ˆ) Markdown: Basics ï¼ˆå¿«é€Ÿå…¥é—¨ï¼‰ ä½¿ç”¨GitHubå’ŒHexoæ­å»ºå…è´¹é™æ€Blog(æœ¬åšå®¢æ¡ˆä¾‹) ###å®‰è£…Hexo\n1 2 3 4 5 npm install hexo-cli -g npm install hexo --save #å¦‚æœå‘½ä»¤æ— æ³•è¿è¡Œï¼Œå¯ä»¥å°è¯•æ›´æ¢taobaoçš„npmæº npm install -g cnpm --registry=https://registry.npm.taobao.org å®‰è£…Hexoæ’ä»¶ 1 2 3 4 5 6 7 8 9 10 11 12 13 npm install hexo-generator-index --save npm install hexo-generator-archive --save npm install hexo-generator-category --save npm install hexo-generator-tag --save npm install hexo-server --save npm install hexo-deployer-git --save npm install hexo-deployer-heroku --save npm install hexo-deployer-rsync --save npm install hexo-deployer-openshift --save npm install hexo-renderer-marked@0.2 --save npm install hexo-renderer-stylus@0.2 --save npm install hexo-generator-feed@1 --save npm install hexo-generator-sitemap@1 --save winä¸‹é¢çš„gitå®¢æˆ·ç«¯æç¤ºFIlename too longè§£å†³æ–¹æ³• 1 git config --global core.longpaths true git-ssh é…ç½®å’Œä½¿ç”¨ ","date":"2016-10-04T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/%E5%A4%87%E5%BF%98%E7%BD%91%E7%AB%99/","title":"å¤‡å¿˜ç½‘ç«™"},{"content":"##å†™åœ¨å‰é¢\nåšçˆ¬è™«çš„å°ä¼™ä¼´ä¸€èˆ¬éƒ½ç»•ä¸è¿‡ä»£ç†IPè¿™ä¸ªé—®é¢˜.\nPS:å¦‚æœè¿˜æ²¡é‡åˆ°è¢«å°IPçš„åœºæ™¯ï¼Œè¦ä¸å°±æ˜¯ä½ é‡å¤ªå°äººå®¶æ‡’å¾—ç†ä½ ï¼Œè¦ä¸å°±æ˜¯äººå®¶å‹æ ¹ä¸åœ¨ä¹\u0026hellip;\nçˆ¬è™«ç”¨æˆ·è‡ªå·±æ˜¯æ²¡æœ‰èƒ½åŠ›ç»´æŠ¤ä¸€ç³»åˆ—çš„ä»£ç†æœåŠ¡å™¨å’Œä»£ç†IPçš„ï¼Œè¿™ä¸ªæˆæœ¬å®åœ¨æœ‰ç‚¹é«˜äº†ã€‚ æ‰€ä»¥å…¬ç”¨ä»£ç†æœåŠ¡å™¨åº”è¿è€Œç”Ÿ,ç°åœ¨å‡ å¤§äº‘æœåŠ¡å•†å®¶éƒ½æä¾›ä»£ç†IPæœåŠ¡ï¼Œä¸€èˆ¬è®ºä¸ªä¹°\u0026hellip;\nåŒæ—¶ç½‘ä¸Šä¹Ÿæœ‰å¾ˆå¤šä»£ç†IPå…±äº«ç½‘ç«™ï¼Œä¼šæŠŠä¸€äº›å…è´¹çš„ä»£ç†IPæ”¾å‡ºæ¥ç»™å¤§å®¶ç”¨ã€‚ å¤§å®¶éƒ½æ˜¯åšçˆ¬è™«çš„ï¼Œé‚£ä¹ˆï¼Œæ˜¯ä¸æ˜¯å¯ä»¥å…ˆæŠŠä»£ç†IPç½‘ç«™çš„æ•°æ®çˆ¬ä¸€éï¼Ÿ æ‰€ä»¥å¯ä»¥çœ‹åˆ°ä¸å°‘çš„çˆ¬ä»£ç†IPçš„çˆ¬è™«ï¼Œå¦‚çªç ´åçˆ¬è™«çš„åˆ©å™¨â€”â€”å¼€æºIPä»£ç†æ± ä¹‹ç±»çš„é¡¹ç›®ã€‚ è¿™äº›é¡¹ç›®éƒ½èƒ½è¾¾åˆ°æŠ“å–ä»£ç†IPæ•°æ®çš„ç›®çš„ï¼Œå¾ˆå¤šæ—¶å€™ä¹Ÿå¤Ÿç”¨äº†ã€‚\nç„¶è€Œåœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­æˆ‘ä»¬å‘ç°äº†ä¸€äº›é—®é¢˜ï¼š\nç½‘ç«™å…¬å¸ƒçš„ä»£ç†IPä¸ä¸€å®šæ˜¯å¯ç”¨çš„ã€‚å¯èƒ½ä»£ç†æœåŠ¡å™¨æŒ‚äº†ï¼Œå¯èƒ½IPæ— æ•ˆäº†\u0026hellip;ç­‰ç­‰ä¹‹ç±»çš„ã€‚ ä»£ç†IPæ˜¯éƒ¨åˆ†å¯ç”¨çš„ã€‚æŸä»£ç†IPå¯ç”¨ä»£ç†è®¿é—®ç™¾åº¦ï¼Œä½†æ˜¯ä»£ç†è®¿é—®è°·æ­Œçš„æ—¶å€™å°±GGäº†ã€‚ ä»£ç†è¿é€šæ€§æ˜¯å¥½çš„ï¼Œä½†æ˜¯å·²ç»è¢«è®¿é—®ç«™è¯†åˆ«ä¸ºä»£ç†IPè¿”å›éªŒè¯ç æˆ–è€…è¾£é¸¡æ•°æ®ã€‚ proxyipcenterçš„è§£å†³æ–¹æ¡ˆ å‡ºäºä»¥ä¸Šç§ç§çš„åŸå› ï¼ŒæŒ‰è€ä¸ä½çš„dalao(@virjar)å¼€å§‹è‡ªå·±åŠ¨æ‰‹æ’¸äº†ã€‚\näºæ˜¯ï¼Œproxyipcenterå‡ºæ¥äº†ã€‚\nè¿™ä¸ªé¡¹ç›®åšäº†ä»€ä¹ˆä¸œè¥¿å‘¢ï¼Ÿ dalaoæ˜¯è¿™æ ·å†™çš„ï¼š\nDungProxyæ˜¯ä¸€ä¸ªä»£ç†IPæœåŠ¡,ä»–åŒ…æ‹¬ä¸€ä¸ªä»£ç†IPèµ„æºserverç«¯å’Œä¸€ç³»åˆ—é€‚é…ä¸­å¿ƒIPèµ„æºå¾—å®¢æˆ·ç«¯ã€‚\nserverè´Ÿè´£ä»£ç†IPèµ„æºçš„æ”¶é›†ç»´æŠ¤ã€‚\nclientåˆ™æ˜¯ä¸€ç³»åˆ—æ–¹ä¾¿ç”¨æˆ·ä½¿ç”¨å¾—API,ä»–å±è”½äº†ä»£ç†IPä¸‹è½½ã€ä»£ç†IPé€‰å–ã€IPç»‘å®šã€IPåˆ‡æ¢ç­‰æ¯”è¾ƒå¤æ‚é€»è¾‘ã€‚ç”¨æˆ·åªéœ€è¦å¼•å…¥clientå³å¯æ–¹ä¾¿ä½¿ç”¨ä»£ç†IPæœåŠ¡\nç®€å•æ¥è¯´ï¼š\nserveræ˜¯ä¸€ä¸ªä»£ç†IPçˆ¬è™«ï¼ŒåŒæ—¶è´Ÿè´£ç®€å•çš„æ•°æ®æ¸…æ´—ã€‚\nclientæœ¬è´¨æ˜¯ä¸€ä¸ªä»£ç†IPæ± ï¼Œè·å–æ•°æ®æºä¹‹åï¼ŒåŸºäºéœ€è¦ä»£ç†è®¿é—®çš„ç½‘ç«™åœ¨æœ¬åœ°ç»´æŠ¤ä¸€ä¸ªä»£ç†IPæ± ä¾›çˆ¬è™«ä½¿ç”¨ã€‚\nä»¥ä¸‹å†…å®¹è½¬è½½è‡ªhttp://git.oschina.net/virjar/proxyipcenter, å¹¶å·²è·å¾—ç›¸å…³æˆæƒã€‚(PS:dalaoå†™çš„å¤ªå¥½äº†ï¼Œæˆ‘éƒ½æ‡’å¾—é‡æ–°å†™ä¸€éäº†\u0026hellip;é—®è¿‡dalaoä¹‹åç›´æ¥è½¬è½½è¿‡æ¥ç®—äº†ã€‚)\nproxyipcenter server DrungProxyçš„ä»£ç†IPéƒ½æ˜¯ä»äº’è”ç½‘æ”¶é›†,ä»–æ˜¯æ¶è®¾åœ¨ä¸€ä¸ªé«˜åº¦ä¸å¯ç”¨çš„èµ„æºä¸Šé¢çš„æœåŠ¡ã€‚serverä¼šè´Ÿè´£å¯¹è¿™äº›èµ„æºè¿›è¡Œæ¸…æ´—ã€æ ¡éªŒã€æ‰“åˆ†,æœ€ç»ˆè¾“å‡ºå¯ä»¥è¢«å®¢æˆ·ç«¯ä½¿ç”¨çš„IPèµ„æºã€‚IPèµ„æºä»å…¥åº“åˆ°æœ€ç»ˆåˆ¤å®šå¯ç”¨ç”Ÿå‘½æµç¨‹å¦‚ä¸‹\nIPæŠ“å– serverç›‘å¬äº†å¾ˆå¤šä»£ç†IPç½‘ç«™,è¿™äº›ç½‘ç«™åŒ…æ‹¬å›½å†…å¤–åå‡ å®¶,æœ‰æ„æ€çš„æ˜¯drungProxyçš„IPçˆ¬è™«æ˜¯ä¸€ç³»åˆ—ç½‘ç«™æ¨¡ç‰ˆã€‚äº”å…­è¡Œé…ç½®å³å¯å®ç°ä¸€ä¸ªç®€å•çš„ç½‘ç«™æ¨¡ç‰ˆ,ç„¶åæˆ‘ä»¬æœ‰ä¸€ä¸ªä¸Šå±‚è°ƒåº¦æ¨¡å—å°†ä¼šè´Ÿè´£è°ƒèµ·æ¨¡ç‰ˆè¿›è¡Œæ•°æ®æŠ“å–ã€‚ IPæ¶ˆé‡ éœ€è¦æ¶ˆé‡çš„åŸå› æ˜¯ç¨‹åºè¿è¡Œåˆ°ä¸€å®šæ—¶é—´ä¹‹å,å¤§é‡IPéƒ½æ˜¯æ•°æ®åº“é‡Œé¢å·²ç»å­˜åœ¨çš„äº†,è¿™ä¸ªæ—¶å€™å¦‚æœåœ¨æ•°æ®åº“è¿›è¡Œæ¶ˆé‡é€»è¾‘å°†ä¼šå¯¼è‡´å¤§é‡æ•°æ®åº“è¯»å†™,å®é™…ä¸Šæˆ‘ä»¬çš„æœåŠ¡å™¨æ˜¯ä¸€ä¸ª1å—é’±çš„è…¾è®¯äº‘(æ›¾ç»æ˜¯),çœ‹èµ·æ¥æ˜¯æ’‘ä¸ä½è¿™ä¹ˆå¤§çš„è¯·æ±‚çš„(å¹³å‡æ¯å¤©å¯ä»¥æœ‰10Ké‡çº§)ã€‚æœ€ååœ¨å…¥åº“å‰è®¾ç½®äº†ä¸€ä¸ªbloomFilteræ¶ˆé‡æ¨¡å—,èƒ½å¤Ÿé«˜æ•ˆçš„æ£€æµ‹èµ„æºæ˜¯å¦è¢«å…¥åº“è¿‡ã€‚ ä½ç½®ä¿¡æ¯å®Œå–„ è¿™ä¸ªé€»è¾‘ä¸å¤§,é€šè¿‡taobaoIpæ¥å£è·å–åœ°å€ä¿¡æ¯,å®Œå–„IPèµ„æºå…ƒæ•°æ®ã€‚taobaoIP IPéªŒè¯ IPéªŒè¯åˆ†ä¸ºå¥½å‡ ä¸ªæ­¥éª¤ã€‚æˆ‘ä»¬çš„IPæ€»èµ„æºæœ‰80W,æ£€éªŒä¸€ä¸ªIPæ˜¯å¦å¯ç”¨ä¸€èˆ¬æ¥è¯´éœ€è¦20ç§’å·¦å³çš„æ—¶é—´,å› ä¸ºä»£ç†IPæœ¬èº«å“åº”æ¯”è¾ƒæ…¢,æˆ‘ä»¬ä¼šæŠŠè¶…æ—¶æ—¶é—´è®¾ç½®å¾—æ¯”è¾ƒé•¿ã€‚æ‰€ä»¥å¯ä»¥è®¡ç®—ä¸€ä¸‹80Wæ•°æ®èµ°ä¸€è½®å°†è¦æ¶ˆè€—å¾—æ—¶é—´,å³ä½¿åœ¨å¤šçº¿ç¨‹å¹¶è¡Œç¯å¢ƒä¸‹æ—¶é—´ä¹Ÿæ˜¯å¾ˆå¤šçš„ã€‚ä¸ºäº†åœ¨ä¸€å®šèµ„æºä¸‹å®Œæˆæ ¡éªŒ,æˆ‘ä»¬è®¾è®¡äº†å¦‚ä¸‹æ­¥éª¤ ç«¯å£å¼€å¯æ ¡éªŒ,åœ¨è¿›è¡Œå¯ç”¨æ€§æ ¡éªŒå‰,é¦–å…ˆéœ€è¦æ£€æŸ¥IPç«¯å£æ˜¯å¦å¼€å¯ã€‚è°ƒç ”å‘ç°å¤§é‡èµ„æºå…¶å®ç«¯å£éƒ½ä¸é€š,æ‰€ä»¥ä¸“é—¨è®¾è®¡ä¸€ä¸ªä»»åŠ¡éªŒè¯ç«¯å£æ˜¯å¦å¼€å¯,ç«¯å£å¼€å¯éªŒè¯è¶…æ—¶æ—¶é—´ä¸º5ç§’ã€‚ç”±äºå¤§å¤šæ•°èµ„æºç«¯å£éƒ½æ²¡æœ‰å¼€å¯,æ‰€ä»¥å¤§éƒ¨åˆ†èµ„æºçš„æ ¡éªŒæ—¶é—´ä¸‹é™åˆ°5ç§’äº†ã€‚ å¯ç”¨æ€§æ ¡éªŒ,è¿›è¡Œå¯ç”¨æ€§æ ¡éªŒçš„éœ€è¦å…ˆè¿›è¡Œç«¯å£å¼€å¯æ ¡éªŒ,ç³»ç»Ÿä¸­ç«¯å£å¼€å¯çš„èµ„æºå¤§æ¦‚3W,æ‰€ä»¥æ ¡éªŒå¯ç”¨æ€§çš„æ€»èµ„æºæœ‰3Wå·¦å³ã€‚å¯ç”¨æ€§æ ¡éªŒå­˜åœ¨å¦‚ä¸‹é—®é¢˜,å¾ˆå¤šä»£ç†IPå…¶å®ä¸æ˜¯ä»£ç†ç½‘ç«™,æƒ³ä»–å‘é€è¯·æ±‚æœ€ç»ˆä¸æ˜¯æˆ‘ä»¬é¢„æœŸçš„æ•°æ®,æ¯”å¦‚ä»–è¿”å›ç»™æˆ‘ä»¬ä¸€ä¸ªä»£ç†IPè®¤è¯ç½‘é¡µã€‚æ‰€ä»¥æˆ‘ä»¬ä¸èƒ½æ ¹æ®æ˜¯å¦èƒ½å¤Ÿè¯·æ±‚åˆ°æ•°æ®æ¥åˆ¤å®šIPæ˜¯å¦å¯ç”¨ã€‚æˆ‘ä»¬çš„åšæ³•æ˜¯åœ¨å…¬ç½‘æ”¾ç½®ä¸€ä¸ªAPIæ¥å£,ç„¶åæ§åˆ¶ä»£ç†IPè®¿é—®æˆ‘ä»¬è‡ªå·±çš„æ¥å£,å¦‚æœèƒ½å¤Ÿæ‹¿åˆ°ç¬¦åˆæˆ‘ä»¬æ¥å£çš„é¢„æœŸæ•°æ®,é‚£ä¹ˆè®¤ä¸ºIPå¯ç”¨ã€‚ domainå¯ç”¨è¯¥æ ¡éªŒ,å¯ç”¨æ€§æ ¡éªŒé€šè¿‡ä¹‹åIPè¿˜ä¸æ˜¯çœŸæ­£å¯ç”¨,æ‚²ä¼¤çš„å‘ç°ä»£ç†IPæ˜¯å’ŒåŸŸåç›¸å…³çš„ã€‚æ‰€ä»¥åŒä¸€ä¸ªIPåœ¨ä¸åŒåŸŸåä¸‹è¡¨ç°å¯èƒ½ä¸ä¸€æ ·ã€‚æ‰€ä»¥æˆ‘ä»¬ç»´æŠ¤äº†ä¸€ä¸ªåŸŸåIPæ± ,è¿™é‡Œé¢å­˜å‚¨å„ä¸ªåŸŸåä¸‹å¯ç”¨IP IPåˆ†å‘ IPåˆ†å‘æ˜¯æ ¹æ®å®¢æˆ·è¯·æ±‚åˆ†é…å¯ç”¨IPã€‚åˆ†å‘é€»è¾‘ç°åœ¨è¿˜æ²¡æœ‰å®Œå…¨å®Œå–„,ä½†æ˜¯å·²ç»å®ç°äº†æœ€è¿«åˆ‡å’Œæœ‰æ ¡çš„åˆ†å‘æ–¹æ¡ˆã€‚åˆ†å‘é€»è¾‘è®¾è®¡æ˜¯:å…ˆå°è¯•æŸ¥è¯¢domainIPæ± ,å†æ ¹æ®å…¶ä»–è¯·æ±‚å‚æ•°åšæ¡ä»¶åŒ¹é…,å†æŸ¥è¯¢ç³»ç»Ÿå¯ç”¨IP,å†éšæœºé€‰æ‹©å¯ç”¨å¡«å……ã€‚å››ä¸ªæ­¥éª¤å¦‚æœæœ‰ä¸€ä¸ªæ­¥éª¤å¾—åˆ°çš„IPè¶…è¿‡è¯·æ±‚å‚æ•°æœŸå¾…æ•°ç›®,åˆ™ä¸è¿›è¡Œæ¥ä¸‹æ¥çš„åŠ¨ä½œã€‚ IPéªŒè¯æ¨¡å‹ å†IPéªŒè¯çš„æ—¶å€™,æˆ‘ä»¬è®¾è®¡äº†ä¸€ä¸ªæ¨¡å‹ç”¨æ¥ç¡®å®šå“ªäº›IPåº”è¯¥ä¼˜å…ˆéªŒè¯ã€‚æ¨¡å‹æè¿°å¦‚ä¸‹:é•¿æœŸå¯ç”¨IPæ£€æµ‹é¢‘ç‡ä½,é•¿æœŸä¸å¯ç”¨IPæ£€æµ‹è¯„ç‡ä½ã€‚ä¸ç¨³å®šIPå’ŒåˆšåŠ å…¥çš„IPæ£€æµ‹é¢‘ç‡é«˜ã€‚æˆ‘ä»¬ä½¿ç”¨ä¼˜å…ˆé˜Ÿåˆ—æ¥å®ç°è¿™ä¸ªé€»è¾‘,æ‰€æœ‰IPæ ¹æ®åˆ†å€¼æ”¾åœ¨ä¸åŒä¼˜å…ˆé˜Ÿåˆ—ä¸­,æ¯æ¬¡æ ¡éªŒçš„æ—¶å€™å†ä¸åŒä¼˜å…ˆé˜Ÿåˆ—ä¸­æ‹¿å‡ºä¸€å®šèµ„æºè¿›è¡Œæ ¡éªŒ(ä¸åŒä¼˜å…ˆçº§æ‹¿å‡ºçš„èµ„æºæ•°ç›®ä¸ä¸€æ ·,é«˜ä¼˜å…ˆçº§çš„å¯¹è±¡æ‹¿å‡ºæ›´å¤šèµ„æº),å¯¹äºåŒä¸€ä¸ªä¼˜å…ˆé˜Ÿåˆ—,æˆ‘ä»¬æ ¹æ®æœ€åéªŒè¯æ—¶é—´æ’åºã€‚ä½¿ä¸Šæ¬¡æ›´æ–°æ—¶é—´æœ€ä¹…çš„èµ„æºè¢«ä¼˜å…ˆé€‰æ‹©ã€‚\nåˆ†å‘å»é‡ åˆ†å‘èµ„æºçš„æ—¶å€™,è®¾è®¡å»é‡é—®é¢˜,ä¹Ÿå°±æ˜¯æ ¹æ®ç›¸åŒæ¡ä»¶,æ¯æ¬¡åˆ†å‘å¾—åˆ°çš„IPå¾ˆå¤§å¯èƒ½ä¼šé‡å¤ã€‚ä¸ºäº†è§„é¿è¿™ä¸ªé—®é¢˜,æ¯æ¬¡åˆ†å‘éƒ½ä¼šç›¸åº”çš„ä¸‹å‘ä¸€ä¸ªèµ„æºç­¾å,ä»–ä¼šè®°å½•åˆ†å‘è¿‡çš„IPã€‚åœ¨ä¸‹æ¬¡è¯·æ±‚çš„æ—¶å€™,å®¢æˆ·ç«¯éœ€è¦å¸¦ä¸Šè¿™ä¸ªç­¾å,æœåŠ¡å™¨ä¼šæ ¹æ®ç­¾åè¿‡æ»¤,åŒæ—¶ä¼šé‡æ–°å¯¹æ–°åˆ†å‘çš„IPèµ„æºåšå†æ¬¡ç­¾å.\nserveréƒ¨ç½² serverç«¯ä½¿ç”¨javaç¼–å†™,ä½¿ç”¨mavenç®¡ç†é¡¹ç›®,ä½¿ç”¨mysqlä½œä¸ºæ•°æ®åº“ã€‚ç›¸å…³æŠ€æœ¯åŒ…æ‹¬springMVC,spring,tomcat,mybatis,guava,fastjson,httpclientç­‰ã€‚ è¿è¡Œserverçš„æ–¹å¼å¾ˆç®€å•\nåœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œmavenå‘½ä»¤(éœ€è¦æå‰å®‰è£…maven,mavenå®‰è£…æ–¹å¼ç•¥)mvn install -Dmaven.test.skip=true åœ¨serverç›®å½•æ‰§è¡Œmavenå‘½ä»¤ mvn tomcat7:run serveré…ç½® ç›´æ¥è¿è¡Œé¡¹ç›®ä½¿ç”¨çš„æ˜¯æˆ‘ä»¬çš„é»˜è®¤æ•°æ®åº“,åŒæ—¶ä½¿ç”¨çš„æ˜¯é»˜è®¤é…ç½®ã€‚å®é™…ä¸Šserverå­˜åœ¨ä¸€äº›é…ç½®ç”¨æ¥è®¾ç½®è¿è¡Œå‚æ•°ã€‚åˆç†çš„è¿è¡Œå‚æ•°èƒ½å¤Ÿåˆç†ä½¿ç”¨æœºå™¨èµ„æºä»¥åŠè¾¾åˆ°æ›´å¥½çš„è¿è¡Œæ•ˆæœã€‚ é¡¹ç›®ä¸»è¦æœ‰ä¸¤ä¸ªé…ç½®æ–‡ä»¶éœ€è¦é…ç½®:\nmysql.properties ç”¨æ¥é…ç½®æ•°æ®åº“ä¿¡æ¯ config.properties é…ç½®å…¶ä»–å¯åŠ¨å‚æ•°,ä¸»è¦éœ€è¦å…³æ³¨é‡Œé¢å‡ ä¸ªurlåœ°å€,è¿˜æœ‰ system.thread.çš„å‚æ•°é¡¹ã€‚system.threadç”¨äºæŒ‡å®šæŸä¸€ç§ç±»å‹çš„ä»»åŠ¡æ‰§è¡Œçš„çº¿ç¨‹æ•°,å¦‚æœæ•°æ®å°äº1,åˆ™è¿™ä¸ªæ¨¡å—ä¸ä¼šå¯åŠ¨ã€‚ä½†æ˜¯å¦‚æœè¿™ä¸ªæ¨¡å—æ¥æ”¶åˆ°äº†ä»»åŠ¡è¯·æ±‚,é‚£ä¹ˆä»–ä¼šè½¬å‘åˆ°å…¶ä»–æœåŠ¡å™¨ä¸Šé¢(ä¹Ÿå°±æ˜¯ä¸Šé¢çš„ä¸¤ä¸ªforwardç›¸å…³çš„url,æ²¡åŠæ³•æœåŠ¡å™¨éƒ½æ˜¯è…Šé¸¡æœåŠ¡å™¨ ) å…¶ä»–çš„åº”è¯¥æ²¡æœ‰äº†æŠŠ,å“¦å¯¹äº†,é¡¹ç›®å­˜åœ¨å¤šä¸ªprofile,ä¹Ÿå°±æ˜¯resources.local,resources.beta,resources.prodç­‰ã€‚ä»–ä»¬å«åšprofile,æ˜¯mavené‡Œé¢çš„æ¦‚å¿µ,é»˜è®¤æ˜¯resources.localç”Ÿæ•ˆçš„ã€‚å¦‚æœæƒ³ä½¿ç”¨å…¶ä»–profileä¸‹é¢çš„é…ç½®,åˆ™å¢åŠ  -Pprofileå‚æ•°,å¦‚è¿è¡Œserver mvn -Pskyee clean tomcat7:run\nserveræ¥å£äº‹ä¾‹ http://115.159.40.202:8080/proxyipcenter/av?usedSign=\u0026amp;checkUrl=http%3A%2F%2Ffree-proxy-list.net%2F\u0026amp;domain=free-proxy-list.net\u0026amp;num=10\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 241 242 243 244 245 246 247 248 249 250 251 252 253 254 255 256 257 258 259 260 261 262 263 264 265 266 267 268 269 { \u0026#34;data\u0026#34;: { \u0026#34;data\u0026#34;: [ { \u0026#34;id\u0026#34;: 257, \u0026#34;ip\u0026#34;: \u0026#34;203.192.12.148\u0026#34;, \u0026#34;proxyIp\u0026#34;: \u0026#34;203.192.12.149\u0026#34;, \u0026#34;port\u0026#34;: 80, \u0026#34;ipValue\u0026#34;: 3418360980, \u0026#34;country\u0026#34;: \u0026#34;ä¸­å›½\u0026#34;, \u0026#34;area\u0026#34;: \u0026#34;ååŒ—\u0026#34;, \u0026#34;region\u0026#34;: \u0026#34;åŒ—äº¬å¸‚\u0026#34;, \u0026#34;city\u0026#34;: \u0026#34;åŒ—äº¬å¸‚\u0026#34;, \u0026#34;isp\u0026#34;: \u0026#34;\u0026#34;, \u0026#34;countryId\u0026#34;: \u0026#34;CN\u0026#34;, \u0026#34;areaId\u0026#34;: \u0026#34;100000\u0026#34;, \u0026#34;regionId\u0026#34;: \u0026#34;110000\u0026#34;, \u0026#34;cityId\u0026#34;: \u0026#34;110100\u0026#34;, \u0026#34;ispId\u0026#34;: \u0026#34;-1\u0026#34;, \u0026#34;transperent\u0026#34;: 2, \u0026#34;speed\u0026#34;: 104, \u0026#34;type\u0026#34;: 1, \u0026#34;connectionScore\u0026#34;: 1310, \u0026#34;availbelScore\u0026#34;: 8, \u0026#34;connectionScoreDate\u0026#34;: 1475641264000, \u0026#34;availbelScoreDate\u0026#34;: 1475646860000, \u0026#34;createtime\u0026#34;: 1473840886000, \u0026#34;lostheader\u0026#34;: false }, { \u0026#34;id\u0026#34;: 654, \u0026#34;ip\u0026#34;: \u0026#34;120.55.245.47\u0026#34;, \u0026#34;proxyIp\u0026#34;: \u0026#34;112.124.119.21\u0026#34;, \u0026#34;port\u0026#34;: 80, \u0026#34;ipValue\u0026#34;: 2016933167, \u0026#34;country\u0026#34;: \u0026#34;ä¸­å›½\u0026#34;, \u0026#34;area\u0026#34;: \u0026#34;åä¸œ\u0026#34;, \u0026#34;region\u0026#34;: \u0026#34;æµ™æ±Ÿçœ\u0026#34;, \u0026#34;city\u0026#34;: \u0026#34;æ­å·å¸‚\u0026#34;, \u0026#34;isp\u0026#34;: \u0026#34;é˜¿é‡Œäº‘\u0026#34;, \u0026#34;countryId\u0026#34;: \u0026#34;CN\u0026#34;, \u0026#34;areaId\u0026#34;: \u0026#34;300000\u0026#34;, \u0026#34;regionId\u0026#34;: \u0026#34;330000\u0026#34;, \u0026#34;cityId\u0026#34;: \u0026#34;330100\u0026#34;, \u0026#34;ispId\u0026#34;: \u0026#34;1000323\u0026#34;, \u0026#34;transperent\u0026#34;: 2, \u0026#34;speed\u0026#34;: 83, \u0026#34;type\u0026#34;: 1, \u0026#34;connectionScore\u0026#34;: 1429, \u0026#34;availbelScore\u0026#34;: 2, \u0026#34;connectionScoreDate\u0026#34;: 1475659905000, \u0026#34;availbelScoreDate\u0026#34;: 1475630273000, \u0026#34;createtime\u0026#34;: 1473840884000, \u0026#34;lostheader\u0026#34;: false }, { \u0026#34;id\u0026#34;: 2489, \u0026#34;ip\u0026#34;: \u0026#34;124.193.33.233\u0026#34;, \u0026#34;proxyIp\u0026#34;: \u0026#34;124.193.33.233\u0026#34;, \u0026#34;port\u0026#34;: 3128, \u0026#34;ipValue\u0026#34;: 2093031913, \u0026#34;country\u0026#34;: \u0026#34;ä¸­å›½\u0026#34;, \u0026#34;area\u0026#34;: \u0026#34;ååŒ—\u0026#34;, \u0026#34;region\u0026#34;: \u0026#34;åŒ—äº¬å¸‚\u0026#34;, \u0026#34;city\u0026#34;: \u0026#34;åŒ—äº¬å¸‚\u0026#34;, \u0026#34;isp\u0026#34;: \u0026#34;é¹åšå£«\u0026#34;, \u0026#34;countryId\u0026#34;: \u0026#34;CN\u0026#34;, \u0026#34;areaId\u0026#34;: \u0026#34;100000\u0026#34;, \u0026#34;regionId\u0026#34;: \u0026#34;110000\u0026#34;, \u0026#34;cityId\u0026#34;: \u0026#34;110100\u0026#34;, \u0026#34;ispId\u0026#34;: \u0026#34;1000143\u0026#34;, \u0026#34;transperent\u0026#34;: 2, \u0026#34;speed\u0026#34;: 3390, \u0026#34;type\u0026#34;: 1, \u0026#34;connectionScore\u0026#34;: 310, \u0026#34;availbelScore\u0026#34;: 2, \u0026#34;connectionScoreDate\u0026#34;: 1475657685000, \u0026#34;availbelScoreDate\u0026#34;: 1475661878000, \u0026#34;createtime\u0026#34;: 1473839334000, \u0026#34;lostheader\u0026#34;: false }, { \u0026#34;id\u0026#34;: 5004, \u0026#34;ip\u0026#34;: \u0026#34;203.192.12.146\u0026#34;, \u0026#34;proxyIp\u0026#34;: \u0026#34;203.192.12.149\u0026#34;, \u0026#34;port\u0026#34;: 80, \u0026#34;ipValue\u0026#34;: 3418360978, \u0026#34;country\u0026#34;: \u0026#34;ä¸­å›½\u0026#34;, \u0026#34;area\u0026#34;: \u0026#34;ååŒ—\u0026#34;, \u0026#34;region\u0026#34;: \u0026#34;åŒ—äº¬å¸‚\u0026#34;, \u0026#34;city\u0026#34;: \u0026#34;åŒ—äº¬å¸‚\u0026#34;, \u0026#34;isp\u0026#34;: \u0026#34;\u0026#34;, \u0026#34;countryId\u0026#34;: \u0026#34;CN\u0026#34;, \u0026#34;areaId\u0026#34;: \u0026#34;100000\u0026#34;, \u0026#34;regionId\u0026#34;: \u0026#34;110000\u0026#34;, \u0026#34;cityId\u0026#34;: \u0026#34;110100\u0026#34;, \u0026#34;ispId\u0026#34;: \u0026#34;-1\u0026#34;, \u0026#34;transperent\u0026#34;: 2, \u0026#34;speed\u0026#34;: 161, \u0026#34;type\u0026#34;: 1, \u0026#34;connectionScore\u0026#34;: 1291, \u0026#34;availbelScore\u0026#34;: 10, \u0026#34;connectionScoreDate\u0026#34;: 1475638336000, \u0026#34;availbelScoreDate\u0026#34;: 1475636727000, \u0026#34;createtime\u0026#34;: 1473840882000, \u0026#34;lostheader\u0026#34;: false }, { \u0026#34;id\u0026#34;: 5421, \u0026#34;ip\u0026#34;: \u0026#34;221.237.155.64\u0026#34;, \u0026#34;proxyIp\u0026#34;: \u0026#34;221.237.155.64\u0026#34;, \u0026#34;port\u0026#34;: 9797, \u0026#34;ipValue\u0026#34;: 3723336512, \u0026#34;country\u0026#34;: \u0026#34;ä¸­å›½\u0026#34;, \u0026#34;area\u0026#34;: \u0026#34;è¥¿å—\u0026#34;, \u0026#34;region\u0026#34;: \u0026#34;å››å·çœ\u0026#34;, \u0026#34;city\u0026#34;: \u0026#34;æˆéƒ½å¸‚\u0026#34;, \u0026#34;isp\u0026#34;: \u0026#34;ç”µä¿¡\u0026#34;, \u0026#34;countryId\u0026#34;: \u0026#34;CN\u0026#34;, \u0026#34;areaId\u0026#34;: \u0026#34;500000\u0026#34;, \u0026#34;regionId\u0026#34;: \u0026#34;510000\u0026#34;, \u0026#34;cityId\u0026#34;: \u0026#34;510100\u0026#34;, \u0026#34;ispId\u0026#34;: \u0026#34;100017\u0026#34;, \u0026#34;transperent\u0026#34;: 2, \u0026#34;speed\u0026#34;: 3238, \u0026#34;type\u0026#34;: 1, \u0026#34;connectionScore\u0026#34;: 119, \u0026#34;availbelScore\u0026#34;: -1, \u0026#34;connectionScoreDate\u0026#34;: 1475611973000, \u0026#34;availbelScoreDate\u0026#34;: 1475629954000, \u0026#34;createtime\u0026#34;: 1473840773000, \u0026#34;lostheader\u0026#34;: false }, { \u0026#34;id\u0026#34;: 8722, \u0026#34;ip\u0026#34;: \u0026#34;58.243.0.162\u0026#34;, \u0026#34;proxyIp\u0026#34;: \u0026#34;58.243.0.162\u0026#34;, \u0026#34;port\u0026#34;: 9999, \u0026#34;ipValue\u0026#34;: 989003938, \u0026#34;country\u0026#34;: \u0026#34;ä¸­å›½\u0026#34;, \u0026#34;area\u0026#34;: \u0026#34;åä¸œ\u0026#34;, \u0026#34;region\u0026#34;: \u0026#34;å®‰å¾½çœ\u0026#34;, \u0026#34;city\u0026#34;: \u0026#34;å®‰åº†å¸‚\u0026#34;, \u0026#34;isp\u0026#34;: \u0026#34;è”é€š\u0026#34;, \u0026#34;countryId\u0026#34;: \u0026#34;CN\u0026#34;, \u0026#34;areaId\u0026#34;: \u0026#34;300000\u0026#34;, \u0026#34;regionId\u0026#34;: \u0026#34;340000\u0026#34;, \u0026#34;cityId\u0026#34;: \u0026#34;340800\u0026#34;, \u0026#34;ispId\u0026#34;: \u0026#34;100026\u0026#34;, \u0026#34;transperent\u0026#34;: 2, \u0026#34;speed\u0026#34;: 5143, \u0026#34;type\u0026#34;: 1, \u0026#34;connectionScore\u0026#34;: 154, \u0026#34;availbelScore\u0026#34;: -3, \u0026#34;connectionScoreDate\u0026#34;: 1475665673000, \u0026#34;availbelScoreDate\u0026#34;: 1475614147000, \u0026#34;createtime\u0026#34;: 1473839836000, \u0026#34;lostheader\u0026#34;: false }, { \u0026#34;id\u0026#34;: 11698, \u0026#34;ip\u0026#34;: \u0026#34;218.7.170.190\u0026#34;, \u0026#34;proxyIp\u0026#34;: \u0026#34;218.7.170.190\u0026#34;, \u0026#34;port\u0026#34;: 3128, \u0026#34;ipValue\u0026#34;: 3657935550, \u0026#34;country\u0026#34;: \u0026#34;ä¸­å›½\u0026#34;, \u0026#34;area\u0026#34;: \u0026#34;ä¸œåŒ—\u0026#34;, \u0026#34;region\u0026#34;: \u0026#34;é»‘é¾™æ±Ÿçœ\u0026#34;, \u0026#34;city\u0026#34;: \u0026#34;ç»¥åŒ–å¸‚\u0026#34;, \u0026#34;isp\u0026#34;: \u0026#34;è”é€š\u0026#34;, \u0026#34;countryId\u0026#34;: \u0026#34;CN\u0026#34;, \u0026#34;areaId\u0026#34;: \u0026#34;200000\u0026#34;, \u0026#34;regionId\u0026#34;: \u0026#34;230000\u0026#34;, \u0026#34;cityId\u0026#34;: \u0026#34;231200\u0026#34;, \u0026#34;ispId\u0026#34;: \u0026#34;100026\u0026#34;, \u0026#34;transperent\u0026#34;: 2, \u0026#34;speed\u0026#34;: 3145, \u0026#34;type\u0026#34;: 1, \u0026#34;connectionScore\u0026#34;: 317, \u0026#34;availbelScore\u0026#34;: -1, \u0026#34;connectionScoreDate\u0026#34;: 1475642001000, \u0026#34;availbelScoreDate\u0026#34;: 1475524810000, \u0026#34;createtime\u0026#34;: 1473839128000, \u0026#34;lostheader\u0026#34;: false }, { \u0026#34;id\u0026#34;: 13318, \u0026#34;ip\u0026#34;: \u0026#34;220.249.185.178\u0026#34;, \u0026#34;proxyIp\u0026#34;: \u0026#34;220.249.185.178\u0026#34;, \u0026#34;port\u0026#34;: 9999, \u0026#34;ipValue\u0026#34;: 3707353522, \u0026#34;country\u0026#34;: \u0026#34;ä¸­å›½\u0026#34;, \u0026#34;area\u0026#34;: \u0026#34;åä¸œ\u0026#34;, \u0026#34;region\u0026#34;: \u0026#34;ç¦å»ºçœ\u0026#34;, \u0026#34;city\u0026#34;: \u0026#34;ç¦å·å¸‚\u0026#34;, \u0026#34;isp\u0026#34;: \u0026#34;è”é€š\u0026#34;, \u0026#34;countryId\u0026#34;: \u0026#34;CN\u0026#34;, \u0026#34;areaId\u0026#34;: \u0026#34;300000\u0026#34;, \u0026#34;regionId\u0026#34;: \u0026#34;350000\u0026#34;, \u0026#34;cityId\u0026#34;: \u0026#34;350100\u0026#34;, \u0026#34;ispId\u0026#34;: \u0026#34;100026\u0026#34;, \u0026#34;transperent\u0026#34;: 2, \u0026#34;speed\u0026#34;: 5094, \u0026#34;type\u0026#34;: 1, \u0026#34;connectionScore\u0026#34;: 129, \u0026#34;availbelScore\u0026#34;: -1, \u0026#34;connectionScoreDate\u0026#34;: 1475615670000, \u0026#34;availbelScoreDate\u0026#34;: 1475585178000, \u0026#34;createtime\u0026#34;: 1473840539000, \u0026#34;lostheader\u0026#34;: false }, { \u0026#34;id\u0026#34;: 57033, \u0026#34;ip\u0026#34;: \u0026#34;210.245.25.228\u0026#34;, \u0026#34;proxyIp\u0026#34;: \u0026#34;210.245.25.228\u0026#34;, \u0026#34;port\u0026#34;: 3128, \u0026#34;ipValue\u0026#34;: 3539278308, \u0026#34;country\u0026#34;: \u0026#34;è¶Šå—\u0026#34;, \u0026#34;area\u0026#34;: \u0026#34;\u0026#34;, \u0026#34;region\u0026#34;: \u0026#34;\u0026#34;, \u0026#34;city\u0026#34;: \u0026#34;\u0026#34;, \u0026#34;isp\u0026#34;: \u0026#34;\u0026#34;, \u0026#34;countryId\u0026#34;: \u0026#34;VN\u0026#34;, \u0026#34;areaId\u0026#34;: \u0026#34;\u0026#34;, \u0026#34;regionId\u0026#34;: \u0026#34;\u0026#34;, \u0026#34;cityId\u0026#34;: \u0026#34;\u0026#34;, \u0026#34;ispId\u0026#34;: \u0026#34;\u0026#34;, \u0026#34;transperent\u0026#34;: 2, \u0026#34;speed\u0026#34;: 1024, \u0026#34;type\u0026#34;: 1, \u0026#34;connectionScore\u0026#34;: 488, \u0026#34;availbelScore\u0026#34;: 36, \u0026#34;connectionScoreDate\u0026#34;: 1475635386000, \u0026#34;availbelScoreDate\u0026#34;: 1475630473000, \u0026#34;createtime\u0026#34;: 1473836572000, \u0026#34;lostheader\u0026#34;: false }, { \u0026#34;id\u0026#34;: 124334, \u0026#34;ip\u0026#34;: \u0026#34;60.194.72.253\u0026#34;, \u0026#34;proxyIp\u0026#34;: \u0026#34;60.194.72.253\u0026#34;, \u0026#34;port\u0026#34;: 3128, \u0026#34;ipValue\u0026#34;: 1019365629, \u0026#34;country\u0026#34;: \u0026#34;ä¸­å›½\u0026#34;, \u0026#34;area\u0026#34;: \u0026#34;ååŒ—\u0026#34;, \u0026#34;region\u0026#34;: \u0026#34;åŒ—äº¬å¸‚\u0026#34;, \u0026#34;city\u0026#34;: \u0026#34;åŒ—äº¬å¸‚\u0026#34;, \u0026#34;isp\u0026#34;: \u0026#34;é¹åšå£«\u0026#34;, \u0026#34;countryId\u0026#34;: \u0026#34;CN\u0026#34;, \u0026#34;areaId\u0026#34;: \u0026#34;100000\u0026#34;, \u0026#34;regionId\u0026#34;: \u0026#34;110000\u0026#34;, \u0026#34;cityId\u0026#34;: \u0026#34;110100\u0026#34;, \u0026#34;ispId\u0026#34;: \u0026#34;1000143\u0026#34;, \u0026#34;transperent\u0026#34;: 2, \u0026#34;speed\u0026#34;: 2366, \u0026#34;type\u0026#34;: 1, \u0026#34;connectionScore\u0026#34;: 610, \u0026#34;availbelScore\u0026#34;: 16, \u0026#34;connectionScoreDate\u0026#34;: 1475643516000, \u0026#34;availbelScoreDate\u0026#34;: 1475631080000, \u0026#34;createtime\u0026#34;: 1473839561000, \u0026#34;lostheader\u0026#34;: false } ], \u0026#34;num\u0026#34;: 10, \u0026#34;sign\u0026#34;: \u0026#34;9999#C99+999#9B99B99999##Y9999+9999999999999999999999t9999s99999999s9999999999999999999999999999#99999999999999GB999999999G9999s9s99999#9999999999Y9+999##99999999+99999999999999+999999999999B999+Y9999G9+99999999999YB99999999999999999999999+99Y999999999B9999G999s99G999999999#99999#9Y999s999999999#B99999999999999999999+999999Y9999999Y9999999999999Y9999Y999999999999999\u0026#34; }, \u0026#34;status\u0026#34;: true } proxyipcenter client client è®¾è®¡æ–‡æ¡£ client ä½¿ç”¨æ–‡æ¡£ clientè¿è¡ŒåŸç† è¿™é‡Œè®²è¿°IPæ± çš„è®¾è®¡ç›¸å…³,å¦‚æœæ‚¨ä»…ä»…æ˜¯ä¸ºäº†ä½¿ç”¨dunproxy-client,åˆ™ä¸å¿…å…³å¿ƒæœ¬æ–‡å†…å®¹\nclientå°±æ˜¯ä¸€ä¸ªä»£ç†IPæ± çš„å®ç°,IPæ± çš„è®¾è®¡åŸºäºä¸¤ä¸ªç‚¹:\nä»£ç†IPéƒ½æ˜¯ä¸ç¨³å®šçš„,ä¸å¯é çš„,éœ€è¦ä¸€ä¸ªæœºåˆ¶æ¥åˆ‡æ¢IP,å°½å¯èƒ½ä½¿ç”¨é«˜è´¨é‡IPã€‚\nIPå’Œç¯å¢ƒå…³ç³»å¾ˆå¤§,åŒä¸€ä¸ªIPåœ¨ä¸åŒçš„æœºå™¨ä¸‹è®¿é—®ä¸åŒçš„ç›®æ ‡ç½‘ç«™,å…¶å¯ç”¨æ€§è¡¨ç°éƒ½æ˜¯ä¸ä¸€æ ·çš„\nä½¿ç”¨IpPoolAPIè·å–IPèµ„æº è·å–IP è·å–ä¸€ä¸ªIPçš„æ–¹å¼æ˜¯è¿™æ ·çš„ IpPool.getInstance().bind(domain, accessUrl);\nç¬¬ä¸€ä¸ªå‚æ•°æ˜¯åŸŸå,å¯ä»¥ä¼ é€’null,ä¼ é€’nullæå–accessUrl schemaé‡Œé¢çš„host ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä½ å½“å‰éœ€è¦è®¿é—®çš„url, å¯ä»¥ä¸ºnull,ä¸ºnullæ—¶domainä¸èƒ½ä¸ºç©º æ›¾ç»æœ‰ä¸€ä¸ªç»‘å®šç”¨æˆ·çš„åŠŸèƒ½,ä½¿å¾—åŒä¸€ä¸ªè´¦æˆ·æ¯æ¬¡è·å–çš„IPç›¸åŒ,åæ¥è§‰å¾—æ˜¯è¿‡åº¦è®¾è®¡,å› ä¸ºå¯¹äºæŠ“å–åœºæ™¯,åˆ‡æ¢IPæ˜¯å¾ˆæ™®é€šçš„éœ€æ±‚,è€Œä¸”è²Œä¼¼æ²¡æœ‰å¤šå°‘serverä¼šæ£€æŸ¥å¸¸ç”¨IPã€‚å°±ç®—æœ‰ä¹Ÿæ˜¯å°ä¼—éœ€æ±‚,æœ¬æ¡†æ¶ä¸å¿…æ”¯æŒ\nè®°å½•IPä½¿ç”¨ æ¯å½“ä½¿ç”¨IPçš„æ—¶å€™,éœ€è¦è®°å½•ä¸€æ¬¡IPä½¿ç”¨,ä¹Ÿå°±æ˜¯å°†IPå®ä¾‹çš„ä½¿ç”¨æ¬¡æ•°åŠ ä¸€,ç”¨äºæ‰“åˆ†æœºåˆ¶è®¡ç®—IPçš„ä½¿ç”¨åˆ†å€¼,è¯„ä¼°IPå¯ç”¨æ€§ æ–¹å¼å¦‚ä¸‹:com.virjar.dungproxy.client.model.AvProxy.recordUsage\nè®°å½•IPä½¿ç”¨å¤±è´¥ æ¯å½“IPä½¿ç”¨å¤±è´¥çš„æ—¶å€™,éœ€è¦è®°å½•IPä½¿ç”¨å¤±è´¥,ä¹Ÿå°±æ˜¯å°†IPå®ä¾‹çš„å¤±è´¥æ¬¡æ•°åŠ ä¸€,ç”¨äºæ‰“åˆ†æœºåˆ¶è®¡ç®—IPçš„ä½¿ç”¨åˆ†å€¼,è¯„ä¼°IPå¯ç”¨æ€§ æ–¹å¼å¦‚ä¸‹:com.virjar.dungproxy.client.model.AvProxy.recordFailed()\nIPä¸‹çº¿ IPä¸‹çº¿å¾ˆç®€å•,æ‹¿åˆ°IPå®ä¾‹,è¿™æ ·è°ƒç”¨com.virjar.dungproxy.client.model.AvProxy.offline()ã€‚ ä¸€èˆ¬æƒ…å†µä¸å»ºè®®è¿™ä¹ˆåš,å› ä¸ºIPæ± ä¼šè‡ªåŠ¨æ£€æŸ¥IPæ˜¯å¦åº”è¯¥ä¸‹çº¿,IPæ± å¯ä»¥å®šåˆ¶å„ç§ç­–ç•¥ã€‚å½“æ—¶,æœ‰äº›æ—¶å€™IPæ± çš„æ£€æŸ¥æœºåˆ¶æ¯”è¾ƒç¼“æ…¢,è€Œä¸Šå±‚ä¸šåŠ¡å¯ä»¥æ˜ç¡®çŸ¥é“æœ¬IPä¸å¯ç”¨,è¿™ä¸ªæ—¶å€™å¯ä»¥ä½¿ç”¨æœ¬APIå¼ºåˆ¶ä¸‹çº¿\né”€æ¯IPæ± å®ä¾‹ IPæ± æ˜¯å•ä¾‹çš„,åŒæ—¶é‡Œé¢ç»´æŠ¤äº†ä¸¤ä¸ªä»»åŠ¡çº¿ç¨‹,åœ¨ä¸šåŠ¡å®Œæˆçš„æ—¶å€™,éœ€è¦é”€æ¯IPæ± æ‰èƒ½ç»ˆæ­¢å†…éƒ¨çº¿ç¨‹ã€‚åŒæ—¶ä¹Ÿä¼šæ‰§è¡Œä¸€äº›æ”¶å°¾å·¥ä½œ,å¦‚å°†å¯ç”¨IP dumpã€‚ é”€æ¯æ–¹å¼æ˜¯:com.virjar.dungproxy.client.ippool.IpPool.destroy\nå…¶ä»– IPæ± æœ‰å…¶ä»–å¾ˆå¤šæ‰©å±•ç‚¹,ä½†æ˜¯ç›®å‰æ¥å£æ²¡æœ‰å¼€å‘å®Œæˆ,å¾…åç»­å®Œå–„\nTODO å‡ ä¸ªä¸»æµè¯­è¨€çš„å®¢æˆ·ç«¯ .NET/.NET core client (è¾£é¸¡æ¥¼ä¸»è¿˜æ²¡åŠ¨æ‰‹\u0026hellip;) Python client(å¦å¤–ä¸€ä¸ªå¤§ä½¬å¥½åƒå¿˜äº†è¿™äº‹äº†\u0026hellip;) Golang client(å¯èƒ½è¿˜æ˜¯è¾£é¸¡æ¥¼ä¸»åŠ¨æ‰‹\u0026hellip;) ","date":"2016-10-04T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/%E5%8F%AF%E8%83%BD%E6%98%AF%E4%B8%80%E4%BB%BD%E6%B2%A1%E4%BB%80%E4%B9%88%E7%94%A8%E7%9A%84%E7%88%AC%E8%99%AB%E4%BB%A3%E7%90%86ip%E6%8C%87%E5%8D%97/","title":"å¯èƒ½æ˜¯ä¸€ä»½æ²¡ä»€ä¹ˆç”¨çš„çˆ¬è™«ä»£ç†IPæŒ‡å—"},{"content":"ä¸€äº›æœ‰ç”¨çš„è„šæœ¬ è·å–ç”µæ± ä½¿ç”¨æƒ…å†µæŠ¥å‘Š(battery-report)-ç”µæ± å†å²è®°å½• æ¥æºï¼šè·å–ç”µæ± ä½¿ç”¨æƒ…å†µæŠ¥å‘Š(battery-report)-ç”µæ± å†å²è®°å½•\nç‚¹å‡»ä»»åŠ¡æ æœç´¢æ¡†ï¼Œæœç´¢ï¼šPOWERSHELL é¼ æ ‡å³é”®ç‚¹å‡»æœç´¢ç»“æœä¸­çš„â€œWindows Powershellâ€ï¼Œç‚¹å‡»â€œä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œâ€ 1 $HTML=[System.Environment]::GetFolderPath(\u0026#39;Desktop\u0026#39;)+\u0026#34;\\\u0026#34;+(Get-Date -Format \u0026#39;yyyy-MM-dd\u0026#39;)+\u0026#34;-ç”µæ± è®°å½•.html\u0026#34;;POWERCFG /BATTERYREPORT /OUTPUT \u0026#34;$HTML\u0026#34;;$TF=Get-Content \u0026#34;$HTML\u0026#34;;$TF| %{$_.Replace(\u0026#34;Battery report\u0026#34;,\u0026#34;ç”µæ± æŠ¥å‘Š\u0026#34;)}| %{$_.Replace(\u0026#34;COMPUTER NAME\u0026#34;,\u0026#34;è®¡ç®—æœºå\u0026#34;)}| %{$_.Replace(\u0026#34;SYSTEM PRODUCT NAME\u0026#34;,\u0026#34;è®¡ç®—æœºå‹å·\u0026#34;)}| %{$_.Replace(\u0026#34;OS BUILD\u0026#34;,\u0026#34;æ“ä½œç³»ç»Ÿå†…éƒ¨ç‰ˆæœ¬\u0026#34;)}| %{$_.Replace(\u0026#34;PLATFORM ROLE\u0026#34;,\u0026#34;å¹³å°è§’è‰²\u0026#34;)}| %{$_.Replace(\u0026#34;CONNECTED STANDBY\u0026#34;,\u0026#34;InstantGoï¼ˆè¿æ¥å¾…æœºï¼‰\u0026#34;)}| %{$_.Replace(\u0026#34;REPORT TIME\u0026#34;,\u0026#34;æŠ¥å‘Šæ—¶é—´\u0026#34;)}| %{$_.Replace(\u0026#34;Installed batteries\u0026#34;,\u0026#34;å·²å®‰è£…çš„ç”µæ± \u0026#34;)}| %{$_.Replace(\u0026#34;Information about each currently installed battery\u0026#34;,\u0026#34;æŸ¥çœ‹å½“å‰å·²å®‰è£…ç”µæ± çš„ä¿¡æ¯\u0026#34;)}| %{$_.Replace(\u0026#34;NAME\u0026#34;,\u0026#34;åç§°\u0026#34;)}| %{$_.Replace(\u0026#34;MANUFACTURER\u0026#34;,\u0026#34;åˆ¶é€ å•†\u0026#34;)}| %{$_.Replace(\u0026#34;SERIAL NUMBER\u0026#34;,\u0026#34;åºåˆ—å·\u0026#34;)}| %{$_.Replace(\u0026#34;CHEMISTRY\u0026#34;,\u0026#34;åŒ–å­¦æˆåˆ†\u0026#34;)}| %{$_.Replace(\u0026#34;AT DESIGN CAPACITY\u0026#34;,\u0026#34;è®¾è®¡å®¹é‡æ—¶\u0026#34;)}| %{$_.Replace(\u0026#34;DESIGN CAPACITY\u0026#34;,\u0026#34;è®¾è®¡å®¹é‡\u0026#34;)}| %{$_.Replace(\u0026#34;FULL CHARGE CAPACITY\u0026#34;,\u0026#34;å®Œå…¨å……ç”µå®¹é‡\u0026#34;)}| %{$_.Replace(\u0026#34;CYCLE COUNT\u0026#34;,\u0026#34;å¾ªç¯è®¡æ•°\u0026#34;)}| %{$_.Replace(\u0026#34;Recent usage\u0026#34;,\u0026#34;æœ€è¿‘ä½¿ç”¨æƒ…å†µ\u0026#34;)}| %{$_.Replace(\u0026#34;Power states over the last 3 days\u0026#34;,\u0026#34;è¿‡å»72å°æ—¶å†…çš„ç”µæºçŠ¶æ€\u0026#34;)}| %{$_.Replace(\u0026#34;START TIME\u0026#34;,\u0026#34;å¼€å§‹æ—¶é—´\u0026#34;)}| %{$_.Replace(\u0026#34;STATE\u0026#34;,\u0026#34;çŠ¶æ€\u0026#34;)}| %{$_.Replace(\u0026#34;SOURCE\u0026#34;,\u0026#34;ç”µæº\u0026#34;)}| %{$_.Replace(\u0026#34;CAPACITY REMAINING\u0026#34;,\u0026#34;å‰©ä½™å®¹é‡\u0026#34;)}| %{$_.Replace(\u0026#34;Battery usage\u0026#34;,\u0026#34;ç”µæ± ä½¿ç”¨æƒ…å†µ\u0026#34;)}| %{$_.Replace(\u0026#34;Battery drains over the last 3 days\u0026#34;,\u0026#34;è¿‡å»72å°æ—¶å†…çš„ç”µæ± æ¶ˆè€—\u0026#34;)}| %{$_.Replace(\u0026#34;DURATION\u0026#34;,\u0026#34;ä½¿ç”¨æ—¶é—´\u0026#34;)}| %{$_.Replace(\u0026#34;ENERGY DRAINED\u0026#34;,\u0026#34;æ¶ˆè€—çš„èƒ½é‡\u0026#34;)}| %{$_.Replace(\u0026#34;Usage history\u0026#34;,\u0026#34;ä½¿ç”¨å†å²è®°å½•\u0026#34;)}| %{$_.Replace(\u0026#34;History of system usage on AC and battery\u0026#34;,\u0026#34;æœ‰å…³äº¤æµç”µæºå’Œç”µæ± çš„ä½¿ç”¨è®°å½•\u0026#34;)}| %{$_.Replace(\u0026#34;BATTERY DURATION\u0026#34;,\u0026#34;ç”µæ± ä½¿ç”¨æ—¶é—´\u0026#34;)}| %{$_.Replace(\u0026#34;AC DURATION \u0026#34;,\u0026#34;äº¤æµç”µæºä½¿ç”¨æ—¶é—´\u0026#34;)}| %{$_.Replace(\u0026#34;PERIOD\u0026#34;,\u0026#34;å‘¨æœŸ\u0026#34;)}| %{$_.Replace(\u0026#34;ACTIVE\u0026#34;,\u0026#34;æ´»åŠ¨\u0026#34;)}| %{$_.Replace(\u0026#34;Battery capacity history\u0026#34;,\u0026#34;ç”µæ± è®¾è®¡å®¹é‡å†å²è®°å½•\u0026#34;)}| %{$_.Replace(\u0026#34;Charge capacity history of the system\u0026#39;s batteries\u0026#34;,\u0026#34;ç”µæ± å……ç”µèƒ½åŠ›å†å²è®°å½•\u0026#34;)}| %{$_.Replace(\u0026#34;Battery life estimates based on observed drains\u0026#34;,\u0026#34;ä»¥è§‚å¯Ÿåˆ°çš„æ¶ˆè€—æƒ…å†µé¢„è®¡ç”µæ± å¯¿å‘½\u0026#34;)}| %{$_.Replace(\u0026#34;Battery life estimates\u0026#34;,\u0026#34;é¢„è®¡ç”µæ± å¯¿å‘½\u0026#34;)}| %{$_.Replace(\u0026#34;AT FULL CHARGE\u0026#34;,\u0026#34;å®Œå…¨å……ç”µæ—¶\u0026#34;)}| %{$_.Replace(\u0026#34;Current estimate of battery life based on all observed drains since OS install\u0026#34;,\u0026#34;ä»¥æ“ä½œç³»ç»Ÿå®‰è£…åæ‰€æœ‰è§‚å¯Ÿåˆ°çš„æ¶ˆè€—è®°å½•ä¸ºåŸºç¡€é¢„è®¡çš„å½“å‰ç”µæ± å¯¿å‘½\u0026#34;)}| %{$_.Replace(\u0026#34;Since OS install\u0026#34;,\u0026#34;ä»æ“ä½œç³»ç»Ÿå®‰è£…å\u0026#34;)}| %{$_.Replace(\u0026#34;Supported\u0026#34;,\u0026#34;æ”¯æŒ\u0026#34;)}| %{$_.Replace(\u0026#34;Not supported\u0026#34;,\u0026#34;ä¸æ”¯æŒ\u0026#34;)}| %{$_.Replace(\u0026#34;BATTERY\u0026#34;,\u0026#34;ç”µæ± \u0026#34;)}| %{$_.Replace(\u0026#34;Suspended\u0026#34;,\u0026#34;å·²æš‚åœ\u0026#34;)}| %{$_.Replace(\u0026#34;Active\u0026#34;,\u0026#34;æ´»åŠ¨\u0026#34;)}| %{$_.Replace(\u0026#34;Unspecified\u0026#34;,\u0026#34;æœªçŸ¥\u0026#34;)}| %{$_.Replace(\u0026#34;Mobile\u0026#34;,\u0026#34;ç§»åŠ¨\u0026#34;)}| %{$_.Replace(\u0026#34;Desktop\u0026#34;,\u0026#34;æ¡Œé¢\u0026#34;)}| %{$_.Replace(\u0026#34;Workstation\u0026#34;,\u0026#34;å·¥ä½œç«™\u0026#34;)}| %{$_.Replace(\u0026#34;Report generated\u0026#34;,\u0026#34;ç”Ÿæˆå½“å‰æŠ¥å‘Š\u0026#34;)}| %{$_.Replace(\u0026#34;Battery\u0026#34;,\u0026#34;ç”µæ± \u0026#34;)}| %{$_.Replace(\u0026#34;AC\u0026#34;,\u0026#34;äº¤æµç”µæº\u0026#34;)}|Out-File \u0026#34;$HTML\u0026#34;;pause ","date":"2016-10-04T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/%E4%B8%80%E4%BA%9B%E6%9C%89%E7%94%A8%E7%9A%84%E8%84%9A%E6%9C%AC/","title":"ä¸€äº›æœ‰ç”¨çš„è„šæœ¬"},{"content":"å¤–å…¬å¤–å©†èŠå¤©è®°å½• ç¬¬ä¸€éƒ¨åˆ†, å…³äºåœ°ä¸» æˆ‘: åº”è¯¥ä¸æ˜¯, XX åœ°æ–¹(ç¦»æˆ‘å®¶ä¸è¿œçš„ä¸€ä¸ªæ‘è½)é‚£è¾¹çš„åœ°ä¸», æˆ‘æœ‰ä¸ªåŒå­¦æ˜¯ XX æ‘è½çš„åœ°ä¸»æ›¾å­™, ä»–çˆ·çˆ·æ˜¯åœ°ä¸»å®¶çš„å„¿å­, å§“é‚“çš„.\nå¤–å…¬: é‚£æ˜¯é‚“æ˜å…‰çš„å„¿å­å§.\næˆ‘: é‚“æ˜å…‰çš„å„¿å­? åº”è¯¥ä¸æ˜¯, æˆ‘åŒå­¦çš„çˆ·çˆ·æ˜¯æˆ‘ä¸Šé«˜ä¸­çš„æ—¶å€™å»ä¸–çš„, ä»¥å‰æ˜¯åœ¨ XX å°è¯´å½“è€å¸ˆçš„, åŒå­¦çš„å¥¶å¥¶æ˜¯å¦ä¸€ä¸ªåœ°æ–¹çš„åœ°ä¸»å®¶çš„å¥³å„¿. é‚“æ˜å…‰? æ˜¯ XX é‚£ä¸ªåœ°æ–¹å°æ´‹æ¥¼çš„é‚£ä¸ªäººå—? ä¸‰å±‚çš„æ´‹æ¥¼, æ°´æ³¥åšçš„, ç™½è‰²åˆ·ç°, å¾ˆå¤šå¹´çš„å•¦(æœ‰ç‚¹å†å²çš„æ„æ€, é‚£ä¸ªæ¥¼åº”è¯¥æ˜¯æ°‘å›½æœŸé—´çš„å»ºç­‘).\nå¤–å©†: ç°åœ¨ä¸­åˆäº†, äººéƒ½ä¸çŸ¥é“é‚£é‡Œå»äº†. (ä¸å¤ªè®°å¾—ä¸ºä»€ä¹ˆå¤–å©†æ’äº†è¿™å¥è¯.)\nå¤–å…¬: å’³å—½.\næ‰é±¼çš„æ¸”ç½‘ æˆ‘: é‚£å¤–å…¬ä½ ä»¥å‰æ‰é±¼çš„ç½‘æ˜¯æ€ä¹ˆåšçš„?\nå¤–å…¬: ä¹œå˜¢?\næˆ‘: ä»¥å‰æ‰é±¼ç”¨çš„ç½‘æ˜¯æ€ä¹ˆåšçš„å‘€?\n","date":"2015-08-31T00:00:00Z","permalink":"https://liguobao.github.io/zh/p/%E5%A4%96%E5%85%AC%E5%A4%96%E5%A9%86%E8%81%8A%E5%A4%A9%E8%AE%B0%E5%BD%95/","title":"å¤–å…¬å¤–å©†èŠå¤©è®°å½•"}]